var xg;function Hg(og,pg){this.Vc=Array(8);null!=og&&null!=pg&&(this.Vc[0]=new THREE.Vector3(og.x,og.y,og.z),this.Vc[1]=new THREE.Vector3(pg.x,og.y,og.z),this.Vc[2]=new THREE.Vector3(og.x,pg.y,og.z),this.Vc[3]=new THREE.Vector3(og.x,og.y,pg.z),this.Vc[4]=new THREE.Vector3(pg.x,pg.y,og.z),this.Vc[5]=new THREE.Vector3(pg.x,og.y,pg.z),this.Vc[6]=new THREE.Vector3(og.x,pg.y,pg.z),this.Vc[7]=new THREE.Vector3(pg.x,pg.y,pg.z))}xg=Hg.prototype;
xg.applyMatrix4=function(og){if(null==this.Vc[0])return this;for(var pg=this.Vc.length,qg=0;qg<pg;qg++)this.Vc[qg].applyMatrix4(og);return this};xg.$e=function(){var og=null,pg=!0,qg=!1,rg=void 0;try{for(var sg=this.Vc[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0){var ug=tg.value;null!=ug&&(null==og?og=ug.clone():og.min(ug.clone()))}}catch(yg){qg=!0,rg=yg}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}return og};
xg.Ze=function(){var og=null,pg=!0,qg=!1,rg=void 0;try{for(var sg=this.Vc[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0){var ug=tg.value;null!=ug&&(null==og?og=ug.clone():og.max(ug.clone()))}}catch(yg){qg=!0,rg=yg}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}return og};xg.getCenter=function(){var og=this.$e(),pg=this.Ze();return null==og||null==pg?null:og.add(pg).multiplyScalar(.5)};xg.length=function(){var og=this.gr();return null==og?null:og.length()};
xg.gr=function(){var og=this.$e(),pg=this.Ze();return null==og||null==pg?null:pg.sub(og)};xg.merge=function(og){var pg=this.$e(),qg=this.Ze();if(null==og.$e()||null==og.Ze())return this;null==pg?pg=og.$e():pg.min(og.$e());null==qg?qg=og.Ze():qg.max(og.Ze());return new Hg(pg,qg)};xg.clone=function(){return new Hg(this.$e(),this.Ze())};
var Ng={Ac:"Actinium 7Act 20 f 89 [227] 2.15 2".split(" "),Al:"Aluminium 3 13 p 13 26.982 1.21 2".split(" "),Am:"Americium 7Act 20 f 95 [243] 1.8 2".split(" "),Sb:"Antimony 5 15 p 51 121.76 1.39 2".split(" "),Ar:"Argon 3 18 p 18 39.948 1.51 1.88".split(" "),As:"Arsenic 4 15 p 33 74.922 1.21 1.85".split(" "),At:"Astatine 6 17 p 85 [210] 1.21 2".split(" "),Ba:"Barium 6 2 s 56 137.327 2.15 2".split(" "),Bk:"Berkelium 7Act 20 f 97 [247] 1.54 2".split(" "),Be:"Beryllium 2 2 s 4 9.012 0.96 2".split(" "),
Bi:"Bismuth 6 15 p 83 208.98 1.48 2".split(" "),Bh:"Bohrium 7 7 d 107 [264] 1.5 2".split(" "),B:"Boron 2 13 p 5 10.811 0.83 2".split(" "),Br:"Bromine 4 17 p 35 79.904 1.21 1.85".split(" "),Cd:"Cadmium 5 12 d 48 112.411 1.54 1.58".split(" "),Cs:"Caesium 6 1 s 55 132.905 2.44 2".split(" "),Ca:"Calcium 4 2 s 20 40.078 1.76 2".split(" "),Cf:"Californium 7Act 20 f 98 [251] 1.83 2".split(" "),C:"Carbon 2 14 p 6 12.011 0.68 1.7".split(" "),Ce:"Cerium 6Lan 19 f 58 140.116 2.04 2".split(" "),Cl:"Chlorine 3 17 p 17 35.453 0.99 1.75".split(" "),
Cr:"Chromium 4 6 d 24 51.996 1.39 2".split(" "),Co:"Cobalt 4 9 d 27 58.933 1.26 2".split(" "),Cu:"Copper 4 11 d 29 63.546 1.32 1.4".split(" "),Cm:"Curium 7Act 20 f 96 [247] 1.69 2".split(" "),Ds:"Darmstadtium 7 10 d 110 [271] 1.5 2".split(" "),Db:"Dubnium 7 5 d 105 [262] 1.5 2".split(" "),Dy:"Dysprosium 6Lan 19 f 66 162.5 1.92 2".split(" "),Es:"Einsteinium 7Act 20 f 99 [252] 1.5 2".split(" "),Er:"Erbium 6Lan 19 f 68 167.26 1.89 2".split(" "),Eu:"Europium 6Lan 19 f 63 151.964 1.98 2".split(" "),Fm:"Fermium 7Act 20 f 100 [257] 1.5 2".split(" "),
F:"Fluorine 2 17 p 9 18.998 0.64 1.47".split(" "),Fr:"Francium 7 1 s 87 [223] 2.6 2".split(" "),Gd:"Gadolinium 6Lan 19 f 64 157.25 1.96 2".split(" "),Ga:"Gallium 4 13 p 31 69.723 1.22 1.87".split(" "),Ge:"Germanium 4 14 p 32 72.61 1.17 2".split(" "),Au:"Gold 6 11 d 79 196.967 1.36 1.66".split(" "),Hf:"Hafnium 6 4 d 72 178.49 1.75 2".split(" "),Hs:"Hassium 7 8 d 108 [269] 1.5 2".split(" "),He:"Helium 1 18 p 2 4.003 1.5 1.4".split(" "),Ho:"Holmium 6Lan 19 f 67 164.93 1.92 2".split(" "),H:"Hydrogen 1 1 s 1 1.008 0.23 1.09".split(" "),
In:"Indium 5 13 p 49 114.818 1.42 1.93".split(" "),I:"Iodine 5 17 p 53 126.904 1.4 1.98".split(" "),Ir:"Iridium 6 9 d 77 192.217 1.41 2".split(" "),Fe:"Iron 4 8 d 26 55.845 1.52 2".split(" "),Kr:"Krypton 4 18 p 36 83.8 1.5 2.02".split(" "),La:"Lanthanum 6Lan 19 f 57 138.906 2.07 2".split(" "),"Lr (Lw)":"Lawrencium 7 3 d 103 [262] 1.5 2".split(" "),Lr:"Lawrencium 7 3 d 103 [262] 1.5 2".split(" "),Lw:"Lawrencium 7 3 d 103 [262] 1.5 2".split(" "),Pb:"Lead 6 14 p 82 207.2 1.46 2.02".split(" "),Li:"Lithium 2 1 s 3 6.941 1.28 1.82".split(" "),
Lu:"Lutetium 6 3 d 71 174.967 1.87 2".split(" "),Mg:"Magnesium 3 2 s 12 24.305 1.41 1.73".split(" "),Mn:"Manganese 4 7 d 25 54.938 1.61 2".split(" "),Mt:"Meitnerium 7 9 d 109 [268] 1.5 2".split(" "),Md:"Mendelevium 7Act 20 f 101 [258] 1.5 2".split(" "),Hg:"Mercury 6 12 d 80 200.59 1.32 1.55".split(" "),Mo:"Molybdenum 5 6 d 42 95.94 1.54 2".split(" "),Nd:"Neodymium 6Lan 19 f 60 144.24 2.01 2".split(" "),Ne:"Neon 2 18 p 10 20.18 1.5 1.54".split(" "),Np:"Neptunium 7Act 20 f 93 [237] 1.9 2".split(" "),
Ni:"Nickel 4 10 d 28 58.693 1.24 1.63".split(" "),Nb:"Niobium 5 5 d 41 92.906 1.64 2".split(" "),N:"Nitrogen 2 15 p 7 14.007 0.68 1.55".split(" "),No:"Nobelium 7Act 20 f 102 [259] 1.5 2".split(" "),Os:"Osmium 6 8 d 76 190.23 1.44 2".split(" "),O:"Oxygen 2 16 p 8 15.999 0.68 1.52".split(" "),Pd:"Palladium 5 10 d 46 106.42 1.39 1.63".split(" "),P:"Phosphorus 3 15 p 15 30.974 1.05 1.8".split(" "),Pt:"Platinum 6 10 d 78 195.078 1.36 1.72".split(" "),Pu:"Plutonium 7Act 20 f 94 [244] 1.87 2".split(" "),
Po:"Polonium 6 16 p 84 [210] 1.4 2".split(" "),K:"Potassium 4 1 s 19 39.098 2.03 2.75".split(" "),Pr:"Praseodymium 6Lan 19 f 59 140.908 2.03 2".split(" "),Pm:"Promethium 6Lan 19 f 61 [145] 1.99 2".split(" "),Pa:"Protactinium 7Act 20 f 91 231.036 2 2".split(" "),Ra:"Radium 7 2 s 88 [226] 2.21 2".split(" "),Rn:"Radon 6 18 p 86 [222] 1.5 2".split(" "),Re:"Rhenium 6 7 d 75 186.207 1.51 2".split(" "),Rh:"Rhodium 5 9 d 45 102.906 1.42 2".split(" "),Rb:"Rubidium 5 1 s 37 85.468 2.2 2".split(" "),Ru:"Ruthenium 5 8 d 44 101.07 1.46 2".split(" "),
Rf:"Rutherfordium 7 4 d 104 [261] 1.5 2".split(" "),Sm:"Samarium 6Lan 19 f 62 150.36 1.98 2".split(" "),Sc:"Scandium 4 3 d 21 44.956 1.7 2".split(" "),Sg:"Seaborgium 7 6 d 106 [266] 1.5 2".split(" "),Se:"Selenium 4 16 p 34 78.96 1.22 1.9".split(" "),Si:"Silicon 3 14 p 14 28.086 1.2 2.1".split(" "),Ag:"Silver 5 11 d 47 107.868 1.45 1.72".split(" "),Na:"Sodium 3 1 s 11 22.991 1.66 2.27".split(" "),Sr:"Strontium 5 2 s 38 87.62 1.95 2".split(" "),S:"Sulphur 3 16 p 16 32.066 1.02 1.8".split(" "),Ta:"Tantalum 6 5 d 73 180.948 1.7 2".split(" "),
Tc:"Technetium 5 7 d 43 [98] 1.47 2".split(" "),Te:"Tellurium 5 16 p 52 127.6 1.47 2.06".split(" "),Tb:"Terbium 6Lan 19 f 65 158.925 1.94 2".split(" "),Tl:"Thallium 6 13 p 81 204.383 1.45 1.96".split(" "),Th:"Thorium 7Act 20 f 90 232.038 2.06 2".split(" "),Tm:"Thulium 6Lan 19 f 69 168.934 1.9 2".split(" "),Sn:"Tin 5 14 p 50 118.71 1.39 2.17".split(" "),Ti:"Titanium 4 4 d 22 47.867 1.6 2".split(" "),W:"Tungsten 6 6 d 74 183.84 1.62 2".split(" "),U:"Uranium 7Act 20 f 92 238.029 1.96 1.86".split(" "),
V:"Vanadium 4 5 d 23 50.942 1.53 2".split(" "),Xe:"Xenon 5 18 p 54 131.29 1.5 2.16".split(" "),Yb:"Ytterbium 6Lan 19 f 70 173.04 1.87 2".split(" "),Y:"Yttrium 5 3 d 39 88.906 1.9 2".split(" "),Zn:"Zinc 4 12 d 30 65.39 1.22 1.39".split(" "),Zr:"Zirconium 5 4 d 40 91.224 1.75 2".split(" "),XXXX:["Unknown",null,null,null,null,null,"1.5","2"]},Pg={bf:function(og){og=og[0].toUpperCase()+og.substr(1).toLowerCase();null==Ng[og]&&(og="XXXX");return Ng[og]}};
function Rg(){this.pos=new THREE.Vector3;this.Xi=this.sh=this.wd=this.gb=this.dw=this.symbol=this.$A=this.nz=this.Le=this.name=this.id=this.ja=null;this.Ha="\x00";this.Gb=this.$a=null}xg=Rg.prototype;xg.oa=function(){return this.id};xg.wa=function(){return this.$a};xg.Sl=function(og){this.$a=og;null!==og&&(this.Ao(this.$a.oa()),this.Rj(this.$a.Ha),this.hi(this.$a.gb),this.lg(this.$a.wd))};xg.Ao=function(og){this.Xi!==og&&(this.Xi=og,null!==this.$a&&this.$a.xe(og))};xg.xb=function(){return this.pos};
xg.bounds=function(){if(null===this.Gb){var og=parseFloat(Pg.bf(this.symbol)[7]),pg=new THREE.Vector3(-og,-og,-og),og=new THREE.Vector3(og,og,og);this.Gb=new Hg(pg,og)}return this.Gb};xg.radius=function(){return parseFloat(Pg.bf(this.symbol)[7])};xg.Rj=function(og){this.Ha!==og&&(this.Ha=og,null!=this.$a&&this.$a.Rj(this.Ha))};xg.hi=function(og){this.gb!=og&&(this.gb=og,null!==this.$a&&this.$a.hi(og))};xg.lg=function(og){this.wd!==og&&(this.wd=og,null!==this.$a&&this.$a.lg(og))};
xg.Qj=function(og){this.sh!==og&&(this.sh=og,null!==this.$a&&this.$a.Qj(og))};xg.td=function(){null!==this.$a&&this.$a.td()};xg.toString=function(){return this.symbol+":"+this.id};xg.eb=function(){return this.$a.eb()+":"+this.toString()};xg.nc=function(){return this.symbol+":"+this.id+":"+this.wd};xg.distanceTo=function(og){return og instanceof Rg?this.pos.distanceTo(og.pos):this.pos.distanceTo(og)};xg.distanceToSquared=function(og){return og instanceof Rg?this.pos.distanceToSquared(og.pos):this.pos.distanceToSquared(og)};
xg.sub=function(og){return og instanceof Rg?new THREE.Vector3(this.pos.x-og.pos.x,this.pos.y-og.pos.y,this.pos.z-og.pos.z):new THREE.Vector3(this.pos.x-og.x,this.pos.y-og.y,this.pos.z-og.z)};xg.add=function(og){return og instanceof Rg?new THREE.Vector3(this.pos.x+og.pos.x,this.pos.y+og.pos.y,this.pos.z+og.pos.z):new THREE.Vector3(this.pos.x+og.x,this.pos.y+og.y,this.pos.z+og.z)};xg.clone=function(){return new THREE.Vector3(this.pos.x,this.pos.y,this.pos.z)};
function Tg(og,pg,qg){this.name=og;this.code=pg;this.ct=qg||!1}Tg.ek=new Tg("Coil"," ");Tg.qm=new Tg("Turn","T");Tg.ug=new Tg("Helix","H");Tg.Gt=new Tg("Helix","H",!0);Tg.nh=new Tg("Strand","x");Tg.jh=new Tg("Strand","X");Tg.Lt=new Tg("Strand","x",!0);Tg.rt=new Tg("Strand","X",!0);Tg.prototype.toString=function(){return name};function Ug(){if(this.constructor===Ug)throw Error("Can't instanciate abstract class BiovizMap");}function Vg(){Ug.call(this);this.ta=new Map;this.If=new Map}Vg.prototype=Object.create(Ug.prototype);
xg=Vg.prototype;xg.constructor=Vg;xg.Mc=function(){this.ta=JSON.stringify(Wg(this.ta));this.If=JSON.stringify(Wg(this.If))};function Wg(og){if(Array.isArray(og)){for(var pg=0,qg=Array(og.length);pg<og.length;pg++)qg[pg]=og[pg];return qg}return Array.from(og)}xg.Vg=function(){this.ta=new Map(JSON.parse(this.ta));this.If=new Map(JSON.parse(this.If))};xg.set=function(og,pg){var qg=this.Jk(og);this.ta.set(qg,pg);this.If.set(qg,og)};
xg.get=function(og){og=this.Jk(og);return this.Kh(og)?this.ta.get(og):null};xg.remove=function(og){og=this.Jk(og);if(this.Kh(og)){var pg=this.ta.get(og);this.ta["delete"](og);this.If["delete"](og);return pg}return null};xg.Kh=function(og){og=this.Jk(og);return this.ta.has(og)};
xg.keys=function(){var og=[],pg=!0,qg=!1,rg=void 0;try{for(var sg=this.ta.keys()[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0)og.push(tg.value)}catch(ug){qg=!0,rg=ug}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}return og};xg.Nz=function(){var og=[],pg=!0,qg=!1,rg=void 0;try{for(var sg=this.If.keys()[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0)og.push(tg.value)}catch(ug){qg=!0,rg=ug}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}return og};
xg.values=function(){var og=[],pg=!0,qg=!1,rg=void 0;try{for(var sg=this.ta.values()[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0)og.push(tg.value)}catch(ug){qg=!0,rg=ug}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}return og};xg.clear=function(){this.ta.clear();this.If.clear()};
xg.fl=function(og){var pg=!0,qg=!1,rg=void 0;try{for(var sg=this.ta.keys()[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0){var ug=tg.value;if(this.ta.get(ug)===og)return ug}}catch(yg){qg=!0,rg=yg}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}};xg.Jk=function(og){if(og instanceof Array){og=[];for(var pg=og.length,qg=0;qg<pg;qg++)og.push(og[qg].nc());return og.join("")}return og instanceof Object?og.nc():og};Vg.__deps=[Ug,Wg];
function Xg(og,pg){this.aq=og;this.Oi=new Vg;this.Ob=pg}xg=Xg.prototype;xg.setValue=function(og){this.Ob=og.slice(0)};xg.lA=function(og){this.aq=og;for(var pg=og.length,qg=0;qg<pg;qg++)this.Oi.set(og[qg],qg)};xg.getValue=function(og,pg){return this.Oi.Kh(og)&&this.Oi.Kh(pg)?this.Ob[this.Oi.get(og)][this.Oi.get(pg)]:0};xg.clone=function(){var og=new Xg;og.setValue(this.Ob);og.lA(this.aq);return og};
xg.Xz=function(og){for(var pg=this.Ob.length,qg=0;qg<pg;qg++)for(var rg=this.Ob[qg].length,sg=0;sg<rg;sg++)this.Ob[qg][sg]*=og};xg.vx=function(){for(var og=this.Ob.length-1,pg=0,qg=this.Ob.length,rg=0;rg<qg;rg++)for(var sg=0;sg<=rg;sg++)rg!==sg&&(pg+=this.Ob[rg][sg]);return pg/((og*og-og)/2)};function Yg(og){this.$p=new Vg;for(var pg=og.length,qg=0;qg<pg;qg++){var rg=og[qg];this.$p.set(rg.getName(),rg)}}Yg.prototype.Tg=function(og){return this.$p.get(og)};
function Zg(og){this.Gm=og?og:Zg.lk.hk;this.Ak=null;this.Rp=this.Vp=NaN}Zg.Dt=10;Zg.Ht=100;Zg.pp=10;Zg.Nt=.1;Zg.bu=0;Zg.au=1;Zg.wp=2;Zg.vp=3;Zg.op=0;Zg.nk=1;Zg.mk=2;Zg.kh="-";
Zg.hk=new Xg("ABCDEFGHIKLMNPQRSTVWXYZ",[[24,0,5,-3,0,-23,5,-8,-8,-4,-12,-7,-3,3,-2,-6,11,6,1,-36,0,-22,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[5,0,115,-32,-30,-8,-20,-13,-11,-28,-15,-9,-18,-31,-24,-22,1,-5,0,-10,0,-5,0],[-3,0,-32,47,27,-45,1,4,-38,5,-40,-30,22,-7,9,-3,5,0,-29,-52,0,-28,0],[0,0,-30,27,36,-39,-8,4,-27,12,-28,-20,9,-5,17,4,2,-1,-19,-43,0,-27,0],[-23,0,-8,-45,-39,70,-52,-1,10,-33,20,16,-31,-38,-26,-32,-28,-22,1,36,0,51,0],[5,0,-20,1,-8,-52,66,-14,-45,-11,-44,-35,4,-16,-10,
-10,4,-11,-33,-40,0,-40,0],[-8,0,-13,4,4,-1,-14,60,-22,6,-19,-13,12,-11,12,6,-2,-3,-20,-8,0,22,0],[-8,0,-11,-38,-27,10,-45,-22,40,-21,28,25,-28,-26,-19,-24,-18,-6,31,-18,0,-7,0],[-4,0,-28,5,12,-33,-11,6,-21,32,-21,-14,8,-6,15,27,1,1,-17,-35,0,-21,0],[-12,0,-15,-40,-28,20,-44,-19,28,-21,40,28,-30,-23,-16,-22,-21,-13,18,-7,0,0,0],[-7,0,-9,-30,-20,16,-35,-13,25,-14,28,43,-22,-24,-10,-17,-14,-6,16,-10,0,-2,0],[-3,0,-18,22,9,-31,4,12,-28,8,-30,-22,38,-9,7,3,9,5,-22,-36,0,-14,0],[3,0,-31,-7,-5,-38,-16,
-11,-26,-6,-23,-24,-9,76,-2,-9,4,1,-18,-50,0,-31,0],[-2,0,-24,9,17,-26,-10,12,-19,15,-16,-10,7,-2,27,15,2,0,-15,-27,0,-17,0],[-6,0,-22,-3,4,-32,-10,6,-24,27,-22,-17,3,-9,15,47,-2,-2,-20,-16,0,-18,0],[11,0,1,5,2,-28,4,-2,-18,1,-21,-14,9,4,2,-2,22,15,-10,-33,0,-19,0],[6,0,-5,0,-1,-22,-11,-3,-6,1,-13,-6,5,1,0,-2,15,25,0,-35,0,-19,0],[1,0,0,-29,-19,1,-33,-20,31,-17,18,16,-22,-18,-15,-20,-10,0,34,-26,0,-11,0],[-36,0,-10,-52,-43,36,-40,-8,-18,-35,-7,-10,-36,-50,-27,-16,-33,-35,-26,142,0,41,0],[0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-22,0,-5,-28,-27,51,-40,22,-7,-21,0,-2,-14,-31,-17,-18,-19,-19,-11,41,0,78,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]);
Zg.ik=new Xg("ARNBDCQZEGHILKMFPSTWYVX*",[[1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,
-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,
-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,
-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,
-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,
-1E4,-1E4,-1E4,1,-1E4,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,1,-1E4,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,0,-1E4],[-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,-1E4,0]]);Zg.lk={hk:Zg.hk,ik:Zg.ik};xg=Zg.prototype;
xg.align=function(og){if(0===og.length)return new Yg;for(var pg=og.length,qg=0;qg<pg;qg++){var rg=og[qg];rg.Bo(rg.Je.toUpperCase())}if(2===og.length)pg=this.Tx(og[0].Je,og[1].Je),og[0].Bo(pg[0]),og[1].Bo(pg[1]),og=new Yg(og);else throw"Alignment must be computed with only 2 sequences, for advanced alignement, use Bioviz Java";return og};
xg.Tx=function(og,pg){var qg=this.Gm.clone(),rg=0;this.Gm===Zg.lk.hk?rg=Zg.Dt:this.Gm===Zg.lk.ik&&(rg=Zg.Ht);qg.Xz(rg);this.Ak=qg;qg=0>=-this.Ak.vx()?2*(Zg.pp+Math.log(Math.min(og.length,pg.length)))*rg:2*(Zg.pp+Math.log(Math.min(og.length,pg.length)));rg*=Zg.Nt;this.Vp=qg;this.Rp=rg;return this.eu(og,pg)};
xg.eu=function(og,pg){var qg=og.length,rg=pg.length,sg=this.ln(2,rg),tg=this.ln(qg,rg),ug=[rg];ug.fill(Zg.op);for(var yg=Number.MIN_VALUE,Bg=-1,Cg=-1,Ag=0;Ag<qg;Ag++){for(var wg=0;wg<rg;wg++)if(0===Ag||0===wg)sg[1][wg]=this.Ak.getValue(og.charAt(Ag),pg.charAt(wg)),0===Ag&&0!==wg&&(sg[1][wg]-=this.xk(Ag,qg,ug[wg-1]===Zg.mk),ug[wg]=Zg.mk),0===wg&&0!==Ag&&(sg[1][wg]-=this.xk(wg,rg,ug[wg]===Zg.nk),ug[wg]=Zg.nk),tg[Ag][wg]=Zg.bu;else{var Dg=sg[0][wg-1]+this.Ak.getValue(og.charAt(Ag),pg.charAt(wg)),Eg=
sg[1][wg-1]-this.xk(Ag,qg,ug[wg-1]===Zg.mk),Fg=sg[0][wg]-this.xk(wg,rg,ug[wg]===Zg.nk);sg[1][wg]=Math.max(Math.max(Dg,Eg),Fg);if(sg[1][wg]===Dg)tg[Ag][wg]=Zg.au,ug[wg]=Zg.op;else if(sg[1][wg]===Eg)tg[Ag][wg]=Zg.vp,ug[wg]=Zg.mk;else if(sg[1][wg]===Fg)tg[Ag][wg]=Zg.wp,ug[wg]=Zg.nk;else throw"Error when filling traceback matrix";(Ag===qg-1||wg===rg-1)&&sg[1][wg]>yg&&(yg=sg[1][wg],Bg=Ag,Cg=wg)}wg=sg[0];sg[0]=sg[1];sg[1]=wg}ug=sg="";Ag=qg-1;for(wg=rg-1;Ag>Bg&&0<=Ag;)sg+=og.charAt(Ag),ug+=Zg.kh,Ag--;for(;wg>
Cg&&0<=wg;)sg+=Zg.kh,ug+=pg.charAt(wg),wg--;for(;0<=Ag&&0<=wg;)0<Ag&&tg[Ag][wg]===Zg.vp?(sg+=Zg.kh,ug+=pg.charAt(wg),wg--):0<wg&&tg[Ag][wg]===Zg.wp?(sg+=og.charAt(Ag),ug+=Zg.kh,Ag--):(sg+=og.charAt(Ag),ug+=pg.charAt(wg),Ag--,wg--);for(;0<=Ag;)sg+=og.charAt(Ag),ug+=Zg.kh,Ag--;for(;0<=wg;)sg+=Zg.kh,ug+=pg.charAt(wg),wg--;return[sg.split("").reverse().join(""),ug.split("").reverse().join("")]};
xg.ln=function(og){var pg=Array(og||0),qg=og;if(1<arguments.length)for(var rg=Array.prototype.slice.call(arguments,1);qg--;)pg[og-1-qg]=this.ln.apply(this,rg);return pg};xg.xk=function(og,pg,qg){return 0===og||og===pg-1?0:qg?this.Rp:this.Vp};function $g(og,pg){this.Nu=og;this.Je=pg;this.zf=this.Ii=null}$g.prototype.Bo=function(og){this.Je=og;this.zf=this.Ii=null};$g.prototype.getName=function(){return this.Nu};
$g.prototype.Rr=function(og){if(null!==this.Je&&(null===this.zf&&this.mw(),null!==this.zf))return this.zf[og];throw Error("Can't find index ",og," in sequence");};$g.prototype.mw=function(){if(null!==this.Je){var og=this.Je.length;this.Ii=Array(og);var pg=0;this.zf=Array(og);for(var qg=0;qg<og;qg++){var rg=this.Je.charAt(qg);"A"<=rg&&"Z">=rg||"a"<=rg&&"z">=rg?(this.Ii[pg]=qg,this.zf[qg]=pg,pg++):this.zf[qg]=-1}this.Ii=this.Ii.slice(0,pg)}else this.zf=null};
function ah(){this.wh=this._id=null;this.xm=[]}xg=ah.prototype;xg.Ls=function(og,pg){void 0!==og&&(this._id=og);void 0!==pg&&(this.wh=pg)};xg.oa=function(){return this._id};xg.getAttributes=function(){return this.xm};xg.getAttribute=function(og){return this.xm[og]};xg.setAttribute=function(og,pg){this.xm[og]=pg};function bh(){ah.call(this);this.$r=!0;this.zd=this.be=null;this.vk=!1}bh.prototype=Object.create(ah.prototype);xg=bh.prototype;xg.constructor=bh;
xg.iA=function(og,pg,qg,rg,sg){this.Ls(pg,og);og===qg.wh&&og===rg.wh||console.warn("Error : nodes ",this.be,", ",this.zd," and edge ",pg," must all be part of same graph ",og);this.be=qg;this.zd=rg;!0!==sg&&(sg=!1);this.vk=sg};xg.cf=function(){return this.zd};xg.ne=function(og){if(this.be===og)return this.zd;if(this.zd===og)return this.be;console.warn(this.be,NaN+this.zd+":"+og);console.warn("Node "+og+" is not part of edge "+this.oa())};
xg.toString=function(){var og;og=""+this.be;og=this.vk?og+"->":og+"--";return og+=this.zd};function Node(){ah.call(this);this.De=null}Node.prototype=Object.create(ah.prototype);xg=Node.prototype;xg.constructor=Node;xg.oA=function(og,pg,qg){this.Ls(pg,og);void 0!==qg&&null!==qg&&(this.De=qg)};xg.me=function(){return this.wh.uj(this)};xg.Ex=function(og){var pg=this.me();if(pg)for(var qg=pg.length,rg=0;rg<qg;rg++)if(pg[rg].ne(this)===og)return rg};xg.Mr=function(og){return void 0!==this.Ex(og)};
xg.hy=function(og){return void 0!==this.Cx(og)};xg.Cx=function(og){var pg=this.me();if(pg)for(var qg=pg.length,rg=0;rg<qg;rg++){var sg=pg[rg];if(sg.vk&&sg.be===og&&sg.cf()===this)return sg}};xg.toString=function(){return this.oa()};xg.nc=function(){return this.oa()};xg.Dx=function(og){var pg=this.me();if(pg)for(var qg=pg.length,rg=0;rg<qg;rg++){var sg=pg[rg];if(sg.vk&&sg.be==this&&sg.cf()==og)return sg}};
function ch(){this.yu=this.Su=0;this.Jf=new Map;this.Yd=new Map;this.Vi=new Map;this.Df=new Map}xg=ch.prototype;xg.Qu=function(){return this.Su++};xg.Ou=function(){return this.yu++};xg.clear=function(){this.Jf.clear();this.Yd.clear();this.Vi.clear();this.Df.clear()};xg.fw=function(){this.Yd.clear();this.Df.clear()};xg.Wm=function(og,pg){void 0===pg&&(pg=null);var qg=new Node;qg.oA(this,og,pg);this.ov(qg);return qg};
xg.Jg=function(og){var pg;do pg=this.Qu();while(null!=this.Jf.get(pg));return this.Wm(pg,og)};xg.ov=function(og){null==og&&console.warn("Error : node undefined or null in Graph");og.wh!==this&&console.warn("Error : node with id ",og," must belong to this in graph");var pg=this.Jf.get(og.oa());null!=pg&&pg!==og?console.warn("Error : node with id ",og.oa()," already exists in graph"):(this.Jf.set(og.oa(),og),this.Vi.has(og.De)||this.Vi.set(og.De,og))};
xg.Pz=function(og){og=this.Jf.get(og);this.Vi.remove(og.De);for(var pg=og.me(),qg=pg.length,rg=0;rg<qg;rg++)this.vs(pg[rg]);this.Df["delete"](og)};xg.removeNode=function(og){this.Pz(og.oa())};xg.containsNode=function(og){return null!==og&&this.Jf.get(og.oa())===og};
xg.Mx=function(){var og=[],pg=this.Jf.values(),qg=!0,rg=!1,sg=void 0;try{for(var tg=pg[Symbol.iterator](),ug;!(qg=(ug=tg.next()).done);qg=!0)og.push(ug.value)}catch(yg){rg=!0,sg=yg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}return og};
xg.values=function(){var og=[],pg=!0,qg=!1,rg=void 0;try{for(var sg=this.Jf.values()[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0)og.push(tg.value.De)}catch(ug){qg=!0,rg=ug}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}return og};xg.findNode=function(og){return this.Vi.get(og)};xg.Gh=function(og,pg,qg){!0!==qg&&(qg=!1);var rg;do rg=this.Ou();while(null!=this.Yd.get(rg));return this.yw(rg,og,pg,qg)};
xg.yw=function(og,pg,qg,rg){!0!==rg&&(rg=!1);var sg=new bh;sg.iA(this,og,pg,qg,rg);this.kv(sg);return sg};
xg.kv=function(og){null==og&&console.warn("Error : edge is null in GRAPH");og.wh!==this&&console.warn("Error : edge with id ",og," must belong to this in graph");var pg=this.Yd.get(og.oa());if(null!=pg&&pg!==og)console.warn("Error : edge with id ",og.oa()," already exists in graph");else{this.Yd.set(og.oa(),og);var pg=[],pg=pg.concat(og.be),pg=pg.concat(og.zd),qg;for(qg in pg){var rg=this.Df.get(pg[qg]);null==rg&&(rg=[],this.Df.set(pg[qg],rg));rg.push(og)}}};
xg.vs=function(og){!0!==og.$r&&(og=this.Yd.get(og));if(this.uw(og)){this.Yd.remove(og.oa());var pg=this.Df.get(og.be);null!==pg&&delete pg[og];pg=this.Df.get(og.zd);null!==pg&&delete pg[og]}};xg.uw=function(og){return og.$r?null!==og&&this.Yd.get(og.oa())===og:null==this.Yd.get(og)};
xg.me=function(){var og=[],pg=!0,qg=!1,rg=void 0;try{for(var sg=this.Yd.values()[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0)og.push(tg.value)}catch(ug){qg=!0,rg=ug}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}return og};xg.uj=function(og){return this.Df.get(og)};function fh(og){this.id=og;this.$d=this.Ua=this.ja=null;this.ka=[];this.Zd=this.Gb=this.na=null;this.Gk=!1}fh.Wt=60;fh.Xt=20;fh.ea={};function gh(og,pg){this.name=og;this.es=pg}gh.prototype.toString=function(){return this.name};
fh.ea.Td=new gh("Protein","protein");fh.ea.vg=new gh("Peptide","peptide");fh.ea.wg=new gh("Small Peptide","smallpept");fh.ea.Ai=new gh("RNA","rna");fh.ea.wi=new gh("DNA","dna");fh.ea.xi=new gh("Ligand","ligand");fh.ea.lp=new gh("Ion","ion");fh.ea.sp=new gh("Solvent","solvent");fh.ea.rm=new gh("Unknown","unknown");xg=fh.prototype;xg.oa=function(){return this.id};xg.xe=function(og){if(this.id!==og){this.id=og;for(var pg=0;pg<this.ka.length;pg++)this.ka[pg].lg(og)}};
xg.Ms=function(og){if(this.co!==og){this.co=og;for(var pg=0;pg<this.ka.length;pg++)this.ka[pg].Qj(og)}};xg.hd=function(){return this.$d.hd()};xg.Sj=function(og){this.ja=og};xg.ii=function(og){this.Ua=og};xg.Ns=function(og){this.$d=og};xg.Ja=function(){return this};xg.add=function(og){null==og&&console.warn("residue is null in Molecule");null!==og.Ja()&&og.Ja()!==this&&console.warn(og," already belongs to ",og.Ja());null===og.Ja()&&(this.ka.push(og),og.Ps(this),this.td())};
xg.remove=function(og){null===og&&console.warn("residue is null in Molecule");og.Ja()===this&&(this.ka.remove(og),og.Ps(null),this.td())};xg.wa=function(og){for(var pg=0;pg<this.ka.length;pg++){var qg=this.ka[pg];if(qg.oa()==og||qg.dl()==og)return qg}return null};
xg.Qa=function(){var og=[],pg=!0,qg=!1,rg=void 0;try{for(var sg=this.ka[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0)og=og.concat(tg.value.Qa())}catch(ug){qg=!0,rg=ug}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}return og};xg.size=function(){return this.ka.length};xg.isEmpty=function(){return 0===this.size};xg.td=function(){this.Gb=this.na=null;null!==this.$d&&this.$d.td()};
xg.xb=function(){if(null===this.na){this.na=new THREE.Vector3;for(var og=this.Qa(),pg=og.length,qg=0;qg<pg;qg++){var rg=og[qg].pos;this.na.x+=rg.x;this.na.y+=rg.y;this.na.z+=rg.z}this.na.x/=pg;this.na.y/=pg;this.na.z/=pg}return this.na};
xg.bounds=function(){if(null===this.Gb){var og=new THREE.Vector3(Infinity,Infinity,Infinity),pg=new THREE.Vector3(-Infinity,-Infinity,-Infinity),qg=!0,rg=!1,sg=void 0;try{for(var tg=this.Qa()[Symbol.iterator](),ug;!(qg=(ug=tg.next()).done);qg=!0){var yg=ug.value.pos;og.x=Math.min(og.x,yg.x);og.y=Math.min(og.y,yg.y);og.z=Math.min(og.z,yg.z);pg.x=Math.max(pg.x,yg.x);pg.y=Math.max(pg.y,yg.y);pg.z=Math.max(pg.z,yg.z)}}catch(Bg){rg=!0,sg=Bg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;
}}this.Gb=new Hg(og,pg)}return this.Gb};xg.toString=function(){return this.ja.name+":"+this.id};xg.nc=function(){return this.toString()};xg.eb=function(){return this.Ua.eb()+":"+this.toString()};xg.lq=function(){null===this.ja||this.ja!==fh.ea.Td||this.Gk||(null===this.Zd&&this.pw(this.ka),this.qw(),this.Gk=!0)};
xg.qA=function(og){if(og.length!=this.ka.length)for(var pg=0,qg=this.ka.length;pg<qg;pg++){var rg=dsspSymbols[og[this.ka[pg]._id-1]];this.ka[pg].Eb=null!=rg?rg:Tg.ek}else for(pg=0,qg=this.ka.length;pg<qg;pg++)rg=dsspSymbols[og[pg]],this.ka[pg].Eb=null!=rg?rg:Tg.ek;this.Gk=!0};
xg.qw=function(){var og=this.ka.length,pg,qg,rg,sg;for(qg=0;qg<og;qg++)this.ka[qg].Eb=null;qg=1;for(sg=4;qg+sg<og;qg++)if(this.wc(this.ka[qg-1],this.ka[qg-1+sg])&&this.wc(this.ka[qg],this.ka[qg+sg]))for(rg=qg;rg<qg+sg;rg++)this.ka[rg].Eb=Tg.ug;for(qg=1;qg+1<og;qg++)for(rg=qg+3;rg+1<og;rg++)if(pg=this.ka[qg],sg=this.ka[rg],null===pg.Eb&&null===sg.Eb)if(this.wc(this.ka[qg-1],sg)&&this.wc(sg,this.ka[qg+1])||this.wc(this.ka[rg-1],pg)&&this.wc(pg,this.ka[rg+1]))pg.Eb=Tg.nh,sg.Eb=Tg.nh;else if(this.wc(pg,
sg)&&this.wc(sg,pg)||this.wc(this.ka[qg-1],this.ka[rg+1])&&this.wc(this.ka[rg-1],this.ka[qg+1]))pg.Eb=Tg.jh,sg.Eb=Tg.jh;qg=1;for(sg=3;qg+sg<og;qg++)if(this.wc(this.ka[qg-1],this.ka[qg-1+sg])&&this.wc(this.ka[qg],this.ka[qg+sg])){pg=!0;for(rg=qg;rg<qg+sg;rg++)if(null!=this.ka[rg]){pg=!1;break}for(rg=qg;rg<qg+sg;rg++)this.ka[rg].Eb=pg?Tg.ug:Tg.qm}qg=1;for(sg=5;qg+sg<og;qg++)if(this.wc(this.ka[qg-1],this.ka[qg-1+sg])&&this.wc(this.ka[qg],this.ka[qg+sg])){pg=!0;for(rg=qg;rg<qg+sg;rg++)if(null!=this.ka[rg]){pg=
!1;break}for(rg=qg;rg<qg+sg;rg++)this.ka[rg].Eb=pg?Tg.ug:Tg.qm}for(sg=3;5>=sg;sg++)for(qg=0;qg+sg<og;qg++)if(this.wc(this.ka[qg],this.ka[qg+sg]))for(rg=qg+1;rg<qg+sg;rg++)pg=this.ka[rg].Eb,null==pg&&(this.ka[rg].Eb=Tg.qm);for(qg=0;qg<og;qg++)pg=this.ka[qg].Eb,null==pg&&(this.ka[qg].Eb=Tg.ek)};xg.wc=function(og,pg){var qg=this.Zd.findNode(og);return null==qg?!1:qg.hy(this.Zd.findNode(pg))};
xg.pw=function(og){var pg=og.length;this.Zd=new ch;for(var qg=1;qg<pg;qg++){var rg=og[qg-1],sg=og[qg],tg=this.Zd.findNode(sg);null==tg&&(tg=this.Zd.Wm(sg.toString(),sg));var ug=sg.md("CA"),yg=sg.md("N");if(null!=ug&&null!=sg){var Bg=sg.md("H");if(rg.oa()+rg.Ha.charCodeAt(0)===sg.oa()+sg.Ha.charCodeAt(0)-1&&"PRO"!==rg.tf){Bg=rg.md("C");rg=rg.md("O");if(null==Bg||null==rg)continue;Bg=Bg.sub(rg);Bg=Bg.normalize();rg=yg.add(Bg);Bg=new Rg;Bg.name="H";Bg.symbol="H";Bg.pos.x=rg.x;Bg.pos.y=rg.y;Bg.pos.z=
rg.z}if(null!=Bg)for(rg=0;rg<pg;rg++)if(rg!=qg&&rg!=qg-1){var Cg=og[rg],sg=this.Zd.findNode(Cg);null==sg&&(sg=this.Zd.Wm(Cg.toString(),Cg));var Ag=Cg.md("CA"),wg=Cg.md("C"),Dg=Cg.md("O");if(null!=Ag&&null!=wg&&null!=Dg&&!(9<Ag.distanceTo(ug))){var Ag=Bg.distanceTo(Dg),Cg=Bg.distanceTo(wg),Dg=yg.distanceTo(Dg),Eg=yg.distanceTo(wg),wg=-9.9;.5>Ag||.5>Cg||.5>Dg||.5>Eg||(wg=27.888/Dg,wg+=27.888/Cg,wg-=27.888/Ag,wg-=27.888/Eg,-9.9>wg&&(wg=-9.9));-.5>wg&&(Ag=tg.Dx(sg),Cg=null!=Ag?Ag.getAttribute("eH"):0,
wg<Cg&&(this.Zd.Gh(tg,sg,!0).setAttribute("eH",wg),null!=Ag&&this.Zd.vs(Ag)))}}}}};xg.Tg=function(og){void 0===og&&(og=!0);for(var pg="",qg=this.ka,rg=0,sg="\x00",tg=this.Xf()?"X":this.Xh()?"N":"-",ug=qg.length,yg=0;yg<ug;yg++){var Bg=qg[yg];if(og&&0!=yg)for(rg=Bg.oa()-rg+Bg.Ha.charCodeAt(0)-sg.charCodeAt(0);1<rg--;)pg+=tg;pg+=Bg.tr();rg=Bg.oa();sg=Bg.Ha}return pg};xg.Xh=function(){return this.ja==fh.ea.wi||this.ja==fh.ea.Ai};
xg.Xf=function(){return this.ja==fh.ea.Td||this.ja==fh.ea.vg||this.ja==fh.ea.wg};xg.Yh=function(){return this.Xh()||this.Xf()};xg.Wh=function(){return this.ja===fh.ea.xi};xg.eo=function(og){var pg=new Zg,qg=[];qg.push(new $g(this.toString(),this.Tg(!1)));qg.push(new $g("ExternalSequence",og));og=pg.align(qg);og.Tg("ExternalSequence");this.ax=og.Tg(this.toString())};
xg.Gu=function(){for(var og=new Map,pg=0,qg=this.ka,rg=0,sg=0;sg<qg.length;sg++){var tg=qg[sg];if(null===tg.ja)rg++;else{var ug=og.get(tg.ja);void 0===ug&&(ug=0,og.set(tg.ja,ug),pg++);var yg=og.get(tg.ja)+1;og.set(tg.ja,yg)}}if(0!==pg){var pg=Infinity,Bg,qg=!0,sg=!1,tg=void 0;try{for(var Cg=og.keys()[Symbol.iterator](),Ag;!(qg=(Ag=Cg.next()).done);qg=!0){var ug=Ag.value,wg=og.get(ug);0!==wg&&wg<pg?(pg=wg,Bg=ug):wg===pg&&ug<Bg&&(Bg=ug)}}catch(Dg){sg=!0,tg=Dg}finally{try{!qg&&Cg["return"]&&Cg["return"]()}finally{if(sg)throw tg;
}}pg>=rg&&(Bg==fh.ea.Td?(og=this.size(),og<fh.Xt?this.Sj(fh.ea.wg):og<fh.Wt?this.Sj(fh.ea.vg):this.Sj(fh.ea.Td)):this.Sj(Bg))}else this.Sj(fh.ea.rm)};function hh(og,pg,qg,rg){this.name=og;this.Cq=pg;this.xv=qg;this.Ma=rg;var sg=arguments.length-4;1<=sg&&(this.Wy=arguments[4]);2<=sg&&(this.XA=arguments[5]);this.yv=arguments}var ih={il:function(og){for(var pg in ih)if(ih[pg].Cq===og)return ih[pg]}};ih.NONE=new hh("","NONE","NONE",null);
var jh={atom:"#F5A99580",residue:"#CCFF00",molecule:"#FF66CC"},kh={A:"#2424DC",B:"#AABDC0",C:"#00C500",D:"#5A00C1",E:"#96640A",F:"#F5A995",G:"#2EF7F0",H:"#C1C1BC",I:"#E8A432",J:"#0AFA0A",K:"#49C8C8",L:"#C8C80A",M:"#64C864",N:"#CB70BB",O:"#960096",P:"#531966",Q:"#173232",R:"#AA4664",S:"#7B7B7B",T:"#189A8F",U:"#F57B15",V:"#EA22EA",W:"#82B4BE",X:"#828282",Y:"#505050",Z:"#323232",0:"#7B7B7B",1:"#189A8F",2:"#F57B15",3:"#EA22EA",4:"#82B4BE",5:"#828282",6:"#505050",7:"#323232",8:"#A050FA",9:"#1EEA20"},lh=
{A:"#FF3232",T:"#0A32FF",C:"#FFFF32",G:"#0AFF0A",U:"#FF32FF",DA:"#FF3232",DT:"#0A32FF",DC:"#FFFF32",DG:"#0AFF0A",DU:"#FF32FF"},mh={SER:"#DAD0CC",LEU:"#008CB1",GLY:"#D6E9E5",ALA:"#69A0AC",LYS:"#DD524A",VAL:"#799CB4",THR:"#D0C2B0",ASP:"#82C56B",GLU:"#4EC4A4",PRO:"#315E87",ASN:"#E5E3DA",ARG:"#A73638",PHE:"#315E87",ILE:"#61818A",GLN:"#CFD0CD",TYR:"#72896E",CYS:"#72896E",HIS:"#6C6C67",MET:"#C8DBE8",TRP:"#356B84"},nh={H:"#FFFFFF",He:"#FADEC5",Li:"#7F3C3D",Be:"#000000",B:"#229262",C:"#AFAFAF",N:"#385E96",
O:"#B83839",F:"#FB9B27",Ne:"#000000",Na:"#38608E",Mg:"#72896E",Al:"#82C56B",Si:"#000000",P:"#FB9B27",S:"#F7B848",Cl:"#28FE28",Ar:"#000000",K:"#FADEC5",Ca:"#6C6C67",Sc:"#6C6C67",Ti:"#72896E",V:"#000000",Cr:"#6C6C67",Mn:"#6C6C67",Fe:"#FB9B27",Co:"#AAB844",Ni:"#6B5248",Cu:"#6B5248",Zn:"#6B5248"},ph={Hydrophobic:"#FF0000",Hydrophilic:"#0000FF"},qh={"First residue":"#00FF00","Last residue":"#0000FF"},yh={Coil:"#B4B4B4",Turn:"#FFB419",Helix:"#FF1919",Strand:"#1919FF"},Hh={AA_AROMATIC:"#CDCD4B",AA_CHARGED_NEG:"#FF1919",
AA_CHARGED_PLUS:"#1919FF",AA_CYSTEINE:"#FF7D0F",AA_GLYCINE:"#9696FF",AA_HYDROPHOB:"#AFAFAF",AA_POLAR_NEG:"#9B3737",AA_POLAR_PLUS:"#37379B",AA_PROLINE:"#FF9B9B",AccessibleSurface:"#C8641E",ALL_ATOMS:"#000000",ALL_RESIDUES:"#000000",ALL_SSE:"#000000",AlphaShapeSurface:"#C8641E",Antiparallel_Strand:"#1919FF",APOLAIRE:"#CFD0CD",ATOM_CARBON_CHAIN:"#AFAFAF",ATOM_CARBON_CYCLE:"#AFAF4B",ATOM_CHARGED_NEG:"#1919FF",ATOM_CHARGED_PLUS:"#1919FF",ATOM_POLAR_NEG:"#9B1919",ATOM_POLAR_PLUS:"#19199B",ATOM_S:"#FFFFFF",
AXIS:"#FFFFFF",BACKBONE:"#A0B4FA",Background:"#000000",BOND:"#1EEA2066",CHARGE_NEG:"#0000FF99",CHARGE_NEUTRAL:"#FFFFFF99",CHARGE_POS:"#FF000099",Coil:"#B4B4B4",CORE:"#FF6464",C_TERM:"#A73638",DELTA_NEG:"#0000B499",DELTA_POS:"#B4000099",FIX:"#315E87",FLEXIBLE:"#C8DBE8",HELIX_2:"#32B432",Helix:"#FF1919",HYDROGEN_BOND:"#FFFFFF33",INTERFACE:"#FFFFFF",MolecularSurface:"#C8641E",N_TERM:"#315E87",Parallel_Strand:"#1919FF",PCORE:"#3C321E",PE:"#F7B848B3",PLANE:"#FFFFFF1A",POLAIRE_F_AB_ANIONIQUE:"#38608E",
POLAIRE_F_AB_CATIONIQUE:"#A73638",POLAIRE_F_AB_NEUTRE:"#F6F7F0",POLAIRE_SANS_F_AB:"#F9B58F",PSURFACE:"#141496",RIM:"#1428FF",SELECTION:"#FDB45D",SSE_B:"#6A68E6",SSE:"#FB9B27",SSE_HA:"#DC5456",SSE_T:"#FAFAFA",STABLE:"#385E96",SURFACE:"#FF0000",Turn:"#FFB419",UNSTABLE:"#BA3938",VDW:"#008CB1E1",Void_mo:"#9BFAB4",Void_pi:"#BEFF64",Void_po:"#C8C8C8",Void_pp:"#787878",Void_pr:"#6464FF"},Ih={white:{r:1,g:1,b:1},black:{r:0,g:0,b:0},grey:{r:.5,g:.5,b:.5},lightgrey:{r:.7,g:.7,b:.7},darkgrey:{r:.3,g:.3,b:.3},
red:{r:1,g:0,b:0},darkred:{r:.5,g:0,b:0},lightred:{r:1,g:.5,b:.5},green:{r:0,g:1,b:0},darkgreen:{r:0,g:.5,b:0},lightgreen:{r:.5,g:1,b:.5},blue:{r:0,g:0,b:1},darkblue:{r:0,g:0,b:.5},lightblue:{r:.5,g:.5,b:1},yellow:{r:1,g:1,b:0},darkyellow:{r:.5,g:.5,b:0},lightyellow:{r:1,g:1,b:.5},cyan:{r:0,g:1,b:1},darkcyan:{r:0,g:.5,b:.5},lightcyan:{r:.5,g:1,b:1},magenta:{r:1,g:0,b:1},darkmagenta:{r:.5,g:0,b:.5},lightmagenta:{r:1,g:.5,b:1},orange:{r:1,g:.5,b:0},darkorange:{r:.5,g:.25,b:0},lightorange:{r:1,g:.75,
b:.5}};function Jh(og,pg){this.u=og;this.domElement=pg;this.Ek=new THREE.Vector3;this.Ch=new THREE.Vector3;this.Uc=new THREE.Vector3;this.Yi=new THREE.Vector3;this.Lf=new THREE.Vector3;this.pc=new THREE.Vector3;this.maxDistance=Infinity}Jh.gk=.025;Jh.fk=.2;Jh.ip=2;Jh.yf=.4;Jh.cu=.05;Jh.jm=.1;Jh.pm=1.5;Jh.Do=function(og){var pg=Math.abs(og);Ph.ba().dc.Bj&&(pg=-og);Jh.yf=pg};THREE.ShaderChunk.cylinderImpostor_frag="// Inherits from Phong Shading in ThreeJS, allows compatibility with chunks\n#define PHONG\n\n#include <common>\n#include <fog_pars_fragment>\n#include <color_pars_fragment>\n#include <lights_pars>\n#include <bsdfs>\n#include <lights_phong_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\n// Normalize diagonal matrix (1)\nconst mat4 D = mat4(\n    vec4(1.0, 0.0, 0.0, 0.0),\n    vec4(0.0, 1.0, 0.0, 0.0),\n    vec4(0.0, 0.0, 0.0, 0.0),\n    vec4(0.0, 0.0, 0.0, -1.0)\n);\n\n// Create transpose method (not built-in OpenGL ES Shading Language)\nhighp mat4 transpose(in highp mat4 inMatrix) {\n    highp vec4 i0 = inMatrix[0];\n    highp vec4 i1 = inMatrix[1];\n    highp vec4 i2 = inMatrix[2];\n    highp vec4 i3 = inMatrix[3];\n\n    highp mat4 outMatrix = mat4(\n        vec4(i0.x, i1.x, i2.x, i3.x),\n        vec4(i0.y, i1.y, i2.y, i3.y),\n        vec4(i0.z, i1.z, i2.z, i3.z),\n        vec4(i0.w, i1.w, i2.w, i3.w)\n    );\n\n    return outMatrix;\n}\n\nvarying mat4 MTInverse;\nvarying mat4 VPInverse;\nvarying vec4 centernormclip;\n\n// Near, far, width and height\nvarying float n, f, w, h;\n\nvarying float vHighlight;\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\nuniform mat4 projectionMatrix;\nuniform mat4 projectionMatrixInverse;\nuniform float devicePixelRatio;\nuniform bool testHighlight;\nuniform bool testUnhighlight;\n\nvarying vec3 vViewDirection;\nvarying float vLength;\n\nvoid main() {\n    vec3 color = vColor;\n    if (testHighlight && vHighlight < 0.5\n        || testUnhighlight && vHighlight > 0.5) {\n        #ifdef WEBGL_depth_texture\n        discard;\n        #else\n        color = vec3(0.8, 0.8, 0.0);\n        /*return;*/\n        #endif\n    }\n\n    vec2 fragCoord = gl_FragCoord.xy  / devicePixelRatio;\n    gl_FragColor = vec4(1.0);\n    float c = (f - n) / (2.0 * n * f) * 2.0 / (gl_DepthRange.diff);\n    vec4 c3 = MTInverse[3] * c;\n\n    // Computing xprime (6)\n    vec4 xp = vec4(\n        (fragCoord.x * 2.0 / w - 1.0),\n        (fragCoord.y * 2.0 / h - 1.0),\n        -1.0,\n        1.0\n    );\n    xp = projectionMatrixInverse * xp;\n    xp.z = -1.0;\n    xp.w = (f + n) / (2.0 * f * n) - (n - f) /\n        (2.0 * f * n) * (gl_DepthRange.near + gl_DepthRange.far) / -gl_DepthRange.diff;\n    vec4 xpPrime = MTInverse * xp;\n\n    // Checking quadratic equation discriminant (7)\n    float c3TDc3 = dot(c3, D * c3);\n    float xpPrimeTDc3 = dot(xpPrime, D * c3);\n    float xpPrimeTDxpPrime = dot(xpPrime, D * xpPrime);\n    float A = c3TDc3, B = 2.0 * xpPrimeTDc3, C = xpPrimeTDxpPrime;\n    float discriminant = B * B - 4.0 * A * C;\n\n    gl_FragColor = vec4(1.0);\n    if (discriminant < 0.0) {\n        discard;\n    } else {\n        // Resolving solutions\n        float x1 = (-B - sqrt(discriminant)) / (2.0 * A);\n        float x2 = (-B + sqrt(discriminant)) / (2.0 * A);\n        float zFront = 1.0 - max(x1, x2); // Sphere front face\n        float zBack = 1.0 - min(x1, x2); // Sphere back face\n\n        float z = zFront;\n\n        // Getting current pixel in NDC\n        vec3 fcFront = vec3(fragCoord.xy, zFront);\n        fcFront.xy /= vec2(w, h);\n        fcFront *= 2.0;\n        fcFront -= 1.0;\n\n        vec3 fcBack = vec3(fragCoord.xy, zBack);\n        fcBack.xy /= vec2(w, h);\n        fcBack *= 2.0;\n        fcBack -= 1.0;\n\n        // Getting current pixel in view coordinates\n        vec4 pFront = projectionMatrixInverse * vec4(fcFront, 1.0);\n        pFront /= pFront.w;\n\n        vec4 pBack = projectionMatrixInverse * vec4(fcBack, 1.0);\n        pBack /= pBack.w;\n\n        // Checking cylinder length\n        vec3 cylBaseFront = pFront.xyz + vViewPosition.xyz;\n\n        vec3 cylBaseBack = pBack.xyz + vViewPosition.xyz;\n\n        float aFront = dot(cylBaseFront,vViewDirection);\n        float aBack = dot(cylBaseBack,vViewDirection);\n        bool backOutLength = false;\n\n        #ifdef FLIP_SIDED\n        z = zBack;\n        #else\n        if (aFront < 0.0 || aFront > vLength + 0.000001) {\n            #ifdef DOUBLE_SIDED\n            z = zBack;\n            #else\n            discard;\n            #endif\n        }\n        #endif\n\n        #if defined(DOUBLE_SIDED) || defined(FLIP_SIDED)\n        if (aBack < 0.0 || aBack > vLength + 0.000001) {\n            if (z == zBack) {\n                discard;\n            } else {\n                backOutLength = true;\n            }\n        }\n        #endif\n\n        // Getting current pixel clip coordinate\n        vec4 vClipPosFront = vec4(\n            (fragCoord.x * 2.0 - 1.0),\n            (fragCoord.y * 2.0 - 1.0),\n            zFront * 2.0 - 1.0,\n            1.0\n        );\n        vec4 vClipPosBack = vec4(\n            (fragCoord.x * 2.0 - 1.0),\n            (fragCoord.y * 2.0 - 1.0),\n            zBack * 2.0 - 1.0,\n            1.0\n        );\n\n        // Computing current pixel position in eye space\n        vec4 vViewPosFront = projectionMatrixInverse * vClipPosFront;\n        vViewPosFront = vViewPosFront / vViewPosFront.w;\n        vViewPosFront.z = - vViewPosFront.z;\n\n        vec4 vViewPosBack = projectionMatrixInverse * vClipPosBack;\n        vViewPosBack = vViewPosBack / vViewPosBack.w;\n        vViewPosBack.z = - vViewPosBack.z;\n\n        // Performing clipping\n        #if NUM_CLIPPING_PLANES > 0\n        for ( int i = 0; i < NUM_CLIPPING_PLANES; ++ i ) {\n            vec4 plane = clippingPlanes[ i ];\n            if ( dot(vViewPosFront.xyz, plane.xyz ) > plane.w ) {\n                #if defined(DOUBLE_SIDED) || defined(FLIP_SIDED)\n                if (backOutLength) {\n                    discard;\n                } else {\n                    z = zBack;\n                }\n                #else\n                discard;\n                #endif\n            }\n            #if defined(DOUBLE_SIDED) || defined(FLIP_SIDED)\n            if ( dot(vViewPosBack.xyz, plane.xyz ) > plane.w) {\n                discard;\n            }\n            #endif\n        }\n        #endif\n\n        gl_FragDepthEXT = z;\n\n        // Position in eye coordinates (8)\n        vec4 pe = vec4(\n            (fragCoord.x * 2.0 / w - 1.0),\n            (fragCoord.y * 2.0 / h - 1.0),\n            -1.0,\n            1.0\n        );\n        pe = projectionMatrixInverse * pe;\n        pe.z = -1.0;\n        pe.w = (f + n)/(2.0 * f * n) -\n            (n - f)/(2.0 * f * n) * (gl_DepthRange.near + gl_DepthRange.far) / gl_DepthRange.diff +\n            z * ((n - f) / (n * f) / gl_DepthRange.diff);\n        vec4 np = MTInverse * pe;\n        // Because the cylinder's axis is Z, we ignore z value of the vertex\n        np.z = 0.0;\n        vec4 ne = transpose(MTInverse) * np;\n\n        // Declaring normal to get compatibility with threejs Phong chunks\n        vec3 normal = normalize(ne.xyz);\n\n        #if defined(DOUBLE_SIDED) || defined(FLIP_SIDED)\n        if (dot(normal, vViewPosition.xyz) < 0.0) {\n            normal = vec3(0.0, 0.0, -1.0);\n        }\n        #endif\n\n        // Starting to compute phong lighting\n        vec4 diffuseColor = vec4(diffuse, opacity);\n        ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\n        vec3 totalEmissiveLight = emissive;\n        /*#include <color_fragment>*/\n        #ifdef USE_COLOR\n\n            diffuseColor.rgb *= color;\n\n        #endif\n        // Declaring specularStength to get compatibility with threejs chunks\n        float specularStrength = 1.0;\n        #include <lights_phong_fragment>\n        #include <lights_template>\n        vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse +\n                                reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveLight;\n\n        gl_FragColor = vec4(outgoingLight, opacity);\n\n        #include <fog_fragment>\n    }\n}\n";
THREE.ShaderChunk.cylinderImpostor_vert="// Inherits from Phong Shading in ThreeJS, allows compatibility with chunks\n#define PHONG\n\n// Normalize diagonal matrix (1)\nconst mat4 D = mat4(\n    vec4(1.0, 0.0, 0.0, 0.0),\n    vec4(0.0, 1.0, 0.0, 0.0),\n    vec4(0.0, 0.0, 0.0, 0.0),\n    vec4(0.0, 0.0, 0.0, -1.0)\n);\n\nconst mat4 t1 = mat4(\n    vec4(1.0, 0.0, 0.0, 0.0),\n    vec4(0.0, 1.0, 0.0, 0.0),\n    vec4(0.0, 0.0, 0.0, 0.0),\n    vec4(0.0, 0.0, 1.0, 1.0)\n);\n\nconst mat4 t2 = mat4(\n    vec4(1.0, 0.0, 0.0, 0.0),\n    vec4(0.0, 1.0, 0.0, 0.0),\n    vec4(0.0, 0.0, 0.0, 0.0),\n    vec4(0.0, 0.0, -1.0, 1.0)\n);\n\n// Create transpose method (not built-in OpenGL ES Shading Language)\nhighp mat4 transpose(in highp mat4 inMatrix) {\n    highp vec4 i0 = inMatrix[0];\n    highp vec4 i1 = inMatrix[1];\n    highp vec4 i2 = inMatrix[2];\n    highp vec4 i3 = inMatrix[3];\n\n    highp mat4 outMatrix = mat4(\n        vec4(i0.x, i1.x, i2.x, i3.x),\n        vec4(i0.y, i1.y, i2.y, i3.y),\n        vec4(i0.z, i1.z, i2.z, i3.z),\n        vec4(i0.w, i1.w, i2.w, i3.w)\n    );\n\n    return outMatrix;\n}\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute float radius;\nattribute vec3 dir;\nattribute float highlight;\n\nuniform vec4 viewport;\nuniform mat4 modelViewMatrixInverse;\nuniform float devicePixelRatio;\n\nvarying float vHighlight;\n\nvarying mat4 MTInverse;\nvarying mat4 VPInverse;\nvarying vec4 centernormclip;\n\n// Near, far, width and height\nvarying float n, f, w, h;\n\n// Compatibility with threejs chunks\nvarying vec3 vViewPosition;\nvarying vec3 vViewDirection;\nvarying float vLength;\n\nvec4 ComputeBoundsFromPMT(mat4 PMT) {\n    // Getting coefficients\n    vec4 r1 = PMT[0];\n    vec4 r2 = PMT[1];\n    vec4 r4 = PMT[3];\n\n    // Intermediate computations\n    float r4TDr4 = dot(r4, D * r4);\n    float r1TDr4 = dot(r1, D * r4);\n    float r1TDr1 = dot(r1, D * r1);\n    float r2TDr4 = dot(r2, D * r4);\n    float r2TDr2 = dot(r2, D * r2);\n\n    // Computing bounding box by resolving second degree equations (5)\n    vec2 yBounds;\n    vec2 xBounds;\n    float A, B, C;\n    A = r4TDr4; B = -2.0 * r1TDr4; C = r1TDr1;\n    xBounds[0] = ( -B - sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    xBounds[1] = ( -B + sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    A = r4TDr4; B = - 2.0 * r2TDr4; C = r2TDr2;\n    yBounds[0] = ( -B - sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    yBounds[1] = ( -B + sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n\n    return vec4(xBounds, yBounds);\n}\n\nvoid main() {\n    vHighlight = highlight;\n\n    // Chunck to color vertex with vertex color attribute\n    #include <color_vertex>\n\n    // Chunck to compute position in world space\n    #include <begin_vertex>\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n    vViewPosition = - mvPosition.xyz;\n\n    float zScale = length(dir);\n    vec3 normDir = normalize(dir);\n\n    // Computing T matrix with u,v,w and c as quadratic surface parameters (2)\n    // Note : ceil radius because low radius value seems to provoke precision errors\n    mat4 Tscalet = mat4(\n        vec4(ceil(radius), 0.0, 0.0,     0.0),\n        vec4(0.0, ceil(radius), 0.0,     0.0),\n        vec4(0.0, 0.0, zScale,   0.0),\n        vec4(0.0, 0.0, 0.0, 1.0)\n    );\n\n    // Finding up vector to compute rotation matrix from dir attribute\n    vec3 up;\n    bool yMain = abs(normDir[1]) > 0.9;\n    if (yMain) {\n    \tup = vec3( 1, 0, 0 );\n    } else {\n    \tup = vec3( 0, 1, 0 );\n    }\n    vec3 xAxis = normalize(cross(up, normDir.xyz));\n    vec3 yAxis = normalize(cross(normDir.xyz, xAxis));\n\n    mat4 Trott = mat4(\n        vec4(xAxis.xyz,     0.0),\n        vec4(yAxis.xyz,     0.0),\n        vec4(normDir.xyz,   0.0),\n        vec4(0.0, 0.0, 0.0, 1.0)\n    );\n\n    mat4 Ttranst = mat4(\n        vec4(1.0, 0.0, 0.0, 0.0),\n        vec4(0.0, 1.0, 0.0, 0.0),\n        vec4(0.0, 0.0, 1.0, 0.0),\n        vec4(position.x,    position.y,    position.z,    1.0)\n    );\n\n    mat4 Tt = Ttranst * Trott * Tscalet;\n\n    vViewDirection = vec3(modelViewMatrix * (Trott * (vec4(0.0, 0.0, 1.0, 0.0))));\n    vLength = zScale;\n\n    // Computing PMTt Matrix\n    mat4 PMTt = transpose(projectionMatrix * modelViewMatrix * Tt * t1);\n\n    vec4 firstBounds = ComputeBoundsFromPMT(PMTt);\n\n    // Computing PMTt Matrix\n    PMTt = transpose(projectionMatrix * modelViewMatrix * Tt * t2);\n\n    vec4 secBounds = ComputeBoundsFromPMT(PMTt);\n\n    vec2 vertBorders;\n    vec2 horizBorders;\n    horizBorders[0] = min(firstBounds[0], min(firstBounds[1], min(secBounds[0], secBounds[1])));\n  \thorizBorders[1] = max(firstBounds[0], max(firstBounds[1], max(secBounds[0], secBounds[1])));\n\n  \tvertBorders[1] = max(firstBounds[2], max(firstBounds[3], max(secBounds[2], secBounds[3])));\n    vertBorders[0] = min(firstBounds[2], min(firstBounds[3], min(secBounds[2], secBounds[3])));\n\n    // Getting bounding box size in window space\n    float bx = abs( horizBorders[ 0 ] - horizBorders[ 1 ] ) * 0.5 * viewport.z;\n    float by = abs( vertBorders[ 0 ] - vertBorders[ 1 ] ) * 0.5 * viewport.w;\n\n    // Getting bounding box center in clip space\n    float cx = 0.5 * (horizBorders.x + horizBorders.y);\n    float cy = 0.5 * (vertBorders.x + vertBorders.y);\n\n    // Setting point size\n    gl_PointSize = ceil(max(bx, by)) * devicePixelRatio;\n    gl_Position.z = 0.0;\n\n    // Reposition vertex to fit with bounding box\n    //gl_Position.xy = vec2(cx, cy) * gl_Position.w;\n\n    // Prepare varyings for fragment shader\n    mat4 TscaleInv = mat4(\n        vec4(1.0 / radius,        0.0,           0.0,           0.0),\n        vec4(0.0,           1.0 / radius,        0.0,           0.0),\n        vec4(0.0,           0.0,           1.0 / zScale,        0.0),\n        vec4(0.0,           0.0,           0.0,           1.0)\n    );\n\n    mat4 TrotInv = transpose(Trott);\n\n    mat4 TtransInv = mat4(\n        vec4(1.0, 0.0, 0.0, 0.0),\n        vec4(0.0, 1.0, 0.0, 0.0),\n        vec4(0.0, 0.0, 1.0, 0.0),\n        vec4(-position, 1.0)\n    );\n\n    mat4 TInverse = TscaleInv * TrotInv * TtransInv;\n\n    MTInverse = TInverse * modelViewMatrixInverse;\n\n    // Getting near and far\n    n = projectionMatrix[3][2] / (projectionMatrix[2][2] - 1.0);\n    f = ((projectionMatrix[2][2] - 1.0) * n) / (projectionMatrix[2][2] + 1.0);\n\n    // Getting width and height of the viewport for fragment\n    w = viewport.z;\n    h = viewport.w;\n}\n";
THREE.ShaderChunk.meshphong_frag_edit="#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\nuniform bool testHighlight;\nuniform bool testUnhighlight;\n\nvarying float vHighlight;\n\n#ifdef RADIUS_CLIP\n    uniform float clipRadius;\n    uniform vec3 vClipCenter[RADIUS_ATOMS_LENGTH];\n#endif\n\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n    vec3 color = vColor;\n    if (testHighlight && vHighlight < 0.5\n        || testUnhighlight && vHighlight > 0.5) {\n        #ifdef WEBGL_depth_texture\n        discard;\n        #else\n        color = vec3(0.8, 0.8, 0.0);\n        /*return;*/\n        #endif\n    }\n\t#include <clipping_planes_fragment>\n\n#ifdef RADIUS_CLIP\n    bool fragInsideRadius = false;\n    for (int i = 0; i < RADIUS_ATOMS_LENGTH; ++i) {\n        if (distance( vViewPosition, - vClipCenter[i] ) < clipRadius) {\n            fragInsideRadius = true;\n            break;\n        }\n    }\n    if( !fragInsideRadius ) {\n        discard;\n    }\n#endif\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t/*#include <color_fragment>*/\n    #ifdef USE_COLOR\n\n        diffuseColor.rgb *= color;\n\n    #endif\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n";
THREE.ShaderChunk.meshphong_vert_edit="#define PHONG\n\nattribute float highlight;\n\nvarying float vHighlight;\nvarying vec3 vViewPosition;\n\n/*#ifdef RADIUS_CLIP*/\n    /*uniform vec3 clipCenter[RADIUS_ATOMS_LENGTH];*/\n\n    /*uniform vec3 vClipCenter[RADIUS_ATOMS_LENGTH];*/\n/*#endif*/\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n    vHighlight = highlight;\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n/*#ifdef RADIUS_CLIP\n    for (int i = 0; i < RADIUS_ATOMS_LENGTH; i++) {\n        vClipCenter[i] = -( modelViewMatrix * vec4( clipCenter[i], 1.0 ) ).xyz;\n    }\n#endif*/\n}\n";
THREE.ShaderChunk.meshphysical_frag_edit="#define PHYSICAL\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\nuniform bool testHighlight;\nuniform bool testUnhighlight;\n\nvarying float vHighlight;\n\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\n\n#ifdef RADIUS_CLIP\n    uniform float clipRadius;\n    uniform vec3 vClipCenter[RADIUS_ATOMS_LENGTH];\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n\n// Quick edit to not take care of vertex normal direction\n// Only computes diffuse color, not specular\nvoid RE_Direct_Physical_Edit( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n    float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n    dotNL = max(dotNL, 0.5);    // Clamp value to set a minimal diffuse color\n\n    vec3 irradiance = dotNL * directLight.color;\n\n    #ifndef PHYSICALLY_CORRECT_LIGHTS\n        irradiance *= PI; // punctual light\n    #endif\n\n    #ifndef STANDARD\n        float clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n    #else\n        float clearCoatDHR = 0.0;\n    #endif\n\n    reflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n\n#undef RE_Direct\n#define RE_Direct               RE_Direct_Physical_Edit\n\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n    vec3 color = vColor;\n    if (testHighlight && vHighlight < 0.99\n        || testUnhighlight && vHighlight > 0.01) {\n        #ifdef WEBGL_depth_texture\n        discard;\n        #else\n        color = vec3(0.8, 0.8, 0.0);\n        /*return;*/\n        #endif\n    }\n\t#include <clipping_planes_fragment>\n\n#ifdef RADIUS_CLIP\n    bool fragInsideRadius = false;\n    for (int i = 0; i < RADIUS_ATOMS_LENGTH; i++) {\n        if (distance( vViewPosition, - vClipCenter[i] ) < clipRadius) {\n            fragInsideRadius = true;\n            break;\n        }\n    }\n    if( !fragInsideRadius ) {\n        discard;\n    }\n#endif\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t/*#include <color_fragment>*/\n    #ifdef USE_COLOR\n\n        diffuseColor.rgb *= color;\n\n    #endif\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n";
THREE.ShaderChunk.meshphysical_vert_edit="#define PHYSICAL\n\nvarying vec3 vViewPosition;\n\nattribute float highlight;\n\nvarying float vHighlight;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n    vHighlight = highlight;\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n";
THREE.ShaderChunk.sphereImpostor_frag="// Inherits from Phong Shading in ThreeJS, allows compatibility with chunks\n#define PHONG\n\n#include <common>\n#include <fog_pars_fragment>\n#include <color_pars_fragment>\n#include <lights_pars>\n#include <bsdfs>\n#include <lights_phong_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\n// Normalize diagonal matrix (1)\nconst mat4 D = mat4(\n    vec4(1.0, 0.0, 0.0, 0.0),\n    vec4(0.0, 1.0, 0.0, 0.0),\n    vec4(0.0, 0.0, 1.0, 0.0),\n    vec4(0.0, 0.0, 0.0, -1.0)\n);\n\n// Create transpose method (not built-in OpenGL ES Shading Language)\nhighp mat4 transpose(in highp mat4 inMatrix) {\n    highp vec4 i0 = inMatrix[0];\n    highp vec4 i1 = inMatrix[1];\n    highp vec4 i2 = inMatrix[2];\n    highp vec4 i3 = inMatrix[3];\n\n    highp mat4 outMatrix = mat4(\n        vec4(i0.x, i1.x, i2.x, i3.x),\n        vec4(i0.y, i1.y, i2.y, i3.y),\n        vec4(i0.z, i1.z, i2.z, i3.z),\n        vec4(i0.w, i1.w, i2.w, i3.w)\n    );\n\n    return outMatrix;\n}\n\nvarying mat4 MTInverse;\nvarying mat4 VPInverse;\nvarying vec4 centernormclip;\n\nvarying float vHighlight;\n\n// Near, far, width and height\nvarying float n, f, w, h;\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\nuniform mat4 projectionMatrix;\nuniform mat4 projectionMatrixInverse;\nuniform float devicePixelRatio;\nuniform bool testHighlight;\nuniform bool testUnhighlight;\n\nvoid main() {\n    vec3 color = vColor;\n    if (testHighlight && vHighlight < 0.5\n        || testUnhighlight && vHighlight > 0.5) {\n        #ifdef WEBGL_depth_texture\n        discard;\n        #else\n        color = vec3(0.8, 0.8, 0.0);\n        /*return;*/\n        #endif\n    }\n\n    vec2 fragCoord = gl_FragCoord.xy / devicePixelRatio;\n    float c = (f - n) / (2.0 * n * f) * 2.0 / (gl_DepthRange.diff);\n    vec4 c3 = MTInverse[3] * c;\n\n    // Computing xprime (6)\n    vec4 xp = vec4(\n        (fragCoord.x * 2.0 / w - 1.0),\n        (fragCoord.y * 2.0 / h - 1.0),\n        -1.0,\n        1.0\n    );\n    xp = projectionMatrixInverse * xp;\n    xp.z = -1.0;\n    xp.w = (f + n) / (2.0 * f * n) - (n - f) /\n        (2.0 * f * n) * (gl_DepthRange.near + gl_DepthRange.far) / -gl_DepthRange.diff;\n    vec4 xpPrime = MTInverse * xp;\n\n    // Checking quadratic equation discriminant (7)\n    float c3TDc3 = dot(c3, D * c3);\n    float xpPrimeTDc3 = dot(xpPrime, D * c3);\n    float xpPrimeTDxpPrime = dot(xpPrime, D * xpPrime);\n    float A = c3TDc3, B = 2.0 * xpPrimeTDc3, C = xpPrimeTDxpPrime;\n    float discriminant = B * B - 4.0 * A * C;\n\n    gl_FragColor = vec4(1.0);\n    if (discriminant < 0.0) {\n        /*gl_FragColor = vec4(1.0, 0.5, 0.5, 1.0);*/\n        discard;\n    } else {\n        // Resolving solutions\n        float x1 = (-B - sqrt(discriminant)) / (2.0 * A);\n        float x2 = (-B + sqrt(discriminant)) / (2.0 * A);\n        float zFront = 1.0 - max(x1, x2); // Sphere front face\n        float zBack = 1.0 - min(x1, x2); // Sphere back face\n\n        float z = zFront;\n\n        // Getting current pixel clip coordinate\n        vec4 vClipPosFront = vec4(\n            (fragCoord.x * 2.0 - 1.0),\n            (fragCoord.y * 2.0 - 1.0),\n            zFront * 2.0 - 1.0,\n            1.0\n        );\n        vec4 vClipPosBack = vec4(\n            (fragCoord.x * 2.0 - 1.0),\n            (fragCoord.y * 2.0 - 1.0),\n            zBack * 2.0 - 1.0,\n            1.0\n        );\n\n        // Computing current pixel position in eye space\n        vec4 vViewPosFront = projectionMatrixInverse * vClipPosFront;\n        vViewPosFront = vViewPosFront / vViewPosFront.w;\n        vViewPosFront.z = - vViewPosFront.z;\n\n        vec4 vViewPosBack = projectionMatrixInverse * vClipPosBack;\n        vViewPosBack = vViewPosBack / vViewPosBack.w;\n        vViewPosBack.z = - vViewPosBack.z;\n\n        #ifdef FLIP_SIDED\n        z = zBack;\n        #endif\n\n        // Performing clipping\n        #if NUM_CLIPPING_PLANES > 0\n        for ( int i = 0; i < NUM_CLIPPING_PLANES; ++ i ) {\n            vec4 plane = clippingPlanes[ i ];\n            if ( dot(vViewPosFront.xyz, plane.xyz ) > plane.w ) {\n                #if defined(DOUBLE_SIDED) || defined(FLIP_SIDED)\n                z = zBack;\n                #else\n                discard;\n                #endif\n            }\n            #if defined(DOUBLE_SIDED) || defined(FLIP_SIDED)\n            if ( dot(vViewPosBack.xyz, plane.xyz ) > plane.w ) {\n                discard;\n            }\n            #endif\n        }\n        #endif\n\n        gl_FragDepthEXT = z;\n\n        // Position in eye coordinates (8)\n        vec4 pe = vec4(\n            (fragCoord.x * 2.0 / w - 1.0),\n            (fragCoord.y * 2.0 / h - 1.0),\n            -1.0,\n            1.0\n        );\n        pe = projectionMatrixInverse * pe;\n        pe.z = -1.0;\n        pe.w = (f + n)/(2.0 * f * n) -\n            (n - f)/(2.0 * f * n) * (gl_DepthRange.near + gl_DepthRange.far) / gl_DepthRange.diff +\n            z * ((n - f) / (n * f) / gl_DepthRange.diff);\n        vec4 np = MTInverse * pe;\n        vec4 ne = transpose(MTInverse) * np;\n\n        // Declaring normal to get compatibility with threejs Phong chunks\n        vec3 normal = normalize(ne.xyz);\n\n        #if defined(DOUBLE_SIDED) || defined(FLIP_SIDED)\n        if (dot(normal, vViewPosition.xyz) < 0.0) {\n            normal = vec3(0.0, 0.0, -1.0);\n        }\n        #endif\n\n        // Starting to compute phong lighting\n        vec4 diffuseColor = vec4(diffuse, opacity);\n        ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\n        vec3 totalEmissiveLight = emissive;\n        /*#include <color_fragment>*/\n        #ifdef USE_COLOR\n\n            diffuseColor.rgb *= color;\n\n        #endif\n        // Declaring specularStength to get compatibility with threejs chunks\n        float specularStrength = 1.0;\n        #include <lights_phong_fragment>\n        #include <lights_template>\n        vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse +\n                                reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveLight;\n\n        gl_FragColor = vec4(outgoingLight, opacity);\n\n        #include <fog_fragment>\n    }\n}\n";
THREE.ShaderChunk.sphereImpostor_vert="// Inherits from Phong Shading in ThreeJS, allows compatibility with chunks\n#define PHONG\n\n// Normalize diagonal matrix (1)\nconst mat4 D = mat4(\n    vec4(1.0, 0.0, 0.0, 0.0),\n    vec4(0.0, 1.0, 0.0, 0.0),\n    vec4(0.0, 0.0, 1.0, 0.0),\n    vec4(0.0, 0.0, 0.0, -1.0)\n);\n\n// Create transpose method (not built-in OpenGL ES Shading Language)\nhighp mat4 transpose(in highp mat4 inMatrix) {\n    highp vec4 i0 = inMatrix[0];\n    highp vec4 i1 = inMatrix[1];\n    highp vec4 i2 = inMatrix[2];\n    highp vec4 i3 = inMatrix[3];\n\n    highp mat4 outMatrix = mat4(\n        vec4(i0.x, i1.x, i2.x, i3.x),\n        vec4(i0.y, i1.y, i2.y, i3.y),\n        vec4(i0.z, i1.z, i2.z, i3.z),\n        vec4(i0.w, i1.w, i2.w, i3.w)\n    );\n\n    return outMatrix;\n}\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute float radius;\nattribute float highlight;\n\nuniform vec4 viewport;\nuniform mat4 modelViewMatrixInverse;\nuniform float devicePixelRatio;\n\nvarying float vHighlight;\n\nvarying mat4 MTInverse;\nvarying mat4 VPInverse;\nvarying vec4 centernormclip;\n\n// Near, far, width and height\nvarying float n, f, w, h;\n\n// Compatibility with threejs chunks\nvarying vec3 vViewPosition;\n\nvoid main() {\n    vHighlight = highlight;\n\n    // Chunck to color vertex with vertex color attribute\n    #include <color_vertex>\n\n    // Chunck to compute position in world space\n    #include <begin_vertex>\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n    vViewPosition = - mvPosition.xyz;\n\n    // Computing T matrix with u,v,w and c as quadratic surface parameters (2)\n    mat4 T = mat4(\n        // Three following vectors represents u, v, w axis of the quadric\n        vec4(radius,        0.0,           0.0,           0.0),\n        vec4(0.0,           radius,        0.0,           0.0),\n        vec4(0.0,           0.0,           radius,        0.0),\n        // Represents c, center of the quadric\n        vec4(position.x,    position.y,    position.z,    1.0)\n    );\n\n    // Computing PMTt Matrix\n    mat4 PMTt = transpose(projectionMatrix * modelViewMatrix * T);\n\n    // Getting coefficients\n    vec4 r1 = PMTt[0];\n    vec4 r2 = PMTt[1];\n    vec4 r4 = PMTt[3];\n\n    // Intermediate computations\n    float r4TDr4 = dot(r4, D * r4);\n    float r1TDr4 = dot(r1, D * r4);\n    float r1TDr1 = dot(r1, D * r1);\n    float r2TDr4 = dot(r2, D * r4);\n    float r2TDr2 = dot(r2, D * r2);\n\n    // Computing bounding box by resolving second degree equations (5)\n    vec2 vertBorders;\n    vec2 horizBorders;\n    float A, B, C;\n    A = r4TDr4; B = -2.0 * r1TDr4; C = r1TDr1;\n    horizBorders[0] = ( -B - sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    horizBorders[1] = ( -B + sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    A = r4TDr4; B = - 2.0 * r2TDr4; C = r2TDr2;\n    vertBorders[0] = ( -B - sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    vertBorders[1] = ( -B + sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n\n    // Getting bounding box size in window space\n    float bx = abs( horizBorders[ 0 ] - horizBorders[ 1 ] ) * viewport.z;\n    float by = abs( vertBorders[ 0 ] - vertBorders[ 1 ] ) * viewport.w;\n\n    // Getting bounding box center in clip space\n    float cx = 0.5 * (horizBorders.x + horizBorders.y);\n    float cy = 0.5 * (vertBorders.x + vertBorders.y);\n\n    // Setting point size\n    gl_PointSize = max(bx, by) * 0.5 * devicePixelRatio;\n\n    // Reposition vertex to fit with bounding box\n    gl_Position.xy = vec2(cx, cy) * gl_Position.w;\n    gl_Position.z = 0.0;\n\n    // Prepare varyings for fragment shader\n    mat4 TInverse = mat4(\n        1.0,          0.0,          0.0,         0.0,\n        0.0,          1.0,          0.0,         0.0,\n        0.0,          0.0,          1.0,         0.0,\n        -position.x,  -position.y,  -position.z, radius\n    );\n    MTInverse = TInverse * modelViewMatrixInverse;\n\n    // Getting near and far\n    n = projectionMatrix[3][2] / (projectionMatrix[2][2] - 1.0);\n    f = ((projectionMatrix[2][2] - 1.0) * n) / (projectionMatrix[2][2] + 1.0);\n\n    // Getting width and height of the viewport for fragment\n    w = viewport.z;\n    h = viewport.w;\n}\n";
THREE.ShaderChunk.transparencyQuad_frag="#include <packing>\n\nvarying vec2 vUv;\n\nuniform sampler2D tOpaque;\nuniform sampler2D tTransparentBack;\nuniform sampler2D tTransparentFront;\nuniform sampler2D tOpaqueDepth;\nuniform sampler2D tTransparentBackDepth;\nuniform sampler2D tTransparentFrontDepth;\nuniform float cameraNear;\nuniform float cameraFar;\n\nfloat readDepth (sampler2D depthSampler, vec2 coord) {\n  float cameraFarPlusNear = cameraFar + cameraNear;\n  float cameraFarMinusNear = cameraFar - cameraNear;\n  float cameraCoef = 2.0 * cameraNear;\n  return cameraCoef / (cameraFarPlusNear - texture2D(depthSampler, coord).x * cameraFarMinusNear);\n}\n\nvoid main()\n{\n    vec4 opaque = texture2D( tOpaque, vUv );\n    vec4 transparentFront = texture2D( tTransparentFront, vUv );\n    vec4 transparentBack = texture2D( tTransparentBack, vUv );\n\n    float opaqueDepth = readDepth( tOpaqueDepth, vUv );\n    float transparentFrontDepth = readDepth( tTransparentFrontDepth, vUv );\n    float transparentBackDepth = readDepth( tTransparentBackDepth, vUv );\n\n    vec4 color = opaque;\n\n    if (transparentBackDepth < 1.0 && opaqueDepth > transparentBackDepth) {\n        color = transparentBack + color * (1.0 - transparentBack.a);\n    }\n    if (transparentFrontDepth < 1.0 && opaqueDepth > transparentFrontDepth) {\n        color = transparentFront + color * (1.0 - transparentFront.a);\n    }\n    /* else if (transparentFrontDepth < 1.0 && transparentBackDepth < 1.0 && opaqueDepth > transparentBackDepth && opaqueDepth > transparentFrontDepth) {\n        vec4 color = transparentBack + opaque * (1.0 - transparentBack.a);\n        color = transparentFront + color * (1.0 - transparentFront.a);\n    }*/\n\n    gl_FragColor = color;\n}\n";
THREE.ShaderChunk.transparencyQuad_vert="varying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n";
function Qh(og){THREE.ShaderMaterial.call(this,{vertexShader:THREE.ShaderChunk.meshphong_vert_edit,fragmentShader:THREE.ShaderChunk.meshphong_frag_edit,uniforms:THREE.UniformsUtils.clone(THREE.UniformsUtils.merge([THREE.ShaderLib.phong.uniforms,{vClipCenter:{value:[new THREE.Vector3]},clip:{value:!1},clipRadius:{value:0},color:{value:new THREE.Color},testHighlight:{value:!1},testUnhighlight:{value:!1}}])),defines:{RADIUS_CLIP:!1,RADIUS_ATOMS_LENGTH:0,WEBGL_depth_texture:Ph.ba().Sh},vertexColors:THREE.VertexColors,
fog:!0,lights:!0,clipping:!0});og&&(this.polygonOffset=!0,this.polygonOffsetFactor=1);this.extensions.fragDepth=Ph.ba().zj}Qh.prototype=Object.create(THREE.ShaderMaterial.prototype);Qh.prototype.constructor=Qh;
function Rh(){THREE.ShaderMaterial.call(this,{vertexShader:THREE.ShaderChunk.meshphysical_vert_edit,fragmentShader:THREE.ShaderChunk.meshphysical_frag_edit,uniforms:THREE.UniformsUtils.clone(THREE.UniformsUtils.merge([THREE.ShaderLib.standard.uniforms,{vClipCenter:{value:[new THREE.Vector3]},clip:{value:!1},clipRadius:{value:0},color:{value:new THREE.Color},testHighlight:{value:!1},testUnhighlight:{value:!1}}])),defines:{RADIUS_CLIP:!1,RADIUS_ATOMS_LENGTH:0,WEBGL_depth_texture:Ph.ba().Sh},vertexColors:THREE.VertexColors,
fog:!0,lights:!0,clipping:!0});this.color=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.emissiveIntensity=1;this.refractionRatio=.98;this.wireframe=!0;this.wireframeLinewidth=2;this.roughness=1;this.metalness=.4;this.side=THREE.DoubleSide;this.extensions.fragDepth=Ph.ba().zj}Rh.prototype=Object.create(THREE.ShaderMaterial.prototype);Rh.prototype.constructor=Rh;
function Th(){var og=THREE.ShaderChunk.sphereImpostor_vert,pg=THREE.ShaderChunk.sphereImpostor_frag,qg=THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.lights,THREE.UniformsLib.fog,{viewport:{type:"v4",value:new THREE.Vector4},modelViewMatrixInverse:{type:"v4",value:new THREE.Matrix4},projectionMatrixInverse:{type:"v4",value:new THREE.Matrix4},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},diffuse:{type:"c",
value:new THREE.Color(16777215)},opacity:{type:"f",value:1},devicePixelRatio:{type:"f",value:window.devicePixelRatio},fog:!0},{vClipCenter:{value:[new THREE.Vector3]},clip:{value:!1},clipRadius:{value:0},color:{value:new THREE.Color},testHighlight:{value:!1},testUnhighlight:{value:!1}}]),rg={RADIUS_CLIP:!1,RADIUS_ATOMS_LENGTH:0,WEBGL_depth_texture:Ph.ba().Sh};THREE.ShaderMaterial.call(this,{uniforms:THREE.UniformsUtils.clone(qg),defines:rg,vertexShader:og,fragmentShader:pg,lights:!0,vertexColors:THREE.VertexColors,
fog:!0,clipping:!0});this.opacity=1;this.$c=[this.Lm,this.Mm,this.Nm,this.Qm];this.extensions.fragDepth=Ph.ba().zj}Th.prototype=Object.create(THREE.ShaderMaterial.prototype);xg=Th.prototype;xg.constructor=Th;
xg.Lm=function(og,pg,qg,rg,sg){sg.uniforms&&null!=sg.uniforms.modelViewMatrixInverse&&(og=new THREE.Matrix4,qg=(new THREE.Matrix4).multiplyMatrices(qg.matrixWorldInverse,this.matrixWorld),og.getInverse(qg),sg.uniforms.modelViewMatrixInverse.value=og,sg.uniforms.modelViewMatrixInverse.needsUpdate=!0)};
xg.Mm=function(og,pg,qg,rg,sg){sg.uniforms&&null!=sg.uniforms.projectionMatrixInverse&&(og=new THREE.Matrix4,og.getInverse(qg.projectionMatrix),sg.uniforms.projectionMatrixInverse.value=og,sg.uniforms.projectionMatrixInverse.needsUpdate=!0)};xg.Nm=function(og,pg,qg,rg,sg){sg.uniforms&&null!=sg.uniforms.devicePixelRatio&&(sg.uniforms.devicePixelRatio.value=window.devicePixelRatio,sg.uniforms.devicePixelRatio.needsUpdate=!0)};
xg.Qm=function(og,pg,qg,rg,sg){sg.uniforms&&null!=sg.uniforms.viewport&&(og=new THREE.Vector4(0,0,og.domElement.offsetWidth,og.domElement.offsetHeight),sg.uniforms.viewport.value=og,sg.uniforms.viewport.needsUpdate=!0)};
function Uh(){var og=THREE.ShaderChunk.cylinderImpostor_vert,pg=THREE.ShaderChunk.cylinderImpostor_frag,qg=THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.lights,THREE.UniformsLib.fog,{viewport:{type:"v4",value:new THREE.Vector4},modelViewMatrixInverse:{type:"v4",value:new THREE.Matrix4},projectionMatrixInverse:{type:"v4",value:new THREE.Matrix4},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},diffuse:{type:"c",
value:new THREE.Color(16777215)},opacity:{type:"f",value:1},devicePixelRatio:{type:"f",value:window.devicePixelRatio},fog:!0},{vClipCenter:{value:[new THREE.Vector3]},clip:{value:!1},clipRadius:{value:0},color:{value:new THREE.Color},testHighlight:{value:!1},testUnhighlight:{value:!1}}]),rg={RADIUS_CLIP:!1,RADIUS_ATOMS_LENGTH:0,WEBGL_depth_texture:Ph.ba().Sh};THREE.ShaderMaterial.call(this,{uniforms:THREE.UniformsUtils.clone(qg),defines:rg,vertexShader:og,fragmentShader:pg,lights:!0,vertexColors:THREE.VertexColors,
fog:!0,clipping:!0});this.opacity=1;this.$c=[this.Lm,this.Mm,this.Nm,this.Qm];this.extensions.fragDepth=Ph.ba().zj}Uh.prototype=Object.create(THREE.ShaderMaterial.prototype);xg=Uh.prototype;xg.constructor=Uh;
xg.Lm=function(og,pg,qg,rg,sg){sg.uniforms&&null!=sg.uniforms.modelViewMatrixInverse&&(og=new THREE.Matrix4,qg=(new THREE.Matrix4).multiplyMatrices(qg.matrixWorldInverse,this.matrixWorld),og.getInverse(qg),sg.uniforms.modelViewMatrixInverse.value=og,sg.uniforms.modelViewMatrixInverse.needsUpdate=!0)};
xg.Mm=function(og,pg,qg,rg,sg){sg.uniforms&&null!=sg.uniforms.projectionMatrixInverse&&(og=new THREE.Matrix4,og.getInverse(qg.projectionMatrix),sg.uniforms.projectionMatrixInverse.value=og,sg.uniforms.projectionMatrixInverse.needsUpdate=!0)};xg.Nm=function(og,pg,qg,rg,sg){sg.uniforms&&null!=sg.uniforms.devicePixelRatio&&(sg.uniforms.devicePixelRatio.value=window.devicePixelRatio,sg.uniforms.devicePixelRatio.needsUpdate=!0)};
xg.Qm=function(og,pg,qg,rg,sg){sg.uniforms&&null!=sg.uniforms.viewport&&(og=new THREE.Vector4(0,0,og.domElement.offsetWidth,og.domElement.offsetHeight),sg.uniforms.viewport.value=og,sg.uniforms.viewport.needsUpdate=!0)};var Vh="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(og){return typeof og}:function(og){return og&&"function"===typeof Symbol&&og.constructor===Symbol&&og!==Symbol.prototype?"symbol":typeof og};
function Wh(og){if(Array.isArray(og)){for(var pg=0,qg=Array(og.length);pg<og.length;pg++)qg[pg]=og[pg];return qg}return Array.from(og)}
function Ph(){if("object"===Vh(Ph.Qi))return Ph.Qi;Ph.Qi=this;this.bgColor=new THREE.Color(0,0,0);this.ef=new THREE.Color("#FFFF00");this.df=new THREE.Color("#FF0000");this.we=3;var og=window.localStorage.getItem("quality"),pg=window.localStorage.getItem("antialias"),qg=window.localStorage.getItem("sao"),rg=window.localStorage.getItem("saoScale"),sg=window.localStorage.getItem("textRatio"),tg=window.localStorage.getItem("background"),ug=window.localStorage.getItem("3DController"),yg=window.localStorage.getItem("invertZoom"),
Bg=window.localStorage.getItem("highlightColor"),Cg=window.localStorage.getItem("hideHighlightColor"),Ag=window.localStorage.getItem("pulseHighlight");this.it=this.Vj=this.Bl=this.nl=this.fj=this.Oj=this.Kj=this.Zf=this.Mq=null;this.lr();this.te={Atoms:this.fj,"Amino Acids":this.Oj,"Nucleic Acids":this.Kj,Molecules:this.Zf,"Secondary Structure":this.Vj,Rainbow:this.Bl,Hydrophobicity:this.nl};this.hc={Atoms:[],Residues:[],Molecules:[],SST:[]};pg="string"==typeof pg?JSON.parse(pg):pg;qg="string"==typeof qg?
JSON.parse(qg):qg;yg="string"==typeof yg?JSON.parse(yg):yg;Ag="string"==typeof Ag?JSON.parse(Ag):Ag;this.dc={Bj:null!=yg?yg:!1,antialias:null!=pg?pg:!0,nf:null!=qg?qg:!0,qB:"0c0c0c"};Jh.Do(Jh.yf);this.qb=null!=og?og:"MEDIUM";this.Fg=null!=sg?sg:8;this.Kf=null!=rg?parseFloat(rg):7.5;null!=tg&&(this.bgColor=new THREE.Color(tg));this.zh=ug;null!=Bg&&(this.ef=new THREE.Color(Bg));null!=Cg&&(this.df=new THREE.Color(Cg));null!=Ag&&(this.we=Ag?3:0);this.fps=this.Uq=60;this.Mu=25E4;this.Qf=this.Mf=this.ng=
this.Gj=null;this.Aa={ma:{radius:1,widthSegments:16,heightSegments:8,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},ra:{radius:1,widthSegments:10,heightSegments:6,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},qa:{radius:1,widthSegments:6,heightSegments:3,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI}};this.va={ma:{radius:.3,widthSegments:12,heightSegments:8,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},ra:{radius:.3,widthSegments:8,
heightSegments:5,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},qa:{radius:.3,widthSegments:5,heightSegments:3,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI}};this.Da={ma:{radiusTop:.2,radiusBottom:.2,height:1,fg:12,heightSegments:1,openEnded:!1},ra:{radiusTop:.2,radiusBottom:.2,height:1,fg:5,heightSegments:1,openEnded:!1},qa:{radiusTop:.2,radiusBottom:.2,height:1,fg:3,heightSegments:1,openEnded:!1}};this.Jb={ma:{radius:this.Da.ma.radiusTop,widthSegments:12,heightSegments:8,
phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},ra:{radius:this.Da.ma.radiusTop,widthSegments:6,heightSegments:4,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},qa:{radius:this.Da.ma.radiusTop,widthSegments:5,heightSegments:3,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI}};this.lineWidth=2;this.Io=1;this.Zj=[]}Ph.ba=function(){return new Ph};xg=Ph.prototype;
xg.subscribe=function(og){if(void 0!==og.update)this.Zj.push(og);else throw Error("Class must have a update function to subscribe to modellingProperties");};xg.unsubscribe=function(og){void 0!==og.update&&this.Zj.splice(this.Zj.indexOf(og),1)};xg.ze=function(og){for(var pg=this.Zj.length,qg=0;qg<pg;qg++)this.Zj[qg].update(og)};
xg.ew=function(og){var pg=og.getSupportedExtensions();this.zj=og.getExtension("EXT_frag_depth")||!1;this.Sh=og.getExtension("WEBGL_depth_texture")||!1;var qg=og.getParameter(og.ALIASED_POINT_SIZE_RANGE);console.info("WebGL version : ",og.getParameter(og.VERSION));console.info("Available WEBGL extensions : ",pg);console.info("WebGL Point Size Range : "+qg[0]+"-"+qg[1]);console.info("Screen resolution : "+screen.width+"-"+screen.height);this.zj&&qg[1]>=Math.min(screen.width,screen.height)?(this.Vh=
!0,console.info("BiovizJS is using advanced impostor representation for Spheres, Sticks and Balls & Sticks.")):console.info("BiovizJS is using standard representation for Spheres, Sticks and Balls & Sticks. Viewer may be slow when loading large molecules.");this.Sh?(console.info("Your hardware is using improved transparency management."),console.info("Your hardware is compatible with Scalable Ambient Occlusion feature."),this.ys=this.aB=!0):(console.info("Your hardware isn't compatible with improved transparency. You may experience issues with transparency."),
console.info("Your hardware isn't compatible with Scalable Ambient Occlusion feature."));this.Sh?(console.info("Your hardware is using improved outline shader."),this.tz=!0):console.info("Your hardware isn't compatible with outline shader. Outline selections will be coloured instead.")};xg.setLineWidth=function(og){this.lineWidth=og;og=new Xh;og.lineWidth=!0;this.ze(og)};
xg.Rz=function(){this.dc.antialias=!0;this.dc.nf=!0;this.qb="MEDIUM";this.Fg=8;this.Kf=7.5;this.bgColor=new THREE.Color(0,0,0);this.ef=new THREE.Color("#FFFF00");this.df=new THREE.Color("#FF0000");this.we=3;this.zh=""};xg.Yv=function(og){this.zh!=og&&(this.zh=og,window.localStorage.setItem("3DController",og))};xg.xn=function(){return"#"+this.bgColor.getHexString()};
xg.zr=function(){return 125<Math.round((299*parseInt(255*this.bgColor.r)+587*parseInt(255*this.bgColor.g)+114*parseInt(255*this.bgColor.b))/1E3)?"black":"white"};xg.ir=function(){return"#"+this.ef.getHexString()};xg.hr=function(){return"#"+this.df.getHexString()};xg.Qv=function(og){window.localStorage.setItem("background",og);this.Pg(new THREE.Color(og))};
xg.Uv=function(og){this.ef!==new THREE.Color(og)&&(window.localStorage.setItem("highlightColor",og),this.ef=new THREE.Color(og),og=new Xh,og.ef=!0,this.ze(og))};xg.Tv=function(og){this.df!==new THREE.Color(og)&&(window.localStorage.setItem("hideHighlightColor",og),this.df=new THREE.Color(og),og=new Xh,og.df=!0,this.ze(og))};xg.Vv=function(){var og=$("#pulse").prop("checked");this.we!==og&&(window.localStorage.setItem("pulseHighlight",og),this.we=og?3:0,og=new Xh,og.we=!0,this.ze(og))};xg.Rv=function(og){this.Pg(new THREE.Color(og))};
xg.Pg=function(og){this.bgColor!=og&&(this.bgColor=og,og=new Xh,og.bgColor=!0,this.ze(og))};xg.Ix=function(){if("LOW"===this.qb)return.5;if("MEDIUM"===this.qb)return 1;if("HIGH"===this.qb)return 2};String.prototype.py=function(){var og=0;if(0==this.length)return og;for(var pg=0;pg<this.length;pg++)og=(og<<5)-og+this.charCodeAt(pg),og&=og;return og};xg=Ph.prototype;
xg.Hc=function(og,pg){var qg;if("A"===pg)return void 0===this.hc.Atoms[og]?(qg=new THREE.Color(this.fj[og]),this.hc.Atoms[og]=qg):this.hc.Atoms[og];if("M"===pg)return og.match(/^[A-Z0-9]$/)||(og="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(og.py()%36)),void 0===this.hc.Molecules[og]?(qg=new THREE.Color(this.Zf[og]),this.hc.Molecules[og]=qg):this.hc.Molecules[og];if("R"===pg)return void 0===this.hc.Residues[og]?(qg=this.Oj[og],void 0===qg&&(qg=this.Kj[og]),qg=new THREE.Color(qg),this.hc.Residues[og]=
qg):this.hc.Residues[og];if("SST"===pg)return void 0===this.hc.SST[og]?(qg=this.Vj[og],qg=new THREE.Color(qg),this.hc.SST[og]=qg):this.hc.SST[og]};xg.bw=function(og){this.Kf!=og&&(this.Kf=og,window.localStorage.setItem("saoScale",this.Kf),og=new Xh,og.saoScale=!0,this.ze(og))};xg.aw=function(og){this.dc.nf!=og&&(window.localStorage.setItem("sao",og),this.dc.nf=og,og=new Xh,og.nf=!0,this.ze(og))};xg.cw=function(og){this.Fg!=og&&(this.Fg=og,window.localStorage.setItem("textRatio",this.Fg))};
xg.Pv=function(og){this.dc.antialias!=og&&(window.localStorage.setItem("antialias",og),this.dc.antialias=og)};xg.Wv=function(og){this.dc.Bj!=og&&(window.localStorage.setItem("invertZoom",og),this.dc.Bj=og,Jh.Do(Jh.yf))};
xg.yq=function(og){this.qb==og||"LOW"!==og&&"MEDIUM"!==og&&"HIGH"!==og||(this.qb=og,og=new Xh,og.Mj=!0,"HIGH"===this.qb?(this.ng=new THREE.SphereGeometry(this.Aa.ma.radius,this.Aa.ma.widthSegments,this.Aa.ma.heightSegments,this.Aa.ma.phiStart,this.Aa.ma.phiLength,this.Aa.ma.thetaStart,this.Aa.ma.thetaLength),this.Mf=new THREE.SphereGeometry(this.va.ma.radius,this.va.ma.widthSegments,this.va.ma.heightSegments,this.va.ma.phiStart,this.va.ma.phiLength,this.va.ma.thetaStart,this.va.ma.thetaLength),this.Qf=
new THREE.CylinderGeometry(this.Da.ma.radiusTop,this.Da.ma.radiusBottom,this.Da.ma.height,this.Da.ma.fg,this.Da.ma.Aj,this.Da.ma.openEnded)):"MEDIUM"===this.qb?(this.ng=new THREE.SphereGeometry(this.Aa.ra.radius,this.Aa.ra.widthSegments,this.Aa.ra.heightSegments,this.Aa.ra.phiStart,this.Aa.ra.phiLength,this.Aa.ra.thetaStart,this.Aa.ra.thetaLength),this.Mf=new THREE.SphereGeometry(this.va.ra.radius,this.va.ra.widthSegments,this.va.ra.heightSegments,this.va.ra.phiStart,this.va.ra.phiLength,this.va.ra.thetaStart,
this.va.ra.thetaLength),this.Qf=new THREE.CylinderGeometry(this.Da.ra.radiusTop,this.Da.ra.radiusBottom,this.Da.ra.height,this.Da.ra.fg,this.Da.ra.Aj,this.Da.ra.openEnded)):"LOW"===this.qb&&(this.ng=new THREE.SphereGeometry(this.Aa.qa.radius,this.Aa.qa.widthSegments,this.Aa.qa.heightSegments,this.Aa.qa.phiStart,this.Aa.qa.phiLength,this.Aa.qa.thetaStart,this.Aa.qa.thetaLength),this.Mf=new THREE.SphereGeometry(this.va.qa.radius,this.va.qa.widthSegments,this.va.qa.heightSegments,this.va.qa.phiStart,
this.va.qa.phiLength,this.va.qa.thetaStart,this.va.qa.thetaLength),this.Qf=new THREE.CylinderGeometry(this.Da.qa.radiusTop,this.Da.qa.radiusBottom,this.Da.qa.height,this.Da.qa.fg,this.Da.qa.Aj,this.Da.qa.openEnded)),this.ze(og),window.localStorage.setItem("quality",this.qb))};
xg.zx=function(){null===this.Qf&&("HIGH"===this.qb?this.Qf=new THREE.CylinderGeometry(this.Da.ma.radiusTop,this.Da.ma.radiusBottom,this.Da.ma.height,this.Da.ma.fg,this.Da.ma.Aj,this.Da.ma.openEnded):"MEDIUM"===this.qb?this.Qf=new THREE.CylinderGeometry(this.Da.ra.radiusTop,this.Da.ra.radiusBottom,this.Da.ra.height,this.Da.ra.fg,this.Da.ra.Aj,this.Da.ra.openEnded):"LOW"===this.qb&&(this.Qf=new THREE.CylinderGeometry(this.Da.qa.radiusTop,this.Da.qa.radiusBottom,this.Da.qa.height,this.Da.qa.fg,this.Da.qa.Aj,
this.Da.qa.openEnded)));return this.Qf};
xg.br=function(){null===this.Mf&&("HIGH"===this.qb?this.Mf=new THREE.SphereGeometry(this.va.ma.radius,this.va.ma.widthSegments,this.va.ma.heightSegments,this.va.ma.phiStart,this.va.ma.phiLength,this.va.ma.thetaStart,this.va.ma.thetaLength):"MEDIUM"===this.qb?this.Mf=new THREE.SphereGeometry(this.va.ra.radius,this.va.ra.widthSegments,this.va.ra.heightSegments,this.va.ra.phiStart,this.va.ra.phiLength,this.va.ra.thetaStart,this.va.ra.thetaLength):"LOW"===this.qb&&(this.Mf=new THREE.SphereGeometry(this.va.qa.radius,
this.va.qa.widthSegments,this.va.qa.heightSegments,this.va.qa.phiStart,this.va.qa.phiLength,this.va.qa.thetaStart,this.va.qa.thetaLength)));return this.Mf};
xg.ey=function(){null===this.ng&&("HIGH"===this.qb?this.ng=new THREE.SphereGeometry(this.Aa.ma.radius,this.Aa.ma.widthSegments,this.Aa.ma.heightSegments,this.Aa.ma.phiStart,this.Aa.ma.phiLength,this.Aa.ma.thetaStart,this.Aa.ma.thetaLength):"MEDIUM"===this.qb?this.ng=new THREE.SphereGeometry(this.Aa.ra.radius,this.Aa.ra.widthSegments,this.Aa.ra.heightSegments,this.Aa.ra.phiStart,this.Aa.ra.phiLength,this.Aa.ra.thetaStart,this.Aa.ra.thetaLength):"LOW"===this.qb&&(this.ng=new THREE.SphereGeometry(this.Aa.qa.radius,
this.Aa.qa.widthSegments,this.Aa.qa.heightSegments,this.Aa.qa.phiStart,this.Aa.qa.phiLength,this.Aa.qa.thetaStart,this.Aa.qa.thetaLength)));return this.ng};
xg.Hx=function(){null===this.Gj&&("HIGH"===this.qb?this.Gj=new THREE.SphereGeometry(this.Jb.ma.radius,this.Jb.ma.widthSegments,this.Jb.ma.heightSegments,this.Jb.ma.phiStart,this.Jb.ma.phiLength,this.Jb.ma.thetaStart,this.Jb.ma.thetaLength):"MEDIUM"===this.qb?this.Gj=new THREE.SphereGeometry(this.Jb.ra.radius,this.Jb.ra.widthSegments,this.Jb.ra.heightSegments,this.Jb.ra.phiStart,this.Jb.ra.phiLength,this.Jb.ra.thetaStart,this.Jb.ra.thetaLength):"LOW"===this.qb&&(this.Gj=new THREE.SphereGeometry(this.Jb.qa.radius,
this.Jb.qa.widthSegments,this.Jb.qa.heightSegments,this.Jb.qa.phiStart,this.Jb.qa.phiLength,this.Jb.qa.thetaStart,this.Jb.qa.thetaLength)));return this.Gj};xg.ll=function(og,pg){if(null===pg||void 0===pg)pg=20;return this.fs(og,{fontsize:pg,sn:{r:255,g:255,b:255,a:1},strokeStyle:!0})};
xg.fs=function(og,pg){void 0===pg&&(pg={});var qg=void 0!==pg.ix?pg.ix:"serif",rg=void 0!==pg.fontsize?pg.fontsize:20,sg=void 0!==pg.sn?pg.sn:{r:1,g:0,b:0,a:1},tg=pg.maxWidth,ug=pg.maxHeight,yg=document.createElement("canvas"),Bg=yg.getContext("2d");Bg.font=rg+"px "+qg;var Cg=og.split("\n"),Ag=0,wg=!0,Dg=!1,Eg=void 0;try{for(var Fg=Cg[Symbol.iterator](),Jg;!(wg=(Jg=Fg.next()).done);wg=!0){var Ig=Jg.value,Lg=1.1*Bg.measureText(Ig).width;Lg>Ag&&(Ag=Lg)}}catch(Kg){Dg=!0,Eg=Kg}finally{try{!wg&&Fg["return"]&&
Fg["return"]()}finally{if(Dg)throw Eg;}}rg=Math.ceil(rg);null!=tg&&Ag>tg&&(rg=Math.ceil(rg*tg/Ag),Bg.font=rg+"px "+qg,Ag=tg);null!=ug&&rg>ug&&(Ag*=ug/rg,rg=ug,Bg.font=rg+"px "+qg);yg.width=Ag;yg.height=10+rg*Cg.length;Bg.fillStyle="rgba("+sg.r+","+sg.g+","+sg.b+","+sg.a+")";Bg.font=rg+"px "+qg;Bg.textAlign="center";Bg.textBaseline="middle";pg.strokeStyle&&(Bg.strokeStyle="rgba(0,0,0,1.0)",Bg.lineWidth=2,Bg.strokeText(og,Ag/2,rg/2));for(qg=0;qg<Cg.length;qg++)Ig=Cg[qg],Bg.fillText(Ig,Ag/2,rg/2+rg*
qg);yg=new THREE.Texture(yg);yg.minFilter=THREE.LinearFilter;yg.needsUpdate=!0;return yg};xg.Bn=function(og){return parseFloat(Pg.bf(og.symbol.charAt(0).toUpperCase()+og.symbol.slice(1).toLowerCase())[7])};
xg.lr=function(){this.Mq=JSON.parse(window.localStorage.getItem("defaultColor"))||JSON.parse(JSON.stringify(jh));this.Zf=JSON.parse(window.localStorage.getItem("moleculeColor"))||JSON.parse(JSON.stringify(kh));this.Kj=JSON.parse(window.localStorage.getItem("nucleicAcidColor"))||JSON.parse(JSON.stringify(lh));this.Oj=JSON.parse(window.localStorage.getItem("residueColor"))||JSON.parse(JSON.stringify(mh));this.fj=JSON.parse(window.localStorage.getItem("atomColor"))||JSON.parse(JSON.stringify(nh));this.nl=
JSON.parse(window.localStorage.getItem("hydroColor"))||JSON.parse(JSON.stringify(ph));this.Bl=JSON.parse(window.localStorage.getItem("rainbowColor"))||JSON.parse(JSON.stringify(qh));this.Vj=JSON.parse(window.localStorage.getItem("sstColor"))||JSON.parse(JSON.stringify(yh));this.it=JSON.parse(window.localStorage.getItem("unsortedProperties"))||JSON.parse(JSON.stringify(Hh));this.te={Atoms:this.fj,"Amino Acids":this.Oj,"Nucleic Acids":this.Kj,Molecules:this.Zf,"Secondary Structure":this.Vj,Rainbow:this.Bl,
Hydrophobicity:this.nl}};
xg.Sz=function(){this.hc={Atoms:[],Residues:[],Molecules:[],SST:[]};window.localStorage.removeItem("defaultColor");window.localStorage.removeItem("moleculeColor");window.localStorage.removeItem("nucleicAcidColor");window.localStorage.removeItem("residueColor");window.localStorage.removeItem("atomColor");window.localStorage.removeItem("hydroColor");window.localStorage.removeItem("rainbowColor");window.localStorage.removeItem("sstColor");window.localStorage.removeItem("unsortedProperties");this.lr();
var og=new Xh;og.To=!0;this.ze(og)};
xg.Wz=function(){window.localStorage.setItem("defaultColor",JSON.stringify(this.Mq));window.localStorage.setItem("moleculeColor",JSON.stringify(this.Zf));window.localStorage.setItem("nucleicAcidColor",JSON.stringify(this.Kj));window.localStorage.setItem("residueColor",JSON.stringify(this.Oj));window.localStorage.setItem("atomColor",JSON.stringify(this.fj));window.localStorage.setItem("hydroColor",JSON.stringify(this.nl));window.localStorage.setItem("rainbowColor",JSON.stringify(this.Bl));window.localStorage.setItem("sstColor",
JSON.stringify(this.Vj));window.localStorage.setItem("unsortedProperties",JSON.stringify(this.it))};xg.Xv=function(og,pg,qg){if(void 0!==this.te[og]&&void 0!==this.te[og][pg]){this.te[og][pg]=qg;var rg=og;"Amino Acids"===rg||"Nucleic Acids"===rg?rg="Residues":"Secondary Structure"===rg&&(rg="SST");void 0!=this.hc[rg]&&void 0!=this.hc[rg][pg]&&(this.hc[rg][pg]=this.hc[rg][pg].set(qg),pg=new Xh,pg.To=!0,pg.Bq=og,this.ze(pg))}};
function Xh(){this.To=this.lineWidth=this.Io=this.Mj=!1;this.Bq=null;this.bgColor=!1}xg.Ye=function(og){og=new Qh(og);og.blendEquation=THREE.AddEquation;og.blendEquationAlpha=THREE.AddEquation;og.blendSrc=THREE.SrcAlphaFactor;og.blendDst=THREE.ZeroFactor;og.blendSrcAlpha=THREE.OneFactor;og.blendDstAlpha=THREE.ZeroFactor;return og};
xg.Hr=function(){var og=new Rh;og.blendEquation=THREE.AddEquation;og.blendEquationAlpha=THREE.AddEquation;og.blendSrc=THREE.SrcAlphaFactor;og.blendDst=THREE.ZeroFactor;og.blendSrcAlpha=THREE.OneFactor;og.blendDstAlpha=THREE.ZeroFactor;return og};
xg.jl=function(){var og=new Th;og.blendEquation=THREE.AddEquation;og.blendEquationAlpha=THREE.AddEquation;og.blendSrc=THREE.SrcAlphaFactor;og.blendDst=THREE.ZeroFactor;og.blendSrcAlpha=THREE.OneFactor;og.blendDstAlpha=THREE.ZeroFactor;og.extensions.fragDepth=!0;og.side=THREE.DoubleSide;return og};
xg.zn=function(){var og=new Uh;og.blendEquation=THREE.AddEquation;og.blendEquationAlpha=THREE.AddEquation;og.blendSrc=THREE.SrcAlphaFactor;og.blendDst=THREE.ZeroFactor;og.blendSrcAlpha=THREE.OneFactor;og.blendDstAlpha=THREE.ZeroFactor;og.extensions.fragDepth=!0;og.side=THREE.DoubleSide;return og};function ci(og){this.ga=Ph.ba();this.duration=og;this.bb=0}ci.prototype.aa=function(){return-1!=this.duration&&this.bb>=this.duration};
ci.prototype.moveTo=function(og){if(1<og||0>og||isNaN(og))return 0;this.bb=this.duration*og};function ei(og,pg,qg){ci.call(this);this.Ln=null;this.opacity=og;this.Ma=qg;this.bb=0;this.duration=pg;this.Ma.da.material.transparent=!0;this.Ln=this.Ma.da.material.opacity}ei.prototype=Object.create(ci.prototype);ei.prototype.constructor=ei;ei.prototype.Ke=function(og){this.bb+=og;og=this.bb/this.duration;1<og&&(og=1);this.Ma.jg(1===og?this.opacity:this.Ln+(this.opacity-this.Ln)*og)};
function gi(og,pg){ci.call(this);this.duration=og;this.Ma=pg;this.ol=[];this.b=this.g=this.r=null;this.jo=!1;this.map=null}gi.prototype=Object.create(ci.prototype);xg=gi.prototype;xg.constructor=gi;xg.by=function(og){og=og.clone();this.ol.push(og)};
xg.init=function(){var og=this.Ma.da.geometry,pg=og.attributes.color,og=og.attributes.color.array;if(0===pg.count)this.Ma.da.material.color=this.Ma.da.material.color.clone(),this.ol.push(this.Ma.da.material.color);else for(var pg=pg.count,qg=0;qg<pg;qg++){var rg=new THREE.Color(og[3*qg],og[3*qg+1],og[3*qg+2]);this.by(rg)}};xg.Rs=function(og,pg,qg){this.r=1<og?og/255:og;this.g=1<pg?pg/255:pg;this.b=1<qg?qg/255:qg;this.init()};xg.nA=function(og){this.jo=!0;this.map=og;this.init()};
xg.Ke=function(og){this.bb+=og;og=this.bb/this.duration;1<og&&(og=1);for(var pg=this.Ma.da.geometry.attributes.color,qg=new Float32Array(pg.array.length),rg=this.ol.length,sg=0;sg<rg;sg++){var tg=this.ol[sg];if(1===og)if(this.jo){var ug=this.map[sg];null!=ug?(qg[3*sg]=ug.r,qg[3*sg+1]=ug.g,qg[3*sg+2]=ug.b):(qg[3*sg]=tg.r,qg[3*sg+1]=tg.g,qg[3*sg+2]=tg.b)}else qg[3*sg]=this.r,qg[3*sg+1]=this.g,qg[3*sg+2]=this.b;else this.jo?(ug=this.map[sg],null!=ug?(qg[3*sg]=tg.r+(ug.r-tg.r)*og,qg[3*sg+1]=tg.g+(ug.g-
tg.g)*og,qg[3*sg+2]=tg.b+(ug.b-tg.b)*og):(qg[3*sg]=tg.r,qg[3*sg+1]=tg.g,qg[3*sg+2]=tg.b)):(qg[3*sg]=tg.r+(this.r-tg.r)*og,qg[3*sg+1]=tg.g+(this.g-tg.g)*og,qg[3*sg+2]=tg.b+(this.b-tg.b)*og)}pg.set(qg);pg.needsUpdate=!0};function hi(og){this.cb=og;this.fa=this.cb.fa;this.Xa=this.cb.la;this.parent=this.cb;this.ga=Ph.ba();this.ga.subscribe(this);this.visible=!1;this.da=null;this.sd=[];this.Wg=!1;this.oj=null;this.ml=!1;this.Fq=null}xg=hi.prototype;
xg.Yc=function(){var og=this;if(this.Wg)return this.oj;this.Wg=!0;if(this.oj=this.Dc())return this.oj.then(function(pg){og.Wg=!1;og.yb();return Promise.resolve(pg)});this.Wg=!1;this.yb();return Promise.resolve(this)};xg["delete"]=function(){this.ga.unsubscribe(this);if(null!=this.da&&(this.parent.remove(this.da),Array.isArray(this.da.material)))for(var og=this.da.material,pg=0;pg<og.length;pg++);};
xg.cd=function(){if("function"===typeof this.cb.la.Ja)switch(this.cb.la.Ja().ja.name){case fh.ea.Td:case fh.ea.vg:case fh.ea.Ai:case fh.ea.wi:this.color(hi.za.oc);break;case fh.ea.wg:case fh.ea.xi:this.color(hi.za.Fb);break;default:this.color(hi.za.Fb)}else this.color(hi.za.Fb)};
xg.yb=function(og){if(null!=this.da){var pg=this.cb.outline,qg=this.da.geometry.attributes.atomIndex,rg=this.da.geometry.attributes.highlight;if(null!=rg){var pg=pg?1:0,sg=rg.array.slice();if(og instanceof Array){for(var tg=[],qg=qg.array,ug=0;ug<og.length;ug++)tg.push(this.fa.indexOf(og[ug]));og=rg.count;for(ug=0;ug<og;ug++)-1!==tg.indexOf(qg[ug])&&(sg[ug]=pg)}else sg.fill(pg);rg.set(sg);rg.needsUpdate=!0}return sg.includes(1)}};
xg.show=function(){var og=this,pg=Promise.resolve(this);if(this.Wg)return this.ml=!1,this.oj;null===this.da&&(this.visible=!0,pg=this.Yc(),pg.then(function(pg){og.ml&&(og.hide(),og.ml=!1);return pg}));null!==this.da&&(this.da.visible=!0,this.visible=this.da.jb=!0);return pg};xg.hide=function(){this.Wg?this.ml=!0:null!==this.da&&(this.da.visible=!1,this.da.jb=!0,this.visible=!1)};xg.Ku=function(og){for(var pg in hi.za)if(hi.za[pg]===og)return!0;return!1};
xg.ry=function(og){og=og.replace("#","");return[parseInt(og.substring(0,2),16),parseInt(og.substring(2,4),16),parseInt(og.substring(4,6),16)]};
xg.color=function(og,pg){this.Fq=og;var qg,rg,sg,tg;if("string"===typeof og){if(void 0!=Ih[og])rg=Ih[og].r,sg=Ih[og].g,tg=Ih[og].b;else if("#"==og.substring(0,1))og=this.ry(og),rg=og[0],sg=og[1],tg=og[2];else if("rgb("==og.substring(0,4))og=og.replace("rgb(",""),og=og.replace(")",""),og=og.split(","),rg=og[0],sg=og[1],tg=og[2];else throw Error("unrecognized color");if(void 0!=pg)return qg=new gi(pg,this),qg.Rs(rg,sg,tg),qg;this.Fp(rg,sg,tg)}else if(this.Ku(og)){if(void 0!=pg)return rg=this.fr(og),
qg=new gi(pg,this),qg.nA(rg),qg;this.pu(og)}else if(3===og.length){rg=og[0];sg=og[1];tg=og[2];if(0<pg)return qg=new gi(pg,this),qg.Rs(rg,sg,tg),qg;this.Fp(rg,sg,tg)}else if(Array.isArray(og))this.ou(og);else throw Error("unrecognized color");};
xg.pu=function(og){if(null!==this.da){var pg=this.da.geometry;if(pg instanceof THREE.BufferGeometry){for(var qg=pg.attributes.color.array,rg=pg.attributes.atomIndex.array.length,sg=0;sg<rg;sg++){var tg=this.Fu(og,sg);void 0!=tg&&(qg[3*sg]=tg.r,qg[3*sg+1]=tg.g,qg[3*sg+2]=tg.b)}pg.attributes.color.needsUpdate=!0}else console.warn("Unknown type of geometry for coloring by atom ",pg)}};
xg.ou=function(og){this.cb instanceof Molecule3D||console.warn("Buffer coloring is only managed for Molecule3D");if(null!==this.da){var pg=this.da.geometry;if(pg instanceof THREE.BufferGeometry){var qg=pg.attributes.color.array,rg=pg.attributes.atomIndex.array,sg=rg.length;if(this.cb.pa.ka.length!==og.length)for(var tg=0;tg<sg;tg++){var ug=rg[tg],ug=this.fa[ug],yg=ug.Xi-1,ug=og[yg];if(null==ug)console.warn("Unknow color for residue id ",yg,". Buffer size is ",og.length);else{var yg=ug[0],Bg=ug[1],
ug=ug[2];if(1<yg||1<Bg||1<ug)yg/=255,Bg/=255,ug/=255;qg[3*tg]=yg;qg[3*tg+1]=Bg;qg[3*tg+2]=ug}}else for(var Cg=-1,Ag=-1,tg=0;tg<sg;tg++)if(ug=rg[tg],ug=this.fa[ug],yg=ug.Xi-1,yg!==Cg&&(Ag++,Cg=yg),ug=og[Ag],null==ug)console.warn("Unknow color for residue id ",Ag,". Buffer size is ",og.length);else{yg=ug[0];Bg=ug[1];ug=ug[2];if(1<yg||1<Bg||1<ug)yg/=255,Bg/=255,ug/=255;qg[3*tg]=yg;qg[3*tg+1]=Bg;qg[3*tg+2]=ug}pg.attributes.color.needsUpdate=!0}else console.warn("Unknown type of geometry for coloring by buffer ",
pg)}};xg.Fu=function(og,pg){null==this.sd[og.id]&&(this.sd[og.id]=this.fr(og));return this.sd[og.id][pg]};xg.fr=function(og){this.sd[og.id]=og===hi.za.rp?this.uu():og===hi.za.kp?this.su():this.tu(og);return this.sd[og.id]};xg.tu=function(og){if(null!==this.da){for(var pg=this.da.geometry.attributes.atomIndex.array,qg=pg.length,rg=[],sg=0;sg<qg;sg++){var tg=this.Du(og,pg[sg]);rg.push(tg)}return rg}};
xg.Du=function(og,pg){var qg,rg;switch(og){case hi.za.oc:qg=this.fa[pg].wa().Ja().id.toUpperCase();qg=this.ga.Hc(qg,"M");break;case hi.za.Ud:qg=this.fa[pg].wa().gb.toUpperCase();qg=this.ga.Hc(qg,"R");break;case hi.za.Fb:rg=this.fa[pg];qg=rg.symbol.charAt(0).toUpperCase()+rg.symbol.slice(1).toLowerCase();qg=this.ga.Hc(qg,"A");break;case hi.za.hp:rg=this.fa[pg];"C"===rg.symbol&&(qg=rg.symbol.charAt(0).toUpperCase()+rg.symbol.slice(1).toLowerCase(),qg=this.ga.Hc(qg,"A"));break;case hi.za.jp:rg=this.fa[pg];
"C"!==rg.symbol&&(qg=rg.symbol.charAt(0).toUpperCase()+rg.symbol.slice(1).toLowerCase(),qg=this.ga.Hc(qg,"A"));break;case hi.za.tp:rg=this.fa[pg],qg=this.ga.Hc(rg.wa().Eb.name,"SST")}return qg};
xg.Fp=function(og,pg,qg){1<og&&(og/=255);1<pg&&(pg/=255);1<qg&&(qg/=255);if(null!==this.da){var rg=this.da.geometry;if(rg instanceof THREE.BufferGeometry){for(var sg=rg.attributes.color.array,tg=sg.length/3,ug=0;ug<tg;ug++)sg[3*ug]=og,sg[3*ug+1]=pg,sg[3*ug+2]=qg;rg.attributes.color.needsUpdate=!0}else console.warn("Unknown type of geometry for coloring by atom ",rg)}};
xg.uu=function(){var og;og=this.cb.fa;for(var pg=new Vg,qg=og.length,rg=0;rg<qg;rg++)pg.set(og[rg],(new THREE.Color).setHSL(rg/qg*.8,1,.42));if(null!==this.da){rg=this.da.geometry;og=[];if(rg instanceof THREE.BufferGeometry)for(qg=rg.attributes.atomIndex.array,rg=0;rg<qg.length;rg++){var sg=pg.get(this.fa[qg[rg]]);og.push(sg)}else console.warn("Unknown type of geometry for mapping by rainbow ",rg);return og}};
xg.su=function(){var og=this.da.geometry,pg=[],qg="IVLFCMAGTWSYPHEZQDBNKR".split(""),rg=[45,42,38,28,25,19,18,-4,-7,-9,-8,-13,-16,-32,-35,-35,-35,-35,-35,-35,-39,-45];if(null!=this.da){for(var og=og.attributes.atomIndex.array,sg=0;sg<og.length;sg++){var tg;tg=this.fa[og[sg]].wa();if(tg.ja==fh.ea.vg||tg.ja==fh.ea.Td||tg.ja==fh.ea.wg){var ug;for(ug=0;ug<qg.length&&qg[ug]!=tg.tr().toUpperCase();ug++);ug==qg.length?tg=new THREE.Color(1,1,1):(tg=rg[ug],tg=0<tg?new THREE.Color(1,1-tg/45,1-tg/45):new THREE.Color(1-
tg/-45,1-tg/-45,1))}else tg=new THREE.Color(1,1,1);pg.push(tg)}return pg}};
xg.jg=function(og,pg){if(null!==this.da)if(void 0===pg||0===pg){if(Array.isArray(this.da.material)){var qg=!0,rg=!1,sg=void 0;try{for(var tg=this.da.material[Symbol.iterator](),ug;!(qg=(ug=tg.next()).done);qg=!0){var yg=ug.value;yg.transparent=1!==og;yg.opacity=og;yg.uniforms.opacity.value=og;yg.uniforms.opacity.needsUpdate=!0;yg.needsUpdate=!0;yg.visible=0===og?!1:!0}}catch(Bg){rg=!0,sg=Bg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}}else null!=this.da.material.uniforms&&
null!=this.da.material.uniforms.opacity&&(this.da.material.transparent=1!==og,this.da.material.opacity=og,this.da.material.uniforms.opacity.value=og,this.da.material.uniforms.opacity.needsUpdate=!0,this.da.material.needsUpdate=!0,this.da.material.visible=0===og?!1:!0);this.da.material.transparent=1!==og;this.da.material.ri=!0}else if(Array.isArray(this.da.material)||null!=this.da.material.uniforms&&null!=this.da.material.uniforms.opacity)return new ei(og,pg,this);return null};
xg.update=function(og){if(null!=this.da){if(og.To){og=og.Bq;if(void 0!=og){if("Amino Acids"===og||"Nucleic Acids"===og)og=hi.za.Ud;this.sd[og]=null}else this.sd=[];this.color(this.Fq)}this.yb()}};hi.jz=function(og,pg){if(void 0!==og&&null!==og){var qg=new og.Ma(pg,og.Wy,og.XA,og.yv);qg.Nj=og.name;return qg}};
hi.za={oc:{name:"Molecules",id:"molecule"},Ud:{name:"Residues",id:"residue"},Fb:{name:"Atoms",id:"atom"},hp:{name:"Carbon atom",id:"carbon"},jp:{name:"Heteroatom",id:"heteroatom"},tp:{name:"Secondary Structure",id:"sse"},rp:{name:"Rainbow",id:"rainbow"},kp:{name:"Hydrophobicity",id:"hydrophobicity"}};hi.za.Lx=function(){var og=[],pg;for(pg in this){var qg=this[pg];this.hasOwnProperty(pg)&&"object"===("undefined"===typeof qg?"undefined":Vh(qg))&&og.push(qg.name)}return og};
hi.za.An=function(og){for(var pg in this)if(this[pg].id===og)return this[pg];return null};hi.za.cl=function(og){for(var pg in this)if(this[pg].name===og)return this[pg];return null};function ii(){Ug.call(this);this.ta=[]}function ji(og,pg){this.key=og;this.value=pg}ii.prototype=Object.create(Ug.prototype);xg=ii.prototype;xg.constructor=ii;
xg.set=function(og,pg){if(void 0===og)throw"ERROR: key cannot be undefined";var qg=this.Ox(og);void 0===qg?"object"===("undefined"===typeof og?"undefined":Vh(og))&&(og.Jj=this.ta.push(new ji(og,pg))-1):qg.value=pg};xg.get=function(og){if(void 0!==og.Jj)return this.ta[og.Jj].value;for(var pg in this.ta)if(this.ta[pg].key===og)return this.ta[pg].value};xg.Ox=function(og){if(void 0!==og.Jj)return this.ta[og.Jj];for(var pg in this.ta)if(this.ta[pg].key===og)return this.ta[pg]};
xg.keys=function(){var og=[],pg;for(pg in this.ta)og.push(this.ta[pg].key);return og};xg.Kh=function(og){return-1!==this.keys().indexOf(og)};xg.values=function(){var og=[],pg;for(pg in this.ta)og.push(this.ta[pg].value);return og};xg.remove=function(og){var pg=-1,qg;for(qg in this.ta)if(this.ta[qg].key===og){pg=qg;break}return 0<=pg?this.ta.splice(pg,1)[0].value:null};xg.clear=function(){this.ta=[]};xg.fl=function(og){for(var pg in this.ta)if(this.ta[pg].value===og)return this.ta[pg].key};
function ui(og,pg,qg){this.Nf=void 0!==og?og:new THREE.Vector3;this.direction=void 0!==pg?pg:new THREE.Vector3;this.radius=void 0!==qg?qg:0}xg=ui.prototype;xg.constructor=THREE.gB;xg.set=function(og,pg,qg){this.Nf.copy(og);this.direction.copy(pg);this.radius=qg;return this};xg.clone=function(){var og=new ui;og.Nf.copy(this.Nf);og.direction.copy(this.direction);og.radius=this.radius;return og};xg.empty=function(){return 0>=this.radius||0===this.direction.length()};xg.containsPoint=function(){console.error("THREE.Cylinder.containsPoint not implemented yet")};
xg.distanceToPoint=function(){console.error("THREE.Cylinder.distanceToPoint not implemented yet")};xg.clampPoint=function(){console.error("THREE.Cylinder.clampPoint not implemented yet")};xg.applyMatrix4=function(og){this.Nf.applyMatrix4(og);var pg=(new THREE.Matrix4).extractRotation(og);this.direction.applyMatrix4(pg);this.radius*=og.getMaxScaleOnAxis();return this};xg.translate=function(og){this.Nf.add(og);return this};
xg.equals=function(og){return og.Nf.equals(this.Nf)&&og.radius===this.radius&&og.direction.equals(this.direction)};function vi(){}
vi.yn=function(og,pg,qg,rg){var sg=1;void 0!==rg&&(sg=rg);var tg=og==pg?og.Gc():og.Gc(!0);rg=og.wb().length()/2;var ug=new THREE.Matrix4;ug.copy(og.matrixWorld);og=new THREE.Matrix4;og.makeTranslation(tg.x,tg.y,tg.z);ug.multiply(og);og=new THREE.Matrix4;og.makeTranslation(-ug.elements[12],-ug.elements[13],-ug.elements[14]);og.multiply(pg.matrix);og.elements[14]=qg?og.elements[14]-(1/sg*rg*2-pg.camera.position.z):pg.matrix.elements[14];return og};
vi.ay=function(og,pg,qg,rg){var sg=new THREE.Matrix4;sg.copy(og.matrixWorld);og=new THREE.Matrix4;og.getInverse(sg);var sg=new THREE.Vector3(og.elements[0],og.elements[1],og.elements[2]),tg=new THREE.Vector3(og.elements[4],og.elements[5],og.elements[6]);og=(new THREE.Vector3).crossVectors(sg,tg);var ug=new THREE.Matrix4;ug.Oh(pg,tg.x,tg.y,tg.z);pg=new THREE.Matrix4;pg.Oh(qg,sg.x,sg.y,sg.z);qg=new THREE.Matrix4;qg.Oh(rg,og.x,og.y,og.z);new THREE.Matrix4;return qg.multiply(pg).multiply(ug)};
vi.qx=function(og,pg){var qg=new THREE.Vector3;qg.copy(og.Gc());var rg=(new THREE.Matrix4).makeTranslation(qg.x,qg.y,qg.z),qg=(new THREE.Matrix4).copy(pg);qg.multiply(og.matrixWorld).multiply(rg);rg=(new THREE.Matrix4).getInverse(qg);return[qg,rg]};vi.Zh=function(og,pg){var qg=new THREE.Vector4(og.x,og.y,og.z,1),rg=new THREE.Vector4(pg.normal.x,pg.normal.y,pg.normal.z,pg.constant);return qg.dot(rg)};
vi.Mz=function(og,pg){var qg=og.origin,rg=og.direction;rg.normalize();var sg=pg.radius,tg=pg.Nf,ug=pg.direction.length(),yg=pg.direction.clone();yg.normalize();var Bg=(new THREE.Vector3).crossVectors(rg,yg);if(1E-4>=Bg.length())return console.warn("May need to resolve equation when cylinder direction and ray direction colinear"),null;var Cg=Bg.clone().normalize(),Ag=(new THREE.Vector3).subVectors(qg,tg),wg=Math.abs(Ag.dot(Cg));if(wg>sg)return null;Bg=-Ag.clone().cross(yg).dot(Cg)/Bg.length();Cg=(new THREE.Vector3).crossVectors(Cg,
yg);Cg.normalize();wg=Math.abs(Math.sqrt(sg*sg-wg*wg)/rg.dot(Cg));sg=Bg-wg;wg=Bg+wg;sg>wg&&(Bg=sg,sg=wg,wg=Bg);sg=(new THREE.Vector3).addVectors(qg,rg.clone().multiplyScalar(sg));qg=(new THREE.Vector3).addVectors(qg,rg.clone().multiplyScalar(wg));rg=(new THREE.Vector3).subVectors(sg,tg).dot(yg);tg=(new THREE.Vector3).subVectors(qg,tg).dot(yg);return rg<=ug&&0<=rg?sg:tg<=ug&&0<=tg?qg:null};
vi.raycast=function(og,pg,qg,rg){if(0===pg.length)return null;var sg=new THREE.Raycaster;sg.linePrecision=.2;sg.params.Points.threshold=2.75;var tg=og.ul,ug=og.Wk;qg=new THREE.Vector2(qg,rg);sg.setFromCamera(qg,og.camera);pg=sg.intersectObjects(pg);if(qg=pg.length){og=null;rg=Infinity;for(var yg=0;yg<qg;yg++){var Bg=pg[yg],Cg=Bg.object,Ag=Bg.distance,wg=Cg.geometry,Dg=null!=Bg.index?Bg.index:Bg.face.a;if(Cg instanceof THREE.Points){var Ag=wg.attributes.radius.array[Dg],Eg=wg.attributes.position.array,
Fg=new THREE.Vector3;Fg.fromArray(Eg,3*Dg);wg=wg.attributes.dir;Eg=new THREE.Vector3;wg&&Eg.fromArray(wg.array,3*Dg);0===Eg.length()?(Dg=new THREE.Sphere(Fg,Ag),Dg.applyMatrix4(Cg.matrixWorld),Cg=sg.ray.intersectSphere(Dg)):(Dg=new ui(Fg,Eg,Ag),Dg.applyMatrix4(Cg.matrixWorld),Cg=vi.Mz(sg.ray,Dg));!Cg||0>vi.Zh(Cg,tg)||0>vi.Zh(Cg,ug)||(Cg=Cg.distanceTo(sg.ray.origin),Cg<rg&&(og=Bg,rg=Cg))}else 0>vi.Zh(Bg.point,tg)||0>vi.Zh(Bg.point,ug)||(Cg=Cg.material,Cg.defines&&Cg.defines.RADIUS_CLIP||!(Ag<rg)||
(og=Bg,rg=Ag))}if(og){sg=og.object;wg=sg.geometry;if(wg instanceof THREE.Geometry)return wg.vertices[og.face.a].la;if(wg instanceof THREE.BufferGeometry)return(null==sg.Ma?sg.parent.fa:sg.Ma.fa)[wg.attributes.atomIndex.array[null!=og.index?og.index:og.face.a]];console.warn("Unknown type of geometry for raycasting real object")}}return null};
vi.sr=function(og,pg){var qg,rg=vi.yn(og,og,!0),sg=og.wb(!0).clone();qg=sg.gr();if(null==qg)return 45;qg=qg.length();rg=sg.applyMatrix4(rg).getCenter();rg=Math.abs(pg.position.z-rg.z)+.5*qg;qg=Math.min(Math.max(Math.mn(2*Math.atan(qg/(2*rg))),Math.mn(2*Math.atan(Math.tan(2*Math.atan(qg/(2*rg))/2)/pg.aspect))),45);isNaN(qg)&&(qg=Math.mn(2*Math.atan(Math.tan(Math.Kz()/2)*pg.aspect)));return qg};
vi.xr=function(og,pg){var qg=new THREE.SpriteMaterial({map:og});qg.depthTest=!1;qg.depthWrite=!1;var rg=qg.map.image.width,sg=qg.map.image.height,tg=new THREE.Sprite(qg);tg.position.set(pg.x,pg.y,pg.z);tg.scale.set(rg/40,sg/40,1);qg.needsUpdate=!1;return tg};function wi(){THREE.Object3D.call(this);this.matrixAutoUpdate=!1;this.matrixWorldNeedsUpdate=!0;this.cb=this;this.bd=new ii;this.ga=Ph.ba();this.outline=!1;this.od=new Set;this.sf=new Vg;this.labels=new THREE.Object3D;this.add(this.labels)}
wi.prototype=Object.create(THREE.Object3D.prototype);wi.prototype.constructor=wi;function yi(){this.map=[]}yi.prototype.get=function(og){return this.map[og.constructor]||this.map[og.prototype.constructor]};yi.prototype.add=function(og,pg){this.map[og.prototype.constructor]=pg};var Gi=new yi;xg=wi.prototype;xg["delete"]=function(){for(var og=this.bd.keys(),pg=0,qg=og.length;pg<qg;pg++)og[pg]["delete"]()};xg.tj=function(){for(var og=[],pg=Gi.get(this),qg=0;qg<pg.length;qg++)og.push(pg[qg]);return og};
xg.show=function(og){var pg=this;if(void 0!==og){if(og=this.hb(og),null!=og)return og.show().then(function(og){pg.vd();return og})}else this.jb=this.visible=!0,this.vd();return Promise.resolve(this)};xg.hide=function(og){void 0!==og?(og=this.hb(og),null!=og&&(og.hide(),null!=og.da&&this.vd())):(this.visible=!1,this.jb=!0,this.vd())};xg.vd=function(){(this.Ea?this.Ea().vf:this.vf).tb().bB(this)};
xg.yb=function(og,pg,qg){this.outline=og;if(pg instanceof Array){var rg=!0,sg=!1,tg=void 0;try{for(var ug=pg[Symbol.iterator](),yg;!(rg=(yg=ug.next()).done);rg=!0){var Bg=yg.value;og?this.od.add(Bg):this.od["delete"](Bg)}}catch(Cg){sg=!0,tg=Cg}finally{try{!rg&&ug["return"]&&ug["return"]()}finally{if(sg)throw tg;}}}else if(this.od=new Set,og){og=!0;ug=!1;yg=void 0;try{for(rg=this.fa[Symbol.iterator]();!(og=(sg=rg.next()).done);og=!0)this.od.add(sg.value)}catch(Cg){ug=!0,yg=Cg}finally{try{!og&&rg["return"]&&
rg["return"]()}finally{if(ug)throw yg;}}}og=this.bd.keys();ug=null;yg=!1;void 0!=qg&&(ug=this.hb(qg));for(qg=0;qg<og.length;qg++)(null==ug||og[qg]===ug)&&og[qg].yb(pg)&&(yg=!0);this.outline=yg;this.vd()};xg.Ny=function(){return this.od.size===this.fa.length};xg.hb=function(og){if(null!==og){var pg=this.bd.fl(og);void 0===pg&&-1!==Gi.get(this).indexOf(og)&&(pg=hi.jz(og,this),void 0!==pg&&(pg.Jj=void 0),this.bd.set(pg,og));return pg}};
xg.pl=function(og){var pg=this.bd.fl(og);return void 0===pg||-1===Gi.get(this).indexOf(og)?!1:pg.visible};xg.Sy=function(){return void 0!==this.bd.fl(ih.ck)};xg.vc=function(){var og=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0,pg=[],qg=this.bd.keys(),rg;for(rg in qg){var sg=qg[rg];!sg.visible&&og||pg.push(sg)}return pg};
xg.Fj=function(){if(this.visible){var og=!0,pg=!1,qg=void 0;try{for(var rg=this.bd.keys()[Symbol.iterator](),sg;!(og=(sg=rg.next()).done);og=!0)if(sg.value.visible)return!0}catch(tg){pg=!0,qg=tg}finally{try{!og&&rg["return"]&&rg["return"]()}finally{if(pg)throw qg;}}}return!1};xg.Cn=function(){var og=[],pg=this.bd.keys(),qg;for(qg in pg)og.push(pg[qg]);return og};
xg.vn=function(){var og=[];if(!this.visible)return og;var pg,qg=this.children.length;if(0!==qg)for(var rg=0;rg<qg;rg++)pg=this.children[rg],pg.visible&&(pg instanceof THREE.Mesh||pg instanceof THREE.Line||pg instanceof THREE.Points?(void 0!==pg.la||pg.geometry.attributes)&&og.push(pg):null!=pg&&pg instanceof wi&&(og=og.concat(pg.vn())));else if(this instanceof THREE.Mesh||this instanceof THREE.Line||this instanceof THREE.Points)if(void 0!==this.la||this.geometry.attributes)return[this];return og};
xg.gc=function(){console.warn("Label not enabled for this type of object")};xg.du=function(og,pg,qg){og=this.ga.ll(og,qg);pg=vi.xr(og,pg);this.labels.add(pg);this.jb=!0;return pg};xg.Ub=function(og,pg,qg,rg,sg){void 0==this.sf.get(og)&&(pg=rg.du(pg,qg,sg),this.sf.set(og,pg))};
xg.Od=function(og){var pg,qg;if(void 0===og){og=this.sf.keys();for(qg=0;qg<og.length;qg++)pg=this.sf.get(og[qg]),pg.parent.remove(pg);this.sf.clear()}else if(Array.isArray(og))for(qg=0;qg<og.length;qg++)pg=this.sf.get(og[qg]),null!=pg&&(this.sf.remove(og[qg]),pg.parent.remove(pg));else pg=this.sf.remove(og),null!=pg&&pg.parent.remove(pg);this.jb=!0};xg.bs=function(og){return void 0!=this.sf.get(og)};xg.Hd=function(){return!1};
xg.Ik=function(og){og.visible=this.visible;og.outline=this.outline;og.od=this.od;var pg=!1,qg=!0,rg=!1,sg=void 0;try{for(var tg=this.vc(!1)[Symbol.iterator](),ug;!(qg=(ug=tg.next()).done);qg=!0){var yg=ug.value.da;if(null!=yg&&null!=yg.geometry){var Bg=!0,Cg=!1,Ag=void 0;try{for(var wg=og.children[Symbol.iterator](),Dg;!(Bg=(Dg=wg.next()).done);Bg=!0){var Eg=Dg.value;void 0!=Eg.geometry&&yg.geometry.uuid===Eg.geometry.uuid&&(pg=!0,Eg.visible=yg.visible)}}catch(Jg){Cg=!0,Ag=Jg}finally{try{!Bg&&wg["return"]&&
wg["return"]()}finally{if(Cg)throw Ag;}}if(!pg){var Fg=yg.clone();og.add(Fg)}pg=!1}}}catch(Jg){rg=!0,sg=Jg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}};xg.clone=function(og,pg){var qg=new this.constructor(og,pg);qg.visible=this.visible;qg.outline=this.outline;qg.od=this.od;return qg};
function Hi(og,pg){THREE.Points.call(this,og,pg);this.$c=pg.$c?pg.$c:[];if(Array.isArray(pg)){var qg=!0,rg=!1,sg=void 0;try{for(var tg=pg[Symbol.iterator](),ug;!(qg=(ug=tg.next()).done);qg=!0){var yg=ug.value;if(null!=yg.$c){var Bg;(Bg=this.$c).push.apply(Bg,Wh(yg.$c))}}}catch(Cg){rg=!0,sg=Cg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}}this.ki=[];this.onBeforeRender=function(og,pg,qg,rg,sg,tg){var ug=!0,wg=!1,yg=void 0;try{for(var Bg=this.$c[Symbol.iterator](),Ag;!(ug=
(Ag=Bg.next()).done);ug=!0)Ag.value.call(this,og,pg,qg,rg,sg,tg)}catch(Og){wg=!0,yg=Og}finally{try{!ug&&Bg["return"]&&Bg["return"]()}finally{if(wg)throw yg;}}}}Hi.prototype=Object.create(THREE.Points.prototype);Hi.prototype.constructor=Hi;Hi.prototype.Rq=function(){console.warn("Sphere clipping not allowed for Points representations")};Hi.prototype.Pq=function(){console.warn("Sphere clipping not allowed for Points representations")};
Hi.prototype.bq=function(og,pg,qg,rg,sg){if(null!=sg.uniforms.vClipCenter){og=qg.matrixWorldInverse;og=(new THREE.Matrix4).multiplyMatrices(og,this.matrixWorld);pg=[];qg=!0;rg=!1;var tg=void 0;try{for(var ug=this.ki[Symbol.iterator](),yg;!(qg=(yg=ug.next()).done);qg=!0)pg.push(yg.value.pos.clone().applyMatrix4(og))}catch(Bg){rg=!0,tg=Bg}finally{try{!qg&&ug["return"]&&ug["return"]()}finally{if(rg)throw tg;}}sg.uniforms.vClipCenter.value=pg}};
function Ii(og,pg){hi.call(this,og);this.Wo=null==pg?!0:pg}Ii.prototype=Object.create(hi.prototype);Ii.prototype.constructor=Ii;ih.rk=new hh("Spheres","SPHERES","SPHERES",Ii);ih.dm=new hh("Balls","BALLS","BALLS",Ii,!1);
Ii.prototype.Dc=function(){var og=this.fa.length,pg,qg=this.ga.Vh;if(qg)pg=og;else{var rg=this.Wo?this.ga.ey():this.ga.br(),sg=(new THREE.BufferGeometry).fromGeometry(rg),tg=sg.attributes.position.array.length/sg.attributes.position.itemSize;pg=og*tg}var rg=new THREE.BufferGeometry,ug=new Float32Array(3*pg),yg=new Float32Array(3*pg),Bg=new Float32Array(pg);if(qg)var Cg=new Float32Array(pg);else var Ag=new Float32Array(3*pg),wg=new Float32Array(2*pg);for(pg=0;pg<og;pg++){var Dg=this.fa[pg],Eg=this.ga.Bn(Dg);
if(qg)ug[3*pg]=Dg.pos.x,ug[3*pg+1]=Dg.pos.y,ug[3*pg+2]=Dg.pos.z,Cg[pg]=this.Wo?Eg:this.ga.va.ma.radius,Bg[pg]=pg;else{var Fg=new THREE.Matrix4;Fg.setPosition(Dg.pos);this.Wo&&(Dg=new THREE.Matrix4,Dg.makeScale(Eg,Eg,Eg),Fg.multiply(Dg));var Jg=sg.clone();Jg.applyMatrix(Fg);for(var Fg=Jg.attributes.position.array,Eg=Jg.attributes.normal.array,Dg=Jg.attributes.color.array,Jg=Jg.attributes.uv.array,Ig=Fg.length/3,Lg=0;Lg<Ig;Lg++){for(var Kg=0;3>Kg;Kg++)ug[pg*Fg.length+3*Lg+Kg]=Fg[3*Lg+Kg],Ag[pg*Eg.length+
3*Lg+Kg]=Eg[3*Lg+Kg],yg[pg*Dg.length+3*Lg+Kg]=Dg[3*Lg+Kg];for(Kg=0;2>Kg;Kg++)wg[pg*Jg.length+2*Lg+Kg]=Jg[2*Lg+Kg];Bg[pg*tg+Lg]=pg}}}rg.addAttribute("position",new THREE.BufferAttribute(ug,3));Dg=new THREE.BufferAttribute(yg,3);Dg.dynamic=!0;rg.addAttribute("color",Dg);rg.addAttribute("atomIndex",new THREE.BufferAttribute(Bg,1));qg?rg.addAttribute("radius",new THREE.BufferAttribute(Cg,1)):rg.addAttribute("normal",new THREE.BufferAttribute(Ag,3));rg.oe();qg&&rg.Qk();og=qg?this.ga.jl():this.ga.Ye();
qg=qg?new Hi(rg,og):new THREE.Mesh(rg,og);qg.Ma=this;this.parent.add(qg);this.da=qg;this.cd()};Ii.prototype.update=function(og){hi.prototype.update.call(this,og);og.Mj&&(this.sd=[],this.parent.remove(this.da),og=this.da.visible,this.da=null,this.Yc(),this.da.visible=og)};function Ji(og){hi.call(this,og)}Ji.prototype=Object.create(hi.prototype);Ji.prototype.constructor=Ji;ih.ck=new hh("Balls & sticks","BSTICKS","BALL_AND_STICKS",Ji);Ji.prototype.Dc=function(){this.ga.Vh?this.Qw():this.Tw();this.cd()};
Ji.prototype.update=function(og){hi.prototype.update.call(this,og);og.Mj&&(this.sd=[],og=this.cb.hb(ih.xg),og.parent.remove(og.da),og.da=null,og=this.da.visible,this.parent.remove(this.da),this.da=null,this.Yc(),this.da.visible=og)};
Ji.prototype.Tw=function(){var og=this.ga.br(),pg=this.ga.Ye(),qg=(new THREE.BufferGeometry).fromGeometry(og),rg=this.fa.length,sg=qg.attributes.position.array.length/qg.attributes.position.itemSize,tg=rg*sg,ug=this.cb.hb(ih.xg);null===ug.da&&(ug.Yc(),ug.hide());for(var og=new THREE.BufferGeometry,ug=ug.da.geometry,yg=Array(3*tg),Bg=Array(3*tg),Cg=Array(3*tg),Ag=Array(2*tg),tg=Array(tg),wg=0;wg<rg;wg++){var Dg=this.fa[wg],Eg=new THREE.Matrix4;Eg.setPosition(Dg.pos);Dg=qg.clone();Dg.applyMatrix(Eg);
for(var Fg=Dg.attributes.position.array,Eg=0;Eg<Fg.length;Eg++)yg[wg*Fg.length+Eg]=Fg[Eg];Fg=Dg.attributes.normal.array;for(Eg=0;Eg<Fg.length;Eg++)Bg[wg*Fg.length+Eg]=Fg[Eg];Fg=Dg.attributes.color.array;for(Eg=0;Eg<Fg.length;Eg++)Cg[wg*Fg.length+Eg]=Fg[Eg];Dg=Dg.attributes.uv.array;for(Eg=0;Eg<Dg.length;Eg++)Ag[wg*Dg.length+Eg]=Dg[Eg];for(Eg=0;Eg<sg;Eg++)tg[wg*sg+Eg]=wg}qg=new Float32Array(yg);rg=new Float32Array(Bg);Cg=new Float32Array(Cg);Ag=new Float32Array(Ag);tg=new Float32Array(tg);sg=new Float32Array(qg.length+
ug.attributes.position.array.length);sg.set(ug.attributes.position.array);sg.set(qg,ug.attributes.position.array.length);qg=new Float32Array(rg.length+ug.attributes.normal.array.length);qg.set(ug.attributes.normal.array);qg.set(rg,ug.attributes.normal.array.length);rg=new Float32Array(Cg.length+ug.attributes.color.array.length);rg.set(ug.attributes.color.array);rg.set(Cg,ug.attributes.color.array.length);Cg=new Float32Array(Ag.length+ug.attributes.uv.array.length);Cg.set(ug.attributes.uv.array);Cg.set(Ag,
ug.attributes.uv.array.length);Ag=new Float32Array(tg.length+ug.attributes.atomIndex.array.length);Ag.set(ug.attributes.atomIndex.array);Ag.set(tg,ug.attributes.atomIndex.array.length);og.addAttribute("position",new THREE.BufferAttribute(sg,3));og.addAttribute("normal",new THREE.BufferAttribute(qg,3));Fg=new THREE.BufferAttribute(rg,3);Fg.dynamic=!0;og.addAttribute("color",Fg);og.addAttribute("uv",new THREE.BufferAttribute(Cg,2));og.addAttribute("atomIndex",new THREE.BufferAttribute(Ag,1));og.oe();
this.ga.Vh&&og.Qk();pg=new THREE.Mesh(og,pg);pg.Ma=this;this.parent.add(pg);this.da=pg};Ji.prototype.Qw=function(){var og=this.cb.hb(ih.xg);null===og.da&&(og.Yc(),og.hide());var pg=og.da.geometry.clone(),qg=pg.attributes.radius.array;qg.fill(this.ga.va.ma.radius,0,og.qj);var rg=this.ga.jl(),sg=this.ga.zn(),rg=[rg,sg];pg.addGroup(0,og.qj,0);pg.addGroup(og.qj,qg.length,1);og=new Hi(pg,rg);og.Ma=this;this.parent.add(og);this.da=og};
THREE.BufferGeometry.prototype.Qk=function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var og=new THREE.Vector3,pg=this.attributes.position;if(pg){for(var pg=pg.array,qg=this.attributes.radius.array,rg=this.boundingSphere.center,sg=0,tg=0,ug=pg.length;tg<ug;tg+=3)og.fromArray(pg,tg),sg=Math.max(sg,rg.distanceTo(og)+qg[tg/3]);this.boundingSphere.radius=sg;isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',
this)}};function Ki(og){hi.call(this,og)}Ki.prototype=Object.create(hi.prototype);Ki.prototype.constructor=Ki;ih.xg=new hh("Sticks","STICKS","STICKS",Ki);Ki.prototype.Dc=function(){this.ga.Vh?this.Sw():this.Vw();this.cd()};
Ki.prototype.Vw=function(){var og=this.cb.la.hd(),pg=this.ga.zx(),pg=(new THREE.BufferGeometry).fromGeometry(pg),qg=this.ga.Hx(),rg=(new THREE.BufferGeometry).fromGeometry(qg),sg=rg.attributes.position.array.length/rg.attributes.position.itemSize,tg=pg.attributes.position.array.length/pg.attributes.position.itemSize,qg=new THREE.BufferGeometry,ug=[],yg=[],Bg=[],Cg=[],Ag=[],wg=new THREE.Matrix4;wg.makeRotationX(.5*Math.PI);for(var Dg=this.fa.length,Eg=0;Eg<Dg;Eg++){var Fg=this.fa[Eg],Jg=og.findNode(Fg);
if("HOH"!==this.fa[Eg].gb){var Ig=new THREE.Matrix4;Ig.setPosition(Fg.pos);var Lg=rg.clone();Lg.applyMatrix(Ig);for(var Kg=Lg.attributes.position.array,Mg=0;Mg<Kg.length;Mg++)ug.push(Kg[Mg]);Kg=Lg.attributes.normal.array;for(Mg=0;Mg<Kg.length;Mg++)yg.push(Kg[Mg]);Kg=Lg.attributes.color.array;for(Mg=0;Mg<Kg.length;Mg++)Bg.push(Kg[Mg]);Kg=Lg.attributes.uv.array;for(Mg=0;Mg<Kg.length;Mg++)Cg.push(Kg[Mg]);for(Mg=0;Mg<sg;Mg++)Ag.push(Eg)}if(Lg=Jg.me())for(var Ig=Lg.length,Og=0;Og<Ig;Og++)if(Mg=Lg[Og].ne(Jg).De,
this.fa.includes(Mg)){var Kg=Fg.pos,Sg=Mg.pos,Mg=Kg.clone(),Qg=new THREE.Vector3((Kg.x+Sg.x)/2,(Kg.y+Sg.y)/2,(Kg.z+Sg.z)/2),Sg=Mg.distanceTo(Qg),vh=Qg.clone().add(Mg).divideScalar(2),Kg=new THREE.Matrix4;Kg.lookAt(Mg,Qg,new THREE.Vector3(0,1,0));Kg.multiply(wg);Kg.setPosition(vh);Mg=new THREE.Matrix4;Mg.makeScale(1,Sg,1);Kg.multiply(Mg);Sg=pg.clone();Sg.applyMatrix(Kg);Kg=Sg.attributes.position.array;for(Mg=0;Mg<Kg.length;Mg++)ug.push(Kg[Mg]);Kg=Sg.attributes.normal.array;for(Mg=0;Mg<Kg.length;Mg++)yg.push(Kg[Mg]);
Kg=Sg.attributes.color.array;for(Mg=0;Mg<Kg.length;Mg++)Bg.push(Kg[Mg]);Kg=Sg.attributes.uv.array;for(Mg=0;Mg<Kg.length;Mg++)Cg.push(Kg[Mg]);for(Mg=0;Mg<tg;Mg++)Ag.push(Eg)}}qg.addAttribute("position",new THREE.Float32BufferAttribute(ug,3));qg.addAttribute("normal",new THREE.Float32BufferAttribute(yg,3));Kg=new THREE.Float32BufferAttribute(Bg,3);Kg.dynamic=!0;qg.addAttribute("color",Kg);qg.addAttribute("uv",new THREE.Float32BufferAttribute(Cg,2));qg.addAttribute("atomIndex",new THREE.Float32BufferAttribute(Ag,
1));qg.oe();og=this.ga.Ye();og=new THREE.Mesh(qg,og);og.Ma=this;this.parent.add(og);this.da=og};
Ki.prototype.Sw=function(){for(var og=this.cb.la.hd(),pg=new THREE.BufferGeometry,qg=[],rg=[],sg=[],tg=[],ug=this.fa.length,yg=0;yg<ug;yg++){var Bg=this.fa[yg],Cg;og.findNode(Bg);"HOH"!==this.fa[yg].gb&&(qg.push(Bg.pos.x),qg.push(Bg.pos.y),qg.push(Bg.pos.z),rg.push(this.ga.Da.ma.radiusBottom),sg.push(0),sg.push(0),sg.push(0),tg.push(yg))}this.qj=tg.length;for(yg=0;yg<ug;yg++){Bg=this.fa[yg];Cg=og.findNode(Bg);var Ag=Cg.me();if(Ag)for(var wg=Ag.length,Dg=0;Dg<wg;Dg++){var Eg=Ag[Dg].ne(Cg).De;if(this.fa.includes(Eg)){var Fg=
Bg.pos,Eg=Eg.pos,Eg=(new THREE.Vector3).subVectors(Eg,Fg);Eg.divideScalar(2);qg.push(Fg.x);qg.push(Fg.y);qg.push(Fg.z);sg.push(Eg.x);sg.push(Eg.y);sg.push(Eg.z);rg.push(this.ga.Da.ma.radiusTop);tg.push(yg)}}}pg.addAttribute("position",new THREE.Float32BufferAttribute(qg,3));og=new THREE.Float32BufferAttribute(new Float32Array(3*rg.length),3);og.dynamic=!0;pg.addAttribute("color",og);pg.addAttribute("radius",new THREE.Float32BufferAttribute(rg,1));pg.addAttribute("dir",new THREE.Float32BufferAttribute(sg,
3));pg.addAttribute("atomIndex",new THREE.Float32BufferAttribute(tg,1));pg.oe();pg.Qk();rg=this.ga.jl();sg=this.ga.zn();rg=[rg,sg];pg.addGroup(0,this.qj,0);pg.addGroup(this.qj,tg.length,1);pg=new Hi(pg,rg);pg.Ma=this;this.parent.add(pg);this.da=pg};Ki.prototype.update=function(og){hi.prototype.update.call(this,og);og.Mj&&!this.cb.Sy()&&(og=this.da.visible,this.sd=[],this.parent.remove(this.da),this.da=null,this.Yc(),this.da.visible=og)};function Li(og){hi.call(this,og);this.hd=this.cb.la.hd()}
Li.prototype=Object.create(hi.prototype);Li.prototype.constructor=Li;ih.LINES=new hh("Lines","LINES","LINES",Li);
Li.prototype.Dc=function(){for(var og=new THREE.BufferGeometry,pg=[],qg=[],rg=[],sg=this.fa.length,tg=0;tg<sg;tg++){var ug=this.fa[tg],yg=this.hd.findNode(ug);if(yg){var Bg=yg.me();if(Bg)for(var Cg=Bg.length,Ag=0;Ag<Cg;Ag++){var wg=Bg[Ag].ne(yg).De;if(this.fa.includes(wg)){var Dg=ug.pos,wg=wg.pos,wg=new THREE.Vector3((Dg.x+wg.x)/2,(Dg.y+wg.y)/2,(Dg.z+wg.z)/2);pg.push(Dg.x);pg.push(Dg.y);pg.push(Dg.z);pg.push(wg.x);pg.push(wg.y);pg.push(wg.z);for(Dg=0;6>Dg;Dg++)qg.push(1);rg.push(tg);rg.push(tg)}}}}og.addAttribute("position",
new THREE.Float32BufferAttribute(pg,3));pg=new THREE.Float32BufferAttribute(qg,3);pg.dynamic=!0;og.addAttribute("color",pg);og.addAttribute("atomIndex",new THREE.Float32BufferAttribute(rg,1));og.oe();rg=new THREE.LineBasicMaterial({linewidth:this.ga.lineWidth,vertexColors:THREE.VertexColors});og=new THREE.LineSegments(og,rg);og.Ma=this;this.da=og;this.parent.add(og);this.cd()};
Li.prototype.update=function(og){hi.prototype.update.call(this,og);og.lineWidth&&(this.parent.remove(this.da),this.da=null,this.Yc())};function Mi(og){hi.call(this,og)}Mi.prototype=Object.create(hi.prototype);Mi.prototype.constructor=Mi;ih.vi=new hh("Atoms","ATOMS","ATOMS",Mi);
Mi.prototype.Dc=function(){for(var og=new THREE.BufferGeometry,pg=[],qg=[],rg=[],sg=this.fa.length,tg=0;tg<sg;tg++){var ug=this.fa[tg],yg=ug.pos.clone();yg.la=ug;yg.x-=.5;var Bg=ug.pos.clone();Bg.la=ug;Bg.x+=.5;var Cg=ug.pos.clone();Cg.la=ug;Cg.y-=.5;var Ag=ug.pos.clone();Ag.la=ug;Ag.y+=.5;var wg=ug.pos.clone();wg.la=ug;wg.z-=.5;var Dg=ug.pos.clone();Dg.la=ug;Dg.z+=.5;pg.push(yg.x,yg.y,yg.z,Bg.x,Bg.y,Bg.z,Cg.x,Cg.y,Cg.z,Ag.x,Ag.y,Ag.z,wg.x,wg.y,wg.z,Dg.x,Dg.y,Dg.z);for(ug=0;18>ug;ug++)qg.push(1);
for(ug=0;6>ug;ug++)rg.push(tg)}og.addAttribute("position",new THREE.Float32BufferAttribute(pg,3));pg=new THREE.Float32BufferAttribute(qg,3);pg.dynamic=!0;og.addAttribute("color",pg);og.addAttribute("atomIndex",new THREE.Float32BufferAttribute(rg,1));og.oe();rg=new THREE.LineBasicMaterial({linewidth:this.ga.Io,vertexColors:THREE.VertexColors});og=new THREE.LineSegments(og,rg);og.Ma=this;this.parent.add(og);this.da=og;this.cd()};
Mi.prototype.update=function(og){hi.prototype.update.call(this,og);og.Io&&(this.parent.remove(this.da),this.da=null,this.Yc())};function Ni(og){this.geometry=new THREE.BufferGeometry;this.Wi=[];this.Mi=og?[]:null;this.zm=[];this.Rm=[];this.vm=[];this.xh=null}xg=Ni.prototype;xg.Qh=function(){return this.Wi.length/3};xg.Lg=function(og,pg,qg,rg){this.Wi.push(og,pg,qg);og=null!=rg?rg:new THREE.Color(1,1,1);this.zm.push(og.r,og.g,og.b);og=new THREE.Vector2(0,1);this.Rm.push(og.x,og.y)};
xg.ed=function(og,pg,qg){null!=this.Mi?this.Mi.push(og,pg,qg):console.warn("This BufferGeometry is not indexed")};xg.Ig=function(og){this.vm.push(og)};xg.oe=function(){this.xh=Array(this.Wi.length/3);this.xh.fill(0);return this.xh};THREE.BufferGeometry.prototype.oe=function(){var og=Array(this.attributes.position.count);og.fill(0);og=new Float32Array(og);this.addAttribute("highlight",new THREE.BufferAttribute(og,1))};
Ni.prototype.Og=function(){null==this.xh&&this.oe();this.geometry.addAttribute("position",new THREE.Float32BufferAttribute(this.Wi,3));this.Wi=void 0;null!=this.Mi&&(this.geometry.setIndex(new THREE.Uint32BufferAttribute(this.Mi,1)),this.Mi=void 0);var og=new THREE.Float32BufferAttribute(this.zm,3);og.dynamic=!0;this.geometry.addAttribute("color",og);this.zm=void 0;this.geometry.addAttribute("highlight",new THREE.Float32BufferAttribute(this.xh,1));this.xh=void 0;this.geometry.addAttribute("uv",new THREE.Float32BufferAttribute(this.Rm,
2));this.Rm=void 0;this.geometry.addAttribute("atomIndex",new THREE.Float32BufferAttribute(this.vm,1));this.vm=void 0;this.geometry.computeVertexNormals();this.geometry.normalizeNormals();return this.geometry};function rj(og){hi.call(this,og)}rj.prototype=Object.create(hi.prototype);rj.prototype.constructor=rj;ih.zt=new hh("Cylinder","CYLINDER","CYLINDER",rj);rj.im=.075;rj.hm=1.2;rj.gm=.25;rj.nm=1.3;rj.mm=.5;rj.tg=.175;rj.sg=.175;rj.lm=34;rj.np=12;rj.wf=20;rj.qp=2.5;xg=rj.prototype;
xg.Dc=function(){var og=this.ga.Hc(this.cb.pa.id,"M"),pg,qg=[],rg=[],sg=[],tg=[],ug=[],yg=[],Bg=[],Cg=[];this.Xa.Xf()?(pg=sj.Wx(this.Xa,og),qg=pg[0],rg=pg[1],sg=pg[2],tg=pg[3],ug=pg[4],yg=pg[5],pg=pg[6]):this.Xa.Xh()&&console.warn("Cylinder representation not available for nucleic molecules");var Ag=new Ni(!0);if(null!==qg){var wg=new sj,Dg;for(Dg in rg){var Eg=null,Fg=null;2<rg[Dg].length&&(Fg=this.zw(Ag,rg[Dg],og),Eg=Fg[0],Fg=Fg[1]);Bg.push(Eg);Cg.push(Fg)}for(Dg=0;Dg<sg.length;Dg++)if(Fg=sg[Dg],
Eg=tg[Dg],null!=Bg[Eg]){var Jg=qg[Fg],Fg=rg[Eg],Ig=Fg[0],Lg=new tj(Ig),Kg=this.fa.indexOf(Ig);Lg.uc=og;Lg.la=Ig;Lg.rb=Kg;Lg.width=rj.tg;Lg.height=rj.sg;Lg.pos=Bg[Eg];Jg.push(Lg.clone());Jg.push(Lg.clone());Jg.push(Lg.clone())}for(Dg=0;Dg<ug.length;Dg++)Eg=yg[Dg],Fg=ug[Dg],null!=Bg[Eg]&&(Jg=qg[Fg],Fg=rg[Eg],Ig=Fg[Fg.length-1],Lg=new tj(Ig),Kg=this.fa.indexOf(Ig),Lg.uc=og,Lg.la=Ig,Lg.rb=Kg,Lg.width=rj.tg,Lg.height=rj.sg,Lg.pos=Cg[Eg],Jg.splice(0,0,Lg.clone()),Jg.splice(0,0,Lg.clone()),Jg.splice(0,0,
Lg.clone()));for(Dg=0;Dg<pg.length;Dg++)sg=pg[Dg]-1,Eg=pg[Dg],null!=Bg[Eg]&&null!=Cg[sg]&&(ug=rg[sg],Fg=rg[Eg],tg=[],Ig=ug[ug.length-1],Lg=new tj(Ig),Kg=this.fa.indexOf(Ig),Lg.uc=og,Lg.la=Ig,Lg.rb=Kg,Lg.width=rj.tg,Lg.height=rj.sg,Lg.pos=Cg[sg],tg.push(Lg.clone()),tg.push(Lg.clone()),tg.push(Lg.clone()),Ig=Fg[0],Lg=new tj(Ig),Kg=this.fa.indexOf(Ig),Lg.uc=og,Lg.la=Ig,Lg.rb=Kg,Lg.width=rj.tg,Lg.height=rj.sg,Lg.pos=Bg[Eg],tg.push(Lg.clone()),tg.push(Lg.clone()),tg.push(Lg.clone()),qg.push(tg));for(Dg in qg)2<
qg[Dg].length&&wg.Eq(Ag,qg[Dg],og);og=Ag.Og();qg=this.ga.Ye();qg.vertexColors=THREE.FaceColors;og=new THREE.Mesh(og,qg);og.la=this.Xa;og.Ma=this;this.parent.add(og);this.da=og;this.color(hi.za.oc)}};xg.Mp=function(og,pg,qg,rg,sg,tg){for(var ug=0;ug<rj.wf;ug++){var yg=ug*Math.PI*2/rj.wf,Bg=rj.qp*Math.sin(yg),yg=rj.qp*Math.cos(yg),Bg=pg.clone().multiplyScalar(Bg).add(qg.clone().multiplyScalar(yg)),Bg=rg.clone().add(Bg);Bg.la=sg;Bg.rb=this.fa.indexOf(sg);og.Lg(Bg.x,Bg.y,Bg.z,tg);og.Ig(Bg.rb)}};
xg.zw=function(og,pg,qg){console.assert(2<pg.length,"Helix number must be > 2");var rg=this.ru(pg),sg=rg[0],tg=rg[1],ug=rg[2],rg=rg[3],yg=sg[0],Bg=sg[sg.length-1],Cg=Bg.clone().sub(yg).normalize(),Ag=Cg.clone().Dn(),Cg=Cg.clone().cross(Ag).normalize(),wg=og.Qh(),Dg,Eg;Eg=yg.clone();Eg.la=pg[0];var Fg=this.fa.indexOf(pg[0]);Eg.rb=Fg;og.Lg(Eg.x,Eg.y,Eg.z,qg);og.Ig(Eg.rb);var wg=og.Qh(),Jg=wg-1;this.Mp(og,Ag,Cg,yg,pg[0],qg);Eg=wg;wg=og.Qh();for(Fg=0;Fg<rj.wf;Fg++){var Ig=(Fg+1)%rj.wf;og.ed(Jg,Eg+Fg,
Eg+Ig)}for(Jg=1;Jg<pg.length;Jg++)for(Fg=pg[Jg],Bg=sg[Jg],this.Mp(og,Ag,Cg,Bg,Fg,qg),Dg=Eg,Eg=wg,wg=og.Qh(),Fg=0;Fg<rj.wf;Fg++)Ig=(Fg+1)%rj.wf,og.ed(Dg+Fg,Eg+Fg,Eg+Ig),og.ed(Dg+Fg,Eg+Ig,Dg+Ig);sg=Bg.clone();sg.la=pg[pg.length-1];Fg=this.fa.indexOf(pg[pg.length-1]);sg.rb=Fg;og.Lg(sg.x,sg.y,sg.z,qg);og.Ig(sg.rb);wg=og.Qh();for(Fg=0;Fg<rj.wf;Fg++)Ig=(Fg+1)%rj.wf,og.ed(wg-1,Eg+Ig,Eg+Fg);yg.add((new THREE.Vector3(tg,ug,rg)).multiplyScalar(.3));Bg.add((new THREE.Vector3(-tg,-ug,-rg)).multiplyScalar(.3));
return[yg,Bg]};
xg.ru=function(og){for(var pg=0,qg=0,rg=0,sg=0,tg=0,ug=0,yg=0,Bg=0,Cg=0,Ag=og.length,wg,Dg=0;Dg<Ag;Dg++)wg=og[Dg],pg+=wg.pos.x,qg+=wg.pos.y,rg+=wg.pos.z,sg+=wg.pos.x*wg.pos.x,tg+=wg.pos.y*wg.pos.y,ug+=wg.pos.z*wg.pos.z,yg+=wg.pos.x*wg.pos.y,Bg+=wg.pos.y*wg.pos.z,Cg+=wg.pos.z*wg.pos.x;wg=Ag*sg-pg*pg;Dg=(Ag*yg-pg*qg)/wg;wg=(-pg*yg+sg*qg)/wg;for(var yg=Ag*tg-qg*qg,sg=(Ag*Bg-qg*rg)/yg,qg=(-qg*Bg+tg*rg)/yg,Bg=Ag*ug-rg*rg,tg=(Ag*Cg-rg*pg)/Bg,ug=(-rg*Cg+ug*pg)/Bg,Cg=1-Dg*sg*tg,pg=(sg*tg*wg+tg*qg+ug)/Cg,
rg=(wg+Dg*tg*qg+Dg*ug)/Cg,qg=(sg*wg+qg+Dg*sg*ug)/Cg,Eg=0,Fg=0,Jg=Number.POSITIVE_INFINITY,Ig=0;180>=Ig;Ig+=10)for(var tg=Math.PI*Ig/180,Lg=0;360>Lg;Lg+=10){for(var Bg=Math.PI*Lg/180,ug=Math.cos(Bg)*Math.sin(tg),Cg=Math.sin(Bg)*Math.sin(tg),sg=Math.cos(tg),Kg=0,Dg=0;Dg<Ag;Dg++){wg=og[Dg];var Mg=(ug*(wg.pos.x-pg)+Cg*(wg.pos.y-rg)+sg*(wg.pos.z-qg))/(ug*ug+Cg*Cg+sg*sg),yg=ug*Mg+pg,Og=Cg*Mg+rg,Mg=sg*Mg+qg,Kg=Kg+((wg.pos.x-yg)*(wg.pos.x-yg)+(wg.pos.y-Og)*(wg.pos.y-Og)+(wg.pos.z-Mg)*(wg.pos.z-Mg))}Kg<Jg&&
(Jg=Kg,Eg=tg,Fg=Bg)}for(var Ig=Eg,Lg=Fg,Sg=-10;10>=Sg;Sg++)for(var tg=Ig+Math.PI*Sg/180,Qg=-10;10>=Qg;Qg++){Bg=Lg+Math.PI*Qg/180;ug=Math.cos(Bg)*Math.sin(tg);Cg=Math.sin(Bg)*Math.sin(tg);sg=Math.cos(tg);for(Dg=Kg=0;Dg<Ag;Dg++)wg=og[Dg],Mg=(ug*(wg.pos.x-pg)+Cg*(wg.pos.y-rg)+sg*(wg.pos.z-qg))/(ug*ug+Cg*Cg+sg*sg),yg=ug*Mg+pg,Og=Cg*Mg+rg,Mg=sg*Mg+qg,Kg+=(wg.pos.x-yg)*(wg.pos.x-yg)+(wg.pos.y-Og)*(wg.pos.y-Og)+(wg.pos.z-Mg)*(wg.pos.z-Mg);Kg<Jg&&(Jg=Kg,Eg=tg,Fg=Bg)}ug=Math.cos(Fg)*Math.sin(Eg);Cg=Math.sin(Fg)*
Math.sin(Eg);sg=Math.cos(Eg);Ag=[];Eg=[];for(tg=!1;!tg;){for(Dg=0;Dg<og.length;Dg++)wg=og[Dg],Mg=(ug*(wg.pos.x-pg)+Cg*(wg.pos.y-rg)+sg*(wg.pos.z-qg))/(ug*ug+Cg*Cg+sg*sg),Eg[Dg]=Mg,yg=ug*Mg+pg,Og=Cg*Mg+rg,Mg=sg*Mg+qg,Ag[Dg]=new THREE.Vector3(yg,Og,Mg);Eg[0]>Eg[Eg.length-1]?(ug=-ug,Cg=-Cg,sg=-sg):tg=!0}for(Dg=0;Dg<og.length;Dg++)for(wg=Dg+1;wg<og.length;wg++)Eg[Dg]>Eg[wg]&&(tg=Eg[Dg],Eg[Dg]=Eg[wg],Eg[wg]=tg,Bg=Ag[Dg],Ag[Dg]=Ag[wg],Ag[wg]=Bg);return[Ag,ug,Cg,sg]};xg.cd=function(){this.color(hi.za.oc)};
xg.update=function(og){hi.prototype.update.call(this,og)};Math.Kz=function(){return 22.5*Math.PI/180};Math.mn=function(og){return 180*og/Math.PI};THREE.Vector3.prototype.nc=function(){return this.x+":"+this.y+":"+this.z};
THREE.Matrix4.prototype.ks=function(og){var pg=new THREE.Vector3;pg.x=og.x*this.elements[0];pg.y=og.x*this.elements[1];pg.z=og.x*this.elements[2];pg.x+=og.y*this.elements[4];pg.y+=og.y*this.elements[5];pg.z+=og.y*this.elements[6];pg.x+=og.z*this.elements[8];pg.y+=og.z*this.elements[9];pg.z+=og.z*this.elements[10];return pg};
THREE.Matrix4.prototype.Oh=function(og,pg,qg,rg){var sg=Math.sqrt(pg*pg+qg*qg+rg*rg);0==sg&&(sg=.01);pg/=sg;qg/=sg;rg/=sg;sg=Math.sin(og);og=Math.cos(og);var tg=1-og;this.elements[0]=tg*pg*pg+og;this.elements[4]=tg*pg*qg-sg*rg;this.elements[8]=tg*pg*rg+sg*qg;this.elements[1]=tg*qg*pg+sg*rg;this.elements[5]=tg*qg*qg+og;this.elements[9]=tg*qg*rg-sg*pg;this.elements[2]=tg*rg*pg-sg*qg;this.elements[6]=tg*rg*qg+sg*pg;this.elements[10]=tg*rg*rg+og;this.elements[3]=0;this.elements[7]=0;this.elements[11]=
0;this.elements[12]=0;this.elements[13]=0;this.elements[14]=0;this.elements[15]=1};THREE.Matrix4.prototype.lerp=function(og,pg,qg){var rg=new THREE.Matrix4;rg.copy(og);rg.elements[12]=og.elements[12]+qg*(pg.elements[12]-og.elements[12]);rg.elements[13]=og.elements[13]+qg*(pg.elements[13]-og.elements[13]);rg.elements[14]=og.elements[14]+qg*(pg.elements[14]-og.elements[14]);this.copy(rg)};
THREE.Matrix4.prototype.slerp=function(og,pg,qg){var rg=og.Jr(),rg=og.normalize(rg);og=pg.Jr();og=pg.normalize(og);var sg=rg[0]*og[0]+rg[1]*og[1]+rg[2]*og[2]+rg[3]*og[3];0>sg&&(og[0]=-og[0],og[1]=-og[1],og[2]=-og[2],og[3]=-og[3],sg=-sg);pg=1-qg;var tg=qg;.1<1-sg&&(tg=Math.acos(sg),sg=1/Math.sin(tg),pg=Math.sin((1-qg)*tg)*sg,tg=Math.sin(qg*tg)*sg);qg=[];qg.push(pg*rg[0]+tg*og[0]);qg.push(pg*rg[1]+tg*og[1]);qg.push(pg*rg[2]+tg*og[2]);qg.push(pg*rg[3]+tg*og[3]);this.setFromQuaternion(qg)};
THREE.Matrix4.prototype.Jr=function(){var og=this.elements[0]+this.elements[5]+this.elements[10],pg,qg,rg;if(0<=og){var sg=Math.sqrt(og+1);rg=.5*sg;sg=.5/sg;og=(this.elements[9]-this.elements[6])*sg;pg=(this.elements[2]-this.elements[8])*sg;qg=(this.elements[4]-this.elements[1])*sg}else this.elements[0]>this.elements[5]&&this.elements[0]>this.elements[10]?(sg=Math.sqrt(1+this.elements[0]-this.elements[5]-this.elements[10]),og=.5*sg,sg=.5/sg,pg=(this.elements[4]+this.elements[1])*sg,qg=(this.elements[2]+
this.elements[8])*sg,rg=(this.elements[9]-this.elements[6])*sg):this.elements[5]>this.elements[10]?(sg=Math.sqrt(1+this.elements[5]-this.elements[0]-this.elements[10]),pg=.5*sg,sg=.5/sg,og=(this.elements[4]+this.elements[1])*sg,qg=(this.elements[9]+this.elements[6])*sg,rg=(this.elements[2]-this.elements[8])*sg):(sg=Math.sqrt(1+this.elements[10]-this.elements[0]-this.elements[5]),qg=.5*sg,sg=.5/sg,og=(this.elements[2]+this.elements[8])*sg,pg=(this.elements[9]+this.elements[6])*sg,rg=(this.elements[4]-
this.elements[1])*sg);return[og,pg,qg,rg]};
THREE.Matrix4.prototype.setFromQuaternion=function(og){this.setPosition(new THREE.Vector3(0,0,0));var pg=this.ms(og),pg=1==pg?2:0<pg?2/pg:0,qg=og[0]*pg,rg=og[1]*pg,sg=og[2]*pg,pg=og[0]*qg,tg=og[0]*rg,ug=og[0]*sg,qg=og[3]*qg,yg=og[1]*rg,Bg=og[1]*sg,rg=og[3]*rg,Cg=og[2]*sg;og=og[3]*sg;this.elements[0]=1-(yg+Cg);this.elements[1]=tg-og;this.elements[2]=ug+rg;this.elements[4]=tg+og;this.elements[5]=1-(pg+Cg);this.elements[6]=Bg-qg;this.elements[8]=ug-rg;this.elements[9]=Bg+qg;this.elements[10]=1-(pg+yg)};
THREE.Matrix4.prototype.ms=function(og){return og[3]*og[3]+og[0]*og[0]+og[1]*og[1]+og[2]*og[2]};THREE.Matrix4.prototype.normalize=function(og){var pg=1/Math.sqrt(this.ms(og));og[0]*=pg;og[1]*=pg;og[2]*=pg;og[3]*=pg;return og};THREE.Vector3.prototype.Vb=function(og,pg){return new THREE.Vector3(this.x+og.x*pg,this.y+og.y*pg,this.z+og.z*pg)};
THREE.Vector3.Hv=function(og,pg,qg){if(og.bo&&pg.bo&&qg.bo){var rg=new THREE.Vector3(pg.x,pg.y,pg.z);rg.sub(new THREE.Vector3(og.x,og.y,og.z));rg.cross((new THREE.Vector3(qg.x,qg.y,qg.z)).sub(new THREE.Vector3(pg.x,pg.y,pg.z)))}else rg=new THREE.Vector3,rg.copy(pg),rg.sub(og),rg.cross(qg.clone().sub(pg));return rg};
THREE.Vector3.qy=function(og,pg,qg,rg,sg){var tg=sg*sg,ug=tg*sg;if(null===og||null===pg||null===qg||null===rg)return null;var yg,Bg;og=pg.clone().sub(og).add(qg.clone().sub(pg)).multiplyScalar(.5);rg=qg.clone().sub(pg).add(rg.clone().sub(qg)).multiplyScalar(.5);yg=2*ug-3*tg+1;sg=ug-2*tg+sg;Bg=ug-tg;tg=-2*ug+3*tg;return pg.clone().multiplyScalar(yg).Vb(og,sg).Vb(rg,Bg).Vb(qg,tg)};
THREE.Vector3.Id=function(og,pg,qg){return null===og|null===pg?new THREE.Vector3:og.clone().multiplyScalar(1-qg).Vb(pg,qg)};THREE.Vector3.prototype.ft=function(og,pg){return Math.atan2(this.clone().dot(pg),this.clone().dot(og))};THREE.Vector3.jx=function(og,pg,qg){return og.clone().multiplyScalar(Math.cos(qg)).Vb(pg,Math.sin(qg))};
THREE.Vector3.prototype.Dn=function(){var og=Math.abs(this.x),pg=Math.abs(this.y),qg=Math.abs(this.z);return og<=pg&&og<=qg?this.clone().cross(new THREE.Vector3(1,0,0)).normalize():pg<=og&&pg<=qg?this.clone().cross(new THREE.Vector3(0,1,0)).normalize():this.clone().cross(new THREE.Vector3(0,0,1)).normalize()};
THREE.Vector3.prototype.Un=function(og,pg,qg){var rg=this.Dn(),sg=this.clone().cross(rg).normalize(),tg=og.length(),ug=pg.length();og=og.ft(rg,sg);pg=pg.ft(rg,sg);Math.abs(og-pg)>Math.PI&&(pg<og?pg+=2*Math.PI:og+=2*Math.PI);pg=THREE.Math.Id(og,pg,qg);qg=THREE.Math.Id(tg,ug,qg);return THREE.Vector3.jx(rg,sg,pg).multiplyScalar(qg)};THREE.Color.Id=function(og,pg,qg){return null===og|null===pg?null:og.clone().multiplyScalar(1-qg).Vb(pg,qg)};
THREE.Color.prototype.Vb=function(og,pg){return new THREE.Color(this.r+og.r*pg,this.g+og.g*pg,this.b+og.b*pg)};THREE.Math.Id=function(og,pg,qg){return og*(1-qg)+pg*qg};THREE.GeometryUtils.Mw=function(og,pg,qg,rg,sg,tg,ug,yg,Bg,Cg,Ag,wg,Dg,Eg,Fg,Jg){var Ig=sg*pg-og*tg,Lg=Bg*pg-og*Cg;og=Dg*pg-og*Eg;pg=Bg*tg-sg*Cg;sg=Dg*tg-sg*Eg;Bg=Dg*Cg-Bg*Eg;return(Bg*ug-sg*Ag+pg*Fg)*rg-(Bg*qg-og*Ag+Lg*Fg)*yg+(sg*qg-og*ug+Ig*Fg)*wg-(pg*qg-Lg*ug+Ig*Ag)*Jg};
THREE.GeometryUtils.KA=function(og,pg,qg,rg){return THREE.GeometryUtils.LA(og.x,og.y,og.z,og.weight,pg.x,pg.y,pg.z,pg.weight,qg.x,qg.y,qg.z,qg.weight,rg.x,rg.y,rg.z,rg.weight)};THREE.GeometryUtils.nj=function(og,pg,qg,rg,sg,tg,ug,yg,Bg){return(og*sg-rg*pg)*Bg-(og*yg-ug*pg)*tg+(rg*yg-ug*sg)*qg};THREE.GeometryUtils.Qe=function(og,pg,qg,rg){return og*rg-qg*pg};
THREE.GeometryUtils.LA=function(og,pg,qg,rg,sg,tg,ug,yg,Bg,Cg,Ag,wg,Dg,Eg,Fg,Jg){sg-=og;tg-=pg;ug-=qg;yg=THREE.GeometryUtils.Ya(sg)+THREE.GeometryUtils.Ya(tg)+THREE.GeometryUtils.Ya(ug)-yg+rg;Bg-=og;Cg-=pg;Ag-=qg;wg=THREE.GeometryUtils.Ya(Bg)+THREE.GeometryUtils.Ya(Cg)+THREE.GeometryUtils.Ya(Ag)-wg+rg;og=Dg-og;pg=Eg-pg;qg=Fg-qg;Eg=THREE.GeometryUtils.Ya(og)+THREE.GeometryUtils.Ya(pg)+THREE.GeometryUtils.Ya(qg)-Jg+rg;Jg=THREE.GeometryUtils.nj(tg,ug,yg,Cg,Ag,wg,pg,qg,Eg);Fg=THREE.GeometryUtils.nj(sg,
ug,yg,Bg,Ag,wg,og,qg,Eg);yg=THREE.GeometryUtils.nj(sg,tg,yg,Bg,Cg,wg,og,pg,Eg);sg=THREE.GeometryUtils.nj(sg,tg,ug,Bg,Cg,Ag,og,pg,qg);if(0===sg)throw"den==0 in squared_radius_orthogonal_sphereC3_detailedParams";return(THREE.GeometryUtils.Ya(Jg)+THREE.GeometryUtils.Ya(Fg)+THREE.GeometryUtils.Ya(yg))*THREE.GeometryUtils.Ya(.5/sg)-rg};THREE.GeometryUtils.Ya=function(og){return og*og};
THREE.GeometryUtils.Qr=function(og,pg,qg,rg){return THREE.GeometryUtils.Cy(og.x,og.y,og.z,og.weight,pg.x,pg.y,pg.z,pg.weight,qg.x,qg.y,qg.z,qg.weight,rg.x,rg.y,rg.z,rg.weight)};
THREE.GeometryUtils.Cy=function(og,pg,qg,rg,sg,tg,ug,yg,Bg,Cg,Ag,wg,Dg,Eg,Fg,Jg){sg-=og;tg-=pg;ug-=qg;Bg-=og;Cg-=pg;Ag-=qg;var Ig=THREE.GeometryUtils.Ya(sg)+THREE.GeometryUtils.Ya(tg)+THREE.GeometryUtils.Ya(ug),Lg=THREE.GeometryUtils.Ya(Bg)+THREE.GeometryUtils.Ya(Cg)+THREE.GeometryUtils.Ya(Ag),Kg=sg*Bg+tg*Cg+ug*Ag,Mg=Ig-yg+rg,Og=Lg-wg+rg;wg=THREE.GeometryUtils.Qe(Ig,Kg,Kg,Lg);yg=THREE.GeometryUtils.Qe(Mg,Kg,Og,Lg);Ig=THREE.GeometryUtils.Qe(Ig,Mg,Kg,Og);og=Dg-og;pg=Eg-pg;qg=Fg-qg;Fg=THREE.GeometryUtils.Ya(og)+
THREE.GeometryUtils.Ya(pg)+THREE.GeometryUtils.Ya(qg);if(0==wg)throw"den==0 in in_sphere_detailedParams";return THREE.GeometryUtils.sign(wg*(Fg-Jg+rg)-yg*(og*sg+pg*tg+qg*ug)-Ig*(og*Bg+pg*Cg+qg*Ag))};THREE.GeometryUtils.sign=function(og){return 0<og?1:0>og?-1:0};
THREE.GeometryUtils.NA=function(og,pg,qg,rg,sg,tg,ug,yg,Bg,Cg,Ag,wg){sg-=og;tg-=pg;ug-=qg;yg=THREE.GeometryUtils.Ya(sg)+THREE.GeometryUtils.Ya(tg)+THREE.GeometryUtils.Ya(ug)-yg+rg;og=Bg-og;pg=Cg-pg;qg=Ag-qg;var Dg=THREE.GeometryUtils.Ya(og)+THREE.GeometryUtils.Ya(pg)+THREE.GeometryUtils.Ya(qg)-wg+rg;Cg=tg*qg-ug*pg;Bg=ug*og-sg*qg;var Eg=sg*pg-tg*og;wg=yg*THREE.GeometryUtils.Qe(pg,qg,Bg,Eg)-Dg*THREE.GeometryUtils.Qe(tg,ug,Bg,Eg);Ag=yg*THREE.GeometryUtils.Qe(og,qg,Cg,Eg)-Dg*THREE.GeometryUtils.Qe(sg,
ug,Cg,Eg);yg=yg*THREE.GeometryUtils.Qe(og,pg,Cg,Bg)-Dg*THREE.GeometryUtils.Qe(sg,tg,Cg,Bg);sg=THREE.GeometryUtils.nj(sg,tg,ug,og,pg,qg,Cg,Bg,Eg);if(0==sg)throw"den==0";return(THREE.GeometryUtils.Ya(wg)+THREE.GeometryUtils.Ya(Ag)+THREE.GeometryUtils.Ya(yg))*THREE.GeometryUtils.Ya(.5/sg)-rg};THREE.GeometryUtils.MA=function(og,pg,qg){return THREE.GeometryUtils.NA(og.x,og.y,og.z,og.weight,pg.x,pg.y,pg.z,pg.weight,qg.x,qg.y,qg.z,qg.weight)};
function sj(){this.Xl=24;this.Wl=2;this.HA=3;this.Az=!1;this.wv=3;this.oo=20;this.Zf=new THREE.Color(16777215)}
sj.Vx=function(og,pg){og.lq();var qg=[],rg=[];qg.push(rg);for(var sg=og.ka,tg=og.Qa(),ug=["N","CA","C"],yg=null,Bg=null,Cg=sg.length,Ag=0;Ag<Cg;Ag++){var wg=sg[Ag];if(null!==yg){var Dg=0;isNaN(parseFloat(wg.oa()))||(Dg+=parseFloat(wg.oa()));isNaN(parseFloat(yg.oa()))||(Dg-=parseFloat(yg.oa()));isNaN(wg.Ha.charCodeAt(0))||isNaN(yg.Ha.charCodeAt(0))||0===wg.Ha.charCodeAt(0)||0===yg.Ha.charCodeAt(0)||(Dg+=wg.Ha.charCodeAt(0),Dg-=yg.Ha.charCodeAt(0));1<Dg&&(rg=[],qg.push(rg))}var yg=!1,Dg=!0,Eg=!1,Fg=
void 0;try{for(var Jg=ug[Symbol.iterator](),Ig;!(Dg=(Ig=Jg.next()).done);Dg=!0){var Lg=wg.md(Ig.value);if(void 0!==Lg&&null!==Lg){var Kg=Bg&&"CA"==Bg.name&&"CA"==Lg.name?5:2;null!=Bg&&!yg&&Lg.distanceTo(Bg)>Kg&&(rg=[],qg.push(rg));var yg=!0,Bg=Lg,Mg=new tj(Lg),Og=tg.indexOf(Lg);Mg.uc=pg;Mg.la=Lg;Mg.rb=Og;Mg.rf="CA"!==Lg.name;switch(wg.Eb.name){case Tg.ug.name:Mg.width=vj.im;Mg.height=vj.hm;Mg.ld=vj.gm;break;case Tg.nh.name:case Tg.jh.name:Mg.width=vj.nm;Mg.height=vj.mm;Mg.jc=!0;Mg.Rg=vj.lm;break;
default:Mg.width=vj.tg,Mg.height=vj.sg}rg.push(Mg)}}}catch(Sg){Eg=!0,Fg=Sg}finally{try{!Dg&&Jg["return"]&&Jg["return"]()}finally{if(Eg)throw Fg;}}yg=wg}return qg};
sj.Wx=function(og,pg){og.lq();for(var qg=og.ka,rg=og.Qa(),sg=[],tg=[],ug=[],yg=[],Bg=[],Cg=[],Ag=[],wg=[],Dg=[],Eg=!1,Fg=!1,Jg=["N","CA","C"],Ig=null,Lg=null,Kg=qg.length,Mg=0;Mg<Kg;Mg++){var Og=qg[Mg];if(null!==Ig){var Sg=0;isNaN(parseFloat(Og.oa()))||(Sg+=parseFloat(Og.oa()));isNaN(parseFloat(Ig.oa()))||(Sg-=parseFloat(Ig.oa()));isNaN(Og.Ha.charCodeAt(0))||isNaN(Ig.Ha.charCodeAt(0))||0===Og.Ha.charCodeAt(0)||0===Ig.Ha.charCodeAt(0)||(Sg+=Og.Ha.charCodeAt(0),Sg-=Ig.Ha.charCodeAt(0));1<Sg&&(Eg?(ug.push(yg),
Eg=!1):Fg&&(sg.push(tg),Fg=!1))}var Qg=Sg=!1,vh=!0,dh=!1,di=void 0;try{for(var Fh=Jg[Symbol.iterator](),xh;!(vh=(xh=Fh.next()).done);vh=!0){var wh=Og.md(xh.value);if(void 0!==wh&&null!==wh){null!=Lg&&!Sg&&2<wh.distanceTo(Lg)&&(Qg=!0);var Lg=wh,eh=new tj(wh),uj=rg.indexOf(wh);eh.uc=pg;eh.la=wh;eh.rb=uj;eh.rf="CA"!==wh.name;switch(Og.Eb.name){case Tg.ug.name:Eg?!Sg&&(Qg||null!=Ig&&Ig.Eb.ct)&&(ug.push(yg),yg=[],null!=Ig&&Ig.Eb.ct&&!Sg&&Dg.push(ug.length)):(Fg&&(Qg||(Bg.push(sg.length),Cg.push(ug.length)),
sg.push(tg),Fg=!1),yg=[],Eg=!0);yg.push(wh);break;case Tg.nh.name:case Tg.jh.name:eh.width=rj.nm;eh.height=rj.mm;eh.jc=!0;eh.Rg=rj.lm;Eg?(Qg||(wg.push(ug.length),Ag.push(sg.length)),ug.push(yg),Eg=!1,tg=[],Fg=!0):Fg?!Sg&&Qg&&(sg.push(tg),tg=[]):(tg=[],Fg=!0);tg.push(eh);break;default:eh.width=rj.tg,eh.height=rj.sg,Eg?(Qg||(wg.push(ug.length),Ag.push(sg.length)),ug.push(yg),Eg=!1,tg=[],Fg=!0):Fg?!Sg&&Qg&&(sg.push(tg),tg=[]):(tg=[],Fg=!0),tg.push(eh)}Sg=!0}}}catch(xi){dh=!0,di=xi}finally{try{!vh&&Fh["return"]&&
Fh["return"]()}finally{if(dh)throw di;}}Ig=Og}Eg?ug.push(yg):Fg&&sg.push(tg);return[sg,ug,Bg,Cg,Ag,wg,Dg]};
sj.Nx=function(og,pg){var qg=[],rg=[];qg.push(rg);for(var sg=og.ka,tg=og.Qa(),ug=["P","O5'","O3'"],yg=null,Bg=null,Cg=sg.length,Ag=0;Ag<Cg;Ag++){var wg=sg[Ag];if(null!==yg){var Dg=0;isNaN(parseFloat(wg.oa()))||(Dg+=parseFloat(wg.oa()));isNaN(parseFloat(yg.oa()))||(Dg-=parseFloat(yg.oa()));isNaN(wg.Ha.charCodeAt(0))||isNaN(yg.Ha.charCodeAt(0))||0===wg.Ha.charCodeAt(0)||0===yg.Ha.charCodeAt(0)||(Dg+=wg.Ha.charCodeAt(0),Dg-=yg.Ha.charCodeAt(0));1<Dg&&(rg=[],qg.push(rg))}var yg=!1,Dg=!0,Eg=!1,Fg=void 0;
try{for(var Jg=ug[Symbol.iterator](),Ig;!(Dg=(Ig=Jg.next()).done);Dg=!0){var Lg=wg.md(Ig.value);if(void 0!==Lg&&null!==Lg){null!=Bg&&!yg&&2<Lg.distanceTo(Bg)&&(rg=[],qg.push(rg));var yg=!0,Bg=Lg,Kg=new tj(Lg),Mg=tg.indexOf(Lg);Kg.uc=pg;Kg.la=Lg;Kg.rb=Mg;Kg.rf=!0;Kg.width=vj.im;Kg.height=vj.hm;Kg.ld=vj.gm;Kg.Rg=vj.np;rg.push(Kg)}}}catch(Og){Eg=!0,Fg=Og}finally{try{!Dg&&Jg["return"]&&Jg["return"]()}finally{if(Eg)throw Fg;}}yg=wg}return qg};
function tj(og){og instanceof Rg?this.pos=og.pos.clone():null!=og&&(this.pos=og.clone());this.uc=null;this.la=og;this.height=this.width=1;this.ld=0;this.jc=this.Cj=!1;this.rf=!0;this.Rg=0;this.Ab=this.Sf=this.Ka=null;this.cj=0}
tj.prototype.clone=function(){var og=new tj;og.pos=this.pos.clone();og.uc=this.uc;og.la=this.la;og.rb=this.rb;og.width=this.width;og.height=this.height;og.ld=this.ld;og.Cj=this.Cj;og.jc=this.jc;og.rf=this.rf;og.Rg=this.Rg;og.Ka=this.Ka;og.Sf=this.Sf;og.Ab=this.Ab;og.cj=this.cj;return og};xg=sj.prototype;
xg.Eq=function(og,pg,qg){if(!(2>pg.length)){this.Zf=qg;this.GA(pg);this.Lv(pg);this.Kv(pg);this.Cw(pg);this.FA(pg);pg=this.WA(pg);pg.forEach(function(og){var pg=og.Ab.clone().cross(og.Ka).normalize();og.Sf=pg});qg=0;for(var rg=pg.length-1;0<=rg;rg--){var sg=pg[rg];sg.jc?(1<rg&&(qg+=sg.pos.distanceTo(pg[rg-1].pos)),sg.cj=qg):qg=0}this.gz(og,pg)}};
xg.GA=function(og){for(var pg=og.length,qg=0;qg<this.HA;qg++){var rg=[];if(this.Az)for(var sg=1;sg<pg-1;sg++)og[sg].rf&&(rg[sg]=og[sg-1].pos.clone().add(og[sg+1].pos.clone()).multiplyScalar(.5));else for(og[1].rf&&(rg[1]=og[0].pos.clone().add(og[1].pos.clone()).multiplyScalar(.5)),og[pg-1].rf&&(rg[pg-1]=og[pg-2].pos.add(og[pg-1].pos.clone()).multiplyScalar(.5)),sg=2;sg<pg-2;sg++)og[sg].rf&&(rg[sg]=(new THREE.Vector3).Vb(og[sg-2].pos.clone(),-.25).Vb(og[sg-1].pos.clone(),.5).Vb(og[sg].pos.clone(),
.5).Vb(og[sg+1].pos.clone(),.5).Vb(og[sg+2].pos.clone(),-.25));for(sg=1;sg<pg-1;sg++){var tg=rg[sg];void 0!==tg&&null!==tg&&(og[sg].pos=tg.clone())}}for(var ug=0,qg=0;qg<pg;qg++)rg=og[qg].Rg,rg>ug&&(ug=rg);for(qg=0;qg<ug;qg++){rg=Array(pg);for(sg=1;sg<pg-1;sg++)og[sg].Rg>qg&&(rg[sg]=og[sg].pos.clone().add(og[sg-1].pos.clone().add(og[sg+1].pos.clone()).multiplyScalar(.5)).multiplyScalar(.5));for(sg=1;sg<pg-1;sg++)tg=rg[sg],null!==tg&&void 0!==tg&&(og[sg].pos=tg.clone())}};
xg.FA=function(og){for(var pg=og.length,qg=0;qg<this.wv;qg++)for(var rg=Array(pg),sg=Array(pg),tg=1;tg<pg-1;tg++)sg[tg]=og[tg-1].Ab.clone().add(og[tg+1].Ab.clone()).Vb(og[tg].Ab.clone(),2).normalize(),rg[tg]=sg[tg].Un(og[tg-1].Ka.clone(),og[tg+1].Ka.clone(),.5).normalize()};
xg.WA=function(og){var pg=og.length;if(1<this.Wl){var qg=Array((pg-3)*this.Wl+2),rg=0;qg[rg++]=og[0];for(var sg=0;sg<pg-3;sg++)for(var tg=0;tg<this.Wl;tg++)qg[rg++]=tj.Iy(og[sg],og[sg+1],og[sg+2],og[sg+3],tg/this.Wl);qg[rg++]=og[pg-1];return qg}return og};
xg.Lv=function(og){og[0].Ab=(new THREE.Vector3).subVectors(og[1].pos,og[0].pos).normalize();for(var pg=og.length,qg=1;qg<pg-1;qg++)og[qg].Ab=(new THREE.Vector3).subVectors(og[qg+1].pos,og[qg-1].pos).normalize();og[pg-1].Ab=(new THREE.Vector3).subVectors(og[pg-1].pos,og[pg-2].pos).normalize()};
xg.Kv=function(og){for(var pg=og.length,qg=0;qg<pg;qg++){var rg=og[qg];if(rg.width!==rg.height){for(var sg=new THREE.Vector3,tg=0,ug=new THREE.Vector3,yg=0,Bg=0,Cg=qg-1;0<=Cg;Cg--){var Bg=Bg+og[Cg].pos.distanceTo(og[Cg+1].pos),Ag=(this.oo-Bg)/Bg*Bg;if(0>=Ag)break;sg=sg.Vb(og[Cg].pos,Ag);tg+=Ag}Bg=0;for(Cg=qg+1;Cg<pg;Cg++){Bg+=og[Cg].pos.distanceTo(og[Cg-1].pos);Ag=(this.oo-Bg)/Bg*Bg;if(0>=Ag)break;ug=ug.Vb(og[Cg].pos,Ag);yg+=Ag}sg=(new THREE.Vector3).addScaledVector(sg,1/tg);ug=(new THREE.Vector3).addScaledVector(ug,
1/yg);0===tg&&(sg=ug);0===yg&&(ug=sg);rg.Ka=(new THREE.Vector3).subVectors(rg.pos,sg).add((new THREE.Vector3).subVectors(rg.pos,ug)).multiplyScalar(1/this.oo);if(.1>(new THREE.Vector3).crossVectors(rg.Ka,rg.Ab).length())rg.Ka=null;else if(rg.Ka=(new THREE.Vector3).crossVectors(rg.Ab,rg.Ka).cross(rg.Ab).normalize(),0===rg.ld)for(tg=qg-1;0<=tg;tg--)if(yg=og[tg].Ka,ug=rg.Ka,null!==yg&&void 0!==yg){0>ug.dot(yg)&&(og[qg].Ka=(new THREE.Vector3).addScaledVector(ug,-1));break}}}};
xg.Cw=function(og){for(var pg=[],qg=og.length,rg=0;rg<qg;rg++){var sg=og[rg];if(null===sg.Ka||void 0===sg.Ka){for(var tg=rg;0<=tg&&(null===og[tg].Ka||void 0===og[tg].Ka);)tg--;for(var ug=rg;ug<qg&&(null===og[ug].Ka||void 0===og[ug].Ka);)ug++;ug===qg&&(ug=-1);if(0>tg&&0>ug)pg[rg]=sg.Ab.Dn();else if(0<=tg&&0<=ug){var yg=(rg-tg)/(ug-tg),sg=sg.Ab.clone();pg[rg]=sg.Un(og[tg].Ka,og[ug].Ka,yg)}else pg[rg]=0<=tg?og[tg].Ka.clone():og[ug].Ka.clone()}}qg=pg.length;for(rg=0;rg<qg;rg++)tg=pg[rg],null!==tg&&void 0!==
tg&&(ug=tg.clone(),ug.la=tg.la,ug.rb=tg.rb,og[rg].Ka=ug)};
xg.gz=function(og,pg){var qg=pg[0].Rk(this.Xl,!0),rg=!1;this.gs(og,qg,!1);for(var sg=pg.length,tg=1;tg<sg;tg++){var ug=pg[tg],yg=ug.Rk(this.Xl,!0),Bg=ug.Wr();if(Bg&&!rg)rg=ug.Rk(this.Xl,!1),ug=ug.Rk(this.Xl,!0),this.ko(og,qg,rg),this.ko(og,rg,ug);else{for(var rg=yg.length,Cg=0;Cg<rg;Cg++).01>=yg[Cg].clone().sub(qg[Cg].clone()).dot(ug.Ab.clone())&&(yg[Cg]=qg[Cg].clone(),yg[Cg].normal=qg[Cg].normal,yg[Cg].la=qg[Cg].la,yg[Cg].rb=qg[Cg].rb);this.ko(og,qg,yg)}qg=yg;rg=Bg}this.gs(og,qg,!0)};
xg.Op=function(og,pg){for(var qg=pg.length,rg=og.Qh(),sg=0;sg<qg;sg++){var tg=pg[sg];og.Lg(tg.x,tg.y,tg.z,this.Zf);og.Ig(tg.rb)}return rg};xg.ko=function(og,pg,qg){if(pg.length!==qg.length)throw"meshFill impossible, a.length !== b.length";pg=pg.length;qg=this.Op(og,qg);for(var rg=0;rg<pg;rg++){var sg=(rg+1)%pg,tg=qg-pg+rg,ug=qg-pg+sg,sg=qg+sg;og.ed(tg,qg+rg,sg);og.ed(tg,sg,ug)}};
xg.gs=function(og,pg,qg){var rg=pg.length;pg=this.Op(og,pg);for(var sg=0;sg<rg-1;sg++){var tg=pg+sg,ug=pg+sg+1,yg=pg+rg-sg-1;qg?og.ed(tg,yg,ug):og.ed(tg,ug,yg)}};tj.prototype.Wr=function(){return this.jc&&this.cj<2*this.width};
tj.prototype.Rk=function(og,pg){for(var qg=Array(og),rg=0;rg<og;rg++){var sg=2*(rg+.5)*Math.PI/og,tg;if(this.Cj){tg=og/4;var ug=tg+2,yg=3*og/4,Bg=yg+2,Cg=.1*this.width;rg==tg||rg==tg+1||rg==Bg||rg==Bg+1?(tg=rg==tg||rg==tg+1?Cg:-Cg,sg=this.height-2*this.width):rg==ug||rg==ug+1||rg==yg||rg==yg+1?(tg=rg==ug||rg==ug+1?Cg:-Cg,sg=2*this.width-this.height):rg<tg||rg>Bg?(tg=Math.sin(2*sg)*this.width,sg=this.height-this.width+Math.cos(2*sg)*this.width):(tg=Math.sin(Math.PI+2*sg)*this.width,sg=this.width-this.height+
Math.cos(Math.PI+2*sg)*this.width)}else tg=Math.sin(sg)*this.width,sg=Math.cos(sg)*this.height,this.jc?(ug=this.width,this.Wr()&&pg&&(ug=this.cj),tg=ug*(0<=tg?1:-1),sg=this.height*(0<=sg?1:-1)):tg+=this.ld*Math.cos(Math.PI*sg/this.height);sg=this.pos instanceof Rg?this.pos.pos.clone().Vb(this.Ka,tg).Vb(this.Sf,sg):this.pos.clone().Vb(this.Ka,tg).Vb(this.Sf,sg);sg.la=this.la;sg.rb=this.rb;qg[rg]=sg}for(rg=0;rg<og;rg++)sg=(rg+og-1)%og,tg=(rg+1)%og,new THREE.Vector3,sg=qg[tg].clone().sub(qg[sg].clone()),
qg[rg].normal=sg.cross(this.Ab).normalize();return qg};
tj.Iy=function(og,pg,qg,rg,sg){og=THREE.Vector3.qy(og.pos.clone(),pg.pos.clone(),qg.pos.clone(),rg.pos.clone(),sg);og=new tj(og);og.la=.5>sg?pg.la:qg.la;og.rb=.5>sg?pg.rb:qg.rb;pg.jc==qg.jc?(og.width=THREE.Math.Id(pg.width,qg.width,sg),og.height=THREE.Math.Id(pg.height,qg.height,sg),og.ld=THREE.Math.Id(pg.ld,qg.ld,sg),og.uc=THREE.Color.Id(pg.uc,qg.uc,sg),og.jc=pg.jc):(og.width=pg.jc?qg.width:pg.width,og.height=pg.jc?qg.height:pg.height,og.ld=pg.jc?qg.ld:pg.ld,og.uc=pg.jc?qg.uc:pg.uc,og.jc=!1);og.Cj=
pg.Cj;og.Sf=THREE.Vector3.Id(pg.Sf,qg.Sf,sg).normalize();og.Ab=THREE.Vector3.Id(pg.Ab,qg.Ab,sg).normalize();og.Ka=null!==pg.Ka&&null!==qg.Ka&&null!==og.Ab&&void 0!==pg.Ka&&void 0!==qg.Ka&&void 0!==og.Ab?og.Ab.clone().Un(pg.Ka,qg.Ka,sg):THREE.Vector3.Id(pg.Ka,qg.Ka,sg).normalize();return og};function vj(og){hi.call(this,og)}vj.prototype=Object.create(hi.prototype);vj.prototype.constructor=vj;ih.dk=new hh("Cartoon","CARTOON","CARTOON",vj);vj.im=.075;vj.hm=1.2;vj.gm=.25;vj.nm=1.3;vj.mm=.5;vj.tg=.175;
vj.sg=.175;vj.lm=34;vj.np=12;vj.prototype.Dc=function(){var og=this.ga.Hc(this.cb.pa.id,"M"),pg=null;this.Xa.Xf()?pg=sj.Vx(this.Xa,og):this.Xa.Xh()&&(pg=sj.Nx(this.Xa,og));var qg=new Ni(!0);if(null!==pg){var rg=new sj,sg;for(sg in pg)2<pg[sg].length&&rg.Eq(qg,pg[sg],og);og=qg.Og();pg=this.ga.Ye();og=new THREE.Mesh(og,pg);og.la=this.Xa;og.Ma=this;this.parent.add(og);this.da=og;this.color(hi.za.oc)}};vj.prototype.cd=function(){this.color(hi.za.oc)};
vj.prototype.update=function(og){hi.prototype.update.call(this,og);og.OA&&(og=this.da.visible,this.sd=[],this.parent.remove(this.da),this.da=null,this.Yc(),this.da.visible=og)};function wj(){this.z=this.y=this.x=void 0}function xj(){this.z=this.y=this.x=void 0;this.ya=new wj;this.gd=this.area=void 0;this.nq=Infinity;this.cs=this.nd=void 0}function Ej(){this.c=this.b=this.a=void 0;this.ya=new wj;this.nd=this.area=void 0}function Fj(){}
Fj.sw=function(og,pg){var qg=og.length,rg=pg.length,sg;for(sg=0;sg<qg;sg++)og[sg].ya.x=0,og[sg].ya.y=0,og[sg].ya.z=0;var tg=new wj,ug=new wj,yg=new wj,Bg=new wj,Cg=new wj,Ag=new wj;for(sg=0;sg<rg;sg++){var wg=pg[sg];tg.x=og[wg.a].x;tg.y=og[wg.a].y;tg.z=og[wg.a].z;ug.x=og[wg.b].x;ug.y=og[wg.b].y;ug.z=og[wg.b].z;yg.x=og[wg.c].x;yg.y=og[wg.c].y;yg.z=og[wg.c].z;Bg.x=ug.x-tg.x;Bg.y=ug.y-tg.y;Bg.z=ug.z-tg.z;Cg.x=yg.x-tg.x;Cg.y=yg.y-tg.y;Cg.z=yg.z-tg.z;Ag.x=Bg.y*Cg.z-Bg.z*Cg.y;Ag.y=Bg.z*Cg.x-Bg.x*Cg.z;Ag.z=
Bg.x*Cg.y-Bg.y*Cg.x;wg.area=.5*Math.sqrt(Ag.x*Ag.x+Ag.y*Ag.y+Ag.z*Ag.z);wg.ya.x=.5*Ag.x/wg.area;wg.ya.y=.5*Ag.y/wg.area;wg.ya.z=.5*Ag.z/wg.area;og[pg[sg].a].ya.x+=pg[sg].ya.x;og[pg[sg].a].ya.y+=pg[sg].ya.y;og[pg[sg].a].ya.z+=pg[sg].ya.z;og[pg[sg].b].ya.x+=pg[sg].ya.x;og[pg[sg].b].ya.y+=pg[sg].ya.y;og[pg[sg].b].ya.z+=pg[sg].ya.z;og[pg[sg].c].ya.x+=pg[sg].ya.x;og[pg[sg].c].ya.y+=pg[sg].ya.y;og[pg[sg].c].ya.z+=pg[sg].ya.z}for(sg=0;sg<qg;sg++)Ag.x=og[sg].ya.x,Ag.y=og[sg].ya.y,Ag.z=og[sg].ya.z,rg=Math.sqrt(Ag.x*
Ag.x+Ag.y*Ag.y+Ag.z*Ag.z),0==rg?(Ag.x=0,Ag.y=0,Ag.z=0):(Ag.x/=rg,Ag.y/=rg,Ag.z/=rg),og[sg].ya.x=Ag.x,og[sg].ya.y=Ag.y,og[sg].ya.z=Ag.z};Fj.bounds=function(og){for(var pg={x:Infinity,y:Infinity,z:Infinity},qg={x:-Infinity,y:-Infinity,z:-Infinity},rg=og.length/4,sg=0;sg<rg;sg++){var tg=og[4*sg],ug=og[4*sg+1],yg=og[4*sg+2];pg.x=Math.min(pg.x,tg);pg.y=Math.min(pg.y,ug);pg.z=Math.min(pg.z,yg);qg.x=Math.max(qg.x,tg);qg.y=Math.max(qg.y,ug);qg.z=Math.max(qg.z,yg)}return[pg,qg]};
Fj.li=function(og){return og*og};Fj.Pw=function(og,pg,qg,rg){rg*=rg;qg.x<og.x?rg-=Fj.li(qg.x-og.x):qg.x>pg.x&&(rg-=Fj.li(qg.x-pg.x));qg.y<og.y?rg-=Fj.li(qg.y-og.y):qg.y>pg.y&&(rg-=Fj.li(qg.y-pg.y));qg.z<og.z?rg-=Fj.li(qg.z-og.z):qg.z>pg.z&&(rg-=Fj.li(qg.z-pg.z));return 0<rg};Fj.__deps=[wj];function Gj(){}Gj.sm=[[0,0,0],[1,0,0],[0,1,0],[1,1,0],[0,0,1],[1,0,1],[0,1,1],[1,1,1]];
Gj.yp=[[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,2,0,1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,0,1,3,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,3,2,0,-1,-1,-1,-1,-1,-1],[1,1,3,2,-1,-1,-1,-1,-1,-1],[2,0,1,3,3,2,0,-1,-1,-1],[0,-1,-1,-1,-1,-1,
-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,1,0,4,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,4,0,2,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,2,4,1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[2,0,4,1,1,3,0,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[2,2,4,0,0,3,2,-1,-1,-1],[1,1,3,2,-1,-1,-1,-1,-1,-1],[2,4,1,3,3,2,4,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,
-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,5,1,0,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[2,0,5,1,1,2,0,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,3,1,5,-1,-1,-1,-1,-1,-1],[1,0,5,3,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,3,2,0,-1,-1,-1,-1,-1,-1],[2,1,5,3,3,2,1,-1,-1,-1],[2,5,3,2,2,0,5,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,0,4,5,-1,-1,-1,-1,-1,-1],[1,4,5,1,-1,-1,-1,-1,-1,-1],[2,
4,5,1,1,0,4,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[2,4,5,0,0,2,4,-1,-1,-1],[1,4,5,1,-1,-1,-1,-1,-1,-1],[2,2,4,5,5,1,2,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,0,4,5,-1,-1,-1,-1,-1,-1],[2,5,3,1,1,4,5,-1,-1,-1],[2,3,0,4,4,5,3,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[3,5,0,3,5,3,2,5,2,4],[3,2,1,4,2,4,5,2,5,3],[2,4,5,3,3,2,4,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,0,2,
6,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[2,2,6,0,0,1,2,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,0,1,3,-1,-1,-1,-1,-1,-1],[1,6,2,3,-1,-1,-1,-1,-1,-1],[1,3,6,0,-1,-1,-1,-1,-1,-1],[2,3,6,2,2,1,3,-1,-1,-1],[2,6,0,1,1,3,6,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,6,4,0,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[2,4,1,0,0,6,4,-1,-1,-1],[1,2,6,4,-1,-1,-1,-1,-1,-1],[2,0,2,6,6,4,0,-1,-1,-1],[1,2,6,4,-1,-1,-1,-1,-1,-1],[2,
1,2,6,6,4,1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,6,4,0,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[3,3,0,6,3,6,4,3,4,1],[2,6,4,2,2,3,6,-1,-1,-1],[2,3,6,4,4,0,3,-1,-1,-1],[3,4,2,1,4,1,3,4,3,6],[2,1,3,6,6,4,1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,5,1,0,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,0,2,6,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[3,6,0,5,6,5,1,6,1,2],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,
-1,-1,-1,-1,-1,-1,-1,-1],[1,3,1,5,-1,-1,-1,-1,-1,-1],[1,0,5,3,-1,-1,-1,-1,-1,-1],[1,6,2,3,-1,-1,-1,-1,-1,-1],[1,3,6,0,-1,-1,-1,-1,-1,-1],[3,5,3,6,5,6,2,5,2,1],[2,6,0,5,6,5,3,-1,-1,-1],[1,5,4,6,-1,-1,-1,-1,-1,-1],[1,5,0,6,-1,-1,-1,-1,-1,-1],[2,4,6,5,5,1,4,-1,-1,-1],[2,6,5,1,1,0,6,-1,-1,-1],[2,6,5,4,4,2,6,-1,-1,-1],[2,5,0,2,2,6,5,-1,-1,-1],[3,1,4,2,1,2,6,1,6,5],[2,5,1,2,2,6,5,-1,-1,-1],[1,5,4,6,-1,-1,-1,-1,-1,-1],[1,5,0,6,-1,-1,-1,-1,-1,-1],[3,6,5,3,6,3,1,6,1,4],[2,6,5,3,6,3,0,-1,-1,-1],[3,3,6,5,3,
5,4,3,4,2],[2,5,0,3,5,3,6,-1,-1,-1],[2,1,4,2,5,3,6,-1,-1,-1],[1,6,5,3,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,2,0,1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,7,3,1,-1,-1,-1,-1,-1,-1],[2,1,7,3,3,0,1,-1,-1,-1],[1,2,3,7,-1,-1,-1,-1,-1,-1],[2,3,7,2,2,0,3,-1,-1,-1],
[1,1,7,2,-1,-1,-1,-1,-1,-1],[2,7,2,0,0,1,7,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,1,0,4,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,4,0,2,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,2,4,1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,7,3,1,-1,-1,-1,-1,-1,-1],[3,4,1,7,4,7,3,4,3,0],[1,2,3,7,-1,-1,-1,-1,-1,-1],[3,7,2,4,7,4,0,7,0,3],[1,1,7,2,-1,-1,-1,-1,-1,-1],[2,7,2,4,7,4,1,-1,-1,
-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,1,5,7,-1,-1,-1,-1,-1,-1],[2,5,7,1,1,0,5,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,1,5,7,-1,-1,-1,-1,-1,-1],[3,7,1,2,7,2,0,7,0,5],[1,5,7,3,-1,-1,-1,-1,-1,-1],[1,5,7,3,-1,-1,-1,-1,-1,-1],[2,1,5,7,7,3,1,-1,-1,-1],[2,0,5,7,7,3,0,-1,-1,-1],[2,7,2,3,3,5,7,-1,-1,-1],[3,0,3,5,0,5,7,0,7,2],[2,2,1,5,5,7,2,-1,-1,-1],[2,0,5,7,7,2,0,-1,-1,-1],[1,7,5,4,-1,-1,-1,-1,-1,-1],[2,4,7,5,5,0,4,-1,-1,-1],[1,7,1,4,-1,-1,
-1,-1,-1,-1],[2,7,1,0,0,4,7,-1,-1,-1],[1,7,5,4,-1,-1,-1,-1,-1,-1],[3,2,4,7,2,7,5,2,5,0],[1,7,1,4,-1,-1,-1,-1,-1,-1],[2,7,1,2,7,2,4,-1,-1,-1],[2,5,4,7,7,3,5,-1,-1,-1],[3,3,5,0,3,0,4,3,4,7],[2,4,7,3,3,1,4,-1,-1,-1],[2,0,4,7,7,3,0,-1,-1,-1],[3,4,7,2,4,2,3,4,3,5],[2,5,0,3,4,7,2,-1,-1,-1],[2,2,1,4,2,4,7,-1,-1,-1],[1,4,7,2,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[1,7,6,2,-1,-1,-1,-1,-1,-1],[2,6,0,2,2,
7,6,-1,-1,-1],[1,7,6,2,-1,-1,-1,-1,-1,-1],[3,1,2,7,1,7,6,1,6,0],[1,3,7,6,-1,-1,-1,-1,-1,-1],[1,3,7,6,-1,-1,-1,-1,-1,-1],[2,7,6,3,3,1,7,-1,-1,-1],[3,6,3,0,6,0,1,6,1,7],[2,3,7,6,6,2,3,-1,-1,-1],[2,0,3,7,7,6,0,-1,-1,-1],[2,1,7,6,6,2,1,-1,-1,-1],[2,0,1,7,7,6,0,-1,-1,-1],[1,4,6,7,-1,-1,-1,-1,-1,-1],[2,6,7,4,4,0,6,-1,-1,-1],[1,4,6,7,-1,-1,-1,-1,-1,-1],[3,7,4,1,7,1,0,7,0,6],[1,4,2,7,-1,-1,-1,-1,-1,-1],[2,7,4,0,0,2,7,-1,-1,-1],[1,4,2,7,-1,-1,-1,-1,-1,-1],[2,1,2,7,1,7,4,-1,-1,-1],[2,7,4,6,6,3,7,-1,-1,-1],
[3,0,6,3,0,3,7,0,7,4],[3,1,7,4,1,4,6,1,6,3],[2,1,7,4,6,3,0,-1,-1,-1],[2,4,2,3,3,7,4,-1,-1,-1],[2,4,0,3,3,7,4,-1,-1,-1],[2,1,7,4,1,4,2,-1,-1,-1],[1,7,4,1,-1,-1,-1,-1,-1,-1],[1,6,7,5,-1,-1,-1,-1,-1,-1],[1,6,7,5,-1,-1,-1,-1,-1,-1],[2,5,6,7,7,1,5,-1,-1,-1],[3,0,5,6,0,6,7,0,7,1],[2,7,5,6,6,2,7,-1,-1,-1],[3,5,6,0,5,0,2,5,2,7],[3,2,7,1,2,1,5,2,5,6],[2,5,6,0,2,7,1,-1,-1,-1],[1,6,3,5,-1,-1,-1,-1,-1,-1],[1,6,3,5,-1,-1,-1,-1,-1,-1],[2,6,3,1,1,5,6,-1,-1,-1],[2,6,3,0,6,0,5,-1,-1,-1],[2,5,6,2,2,3,5,-1,-1,-1],[2,
0,3,5,0,5,6,-1,-1,-1],[2,1,5,6,6,2,1,-1,-1,-1],[1,5,6,0,-1,-1,-1,-1,-1,-1],[2,4,6,7,7,5,4,-1,-1,-1],[2,0,6,7,7,5,0,-1,-1,-1],[2,1,4,6,6,7,1,-1,-1,-1],[2,1,0,6,6,7,1,-1,-1,-1],[2,2,7,5,5,4,2,-1,-1,-1],[2,5,0,2,2,7,5,-1,-1,-1],[2,2,7,1,2,1,4,-1,-1,-1],[1,1,2,7,-1,-1,-1,-1,-1,-1],[2,3,5,4,4,6,3,-1,-1,-1],[2,0,6,3,0,3,5,-1,-1,-1],[2,3,1,4,4,6,3,-1,-1,-1],[1,3,0,6,-1,-1,-1,-1,-1,-1],[2,5,4,2,2,3,5,-1,-1,-1],[1,0,3,5,-1,-1,-1,-1,-1,-1],[1,2,1,4,-1,-1,-1,-1,-1,-1],[0,-1,-1,-1,-1,-1,-1,-1,-1,-1]];
function Hj(og){this.precision=og.precision;this.ye=og.type;this.ve=og.radius;this.fe=new Float32Array(og.aBuf);this.mb=this.ib=this.fb=this.v=this.Pc=this.Zc=this.nb=this.bounds=void 0}Hj.Rc={Ei:0,Ci:1,zi:2};Hj.Qc=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1],[1,1,0],[1,-1,0],[-1,1,0],[-1,-1,0],[1,0,1],[1,0,-1],[-1,0,1],[-1,0,-1],[0,1,1],[0,1,-1],[0,-1,1],[0,-1,-1],[1,1,1],[1,1,-1],[1,-1,1],[-1,1,1],[1,-1,-1],[-1,-1,1],[-1,1,-1],[-1,-1,-1]];xg=Hj.prototype;
xg.init=function(){this.Pc=.7/this.precision;this.xc=1/this.Pc;this.bounds=this.bounds||Fj.bounds(this.fe);this.nb=this.bounds[0];this.Zc=this.bounds[1];var og;og=3+this.ve;this.nb.x+=-og;this.nb.y+=-og;this.nb.z+=-og;this.Zc.x+=og;this.Zc.y+=og;this.Zc.z+=og;this.fb=Math.ceil((this.Zc.x-this.nb.x)*this.xc)+1;this.ib=Math.ceil((this.Zc.y-this.nb.y)*this.xc)+1;this.mb=Math.ceil((this.Zc.z-this.nb.z)*this.xc)+1;this.v=Array(this.fb);for(og=0;og<this.fb;og++){this.v[og]=Array(this.ib);for(var pg=0;pg<
this.ib;pg++){this.v[og][pg]=Array(this.mb);for(var qg=0;qg<this.mb;qg++)this.v[og][pg][qg]={sB:!1,nd:!1,Lc:!1,aa:!1,distance:-1,gd:[]}}}};
xg.dx=function(){for(var og=this.fe.length/4,pg=new Map,qg,rg,sg=0;sg<og;sg++){var tg=this.fe[4*sg],ug=this.fe[4*sg+1],yg=this.fe[4*sg+2],Bg=this.fe[4*sg+3],Cg=Math.round((tg-this.nb.x)*this.xc),Ag=Math.round((ug-this.nb.y)*this.xc),wg=Math.round((yg-this.nb.z)*this.xc);this.v[Cg][Ag][wg].rB=!0;this.v[Cg][Ag][wg].nd=!0;this.v[Cg][Ag][wg].gd.push(sg);qg=pg.get(Bg);if(null==qg){rg=(Bg+this.ve)*this.xc+.5;var Dg=rg*rg;rg=Math.ceil(rg);qg=Array(rg*rg);for(var Eg=0,Fg=0;Fg<rg;Fg++)for(var Jg=0;Jg<rg;Jg++){var Ig=
Fg*Fg+Jg*Jg;qg[Eg]=Ig>Dg?-1:Math.trunc(Math.sqrt(Dg-Ig));Eg++}pg.set(Bg,[rg,qg])}else rg=qg[0],qg=qg[1];for(Eg=Dg=0;Eg<rg;Eg++)for(Fg=0;Fg<rg;Fg++){for(Ig=-1;2>Ig;Ig++)for(var Lg=-1;2>Lg;Lg++)for(var Kg=-1;2>Kg;Kg++)if(0!=Ig&&0!=Lg&&0!=Kg)for(var Mg=Cg+Ig*Eg,Og=wg+Kg*Fg,Jg=0;Jg<rg;Jg++)if(0!=Eg||0!=Fg||0!=Jg){var Sg=Ag+Jg*Lg;if(!(0>Mg||0>Sg||0>Og||Mg>=this.fb||Sg>=this.ib||Og>=this.mb)){if(Eg>=qg[Dg]||Fg>=qg[Dg]||Jg>=qg[Dg]){var Qg={x:(Mg-.5)*this.Pc+this.nb.x,y:(Sg-.5)*this.Pc+this.nb.y,z:(Og-.5)*
this.Pc+this.nb.z};if(!Fj.Pw(Qg,{x:Qg.x+this.Pc,y:Qg.y+this.Pc,z:Qg.z+this.Pc},{x:tg,y:ug,z:yg},Bg+this.ve))break}this.v[Mg][Sg][Og].nd=!0;this.v[Mg][Sg][Og].gd.push(sg)}}Dg++}}for(pg=og=0;pg<this.fb;pg++)for(sg=this.v[pg],tg=0;tg<this.ib;tg++)for(ug=sg[tg],yg=0;yg<this.mb;yg++)Bg=ug[yg],Bg.nd&&(Bg.aa=!0,og++)};
xg.ow=function(){for(var og=0;og<this.fb;og++)for(var pg=this.v[og],qg=0;qg<this.ib;qg++)for(var rg=pg[qg],sg=0;sg<this.mb;sg++){var tg=rg[sg];if(tg.nd)for(var ug=0;26>ug;)if(-1<og+Hj.Qc[ug][0]&&og+Hj.Qc[ug][0]<this.fb&&-1<qg+Hj.Qc[ug][1]&&qg+Hj.Qc[ug][1]<this.ib&&-1<sg+Hj.Qc[ug][2]&&sg+Hj.Qc[ug][2]<this.mb&&!this.v[og+Hj.Qc[ug][0]][qg+Hj.Qc[ug][1]][sg+Hj.Qc[ug][2]].nd){tg.Lc=!0;break}else ug++}};
xg.bx=function(){if(this.ye===Hj.Rc.zi){var og,pg,qg,rg,sg=rg=0,tg=Array(this.fb);for(og=0;og<this.fb;og++)for(tg[og]=Array(this.ib),pg=0;pg<this.ib;pg++)for(tg[og][pg]=Array(this.mb),qg=0;qg<this.mb;qg++){var ug=this.v[og][pg][qg],yg=tg[og][pg][qg]={Zb:void 0,$b:void 0,ac:void 0};ug.aa=!1;ug.nd&&(ug.Lc?(rg++,yg.Zb=og,yg.$b=pg,yg.ac=qg,ug.distance=0,ug.aa=!0):sg++)}ug=Math.trunc(1.2*rg);yg=Math.trunc(1.2*rg);ug>sg&&(ug=sg);ug<rg&&(ug=rg);yg>sg&&(yg=sg);var Bg=Array(ug);for(qg=0;qg<ug;qg++)Bg[qg]=
{Zb:void 0,$b:void 0,ac:void 0};var Cg=Array(yg);for(qg=0;qg<yg;qg++)Cg[qg]={Zb:void 0,$b:void 0,ac:void 0};for(og=rg=0;og<this.fb;og++)for(pg=0;pg<this.ib;pg++)for(qg=0;qg<this.mb;qg++)this.v[og][pg][qg].Lc&&(Bg[rg].Zb=og,Bg[rg].$b=pg,Bg[rg].ac=qg,rg++,this.v[og][pg][qg].Lc=!1);do for(pg=this.cx(rg,yg,tg,Bg,Cg,sg)[0],og=rg=0;og<pg;og++)if(this.v[Cg[og].Zb][Cg[og].$b][Cg[og].ac].Lc=!1,Math.sqrt(this.v[Cg[og].Zb][Cg[og].$b][Cg[og].ac].distance)<=1.02*this.ve*this.xc&&(Bg[rg].Zb=Cg[og].Zb,Bg[rg].$b=
Cg[og].$b,Bg[rg].ac=Cg[og].ac,rg++),rg>=ug){qg=ug;ug*=2;ug>sg&&(ug=sg);for(var Ag=0;Ag<ug-qg;Ag++)Bg.push({Zb:void 0,$b:void 0,ac:void 0})}while(0!=rg);sg=this.xc-.5;0>sg&&(sg=0);for(og=0;og<this.fb;og++)for(pg=0;pg<this.ib;pg++)for(qg=0;qg<this.mb;qg++)ug=this.v[og][pg][qg],ug.Lc=!1,ug.nd&&(!ug.aa||ug.aa&&Math.sqrt(ug.distance)>=this.ve*this.xc-.5/(.1+sg))&&(ug.Lc=!0,ug.aa&&(ug.gd=this.v[tg[og][pg][qg].Zb][tg[og][pg][qg].$b][tg[og][pg][qg].ac].gd))}};
xg.cx=function(og,pg,qg,rg,sg,tg){var ug,yg,Bg,Cg,Ag,wg,Dg,Eg,Fg=0;yg=0;if(0!=og){var Jg,Ig,Lg,Kg;for(ug=0;ug<og;ug++){if(yg>=pg-26)for(Bg=pg,pg=Math.trunc(1.2*pg),pg>tg&&(pg=tg),Cg=0;Cg<pg-Bg;Cg++)sg.push({Zb:void 0,$b:void 0,ac:void 0});Bg=rg[ug].Zb;Cg=rg[ug].$b;Ag=rg[ug].ac;for(Jg=0;Jg<Hj.Qc.length;Jg++)if(Ig=Bg+Hj.Qc[Jg][0],Lg=Cg+Hj.Qc[Jg][1],Kg=Ag+Hj.Qc[Jg][2],Ig<this.fb&&-1<Ig&&Lg<this.ib&&-1<Lg&&Kg<this.mb&&-1<Kg){var Mg=this.v[Ig][Lg][Kg],Og=qg[Bg][Cg][Ag];wg=Ig-Og.Zb;Dg=Lg-Og.$b;Eg=Kg-Og.ac;
wg+=0<=wg?.5:-.5;Dg+=0<=Dg?.5:-.5;Eg+=0<=Eg?.5:-.5;wg=wg*wg+Dg*Dg+Eg*Eg;Mg.nd&&!Mg.aa?(qg[Ig][Lg][Kg].Zb=Og.Zb,qg[Ig][Lg][Kg].$b=Og.$b,qg[Ig][Lg][Kg].ac=Og.ac,Mg.distance=wg,Mg.aa=!0,Mg.Lc=!0,sg[yg].Zb=Ig,sg[yg].$b=Lg,sg[yg].ac=Kg,yg++,Fg++):Mg.nd&&Mg.aa&&wg<Mg.distance&&(qg[Ig][Lg][Kg].Zb=Og.Zb,qg[Ig][Lg][Kg].$b=Og.$b,qg[Ig][Lg][Kg].ac=Og.ac,Mg.distance=wg,Mg.Lc||(Mg.Lc=!0,sg[yg].Zb=Ig,sg[yg].$b=Lg,sg[yg].ac=Kg,yg++))}}return[yg,Fg]}};
xg.Dv=function(){for(var og=this.ff.vertices,pg=this.ff.faces,qg=new Float32Array(4*og.length),rg=new Uint32Array(3*pg.length),sg=0;sg<og.length;sg++){var tg=og[sg];qg[4*sg]=tg.x;qg[4*sg+1]=tg.y;qg[4*sg+2]=tg.z;qg[4*sg+3]=tg.gd}for(og=0;og<pg.length;og++)sg=pg[og],rg[3*og]=sg.a,rg[3*og+1]=sg.b,rg[3*og+2]=sg.c;this.ff.vertices=qg.buffer;this.ff.faces=rg.buffer};
xg.ez=function(){var og,pg,qg;if(this.ye===Hj.Rc.Ei||this.ye===Hj.Rc.Ci)for(og=0;og<this.fb;og++)for(pg=0;pg<this.ib;pg++)for(qg=0;qg<this.mb;qg++)this.v[og][pg][qg].Lc=!1;else if(this.ye===Hj.Rc.zi)for(og=0;og<this.fb;og++)for(pg=0;pg<this.ib;pg++)for(qg=0;qg<this.mb;qg++)this.v[og][pg][qg].aa=!1,this.v[og][pg][qg].Lc&&(this.v[og][pg][qg].aa=!0),this.v[og][pg][qg].Lc=!1};
xg.dz=function(){var og,pg,qg;this.ez();var rg=Array(this.fb);for(og=0;og<this.fb;og++)rg[og]=Array(this.ib);for(og=0;og<this.fb;og++)for(pg=0;pg<this.ib;pg++)rg[og][pg]=Array(this.mb);for(og=0;og<this.fb;og++)for(pg=0;pg<this.ib;pg++)for(qg=0;qg<this.mb;qg++)rg[og][pg][qg]=-1;var sg=2*(this.mb*this.fb+this.ib*this.fb+this.mb*this.ib),tg=2*sg,ug=0,yg=0,Bg=Array(sg);for(og=0;og<sg;og++)Bg[og]=new xj;var Cg=Array(tg);for(og=0;og<tg;og++)Cg[og]=new Ej;var Ag,wg,Dg;wg=Array.apply(null,Array(6)).map(function(){return Array(3)});
for(og=0;1>og;og++)for(pg=0;pg<this.ib-1;pg++)for(qg=0;qg<this.mb-1;qg++)if(this.v[og][pg][qg].aa&&this.v[og][pg+1][qg].aa&&this.v[og][pg+1][qg+1].aa&&this.v[og][pg][qg+1].aa){wg[0][0]=og;wg[0][1]=pg;wg[0][2]=qg;wg[1][0]=og;wg[1][1]=pg+1;wg[1][2]=qg;wg[2][0]=og;wg[2][1]=pg+1;wg[2][2]=qg+1;wg[3][0]=og;wg[3][1]=pg;wg[3][2]=qg+1;for(Ag=0;4>Ag;Ag++)-1==rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]&&(rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]=yg,Bg[yg].x=wg[Ag][0],Bg[yg].y=wg[Ag][1],Bg[yg].z=wg[Ag][2],yg++);Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];
Cg[ug].c=rg[wg[1][0]][wg[1][1]][wg[1][2]];Cg[ug++].b=rg[wg[2][0]][wg[2][1]][wg[2][2]];Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].c=rg[wg[2][0]][wg[2][1]][wg[2][2]];Cg[ug++].b=rg[wg[3][0]][wg[3][1]][wg[3][2]]}else if(this.v[og][pg][qg].aa&&this.v[og][pg+1][qg].aa&&this.v[og][pg+1][qg+1].aa||this.v[og][pg+1][qg].aa&&this.v[og][pg+1][qg+1].aa&&this.v[og][pg][qg+1].aa||this.v[og][pg+1][qg+1].aa&&this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa||this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa&&this.v[og][pg+
1][qg].aa){this.v[og][pg][qg].aa&&this.v[og][pg+1][qg].aa&&this.v[og][pg+1][qg+1].aa?(wg[0][0]=og,wg[0][1]=pg,wg[0][2]=qg,wg[1][0]=og,wg[1][1]=pg+1,wg[1][2]=qg,wg[2][0]=og,wg[2][1]=pg+1,wg[2][2]=qg+1):this.v[og][pg+1][qg].aa&&this.v[og][pg+1][qg+1].aa&&this.v[og][pg][qg+1].aa?(wg[0][0]=og,wg[0][1]=pg+1,wg[0][2]=qg,wg[1][0]=og,wg[1][1]=pg+1,wg[1][2]=qg+1,wg[2][0]=og,wg[2][1]=pg,wg[2][2]=qg+1):this.v[og][pg+1][qg+1].aa&&this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa?(wg[0][0]=og,wg[0][1]=pg+1,wg[0][2]=
qg+1,wg[1][0]=og,wg[1][1]=pg,wg[1][2]=qg+1,wg[2][0]=og,wg[2][1]=pg,wg[2][2]=qg):this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa&&this.v[og][pg+1][qg].aa&&(wg[0][0]=og,wg[0][1]=pg,wg[0][2]=qg+1,wg[1][0]=og,wg[1][1]=pg,wg[1][2]=qg,wg[2][0]=og,wg[2][1]=pg+1,wg[2][2]=qg);for(Ag=0;3>Ag;Ag++)-1==rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]&&(rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]=yg,Bg[yg].x=wg[Ag][0],Bg[yg].y=wg[Ag][1],Bg[yg].z=wg[Ag][2],yg++);Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].c=rg[wg[1][0]][wg[1][1]][wg[1][2]];
Cg[ug++].b=rg[wg[2][0]][wg[2][1]][wg[2][2]]}for(og=0;og<this.fb-1;og++)for(pg=0;1>pg;pg++)for(qg=0;qg<this.mb-1;qg++)if(this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&this.v[og+1][pg][qg+1].aa&&this.v[og][pg][qg+1].aa){wg[0][0]=og;wg[0][1]=pg;wg[0][2]=qg;wg[1][0]=og+1;wg[1][1]=pg;wg[1][2]=qg;wg[2][0]=og+1;wg[2][1]=pg;wg[2][2]=qg+1;wg[3][0]=og;wg[3][1]=pg;wg[3][2]=qg+1;for(Ag=0;4>Ag;Ag++)-1==rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]&&(rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]=yg,Bg[yg].x=wg[Ag][0],Bg[yg].y=wg[Ag][1],
Bg[yg].z=wg[Ag][2],yg++);Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].b=rg[wg[1][0]][wg[1][1]][wg[1][2]];Cg[ug++].c=rg[wg[2][0]][wg[2][1]][wg[2][2]];Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].b=rg[wg[2][0]][wg[2][1]][wg[2][2]];Cg[ug++].c=rg[wg[3][0]][wg[3][1]][wg[3][2]]}else if(this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&this.v[og+1][pg][qg+1].aa||this.v[og+1][pg][qg].aa&&this.v[og+1][pg][qg+1].aa&&this.v[og][pg][qg+1].aa||this.v[og+1][pg][qg+1].aa&&this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa||
this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa){this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&this.v[og+1][pg][qg+1].aa?(wg[0][0]=og,wg[0][1]=pg,wg[0][2]=qg,wg[1][0]=og+1,wg[1][1]=pg,wg[1][2]=qg,wg[2][0]=og+1,wg[2][1]=pg,wg[2][2]=qg+1):this.v[og+1][pg][qg].aa&&this.v[og+1][pg][qg+1].aa&&this.v[og][pg][qg+1].aa?(wg[0][0]=og+1,wg[0][1]=pg,wg[0][2]=qg,wg[1][0]=og+1,wg[1][1]=pg,wg[1][2]=qg+1,wg[2][0]=og,wg[2][1]=pg,wg[2][2]=qg+1):this.v[og+1][pg][qg+1].aa&&this.v[og][pg][qg+
1].aa&&this.v[og][pg][qg].aa?(wg[0][0]=og+1,wg[0][1]=pg,wg[0][2]=qg+1,wg[1][0]=og,wg[1][1]=pg,wg[1][2]=qg+1,wg[2][0]=og,wg[2][1]=pg,wg[2][2]=qg):this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&(wg[0][0]=og,wg[0][1]=pg,wg[0][2]=qg+1,wg[1][0]=og,wg[1][1]=pg,wg[1][2]=qg,wg[2][0]=og+1,wg[2][1]=pg,wg[2][2]=qg);for(Ag=0;3>Ag;Ag++)-1==rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]&&(rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]=yg,Bg[yg].x=wg[Ag][0],Bg[yg].y=wg[Ag][1],Bg[yg].z=wg[Ag][2],yg++);Cg[ug].a=
rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].b=rg[wg[1][0]][wg[1][1]][wg[1][2]];Cg[ug++].c=rg[wg[2][0]][wg[2][1]][wg[2][2]]}for(og=0;og<this.fb-1;og++)for(pg=0;pg<this.ib-1;pg++)for(qg=0;1>qg;qg++)if(this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&this.v[og+1][pg+1][qg].aa&&this.v[og][pg+1][qg].aa){wg[0][0]=og;wg[0][1]=pg;wg[0][2]=qg;wg[1][0]=og+1;wg[1][1]=pg;wg[1][2]=qg;wg[2][0]=og+1;wg[2][1]=pg+1;wg[2][2]=qg;wg[3][0]=og;wg[3][1]=pg+1;wg[3][2]=qg;for(Ag=0;4>Ag;Ag++)-1==rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]&&
(rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]=yg,Bg[yg].x=wg[Ag][0],Bg[yg].y=wg[Ag][1],Bg[yg].z=wg[Ag][2],yg++);Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].c=rg[wg[1][0]][wg[1][1]][wg[1][2]];Cg[ug++].b=rg[wg[2][0]][wg[2][1]][wg[2][2]];Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].c=rg[wg[2][0]][wg[2][1]][wg[2][2]];Cg[ug++].b=rg[wg[3][0]][wg[3][1]][wg[3][2]]}else if(this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&this.v[og+1][pg+1][qg].aa||this.v[og+1][pg][qg].aa&&this.v[og+1][pg+1][qg].aa&&this.v[og][pg+
1][qg].aa||this.v[og+1][pg+1][qg].aa&&this.v[og][pg+1][qg].aa&&this.v[og][pg][qg].aa||this.v[og][pg+1][qg].aa&&this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa){this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&this.v[og+1][pg+1][qg].aa?(wg[0][0]=og,wg[0][1]=pg,wg[0][2]=qg,wg[1][0]=og+1,wg[1][1]=pg,wg[1][2]=qg,wg[2][0]=og+1,wg[2][1]=pg+1,wg[2][2]=qg):this.v[og+1][pg][qg].aa&&this.v[og+1][pg+1][qg].aa&&this.v[og][pg+1][qg].aa?(wg[0][0]=og+1,wg[0][1]=pg,wg[0][2]=qg,wg[1][0]=og+1,wg[1][1]=pg+1,wg[1][2]=
qg,wg[2][0]=og,wg[2][1]=pg+1,wg[2][2]=qg):this.v[og+1][pg+1][qg].aa&&this.v[og][pg+1][qg].aa&&this.v[og][pg][qg].aa?(wg[0][0]=og+1,wg[0][1]=pg+1,wg[0][2]=qg,wg[1][0]=og,wg[1][1]=pg+1,wg[1][2]=qg,wg[2][0]=og,wg[2][1]=pg,wg[2][2]=qg):this.v[og][pg+1][qg].aa&&this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&(wg[0][0]=og,wg[0][1]=pg+1,wg[0][2]=qg,wg[1][0]=og,wg[1][1]=pg,wg[1][2]=qg,wg[2][0]=og+1,wg[2][1]=pg,wg[2][2]=qg);for(Ag=0;3>Ag;Ag++)-1==rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]&&(rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]=
yg,Bg[yg].x=wg[Ag][0],Bg[yg].y=wg[Ag][1],Bg[yg].z=wg[Ag][2],yg++);Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].c=rg[wg[1][0]][wg[1][1]][wg[1][2]];Cg[ug++].b=rg[wg[2][0]][wg[2][1]][wg[2][2]]}for(og=this.fb-1;og<this.fb;og++)for(pg=0;pg<this.ib-1;pg++)for(qg=0;qg<this.mb-1;qg++)if(this.v[og][pg][qg].aa&&this.v[og][pg+1][qg].aa&&this.v[og][pg+1][qg+1].aa&&this.v[og][pg][qg+1].aa){wg[0][0]=og;wg[0][1]=pg;wg[0][2]=qg;wg[1][0]=og;wg[1][1]=pg+1;wg[1][2]=qg;wg[2][0]=og;wg[2][1]=pg+1;wg[2][2]=qg+1;wg[3][0]=
og;wg[3][1]=pg;wg[3][2]=qg+1;for(Ag=0;4>Ag;Ag++)-1==rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]&&(rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]=yg,Bg[yg].x=wg[Ag][0],Bg[yg].y=wg[Ag][1],Bg[yg].z=wg[Ag][2],yg++);Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].b=rg[wg[1][0]][wg[1][1]][wg[1][2]];Cg[ug++].c=rg[wg[2][0]][wg[2][1]][wg[2][2]];Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].b=rg[wg[2][0]][wg[2][1]][wg[2][2]];Cg[ug++].c=rg[wg[3][0]][wg[3][1]][wg[3][2]]}else if(this.v[og][pg][qg].aa&&this.v[og][pg+1][qg].aa&&
this.v[og][pg+1][qg+1].aa||this.v[og][pg+1][qg].aa&&this.v[og][pg+1][qg+1].aa&&this.v[og][pg][qg+1].aa||this.v[og][pg+1][qg+1].aa&&this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa||this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa&&this.v[og][pg+1][qg].aa){this.v[og][pg][qg].aa&&this.v[og][pg+1][qg].aa&&this.v[og][pg+1][qg+1].aa?(wg[0][0]=og,wg[0][1]=pg,wg[0][2]=qg,wg[1][0]=og,wg[1][1]=pg+1,wg[1][2]=qg,wg[2][0]=og,wg[2][1]=pg+1,wg[2][2]=qg+1):this.v[og][pg+1][qg].aa&&this.v[og][pg+1][qg+1].aa&&this.v[og][pg][qg+
1].aa?(wg[0][0]=og,wg[0][1]=pg+1,wg[0][2]=qg,wg[1][0]=og,wg[1][1]=pg+1,wg[1][2]=qg+1,wg[2][0]=og,wg[2][1]=pg,wg[2][2]=qg+1):this.v[og][pg+1][qg+1].aa&&this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa?(wg[0][0]=og,wg[0][1]=pg+1,wg[0][2]=qg+1,wg[1][0]=og,wg[1][1]=pg,wg[1][2]=qg+1,wg[2][0]=og,wg[2][1]=pg,wg[2][2]=qg):this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa&&this.v[og][pg+1][qg].aa&&(wg[0][0]=og,wg[0][1]=pg,wg[0][2]=qg+1,wg[1][0]=og,wg[1][1]=pg,wg[1][2]=qg,wg[2][0]=og,wg[2][1]=pg+1,wg[2][2]=qg);
for(Ag=0;3>Ag;Ag++)-1==rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]&&(rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]=yg,Bg[yg].x=wg[Ag][0],Bg[yg].y=wg[Ag][1],Bg[yg].z=wg[Ag][2],yg++);Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].b=rg[wg[1][0]][wg[1][1]][wg[1][2]];Cg[ug++].c=rg[wg[2][0]][wg[2][1]][wg[2][2]]}for(og=0;og<this.fb-1;og++)for(pg=this.ib-1;pg<this.ib;pg++)for(qg=0;qg<this.mb-1;qg++)if(this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&this.v[og+1][pg][qg+1].aa&&this.v[og][pg][qg+1].aa){wg[0][0]=og;wg[0][1]=
pg;wg[0][2]=qg;wg[1][0]=og+1;wg[1][1]=pg;wg[1][2]=qg;wg[2][0]=og+1;wg[2][1]=pg;wg[2][2]=qg+1;wg[3][0]=og;wg[3][1]=pg;wg[3][2]=qg+1;for(Ag=0;4>Ag;Ag++)-1==rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]&&(rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]=yg,Bg[yg].x=wg[Ag][0],Bg[yg].y=wg[Ag][1],Bg[yg].z=wg[Ag][2],yg++);Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].c=rg[wg[1][0]][wg[1][1]][wg[1][2]];Cg[ug++].b=rg[wg[2][0]][wg[2][1]][wg[2][2]];Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].c=rg[wg[2][0]][wg[2][1]][wg[2][2]];
Cg[ug++].b=rg[wg[3][0]][wg[3][1]][wg[3][2]]}else if(this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&this.v[og+1][pg][qg+1].aa||this.v[og+1][pg][qg].aa&&this.v[og+1][pg][qg+1].aa&&this.v[og][pg][qg+1].aa||this.v[og+1][pg][qg+1].aa&&this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa||this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa){this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&this.v[og+1][pg][qg+1].aa?(wg[0][0]=og,wg[0][1]=pg,wg[0][2]=qg,wg[1][0]=og+1,wg[1][1]=pg,wg[1][2]=qg,
wg[2][0]=og+1,wg[2][1]=pg,wg[2][2]=qg+1):this.v[og+1][pg][qg].aa&&this.v[og+1][pg][qg+1].aa&&this.v[og][pg][qg+1].aa?(wg[0][0]=og+1,wg[0][1]=pg,wg[0][2]=qg,wg[1][0]=og+1,wg[1][1]=pg,wg[1][2]=qg+1,wg[2][0]=og,wg[2][1]=pg,wg[2][2]=qg+1):this.v[og+1][pg][qg+1].aa&&this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa?(wg[0][0]=og+1,wg[0][1]=pg,wg[0][2]=qg+1,wg[1][0]=og,wg[1][1]=pg,wg[1][2]=qg+1,wg[2][0]=og,wg[2][1]=pg,wg[2][2]=qg):this.v[og][pg][qg+1].aa&&this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&(wg[0][0]=
og,wg[0][1]=pg,wg[0][2]=qg+1,wg[1][0]=og,wg[1][1]=pg,wg[1][2]=qg,wg[2][0]=og+1,wg[2][1]=pg,wg[2][2]=qg);for(Ag=0;3>Ag;Ag++)-1==rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]&&(rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]=yg,Bg[yg].x=wg[Ag][0],Bg[yg].y=wg[Ag][1],Bg[yg].z=wg[Ag][2],yg++);Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].c=rg[wg[1][0]][wg[1][1]][wg[1][2]];Cg[ug++].b=rg[wg[2][0]][wg[2][1]][wg[2][2]]}for(og=0;og<this.fb-1;og++)for(pg=0;pg<this.ib-1;pg++)for(qg=this.mb-1;qg<this.mb;qg++)if(this.v[og][pg][qg].aa&&
this.v[og+1][pg][qg].aa&&this.v[og+1][pg+1][qg].aa&&this.v[og][pg+1][qg].aa){wg[0][0]=og;wg[0][1]=pg;wg[0][2]=qg;wg[1][0]=og+1;wg[1][1]=pg;wg[1][2]=qg;wg[2][0]=og+1;wg[2][1]=pg+1;wg[2][2]=qg;wg[3][0]=og;wg[3][1]=pg+1;wg[3][2]=qg;for(Ag=0;4>Ag;Ag++)-1==rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]&&(rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]=yg,Bg[yg].x=wg[Ag][0],Bg[yg].y=wg[Ag][1],Bg[yg].z=wg[Ag][2],yg++);Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].b=rg[wg[1][0]][wg[1][1]][wg[1][2]];Cg[ug++].c=rg[wg[2][0]][wg[2][1]][wg[2][2]];
Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].b=rg[wg[2][0]][wg[2][1]][wg[2][2]];Cg[ug++].c=rg[wg[3][0]][wg[3][1]][wg[3][2]]}else if(this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&this.v[og+1][pg+1][qg].aa||this.v[og+1][pg][qg].aa&&this.v[og+1][pg+1][qg].aa&&this.v[og][pg+1][qg].aa||this.v[og+1][pg+1][qg].aa&&this.v[og][pg+1][qg].aa&&this.v[og][pg][qg].aa||this.v[og][pg+1][qg].aa&&this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa){this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&this.v[og+1][pg+1][qg].aa?
(wg[0][0]=og,wg[0][1]=pg,wg[0][2]=qg,wg[1][0]=og+1,wg[1][1]=pg,wg[1][2]=qg,wg[2][0]=og+1,wg[2][1]=pg+1,wg[2][2]=qg):this.v[og+1][pg][qg].aa&&this.v[og+1][pg+1][qg].aa&&this.v[og][pg+1][qg].aa?(wg[0][0]=og+1,wg[0][1]=pg,wg[0][2]=qg,wg[1][0]=og+1,wg[1][1]=pg+1,wg[1][2]=qg,wg[2][0]=og,wg[2][1]=pg+1,wg[2][2]=qg):this.v[og+1][pg+1][qg].aa&&this.v[og][pg+1][qg].aa&&this.v[og][pg][qg].aa?(wg[0][0]=og+1,wg[0][1]=pg+1,wg[0][2]=qg,wg[1][0]=og,wg[1][1]=pg+1,wg[1][2]=qg,wg[2][0]=og,wg[2][1]=pg,wg[2][2]=qg):this.v[og][pg+
1][qg].aa&&this.v[og][pg][qg].aa&&this.v[og+1][pg][qg].aa&&(wg[0][0]=og,wg[0][1]=pg+1,wg[0][2]=qg,wg[1][0]=og,wg[1][1]=pg,wg[1][2]=qg,wg[2][0]=og+1,wg[2][1]=pg,wg[2][2]=qg);for(Ag=0;3>Ag;Ag++)-1==rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]&&(rg[wg[Ag][0]][wg[Ag][1]][wg[Ag][2]]=yg,Bg[yg].x=wg[Ag][0],Bg[yg].y=wg[Ag][1],Bg[yg].z=wg[Ag][2],yg++);Cg[ug].a=rg[wg[0][0]][wg[0][1]][wg[0][2]];Cg[ug].b=rg[wg[1][0]][wg[1][1]][wg[1][2]];Cg[ug++].c=rg[wg[2][0]][wg[2][1]][wg[2][2]]}var Eg,Fg=Array(8),Jg=Array.apply(null,
Array(8)).map(function(){return Array(3)}),Ig=Array(3);for(og=0;og<this.fb-1;og++)for(pg=0;pg<this.ib-1;pg++)for(qg=0;qg<this.mb-1;qg++){wg=1;for(Ag=Eg=0;8>Ag;Ag++)Jg[Ag][0]=og+Gj.sm[Ag][0],Jg[Ag][1]=pg+Gj.sm[Ag][1],Jg[Ag][2]=qg+Gj.sm[Ag][2],Fg[Ag]=this.v[Jg[Ag][0]][Jg[Ag][1]][Jg[Ag][2]].aa?1:0,Eg+=Fg[Ag]*wg,wg*=2;wg=1;for(Ag=0;Ag<Gj.yp[Eg][0];Ag++){for(Dg=0;3>Dg;Dg++)Ig[Dg]=Gj.yp[Eg][wg+Dg],-1==rg[Jg[Ig[Dg]][0]][Jg[Ig[Dg]][1]][Jg[Ig[Dg]][2]]&&(rg[Jg[Ig[Dg]][0]][Jg[Ig[Dg]][1]][Jg[Ig[Dg]][2]]=yg,Bg[yg].x=
Jg[Ig[Dg]][0],Bg[yg].y=Jg[Ig[Dg]][1],Bg[yg].z=Jg[Ig[Dg]][2],yg++);wg+=3;Cg[ug].a=rg[Jg[Ig[0]][0]][Jg[Ig[0]][1]][Jg[Ig[0]][2]];Cg[ug].b=rg[Jg[Ig[1]][0]][Jg[Ig[1]][1]][Jg[Ig[1]][2]];Cg[ug++].c=rg[Jg[Ig[2]][0]][Jg[Ig[2]][1]][Jg[Ig[2]][2]]}if(yg+6>sg){for(wg=0;wg<sg;wg++)Bg.push(new xj);sg*=2}if(ug+3>tg){for(wg=0;wg<tg;wg++)Cg.push(new Ej);tg*=2}}Bg.splice(yg);Cg.splice(ug);for(og=0;og<yg;og++)pg=this.v[Bg[og].x][Bg[og].y][Bg[og].z],Bg[og].cs=!1,pg.Lc&&(Bg[og].cs=!0);for(og=0;og<ug;og++){qg=Cg[og];pg=
this.v[Bg[qg.a].x][Bg[qg.a].y][Bg[qg.a].z].gd;yg=[[Bg[qg.a].x,Bg[qg.a].y,Bg[qg.a].z],[Bg[qg.b].x,Bg[qg.b].y,Bg[qg.b].z],[Bg[qg.c].x,Bg[qg.c].y,Bg[qg.c].z]];qg=[qg.a,qg.b,qg.c];rg=!0;sg=!1;tg=void 0;try{for(var Lg=pg[Symbol.iterator](),Kg;!(rg=(Kg=Lg.next()).done);rg=!0){var Mg=Kg.value,Og=[(this.fe[4*Mg]-this.nb.x)*this.xc,(this.fe[4*Mg+1]-this.nb.y)*this.xc,(this.fe[4*Mg+2]-this.nb.z)*this.xc],Sg=this.fe[4*Mg+3]*this.xc;for(pg=0;3>pg;pg++){var Qg=(yg[pg][0]-Og[0])*(yg[pg][0]-Og[0])+(yg[pg][1]-Og[1])*
(yg[pg][1]-Og[1])+(yg[pg][2]-Og[2])*(yg[pg][2]-Og[2]),Qg=Math.sqrt(Qg)-Sg,vh=Bg[qg[pg]];Qg<vh.nq&&(vh.nq=Qg,vh.gd=Mg)}}}catch(dh){sg=!0,tg=dh}finally{try{!rg&&Lg["return"]&&Lg["return"]()}finally{if(sg)throw tg;}}}this.ff={vertices:Bg,faces:Cg,minBound:this.nb,maxBound:this.Zc,voxelSize:this.Pc}};
xg.Xy=function(){for(var og=this.ff.vertices,pg=this.ff.faces,qg=og.length,rg=pg.length,sg=Array(qg),tg=0;tg<qg;tg++)sg[tg]={x:void 0,y:void 0,z:void 0};for(var ug=Array(20),yg,Bg,tg=0;20>tg;tg++)ug[tg]=new Int32Array(qg);for(tg=0;tg<qg;tg++)ug[0][tg]=0;for(tg=0;tg<rg;tg++){Bg=!0;for(yg=0;yg<ug[0][pg[tg].a];yg++)if(pg[tg].b==ug[yg+1][pg[tg].a]){Bg=!1;break}Bg&&(ug[0][pg[tg].a]++,ug[ug[0][pg[tg].a]][pg[tg].a]=pg[tg].b);Bg=!0;for(yg=0;yg<ug[0][pg[tg].a];yg++)if(pg[tg].c==ug[yg+1][pg[tg].a]){Bg=!1;break}Bg&&
(ug[0][pg[tg].a]++,ug[ug[0][pg[tg].a]][pg[tg].a]=pg[tg].c);Bg=!0;for(yg=0;yg<ug[0][pg[tg].b];yg++)if(pg[tg].a==ug[yg+1][pg[tg].b]){Bg=!1;break}Bg&&(ug[0][pg[tg].b]++,ug[ug[0][pg[tg].b]][pg[tg].b]=pg[tg].a);Bg=!0;for(yg=0;yg<ug[0][pg[tg].b];yg++)if(pg[tg].c==ug[yg+1][pg[tg].b]){Bg=!1;break}Bg&&(ug[0][pg[tg].b]++,ug[ug[0][pg[tg].b]][pg[tg].b]=pg[tg].c);Bg=!0;for(yg=0;yg<ug[0][pg[tg].c];yg++)if(pg[tg].a==ug[yg+1][pg[tg].c]){Bg=!1;break}Bg&&(ug[0][pg[tg].c]++,ug[ug[0][pg[tg].c]][pg[tg].c]=pg[tg].a);Bg=
!0;for(yg=0;yg<ug[0][pg[tg].c];yg++)if(pg[tg].b==ug[yg+1][pg[tg].c]){Bg=!1;break}Bg&&(ug[0][pg[tg].c]++,ug[ug[0][pg[tg].c]][pg[tg].c]=pg[tg].b)}Bg=.75/(this.xc+3.5);for(rg=0;1>rg;rg++){for(tg=0;tg<qg;tg++){var Cg=sg[tg],Ag=og[tg];if(3>ug[0][tg])Cg.x=Ag.x,Cg.y=Ag.y,Cg.z=Ag.z;else{var wg=3==ug[0][tg]||4==ug[0][tg]?.5:1;Cg.x=0;Cg.y=0;for(yg=Cg.z=0;yg<ug[0][tg];yg++)Cg.x+=og[ug[yg+1][tg]].x,Cg.y+=og[ug[yg+1][tg]].y,Cg.z+=og[ug[yg+1][tg]].z;Cg.x+=wg*Ag.x;Cg.y+=wg*Ag.y;Cg.z+=wg*Ag.z;Cg.x/=wg+ug[0][tg];
Cg.y/=wg+ug[0][tg];Cg.z/=wg+ug[0][tg]}}for(tg=0;tg<qg;tg++)yg=sg[tg],Cg=og[tg],Cg.x=yg.x,Cg.y=yg.y,Cg.z=yg.z;Fj.sw(og,pg);for(tg=0;tg<qg;tg++)Cg=og[tg],yg=og[tg].nd?1:-1,Cg.x+=yg*Bg*Cg.ya.x,Cg.y+=yg*Bg*Cg.ya.y,Cg.z+=yg*Bg*Cg.ya.z}};Hj.__deps=[Fj,Gj,xj,Ej];function Ij(og){og=new Hj(og.data);og.init();og.dx();og.ow();og.bx();og.dz();og.Xy();og.Dv();postMessage(og.ff,[og.ff.vertices,og.ff.faces])}Ij.__deps=[Hj];function Jj(){}
function Kj(og){(1<arguments.length&&void 0!==arguments[1]?arguments[1]:[]).forEach(function(og){importScripts(og);URL.revokeObjectURL(og)});self.onmessage=og}Jj.Xq=function(og){var pg=og.__deps.filter(function(og){return"function"===typeof og}).map(function(og){return Jj.mx(og)}),pg=JSON.stringify(pg);og=URL.createObjectURL(new Blob(["("+Kj.toString()+")("+og.toString()+","+pg+");"],{type:"application/javascript"}));pg=new Worker(og);URL.revokeObjectURL(og);return pg};
Jj.Wq=function(og){var pg=og.toString(),qg="\n",rg="\n",sg="\n";if(null!=og.__deps){var tg=!0,ug=!1,yg=void 0;try{for(var Bg=og.__deps[Symbol.iterator](),Cg;!(tg=(Cg=Bg.next()).done);tg=!0){var Ag=Cg.value;if("function"==typeof Ag)rg+=Jj.Wq(Ag);else debugger}}catch(Eg){ug=!0,yg=Eg}finally{try{!tg&&Bg["return"]&&Bg["return"]()}finally{if(ug)throw yg;}}}for(var wg in og.prototype)"function"==typeof og.prototype[wg]&&(qg+=og.name+".prototype."+wg+"="+og.prototype[wg].toString()+"\n");for(var Dg in og)"__deps"!=
Dg&&(sg="function"==typeof og[Dg]?sg+(og.name+"."+Dg+" = "+og[Dg].toString()+";\n"):sg+(og.name+"."+Dg+" = "+JSON.stringify(og[Dg])+";\n"));return rg+pg+qg+sg};Jj.mx=function(og){og=Jj.Wq(og);return URL.createObjectURL(new Blob([og],{type:"application/javascript"}))};function Lj(og,pg,qg,rg){this.fa=og;this.ve=pg||0;this.ye=qg;this.precision=rg;this.ga=Ph.ba();this.Pc=this.Zc=this.nb=void 0}Lj.Rc={Ei:0,Ci:1,zi:2};
Lj.prototype.zu=function(){for(var og=this.fa.length,pg=new Float32Array(4*og),qg=0;qg<og;qg++){var rg=this.fa[qg],sg=this.ga.Bn(rg);pg[4*qg]=rg.pos.x;pg[4*qg+1]=rg.pos.y;pg[4*qg+2]=rg.pos.z;pg[4*qg+3]=sg}return pg};
Lj.prototype.compute=function(){var og=this,pg=this.zu();return new Promise(function(qg){var rg=Jj.Xq(Ij);rg.onmessage=function(pg){og.nb=pg.data.minBound;og.Zc=pg.data.maxBound;og.Pc=pg.data.voxelSize;rg.terminate();qg(pg)};rg.postMessage({type:og.ye,radius:og.ve,precision:og.precision,aBuf:pg.buffer},[pg.buffer])})};
Lj.prototype.Og=function(og,pg){for(var qg=new Ni(!0),rg=0,sg=og.length/4;rg<sg;rg++)qg.Lg(og[4*rg]*this.Pc+this.nb.x,og[4*rg+1]*this.Pc+this.nb.y,og[4*rg+2]*this.Pc+this.nb.z),qg.Ig(og[4*rg+3]);rg=0;for(sg=pg.length/3;rg<sg;rg++)qg.ed(pg[3*rg],pg[3*rg+1],pg[3*rg+2]);return qg.Og()};
function Ck(og,pg){THREE.Mesh.call(this,og,pg);this.$c=pg.$c?pg.$c:[];this.$c.push(this.bq);this.ki=[];this.onBeforeRender=function(og,pg,sg,tg,ug,yg){var qg=!0,rg=!1,Ag=void 0;try{for(var wg=this.$c[Symbol.iterator](),Dg;!(qg=(Dg=wg.next()).done);qg=!0)Dg.value.call(this,og,pg,sg,tg,ug,yg)}catch(Eg){rg=!0,Ag=Eg}finally{try{!qg&&wg["return"]&&wg["return"]()}finally{if(rg)throw Ag;}}}}Ck.prototype=Object.create(THREE.Mesh.prototype);Ck.prototype.constructor=Ck;
Ck.prototype.Rq=function(og,pg){this.ki=[];var qg=!0,rg=!1,sg=void 0;try{for(var tg=og[Symbol.iterator](),ug;!(qg=(ug=tg.next()).done);qg=!0)this.ki.push(ug.value)}catch(yg){rg=!0,sg=yg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}qg=this.material.uniforms;rg=this.material.defines;rg.RADIUS_CLIP=!0;rg.RADIUS_ATOMS_LENGTH=og.length;qg.clipRadius.value=pg;qg.opacity.value=.5;qg.clipRadius.needsUpdate=!0;qg.opacity.needsUpdate=!0;this.material.transparent=!0;this.material.needsUpdate=
!0;this.material.ri=!0};Ck.prototype.Pq=function(){var og=this.material.uniforms,pg=this.material.defines;this.ki=[];pg.RADIUS_CLIP=!1;pg.RADIUS_ATOMS_LENGTH=0;og.opacity.value=1;og.opacity.needsUpdate=!0;this.material.transparent=!1;this.material.needsUpdate=!0;this.material.ri=!0};
Ck.prototype.bq=function(og,pg,qg,rg,sg){if(sg.defines.RADIUS_CLIP){og=qg.matrixWorldInverse;var tg=(new THREE.Matrix4).multiplyMatrices(og,this.matrixWorld);og=this.ki.map(function(og){return og.clone().applyMatrix4(tg)});sg.uniforms.vClipCenter.value=og;sg.uniforms.vClipCenter.needsUpdate=!0}};function Dk(og,pg,qg,rg){hi.call(this,og);this.wireframe=pg;this.rv=qg?Dk.ot:Dk.pt;this.ye=rg[6];this.ro=this.Eo=null;this.fa=[]}Dk.pt=0;Dk.ot=1.4;Dk.prototype=Object.create(hi.prototype);
Dk.prototype.constructor=Dk;ih.tm=new hh("Van der Walls Surface","VDWS","VDW_SURFACE",Dk,!1,!1,Lj.Rc.Ei);ih.bm=new hh("Accessible Surface","AS","ACCESSIBLE_SURFACE",Dk,!1,!0,Lj.Rc.Ci);ih.jk=new hh("Molecular Surface","MS","MOLECULAR_SURFACE",Dk,!1,!0,Lj.Rc.zi);ih.zp=new hh("Van der Walls Surface Wireframe","VDWSM","VDW_SURFACE_WIREFRAME",Dk,!0,!1,Lj.Rc.Ei);ih.Zo=new hh("Accessible Surface Wireframe","ASM","ACCESSIBLE_SURFACE_WIREFRAME",Dk,!0,!0,Lj.Rc.Ci);
ih.mp=new hh("Molecular Surface Wireframe","MSM","MOLECULAR_SURFACE_WIREFRAME",Dk,!0,!0,Lj.Rc.zi);xg=Dk.prototype;xg.Dc=function(){var og=this,pg=this.Jp();if(null!=pg)return pg.then(function(pg){pg=new Ck(pg.data.geometry,pg.data.material);pg.la=og.Xa;pg.Ma=og;og.parent.add(pg);og.da=pg;og.color(hi.za.Fb);return og})};
xg.dy=function(){var og=Promise.resolve(this),pg=this;return null!==this.ro?this.ro:null===this.Eo&&(this.ro=prom=this.Jp(.2),null!=prom)?prom.then(function(og){og=new Ck(og.data.geometry,og.data.material);og.visible=!1;og.la=pg.Xa;og.Ma=pg;pg.parent.add(og);pg.Eo=og;og=og.geometry;if(og instanceof THREE.BufferGeometry){for(var qg=og.attributes.color.array,sg=og.attributes.atomIndex.array,tg=sg.length,ug=0;ug<tg;ug++){var yg=sg[ug],Bg;null==Bg&&(Bg=pg.ga.Hc(pg.fa[yg].wa().Ja().id.toUpperCase(),"M"));
void 0!=Bg&&(qg[3*ug]=Bg.r,qg[3*ug+1]=Bg.g,qg[3*ug+2]=Bg.b)}og.attributes.color.needsUpdate=!0}else console.warn("Unknown type of geometry for coloring by molecule ",og);return pg}):og};
xg.Jp=function(og){var pg=this;null!=this.Xa.Yh&&this.Xa.Yh()?this.fa=this.Xa.Qa():null!=this.Xa.Wh&&this.Xa.Wh()?this.fa=this.Xa.Qa():this.cb.$n&&(this.fa=this.cb.fa);if(0<this.fa.length){var qg,rg,sg=null,sg=this.ye===Lj.Rc.Ei?ih.tm:this.ye===Lj.Rc.Ci?ih.bm:ih.jk;if(this.wireframe){qg=this.ga.Hr();var tg=this.cb.hb(sg);og=new Promise(function(og){if(null===tg.da){var pg=null;tg.Wg?pg=tg.Yc():(pg=tg.show(),tg.hide());pg.then(function(pg){pg={};pg.data={material:qg,geometry:tg.da.geometry.clone()};
og(pg)})}else pg={},pg.data={material:qg,geometry:tg.da.geometry.clone()},og(pg)})}else qg=this.ga.Ye(!0),qg.side=THREE.DoubleSide,og=this.rw(og),og.then(function(og){rg=pg.Qq.Og(new Float32Array(og.data.vertices),new Uint32Array(og.data.faces));rg.computeFaceNormals();rg.computeVertexNormals();rg.normalizeNormals();og.data.geometry=rg;og.data.material=qg;return"done"});return og}};xg.rw=function(og){this.Qq=new Lj(this.fa,this.rv,this.ye,og||this.ga.Ix());return this.Qq.compute()};
xg.update=function(og){var pg=this;hi.prototype.update.call(this,og);og.Mj&&(this.sd=[],null!=this.da&&(visible=this.da.visible,this.parent.remove(this.da),this.da=null,this.Yc().then(function(){pg.da.visible=visible})))};xg.cd=function(){this.color(hi.za.oc)};
var Ek={gx:function(og,pg,qg){for(var rg,sg=og.yj(),tg=sg.length,ug=0;ug<tg;ug++)rg=sg[ug],rg.Kb=!1,rg.Iv(),rg.Mv(pg);for(var yg=new Vg,sg=og.yj(),tg=sg.length,ug=0;ug<tg;ug++){rg=sg[ug];for(var Bg=[],Cg=rg.vj(),Ag=0;4>Ag;Ag++){var wg=rg.Dr(Ag);Bg.push(Ek.Jy(rg,wg[3],Cg[Ag],wg[0],wg[1],wg[2],pg))}yg.set(rg,Bg)}if(qg){pg=[];sg=og.yj();tg=sg.length;for(ug=0;ug<tg;ug++)if(rg=sg[ug],rg.Kb=!1,rg.pe=!1,rg.ny()){Cg=rg.vj();Bg=yg.get(rg);for(Ag=0;4>Ag;Ag++)null!=Cg[Ag]||Bg[Ag]||(rg.pe=!0);rg.pe&&pg.push(rg)}for(;0!==
pg.length;)for(ug=pg[pg.length-1],pg.splice(pg.length-1),ug.Kb=!0,ug.pe=!0,Cg=ug.vj(),Bg=yg.get(ug),Ag=0;4>Ag;Ag++)null==Cg[Ag]||Cg[Ag].Kb||Bg[Ag]||pg.push(Cg[Ag]);sg=og.yj();tg=sg.length;for(ug=0;ug<tg;ug++)if(rg=sg[ug],rg.Kb=!1,!rg.pe)for(Cg=rg.vj(),Bg=yg.get(rg),Ag=0;4>Ag;Ag++)null==Cg[Ag]||Cg[Ag].pe||(Bg[Ag]=!1)}return yg},ww:function(og,pg,qg,rg){qg=Ek.gx(pg,qg,rg);pg=pg.yj();rg=[];for(var sg=Array(3),tg=pg.length,ug=0;ug<tg;ug++){for(var yg=pg[ug],Bg=yg.vj(),Cg=qg.get(yg),Bg=Bg.length,Ag=0;Ag<
Bg;Ag++)if(Cg[Ag]){for(var wg=yg.Dr(Ag),Dg=0;3>Dg;Dg++){var Eg=wg[Dg],Fg=rg.indexOf(Eg);-1===Fg&&(Fg=rg.push(Eg)-1,og.Lg(Eg.x,Eg.y,Eg.z));sg[Dg]=Fg}yg.pe?og.ed(sg[2],sg[1],sg[0]):og.ed(sg[0],sg[1],sg[2])}yg.Kb=!0}return rg},Jy:function(og,pg,qg,rg,sg,tg,ug){if(null==og)throw"!!";var yg=og.pe,Bg=null==qg||qg.pe;return yg!=Bg||yg&&Bg&&(null==qg||0<THREE.GeometryUtils.Qr(rg,sg,tg,og.Qx(qg)))&&0<THREE.GeometryUtils.Qr(rg,sg,tg,pg)&&ug>=THREE.GeometryUtils.MA(rg,sg,tg)?!0:!1}};
function Fk(){this.Kb=!1;this.pe=null;this.alpha=-1;this.ji=!1;this.an=this.d=this.c=this.b=this.a=this.po=null;this.Ec=-1;this.id=this.tc=this.sc=this.rc=this.qc=null}xg=Fk.prototype;xg.toString=function(){return this.po+":"+this.id};xg.nc=function(){return this.po+":"+this.id};
xg.set=function(og,pg,qg,rg,sg,tg){this.po=og;this.a=pg;this.b=qg;this.c=rg;this.d=sg;this.ji=!1;this.id=og.Yy++;this.an=og.xx(this.yx());this.Ec=this.an.cA(this);pg.mc.push(this);qg.mc.push(this);rg.mc.push(this);sg.mc.push(this);this.qc=null!=tg?tg:this.a.Yk(this,this.b,this.c);null!=this.qc&&this.qc.Yf(this.a,this.b,this.c,this);this.rc=this.a.Yk(this,this.c,this.d);null!=this.rc&&this.rc.Yf(this.a,this.c,this.d,this);this.sc=this.a.Yk(this,this.d,this.b);null!=this.sc&&this.sc.Yf(this.a,this.d,
this.b,this);this.tc=this.b.Yk(this,this.d,this.c);null!=this.tc&&this.tc.Yf(this.b,this.d,this.c,this)};
xg.pi=function(og){var pg=this.a.x-og.x,qg=this.a.y-og.y,rg=this.a.z-og.z,sg=this.b.x-og.x,tg=this.b.y-og.y,ug=this.b.z-og.z,yg=this.c.x-og.x,Bg=this.c.y-og.y,Cg=this.c.z-og.z,Ag=this.d.x-og.x,wg=this.d.y-og.y,Dg=this.d.z-og.z;return-THREE.GeometryUtils.sign(THREE.GeometryUtils.Mw(pg,qg,rg,pg*pg+qg*qg+rg*rg+(og.weight-this.a.weight),sg,tg,ug,sg*sg+tg*tg+ug*ug+(og.weight-this.b.weight),yg,Bg,Cg,yg*yg+Bg*Bg+Cg*Cg+(og.weight-this.c.weight),Ag,wg,Dg,Ag*Ag+wg*wg+Dg*Dg+(og.weight-this.d.weight)))};
xg.Yf=function(og,pg,qg,rg){if(og===this.a||pg===this.a||qg===this.a)if(og===this.c||pg===this.c||qg===this.c)og===this.b||pg===this.b||qg===this.b?this.qc=rg:this.rc=rg;else{if(og!==this.d&&pg!==this.d&&qg!==this.d)throw"This tetrahedron doesn't have the right vertices";this.sc=rg}else if(og===this.b||pg===this.b||qg===this.b)this.tc=rg;else throw"This tetrahedron doesn't have the right vertices - ("+og+"),("+pg+"),("+qg+") - ("+a+"),("+b+"),("+c+"),("+d+")";};
xg.yx=function(){return new THREE.Vector3((this.a.x+this.b.x+this.c.x+this.d.x)/4,(this.a.y+this.b.y+this.c.y+this.d.y)/4,(this.a.z+this.b.z+this.c.z+this.d.z)/4)};xg.Iv=function(){this.alpha=THREE.GeometryUtils.KA(this.a,this.b,this.c,this.d)};xg.Mv=function(og){this.pe=this.alpha>og};xg.vj=function(){var og=[];og.push(this.qc);og.push(this.rc);og.push(this.sc);og.push(this.tc);return og};
xg.Dr=function(og){if(0==og)return[this.c,this.b,this.a,this.d];if(1==og)return[this.d,this.c,this.a,this.b];if(2==og)return[this.b,this.d,this.a,this.c];if(3==og)return[this.c,this.d,this.b,this.a];throw"i :"+og+" not between 0 and 3";};xg.Yr=function(og){return this.a.x===og.x&&this.a.y===og.y&&this.a.z===og.z||this.b.x===og.x&&this.b.y===og.y&&this.b.z===og.z||this.c.x===og.x&&this.c.y===og.y&&this.c.z===og.z||this.d.x===og.x&&this.d.y===og.y&&this.d.z===og.z};
xg.ny=function(){return null==this.qc||null==this.rc||null==this.sc||null==this.tc};
xg.disconnect=function(){this.an.pA(this.Ec);null!=this.qc&&this.qc.Yf(this.a,this.b,this.c,null);null!=this.rc&&this.rc.Yf(this.a,this.c,this.d,null);null!=this.sc&&this.sc.Yf(this.a,this.d,this.b,null);null!=this.tc&&this.tc.Yf(this.b,this.d,this.c,null);this.a.mc.splice(this.a.mc.indexOf(this),1);this.b.mc.splice(this.b.mc.indexOf(this),1);this.c.mc.splice(this.c.mc.indexOf(this),1);this.d.mc.splice(this.d.mc.indexOf(this),1);this.tc=this.sc=this.rc=this.qc=this.d=this.c=this.b=this.a=null};
xg.Qx=function(og){if(og.qc==this)return og.d;if(og.rc==this)return og.b;if(og.sc==this)return og.c;if(og.tc==this)return og.a;throw"getOtherVertex: Tetrahedra "+this+" and "+og+" not touching";};function Gk(){this.Xa=[];this.Vq=[];this.$k=0}Gk.prototype.cA=function(og){if(0<this.$k){var pg=this.Vq[--this.$k];this.Xa[pg]=og;return pg}pg=this.getSize();this.Xa[pg]=og;return pg};Gk.prototype.pA=function(og){this.Xa[og]=null;this.Vq[this.$k++]=og};Gk.prototype.getSize=function(){return this.Xa.length};
Gk.prototype.jr=function(){return this.getSize()-this.$k};function Hk(og,pg,qg){THREE.Vector3.call(this);this.bo=!0;this.x=og;this.y=pg;this.z=qg;this.radius=this.weight=1;this.mc=[]}xg=Hk.prototype;xg.set=function(og,pg){this.weight=og;this.radius=pg};xg.toString=function(){return this.x+":"+this.y+":"+this.z};xg.nc=function(){return this.x+":"+this.y+":"+this.z};xg.Yk=function(og,pg,qg){for(var rg=this.mc.length,sg=0;sg<rg;sg++){var tg=this.mc[sg];if(tg.Yr(pg)&&tg.Yr(qg)&&tg!=og)return tg}return null};
xg.remove=function(){for(var og=[],pg=this.mc.length,qg=0;qg<pg;qg++)og.push(this.mc[qg]);pg=og.length;for(qg=0;qg<pg;qg++)og[qg].disconnect()};function Ik(){this.rq=this.he=this.Of=this.jd=this.max=this.min=null;this.hj=0;this.Bd=[];this.Gg=[];this.zb=[];this.iterator=null;this.Yy=0}xg=Ik.prototype;xg.toString=function(){return"Tesselation"};
xg.cz=function(og){if(4>og.length)throw"Too few points to tesselate";this.Jv(og);var pg=(this.min.x+this.max.x)/2,qg=(this.min.y+this.max.y)/2,rg=(this.min.z+this.max.z)/2,sg=this.min.distanceTo(this.max);this.he=this.Of=this.jd=8;this.rq=Math.max(this.jd,Math.max(this.Of,this.he));this.hj=this.jd*this.Of*this.he;var tg=new Hk(pg-sg,qg-sg,rg-sg),ug=new Hk(pg+sg,qg+sg,rg-sg),yg=new Hk(pg-sg,qg+sg,rg+sg),pg=new Hk(pg+sg,qg-sg,rg+sg);(new Fk).set(this,tg,ug,yg,pg,null);qg=og.length;for(rg=0;rg<qg;rg++)this.qv(og[rg]);
tg.remove();ug.remove();yg.remove();pg.remove()};xg.Jv=function(og){this.min=new THREE.Vector3(Infinity,Infinity,Infinity);this.max=new THREE.Vector3(-Infinity,-Infinity,-Infinity);for(var pg=og.length,qg=0;qg<pg;qg++){var rg=og[qg];this.min.x=Math.min(this.min.x,rg.x);this.min.y=Math.min(this.min.y,rg.y);this.min.z=Math.min(this.min.z,rg.z);this.max.x=Math.max(this.max.x,rg.x);this.max.y=Math.max(this.max.y,rg.y);this.max.z=Math.max(this.max.z,rg.z)}};
xg.qv=function(og){this.Gg=[];var pg=!1,qg=this.Bd[this.cr(og)];if(void 0!==qg&&null!==qg)for(var rg in qg.Xa){var sg=qg.Xa[rg];if(null!=sg){var tg=sg.pi(og);0===tg&&console.warn(">1 point on the same power sphere");if(null!==sg&&void 0!==sg&&0<tg){sg.Kb=!0;this.bi(sg,og);this.ai(sg);pg=!0;break}}}if(!pg)for(var qg=!1,tg=Math.trunc((og.x-this.min.x)*this.jd/(this.max.x-this.min.x)),ug=Math.trunc((og.y-this.min.y)*this.Of/(this.max.y-this.min.y)),yg=Math.trunc((og.z-this.min.z)*this.he/(this.max.z-
this.min.z)),pg=1;pg<this.rq&&!qg;pg++)for(var Bg=-pg;Bg<=pg&&!qg;Bg++)for(var Cg=-pg;Cg<=pg&&!qg;Cg++)for(var Ag=-pg;Ag<=pg&&!qg;Ag++)if(Math.abs(Ag)==pg||Math.abs(Cg)==pg||Math.abs(Bg)==pg){var sg=tg+Ag,wg=ug+Cg,Dg=yg+Bg;if(!(0>sg||sg>=this.jd||0>wg||wg>=this.Of||0>Dg||Dg>=this.he)&&(sg=this.Bd[Math.trunc(sg+wg*this.jd+Dg*this.jd*this.he)],null!=sg))for(rg in wg=sg.Xa,wg)if(sg=wg[rg],null!=sg&&void 0!=sg&&0<sg.pi(og)){sg.Kb=!0;this.bi(sg,og);this.ai(sg);qg=!0;break}}this.zb=[];rg=this.Gg.length;
for(pg=0;pg<rg;pg++)sg=this.Gg[pg],null!=sg.qc&&sg.qc.ji||(this.zb.push(sg.qc),this.zb.push(sg.a),this.zb.push(sg.b),this.zb.push(sg.c)),null!=sg.rc&&sg.rc.ji||(this.zb.push(sg.rc),this.zb.push(sg.a),this.zb.push(sg.c),this.zb.push(sg.d)),null!=sg.sc&&sg.sc.ji||(this.zb.push(sg.sc),this.zb.push(sg.a),this.zb.push(sg.d),this.zb.push(sg.b)),null!=sg.tc&&sg.tc.ji||(this.zb.push(sg.tc),this.zb.push(sg.b),this.zb.push(sg.d),this.zb.push(sg.c));for(pg=0;pg<rg;pg++)sg=this.Gg[pg],sg.disconnect();rg=0;sg=
this.zb.length;for(pg=0;pg<sg;pg+=4)qg=this.zb[pg],tg=this.zb[pg+1],ug=this.zb[pg+2],yg=this.zb[pg+3],Bg=(new THREE.Vector3((tg.x+ug.x+yg.x)/3,(tg.y+ug.y+yg.y)/3,(tg.z+ug.z+yg.z)/3)).sub(og),Bg=0>THREE.Vector3.Hv(tg,ug,yg).dot(Bg),Cg=rg<this.Gg.length?this.Gg[rg++]:new Fk,Bg?Cg.set(this,tg,ug,yg,og,qg):Cg.set(this,yg,ug,tg,og,qg)};
xg.cr=function(og){var pg=Math.trunc((og.x-this.min.x)*this.jd/(this.max.x-this.min.x)),qg=Math.trunc((og.y-this.min.y)*this.Of/(this.max.y-this.min.y));og=Math.trunc((og.z-this.min.z)*this.he/(this.max.z-this.min.z));0>pg&&(pg=0);pg>=this.jd&&(pg=this.jd-1);0>qg&&(qg=0);qg>=this.Of&&(qg=this.Of-1);0>og&&(og=0);og>=this.he&&(og=this.he-1);return pg+qg*this.jd+og*this.jd*this.he};
xg.bi=function(og,pg){og.ji=!0;this.Gg.push(og);var qg=og.qc;null==qg||void 0===qg||qg.Kb||(qg.Kb=!0,0<qg.pi(pg)&&this.bi(qg,pg));qg=og.rc;null==qg||void 0===qg||qg.Kb||(qg.Kb=!0,0<qg.pi(pg)&&this.bi(qg,pg));qg=og.sc;null==qg||void 0===qg||qg.Kb||(qg.Kb=!0,0<qg.pi(pg)&&this.bi(qg,pg));qg=og.tc;null==qg||void 0===qg||qg.Kb||(qg.Kb=!0,0<qg.pi(pg)&&this.bi(qg,pg))};
xg.ai=function(og){og.Kb=!1;var pg;pg=og.qc;null!=pg&&void 0!==pg&&pg.Kb&&this.ai(pg);pg=og.rc;null!=pg&&void 0!==pg&&pg.Kb&&this.ai(pg);pg=og.sc;null!=pg&&void 0!==pg&&pg.Kb&&this.ai(pg);pg=og.tc;null!=pg&&void 0!==pg&&pg.Kb&&this.ai(pg)};xg.xx=function(og){og=this.cr(og);if(void 0!==this.Bd[og]&&null!==this.Bd[og])return this.Bd[og];this.Bd[og]=new Gk;return this.Bd[og]};
xg.yj=function(){var og=0;this.iterator=new Ik.Iterator(this);for(var pg=[];this.iterator.ly();){var qg=this.iterator.next();void 0!==qg&&pg.push(qg);og++}return pg};Ik.Iterator=function(og){this.pg=og;this.Bc=this.Ec=0;for(this.vb=this.pg.Bd[this.Ec];this.Ec<this.pg.hj&&(null==this.vb||void 0==this.vb||0==this.vb.jr());)this.Ec++,this.vb=this.Ec<this.pg.hj?this.pg.Bd[this.Ec]:null;if(null!=this.vb&&void 0!=this.vb)for(;this.Bc<this.vb.getSize()&&(null==this.vb.Xa[this.Bc]||void 0==this.vb.Xa[this.Bc]);)this.Bc++};
Ik.Iterator.prototype.next=function(){var og=this.pg.Bd[this.Ec].Xa[this.Bc];for(this.Bc++;this.Bc<this.vb.getSize()&&(null==this.vb.Xa[this.Bc]||void 0===this.vb.Xa[this.Bc]);)this.Bc++;if(this.Bc>=this.vb.getSize()){this.Bc=0;for(this.Ec++;this.Ec<this.pg.hj;){this.vb=this.pg.Bd[this.Ec];if(null!==this.vb&&void 0!==this.vb&&0<this.vb.jr())break;this.Ec++}this.Ec>=this.pg.hj&&(this.vb=null)}if(null!=this.vb&&void 0!=this.vb)for(;this.Bc<this.vb.getSize()&&null==this.vb.Xa[this.Bc];)this.Bc++;return og};
Ik.Iterator.prototype.ly=function(){return null!=this.vb};function Jk(){this.ve=1.4;this.alpha=0;this.oq=new Vg}
Jk.prototype.Ev=function(og){for(var pg=[],qg=og.length,rg=0;rg<qg;rg++){var sg=og[rg];this.oq.set(sg.pos,sg);var tg=Ph.ba().Bn(sg),ug=(tg+this.ve)*(tg+this.ve),sg=new Hk(sg.pos.x,sg.pos.y,sg.pos.z);sg.set(ug,tg);pg.push(sg)}sg=new Ik;sg.cz(pg);pg=new Ni(!0);qg=Ek.ww(pg,sg,this.alpha,!0);rg=qg.length;for(sg=0;sg<rg;sg++){var tg=qg[sg],ug=this.rx(tg),yg=og.indexOf(ug);if(void 0===ug)throw"Couldn't get atom for position :"+tg.x+", "+tg.y+", "+tg.z;pg.Ig(yg)}return pg.Og()};Jk.prototype.rx=function(og){return this.oq.get(og)};
function Kk(og,pg){hi.call(this,og);this.wireframe=pg}Kk.prototype=Object.create(hi.prototype);Kk.prototype.constructor=Kk;ih.cm=new hh("Alpha Shape","ASHAPE","ALPHA_SHAPE",Kk,!1);ih.$o=new hh("Alpha Shape Wireframe","ASHAPEM","ALPHA_SHAPE_WIREFRAME",Kk,!0);Kk.prototype.Dc=function(){this.xu()};
Kk.prototype.xu=function(){var og;if(this.wireframe){var pg=this.ga.Hr();og=this.cb.hb(ih.cm);null===og.da&&(og.Yc(),og.hide());og=og.da.geometry.clone()}else pg=this.ga.Ye(!0),pg.side=THREE.DoubleSide,pg.shading=THREE.FlatShading,og=(new Jk).Ev(this.fa),og.computeFaceNormals(),og.computeVertexNormals(),og.normalizeNormals();pg=new Ck(og,pg);pg.Ma=this;this.parent.add(pg);this.da=pg;this.color(hi.za.oc)};Kk.prototype.update=function(og){hi.prototype.update.call(this,og)};Kk.prototype.cd=function(){this.color(hi.za.oc)};
function Lk(og,pg,qg){this.lb=og;this.kb=pg;this.pb=new THREE.Vector3((og.x+pg.x)/2,(og.y+pg.y)/2,(og.z+pg.z)/2);this.Za=null;this.Xd=qg;void 0===qg&&(this.Xd=32);this.Ob=[]}xg=Lk.prototype;
xg.add=function(og){if(og.Qy){var pg=og.Ck.pos;this.Mk(pg)||console.warn("Error : "+pg+" can't fit into [ "+this.lb+" , "+this.kb+" ]");if(null==this.Za)this.Ob.push(og),this.Ob.length>this.Xd&&this.av();else for(var qg=0,rg=this.Za.length;qg<rg;qg++){var sg=this.Za[qg];if(sg.Mk(pg)){sg.add(og);break}}}else if(0<og.length)for(qg=0,rg=og.length;qg<rg;qg++)this.add(og[qg])};
xg.av=function(){null!=this.Za&&console.warn("Error : This octant was already split ");this.Za=[];this.Za.push(new Lk(new THREE.Vector3(this.lb.x,this.lb.y,this.lb.z),new THREE.Vector3(this.pb.x,this.pb.y,this.pb.z),this.Xd));this.Za.push(new Lk(new THREE.Vector3(this.pb.x,this.lb.y,this.lb.z),new THREE.Vector3(this.kb.x,this.pb.y,this.pb.z),this.Xd));this.Za.push(new Lk(new THREE.Vector3(this.lb.x,this.pb.y,this.lb.z),new THREE.Vector3(this.pb.x,this.kb.y,this.pb.z),this.Xd));this.Za.push(new Lk(new THREE.Vector3(this.pb.x,
this.pb.y,this.lb.z),new THREE.Vector3(this.kb.x,this.kb.y,this.pb.z),this.Xd));this.Za.push(new Lk(new THREE.Vector3(this.lb.x,this.lb.y,this.pb.z),new THREE.Vector3(this.pb.x,this.pb.y,this.kb.z),this.Xd));this.Za.push(new Lk(new THREE.Vector3(this.pb.x,this.lb.y,this.pb.z),new THREE.Vector3(this.kb.x,this.pb.y,this.kb.z),this.Xd));this.Za.push(new Lk(new THREE.Vector3(this.lb.x,this.pb.y,this.pb.z),new THREE.Vector3(this.pb.x,this.kb.y,this.kb.z),this.Xd));this.Za.push(new Lk(new THREE.Vector3(this.pb.x,
this.pb.y,this.pb.z),new THREE.Vector3(this.kb.x,this.kb.y,this.kb.z),this.Xd));var og=0,pg=this.Ob.length;a:for(;og<pg;og++)for(var qg=this.Ob[og],rg=qg.Ck.pos,sg=0,tg=this.Za.length;sg<tg;sg++){var ug=this.Za[sg];if(ug.Mk(rg)){ug.add(qg);continue a}}this.Ob=[]};
xg.optimize=function(){if(null!=this.Za){for(var og=0,pg=0,qg=this.Za.length;pg<qg;pg++){var rg=this.Za[pg];rg.optimize();rg.isEmpty()&&!rg.gy()&&(this.Za[pg]=null,og++)}if(0!==og)if(og===this.Za.length)this.Za=[];else for(og=this.Za.slice(),this.Za=[],pg=0,qg=og.length;pg<qg;pg++)rg=og[pg],null!=rg&&this.Za.push(rg)}};xg.isEmpty=function(){return 0===this.Ob.length};xg.gy=function(){return null!=this.Za};
xg.Mk=function(og){return og.x>=this.lb.x&&og.y>=this.lb.y&&og.z>=this.lb.z&&og.x<=this.kb.x&&og.y<=this.kb.y&&og.z<=this.kb.z};xg.Xk=function(og,pg,qg){qg=qg||[];if(!this.Mk(og)&&!this.$u(og,pg))return qg;if(null!=this.Za)for(var rg=0,sg=this.Za.length;rg<sg;rg++)this.Za[rg].Xk(og,pg,qg);else for(rg=0,sg=this.Ob.length;rg<sg;rg++){var tg=this.Ob[rg];tg.getPoint().distanceToSquared(og)<=pg*pg&&qg.push(tg)}return qg};
xg.$u=function(og,pg){var qg=0,rg=0,sg=0;og.x<this.lb.x?qg=og.x-this.lb.x:og.x>this.kb.x&&(qg=og.x-this.kb.x);og.y<this.lb.y?rg=og.y-this.lb.y:og.y>this.kb.y&&(rg=og.y-this.kb.y);og.z<this.lb.z?sg=og.z-this.lb.z:og.z>this.kb.z&&(sg=og.z-this.kb.z);return 0<pg*pg-(qg*qg+rg*rg+sg*sg)};xg.trace=function(){this.dv()};xg.dv=function(){var og=0;void 0===og&&(og=0);for(var pg=0;pg<og;pg++)console.log(pg==og-1?"\u2514-":"  ");console.log(this.toString()+": "+this.Ob.length);if(null!=this.Za){og++;for(var qg in this.Za)this.Za[qg].trace(og)}};
xg.toString=function(){return"[("+this.lb.x+","+this.lb.y+","+this.lb.z+"),("+this.kb.x+","+this.kb.y+","+this.kb.z+")]"};function Mk(og){this.Qy=!0;this.Ck=og}Mk.prototype.getPoint=function(){return this.Ck};Mk.prototype.toString=function(){return this.Ck.toString()};
function Nk(og,pg){hi.call(this,og);this.da=[];this.labels=[];this.bj=[];this.Yj=this.cb.Ea();this.params={Ow:1,Aq:1023,Hy:!1};for(var qg=this.Yj.cc(),rg=0;rg<qg.length;rg++)if(this.params.Hy||"Solvent"!=qg[rg].pa.ja.name&&(!pg||qg[rg].pa.ja.name===pg))this.bj=this.bj.concat(qg[rg].fa)}Nk.prototype=Object.create(hi.prototype);Nk.prototype.constructor=Nk;ih.Jt=new hh("Potential H-Bonds with Ligands","MOLECULARINTERACTIONSLIGAND","MOLECULAR_INTERACTIONS_LIGAND",Nk,"Ligand");
ih.Kt=new hh("Potential H-Bonds with Proteins","MOLECULARINTERACTIONSPROTEIN","MOLECULAR_INTERACTIONS_PROTEIN",Nk,"Protein");xg=Nk.prototype;
xg.nw=function(){for(var og=new THREE.Vector3(Infinity,Infinity,Infinity),pg=new THREE.Vector3(-Infinity,-Infinity,-Infinity),qg=this.bj.length,rg=0;rg<qg;rg++){var sg=this.bj[rg].pos;og.x=Math.min(og.x,sg.x);og.y=Math.min(og.y,sg.y);og.z=Math.min(og.z,sg.z);pg.x=Math.max(pg.x,sg.x);pg.y=Math.max(pg.y,sg.y);pg.z=Math.max(pg.z,sg.z)}og=new Lk(og,pg,32);for(rg=0;rg<qg;rg++)og.add(new Mk(this.bj[rg]));og.optimize();return og};
xg.Py=function(og,pg){var qg=og.wa(),rg=pg.wa();if("GLU"===qg.gb&&"LYS"===rg.gb){if(("OE1"===og.name||"OE2"===og.name)&&"NZ"===pg.name)return!0}else if("GLU"===rg.gb&&"LYS"===qg.gb&&("OE1"===pg.name||"OE2"===pg.name)&&"NZ"===og.name)return!0;var sg=og.name.substring(0,1),tg=og.name.substring(0,1);return"GLU"===qg.gb&&("OE1"===og.name||"OE2"==og.name)&&"O"===tg||"GLU"===rg.gb&&("OE1"===pg.name||"OE2"==pg.name)&&"O"===sg?!1:!0};
xg.Oy=function(og,pg){var qg=og.wa(),rg=pg.wa();if(3.5>og.pos.distanceTo(pg.pos)){var sg=og.name.substring(0,1),tg=og.name.substring(0,1);if("SER"===qg.gb&&"OG"===og.name&&("N"===tg||"O"===tg)||"SER"===rg.gb&&"OG"===pg.name&&("N"===sg||"O"===sg))return!0}return!1};xg.Ry=function(og,pg){var qg=og.name.substring(0,1),rg=pg.name.substring(0,1);return"O"!==qg&&"N"!==qg||"O"!==rg&&"N"!==rg?!1:!0};xg.hq=function(og,pg,qg,rg){qg.push(og.pos);qg.push(pg.pos);og=this.Gx(og,pg);rg.push(og);rg.push(og)};
xg.Dq=function(og){for(var pg="",qg=0;qg<og.length;qg++)pg+=og[qg].charCodeAt(0).toString(2);return pg};
xg.Gx=function(og,pg){var qg,rg;qg="Ligand"===og.wa().Ja().ja.name?og.wa().eb():og.wa().Ja().eb();rg="Ligand"===pg.wa().Ja().ja.name?pg.wa().eb():pg.wa().Ja().eb();qg=parseInt(this.Dq(qg),2)+parseInt(this.Dq(rg),2);qg%=this.params.Aq;qg=(new THREE.Color).setHSL(qg/this.params.Aq,1,.42);rg=this.ga.Hc(og.wa().Ja().oa(),"M");var sg=this.ga.Hc(pg.wa().Ja().oa(),"M");return new THREE.Color((qg.r+(1-(rg.r+sg.r)/2))/2,(qg.g+(1-(rg.g+sg.g)/2))/2,(qg.b+(1-(rg.b+sg.b)/2))/2)};
xg.makeGeometry=function(og,pg,qg){var rg,sg;(rg=og.vertices).push.apply(rg,Wh(pg));(sg=og.colors).push.apply(sg,Wh(qg));og.computeLineDistances();pg=new THREE.LineDashedMaterial({vertexColors:THREE.VertexColors,linewidth:2,scale:5,dashSize:1,gapSize:1});og=new THREE.LineSegments(og,pg);og.Ma=this;this.da.push(og);this.parent.add(og)};
xg.Dc=function(){for(var og=new THREE.Geometry,pg=[],qg=[],rg=new THREE.Geometry,sg=[],tg=[],ug=0,yg=0,Bg=this.nw(),Cg=0;Cg<this.fa.length;Cg++)for(var Ag=Bg.Xk(this.fa[Cg].pos,4),wg=Ag.length,Dg=0;Dg<wg;Dg++){var Eg=Ag[Dg].getPoint();if(this.fa[Cg].wa().Ja()!=Eg.wa().Ja()&&this.Ry(this.fa[Cg],Eg)){var Fg=this.fa[Cg].pos.distanceTo(Eg.pos).toFixed(this.params.Ow),Jg=(new THREE.Vector3).addVectors(this.fa[Cg].pos,Eg.pos).multiplyScalar(.5);this.Oy(this.fa[Cg],Eg)?(this.hq(this.fa[Cg],Eg,pg,qg),yg++,
this.Ub(Fg,Jg)):this.Py(this.fa[Cg],Eg)&&(this.hq(this.fa[Cg],Eg,sg,tg),ug++,this.Ub(Fg,Jg))}}0<ug&&this.makeGeometry(rg,sg,tg);0<yg&&this.makeGeometry(og,pg,qg)};xg.Ub=function(og,pg){var qg=this.ga.ll(og,15),qg=new THREE.SpriteMaterial({map:qg});qg.depthTest=!1;qg.depthWrite=!1;var rg=new THREE.Sprite(qg);rg.position.set(pg.x,pg.y,pg.z);rg.scale.set(qg.map.image.width/40,qg.map.image.height/40,1);this.labels.push(rg);this.parent.add(rg)};xg.update=function(){};xg.color=function(){};
xg.hide=function(){if(0!==this.da.length){var og;for(og=0;og<this.da.length;og++)this.da[og].visible=!1,this.da[og].jb=!0;for(og=0;og<this.labels.length;og++)this.labels[og].visible=!1;this.jb=!0;this.visible=!1}};xg.show=function(){if(0===this.da.length)return this.Yc()||Promise.resolve(this);if(0!==this.da.length){var og;for(og=0;og<this.da.length;og++)this.da[og].visible=!0,this.da[og].jb=!0;for(og=0;og<this.labels.length;og++)this.labels[og].visible=!0;this.jb=this.visible=!0;return Promise.resolve(this)}};
xg.yb=function(){};xg["delete"]=function(){this.ga.unsubscribe(this);if(0<this.da.length){var og;for(og=0;og<this.da.length;og++)this.parent.remove(this.da[og]);for(og=0;og<this.labels.length;og++)this.parent.remove(this.labels[og])}};xg.cd=function(){};
function Rk(og,pg){wi.call(this);this.Xc=pg;this.$h=og;this.$h.add(this);this.fa=[pg];this.la=this.Xc;var qg=!0,rg=!1,sg=void 0;try{for(var tg=og.od[Symbol.iterator](),ug;!(qg=(ug=tg.next()).done);qg=!0)if(pg=ug.value,this.fa.includes(pg)){this.outline=!0;break}}catch(yg){rg=!0,sg=yg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}this.updateMatrixWorld()}Rk.prototype=Object.create(wi.prototype);Rk.prototype.constructor=Rk;Gi.add(Rk,[ih.rk,ih.dm,ih.vi]);xg=Rk.prototype;
xg["delete"]=function(){wi.prototype["delete"].call(this);this.parent.remove(this)};xg.reset=function(){this.visible=!0;for(var og=this.vc(!1),pg=0;pg<og.length;pg++){var qg=og[pg];qg.da&&(qg.cd(),qg.yb(!1),qg.jg(1),qg.hide())}this.vd()};xg.Ea=function(){return this.$h.Ea()};xg.Bb=function(){return this.$h.Bb()};xg.ic=function(){return this.$h};xg.Gc=function(){return this.Xc.xb()};xg.wb=function(){return this.Xc.bounds()};xg.Hd=function(){return this.Ea().vf.Hd()};
xg.clone=function(og){og=wi.prototype.clone.call(this,og,this.Xc);var pg=this.bd.keys(),qg;for(qg in pg){var rg=pg[qg].da.clone(!1);og.add(rg)}return og};
function Sk(og,pg){wi.call(this);this.bc=pg;this.Ij=og;this.Ij.add(this);this.ge=new Vg;this.fa=this.bc.Qa();this.la=this.bc;var qg=!0,rg=!1,sg=void 0;try{for(var tg=og.od[Symbol.iterator](),ug;!(qg=(ug=tg.next()).done);qg=!0){var yg=ug.value;this.fa.includes(yg)&&(this.outline=!0,this.od.add(yg))}}catch(Bg){rg=!0,sg=Bg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}this.updateMatrixWorld()}Sk.prototype=Object.create(wi.prototype);Sk.prototype.constructor=Sk;
Gi.add(Sk,[ih.rk,ih.ck,ih.LINES,ih.xg,ih.vi]);xg=Sk.prototype;xg["delete"]=function(){wi.prototype["delete"].call(this);for(var og=this.ge.values(),pg=0,qg=og.length;pg<qg;pg++)og[pg]["delete"]();this.parent.remove(this)};xg.Ea=function(){return this.Ij.lo};xg.Bb=function(){return this.Ij};
xg.reset=function(){this.visible=!0;for(var og=this.vc(!1),pg=0;pg<og.length;pg++){var qg=og[pg];qg.da&&(qg.cd(),qg.yb(!1),qg.jg(1),qg.hide())}og=this.ge.values();qg=og.length;for(pg=0;pg<qg;pg++)og[pg].reset();this.vd()};xg.le=function(og,pg){"string"===typeof og&&(og=og.includes(":")?this.bc.ar(og.split(":")[1]):this.bc.ar(og));if(og.$a!==this.bc)throw og.toString()+" don't belongs to "+this.bc.toString();var qg=this.ge.get(og);null==qg&&pg&&(qg=new Rk(this,og),this.ge.set(og,qg));return qg};
xg.Gc=function(){return this.bc.bounds().getCenter()};xg.wb=function(){return this.bc.bounds()};xg.Hd=function(){return this.Ea().vf.Hd()};xg.clone=function(og){og=wi.prototype.clone.call(this,og,this.bc);var pg=this.bd.keys(),qg;for(qg in pg){var rg=pg[qg].da.clone(!1);og.add(rg)}qg=this.ge.values();pg=0;for(rg=qg.length;pg<rg;pg++){var sg=qg[pg].clone(og);og.add(sg);og.ge.set(sg.Xc,sg)}return og};
function Tk(og,pg){wi.call(this);this.lo=og;this.lo.add(this);this.pa=pg;this.qd=new Vg;this.fa=this.pa.Qa();this.la=this.pa;this.updateMatrixWorld()}Tk.prototype=Object.create(wi.prototype);Tk.prototype.constructor=Tk;Gi.add(Tk,[ih.rk,ih.ck,ih.LINES,ih.xg,ih.vi,ih.dk,ih.zt,ih.tm,ih.zp,ih.bm,ih.Zo,ih.jk,ih.mp,ih.cm,ih.$o,ih.Jt,ih.Kt]);xg=Tk.prototype;xg["delete"]=function(){wi.prototype["delete"].call(this);for(var og=this.qd.values(),pg=0,qg=og.length;pg<qg;pg++)og[pg]["delete"]();this.parent.remove(this)};
xg.gw=function(){for(var og=this.qd.values(),pg=0,qg=og.length;pg<qg;pg++)this.remove(og[pg]);this.qd.clear()};xg.Ea=function(){return this.lo};xg.clear=function(og){og=this.hb(og);null!==og&&void 0!==og&&og.clear()};
xg.Ax=function(){if(this.la.Ua.cq>this.ga.Mu)return ih.rk;if(null!==this.pa.ja.name)switch(this.pa.ja.name){case "Protein":case "Peptide":return ih.dk;case "Small Peptide":return ih.ck;case "RNA":case "DNA":return ih.dk;case "Ligand":return ih.xg;case "Ion":return ih.vi;case "Solvent":case "Unknown":return ih.NONE}console.warn("Error, cannot draw : ",this.pa.ja.name);return null};xg.Ul=function(){var og=this.hb(this.Ax());null!==og&&void 0!==og?og.show():Promise.resolve()};
xg.ic=function(og,pg){"string"===typeof og&&(og=og.includes(":")?this.pa.wa(og.split(":")[1]):this.pa.wa(og));if(null==og||og.Ja()!==this.pa)return null;var qg=this.qd.get(og);null==qg&&pg&&(qg=new Sk(this,og),this.qd.set(og,qg));return qg};xg.reset=function(){this.visible=!0;for(var og=this.vc(!1),pg=0;pg<og.length;pg++){var qg=og[pg];qg.da&&(qg.cd(),qg.yb(!1),qg.jg(1),qg.hide())}this.Ul();og=this.qd.values();qg=og.length;for(pg=0;pg<qg;pg++)og[pg].reset();this.vd()};
xg.lf=function(){this.matrix.identity();this.matrixWorldNeedsUpdate=!0};xg.Gc=function(){return this.pa.bounds().getCenter()};xg.wb=function(){return this.pa.bounds()};xg.nc=function(){return this.pa.nc()};xg.Hd=function(){return this.Ea().vf.Hd()};
xg.clone=function(og){var pg=wi.prototype.clone.call(this,og,this.pa);if(this.Ea().vf.tb().Fd()){if(this.pa.Yh()||this.pa.Wh()){var qg=this.hb(ih.jk);qg.dy().then(function(){var og=qg.Eo.clone(!1);og.visible=!0;pg.add(og)})}return pg}og=this.bd.keys();for(var rg in og){var sg=og[rg];null==sg.da||sg.da instanceof Array||(sg=sg.da.clone(!1),pg.add(sg))}rg=this.qd.values();og=0;for(sg=rg.length;og<sg;og++){var tg=rg[og].clone(pg);pg.qd.set(tg.bc,tg);pg.add(tg)}return pg};
function Uk(){var og;$('<div id="not-implemented-dialog-form" title="Feature not available"><p class="info">This feature will be added soon</p></div>').appendTo(document.body);og=$("#not-implemented-dialog-form").dialog({autoOpen:!1,height:250,width:300,modal:!0,position:{my:"center",at:"center",of:$("#content")},buttons:{Cancel:function(){og.dialog("close")}}});$("#not-implemented-dialog-form")}var Vk=Vk||{};Vk.Sa=Vk.Sa||{};Vk.Sa.Sk=Vk.Sa.Sk||!1;Vk.Sa.zv=function(){return Vk.Sa.zk||Vk.Sa.yk};
Vk.Sa.hv=function(){if(Vk.Sa.zk)return document.webkitIsFullScreen;if(Vk.Sa.yk)return document.mozFullScreen;console.assert(!1)};Vk.Sa.gv=function(){Vk.Sa.Sk=!1};Vk.Sa.suspend=function(){Vk.Sa.Sk=!0};Vk.Sa.request=function(og){og=og||document.body;Vk.Sa.zk?og.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):Vk.Sa.yk?og.mozRequestFullScreen():console.assert(!1)};Vk.Sa.cancel=function(){Vk.Sa.zk?document.webkitCancelFullScreen():Vk.Sa.yk?document.mozCancelFullScreen():console.assert(!1)};
Vk.Sa.zk="webkitCancelFullScreen"in document?!0:!1;Vk.Sa.yk="mozCancelFullScreen"in document?!0:!1;Vk.Sa.toggle=function(og,pg){Vk.Sa.hv()?(og.gn(),null!=og.Vk?og.contextMenu.moveTo(og.Vk):og.contextMenu.moveTo(og.jn),Vk.Sa.cancel()):(og.gn(),null!=og.Vk&&og.contextMenu.moveTo(og.jn),Vk.Sa.request(pg))};
Vk.Sa.Bv=function(og){og=og||{};var pg=og.charCode||102,qg=void 0!==og.dblclick?og.dblclick:!1,rg=og.element,sg=og.Cv;document.addEventListener("keypress",function(og,pg){return function(){return og.apply(pg,arguments)}}(function(og){og.which!==pg||Vk.Sa.Sk||Vk.Sa.toggle(sg,rg)},this),!1);qg&&document.addEventListener("dblclick",toggle,!1)};
function Wk(og){var pg,qg;$('<div id="load-structure-dialog-form" title="Load New Structure"><p class="validateTips">All form fields are required.</p><form><fieldset><label id ="structIDLabel" for="structID">Structure ID : </label><input type="text" name="structID" id="structID" class="text ui-widget-content ui-corner-all"><br><label for="isPDBX">Load PDBX : </label><input type="checkbox" name="isPDBX" id="isPDBX" class="button ui-widget-content ui-corner-all" checked><input type="submit" tabindex="-1" style="position:absolute; top:-1000px"></fieldset></form></div>').appendTo(document.body);var rg=
$("#structID"),sg=$("#isPDBX"),tg=$([]).add(rg).add(sg);pg=$("#load-structure-dialog-form").dialog({autoOpen:!1,height:250,width:300,modal:!0,position:{my:"center",at:"center",of:$("#content")},buttons:{"Load Structure":function(){tg.removeClass("ui-state-error");if(!og.Hj){var qg=/^[a-z0-9]+$/i;if(4!=rg.val().length||!qg.test(rg.val())){rg.addClass("ui-state-error");return}}Xk.ba().Xg=sg.is(":checked");biovizAPI.re(rg.val())["catch"](function(og){console.log(og.message)});pg.dialog("close")},Cancel:function(){pg.dialog("close")}},
open:function(){Vk.Sa.suspend();og.Hj?$("#structIDLabel").html("Structure URL : "):$("#structIDLabel").html("Structure ID : ")},close:function(){Vk.Sa.gv();qg[0].reset();tg.removeClass("ui-state-error")}});qg=pg.find("form").on("submit",function(pg){pg.preventDefault();og.re()});return $("#load-structure-dialog-form")}
function Yk(og){var pg,qg;$('<div id="load-structure-file-dialog-form" title="Load New Structure"><p class="validateTips">All form fields are required.</p><form><fieldset><label id ="structIDLabel" for="file">Structure file : </label><input type="file" name="file" id="file"><br><label for="isPDBX2">Load PDBX : </label><input type="checkbox" name="isPDBX2" id="isPDBX2" class="button ui-widget-content ui-corner-all" checked><input type="submit" tabindex="-1" style="position:absolute; top:-1000px"></fieldset></form></div>').appendTo(document.body);var rg=
$("#isPDBX2");pg=$("#load-structure-file-dialog-form").dialog({autoOpen:!1,height:250,width:300,modal:!0,position:{my:"center",at:"center",of:$("#content")},buttons:{"Load Structure":function(){var og=$("#file")[0].files;Xk.ba().Xg=rg.is(":checked");biovizAPI.ql(og[0])["catch"](function(og){console.log(og.message)});pg.dialog("close")},Cancel:function(){pg.dialog("close")}},open:function(){og.Hj?$("#structIDLabel").html("Structure URL : "):$("#structIDLabel").html("Structure ID : ")},close:function(){qg[0].reset()}});
qg=pg.find("form").on("submit",function(pg){pg.preventDefault();og.re()});return $("#load-structure-file-dialog-form")}
function Zk(og){var pg,qg;$('<div id="load-script-dialog-form" title="Load New Script"><form><fieldset><label id ="scriptLabel" for="script">Script (string or url) : </label><input type="text" name="script" id="script" class="text ui-widget-content ui-corner-all"><br><input type="submit" tabindex="-1" style="position:absolute; top:-1000px"></fieldset></form></div>').appendTo(document.body);var rg=$("#script"),sg=$([]).add(rg);pg=$("#load-script-dialog-form").dialog({autoOpen:!1,height:250,width:300,
modal:!0,position:{my:"center",at:"center",of:$("#content")},buttons:{"Load Script":function(){function og(og){try{Xk.ba().pn(og),pg.dialog("close")}catch(Bg){rg.addClass("ui-state-error"),console.warn("Didn't succeed to get script")}}sg.removeClass("ui-state-error");var qg=rg.val();$.ajax({async:!0,crossDomain:!0,url:qg,success:function(pg){og(pg)},error:function(){og(qg)}})},Cancel:function(){pg.dialog("close")}},close:function(){qg[0].reset();sg.removeClass("ui-state-error")}});qg=pg.find("form").on("submit",
function(pg){pg.preventDefault();og.bz()});return $("#load-script-dialog-form")}
function $k(og){var pg,qg;$('<div id="load-local-script-dialog-form" title="Load New Script"><form><fieldset><label id ="scriptLabel" for="scriptFile">Script (string or url) : </label><input type="file" name="scriptFile" id="scriptFile"><br><input type="submit" tabindex="-1" style="position:absolute; top:-1000px"></fieldset></form></div>').appendTo(document.body);pg=$("#load-local-script-dialog-form").dialog({autoOpen:!1,height:250,width:300,modal:!0,position:{my:"center",at:"center",of:$("#content")},
buttons:{"Load Script":function(){var og=$("#scriptFile")[0].files,qg=new FileReader;qg.onload=function(){return function(og){og=og.target.result;Xk.ba().pn(og);pg.dialog("close");pg.dialog("close")}}(og);qg.readAsText(og[0])},Cancel:function(){pg.dialog("close")}},close:function(){qg[0].reset()}});qg=pg.find("form").on("submit",function(pg){pg.preventDefault();og.bz()});return $("#load-local-script-dialog-form")}
function al(og){function pg(){yg=tg.qb;Bg=tg.dc.antialias;Cg=tg.dc.nf;Ag=tg.Kf;wg=tg.dc.Bj;Dg=tg.Fg;Eg=tg.xn();Fg=tg.ir();Jg=tg.hr();Ig=tg.we;Lg=tg.zh;Kg=yg;Og=Dg;Sg=Lg;Qg="";$("#quality").find('option[value="'+yg+'"]').attr("selected",!0);$("#quality").selectmenu("refresh");$("#antialias").prop("checked",Bg);$("#invertZoom").prop("checked",wg);$("#sao").prop("checked",Cg);$("#saoScale").slider("value",10*Ag);$("#saoScaleInfo").html(Ag);$("#textSize").slider("value",Dg);$("#textSizeInfo").html(Dg+
"%");$("#mouse3D").val("");var og=[],pg=ug.Mh.values(),qg;for(qg in pg){var rg=pg[qg];og.push('<option value="'+rg.index+'">'+rg.id+"</option>")}$("#mouse3D").append(og.join(""));null!=ug.Xb&&(Qg=ug.Xb.id,Sg=ug.Xb.index,$("#mouse3D").find('option[value="'+Sg+'"]').attr("selected",!0),$("#mouse3D").selectmenu("refresh"));$("#colorpicker").minicolors("value",Eg);$("#colorpickerHighlight").minicolors("value",Fg);$("#colorpickerHighlightHide").minicolors("value",Jg);$("#pulse").prop("checked",Ig)}function qg(){tg.yq(Kg);
yg=Kg;Bg=$("#antialias").prop("checked");tg.Pv(Bg);Cg=$("#sao").prop("checked");tg.aw(Cg);tg.bw(Mg);Ag=Mg;wg=$("#invertZoom").prop("checked");tg.Wv(wg);tg.cw(Og);Dg=Og;$("#saveBg").prop("checked")?tg.Qv(og.Hk):tg.Rv(og.Hk);Eg=og.Hk;tg.Uv(og.bv);tg.Tv(og.cv);tg.Vv();ug.kA(Sg);tg.Yv(Qg);Lg=Sg}var rg,sg=$('<div id="config-dialog-form" title="BiovizJS Configuration"><label for="quality">Select a quality : </label><select name="quality" id="quality"><option value="LOW">Low</option><option value="MEDIUM">Medium</option><option value="HIGH">High</option></select><br/><label for="antialias">Antialiasing (needs page refresh) : </label><input type="checkbox" name="Antialiasing" id="antialias" class="button ui-widget-content ui-corner-all"><br/><label for="sao">Ambient Occlusion : </label><input type="checkbox" name="Occlusion" id="sao" class="button ui-widget-content ui-corner-all"><label for="saoScale">Occlusion scale : </label><span id="saoScaleInfo"></span><div id="saoScale"></div><br/><label for="invertZoom">Invert Zoom Axis : </label><input type="checkbox" name="InvertZoom" id="invertZoom" class="button ui-widget-content ui-corner-all"><br/><label for="mouse3D">Select a 3D Mouse : </label><select name="mouse3D" id="mouse3D"></select><br/><label for="colorpicker">Background color : </label><div id="colorpicker" value="colorpicker"></div><label for="saveBg" style="display: inline-block">Save background configuration : </label><input type="checkbox" name="saveBg" id="saveBg" class="button ui-widget-content ui-corner-all" style="display: inline-block"><br/><label for="colorpickerHighlight">Highlight color (visible) : </label><div id="colorpickerHighlight" value="colorpickerHighlight"></div><label for="colorpickerHighlightHide">Highlight color (hidden) : </label><div id="colorpickerHighlightHide" value="colorpickerHighlightHide"></div><label for="pulse">Pulse Highlight : </label><input type="checkbox" name="Pulse" id="pulse" class="button ui-widget-content ui-corner-all"><br/><label for="textSize">Text Size : </label><span id="textSizeInfo"></span><div id="textSize"></div><br/>');
sg.appendTo(document.body);var tg=Ph.ba(),ug=Xk.ba().ca.u.js,yg=tg.qb,Bg=tg.dc.antialias,Cg=tg.dc.nf,Ag=tg.Kf,wg=tg.dc.Bj,Dg=tg.Fg,Eg=tg.xn(),Fg=tg.ir(),Jg=tg.hr(),Ig=tg.we,Lg=tg.zh,Kg=yg,Mg=Ag,Og=Dg,Sg=Lg,Qg="";rg=$("#config-dialog-form").dialog({autoOpen:!1,height:250,width:300,modal:!0,position:{my:"center",at:"center",of:$("#content")},buttons:{Reset:function(){tg.Rz();$("#saveBg").prop("checked",!0);pg();qg()},Apply:function(){qg();rg.dialog("close")},Cancel:function(){rg.dialog("close")}},open:function(){pg()}});
$("#quality").selectmenu({width:"200px",select:function(og,pg){Kg=pg.item.value}});$("#mouse3D").selectmenu({width:"200px",select:function(og,pg){Sg=pg.item.value;Qg=pg.item.label}});$("#textSize").slider({slide:function(og,pg){Og=pg.value;$("#textSizeInfo").html(Og+"%")}});$("#saoScale").slider({slide:function(og,pg){Mg=pg.value/10;$("#saoScaleInfo").html(Mg)}});Eg=tg.xn();$("#colorpicker").minicolors({control:"hue",defaultValue:Eg,format:"hex",keywords:"",letterCase:"lowercase",swatches:[],change:function(pg){pg&&
"object"===("undefined"===typeof console?"undefined":Vh(console))&&(og.Hk=pg)}});$("#colorpickerHighlight").minicolors({control:"hue",defaultValue:Eg,format:"hex",keywords:"",letterCase:"lowercase",swatches:[],change:function(pg){pg&&"object"===("undefined"===typeof console?"undefined":Vh(console))&&(og.bv=pg)}});$("#colorpickerHighlightHide").minicolors({control:"hue",defaultValue:Eg,format:"hex",keywords:"",letterCase:"lowercase",swatches:[],change:function(pg){pg&&"object"===("undefined"===typeof console?
"undefined":Vh(console))&&(og.cv=pg)}});sg.find("select").css({width:"150%"});sg.find("select").find(".options-small").css({"font-size":"0.8em"});sg.find("label").css({display:"block"});return $("#config-dialog-form")}
function bl(){var og;og='<div id="biovizjsinfo" title="BiovizJS informations"><div id="keyboard" autofocus><div id="mouse"><label> Mouse </label><div class="separator"></div><table><tr><td class="controlLine">Left-click</td><td> Rotate</td></tr><tr><td class="controlLine">Right-click</td><td> Translate / Open context menu</td></tr><tr><td class="controlLine">Double click</td><td> Select an object</td></tr><tr><td class="controlLine">Scroll Up / Down</td><td> Move object forward / backward</td></tr><tr><td class="controlLine">Ctrl + Scroll</td><td> Control eye separation for stereoscopy and anaglyph effects</td></tr></table></div><br/><label> Keyboard shortcut </label><div class="separator"></div><table><tr><td>I</td><td>Show controls</td></tr>';null!=
Xk.ba().ob&&(null!=Xk.ba().ob.Jc("Representation")&&(og+="<tr><td>R</td><td>Show representation manager</td></tr>"),null!=Xk.ba().ob.Jc("Legend")&&(og+="<tr><td>L</td><td>Show color mapping legend</td></tr>"),null!=Xk.ba().ob.Jc("Measurements")&&(og+="<tr><td>M</td><td>Show measuring tool</td></tr>"),null!=Xk.ba().ob.Jc("Clipping")&&(og+="<tr><td>C</td><td>Show clipping tool</td></tr>"),null!=Xk.ba().ob.Jc("Fog")&&(og+="<tr><td>N</td><td>Show fog tool</td></tr>"),null!=Xk.ba().ob.Jc("Bioassembly")&&
(og+="<tr><td>A</td><td>Show bioassembly manager</td></tr>"));og=$(og+"<tr><td>F</td><td>Enable / Disable BiovizJS full-screen</td></tr></table></div></div>");og.appendTo(document.body);$("#keyboard").css({display:"flex","flex-direction":"column"});$(".keyboardItem").css({margin:"0"});$("#mouse").css({display:"flex","flex-direction":"column"});$(".mouseItem").css({margin:"0"});$(".separator").css({"border-style":"solid","border-width":"1px",width:"60%"});$(".controlLine").css({overflow:"hidden","white-space":"nowrap"});
var pg=$("#biovizjsinfo").dialog({autoOpen:!1,modal:!0,position:{my:"center",at:"center",of:$("#content")}});og.css({"font-size":"0.8em"});document.addEventListener("keypress",function(og,pg){return function(){return og.apply(pg,arguments)}}(function(og){105===og.which&&($("#pInformation").hide(),pg.dialog("isOpen")?pg.dialog("close"):pg.dialog("open"))},this),!1);return pg}
function cl(){var og=new ClientJS,pg;pg='<div id="systemInfo" title="System informations"><div id="sysInfo" autofocus><table>'+('<tr><td class="controlLine">Browser</td><td>'+og.getBrowser()+"</td></tr>");pg+='<tr><td class="controlLine">Browser Version</td><td>'+og.getBrowserVersion()+"</td></tr>";pg+='<tr><td class="controlLine">Operating System</td><td>'+og.getOS()+"</td></tr>";pg+='<tr><td class="controlLine">OS Version</td><td>'+og.getOSVersion()+"</td></tr>";pg+='<tr><td class="controlLine">CPU</td><td>'+
og.getCPU()+"</td></tr>";og=$(pg+"</table></div>");og.appendTo(document.body);$("#sysInfo").css({display:"flex","flex-direction":"column"});$(".controlLine").css({overflow:"hidden","white-space":"nowrap"});pg=$("#systemInfo").dialog({autoOpen:!1,modal:!0,position:{my:"center",at:"center",of:$("#content")}});og.css({"font-size":"0.8em"});return pg}
function dl(){var og=$('<div id="biovizJSInfo" title="About Bioviz JS"><div id="bvInfo" autofocus><p>Bioviz JS, a molecular 3D viewer for browser and mobile devices</p><p>More information about BIONEXT <a id="bvLink" href="http://bionext.com">here</a>.</p>'+("<p>&copy; 2015-"+(new Date).getFullYear()+" BIONEXT SA</p>")+"</div>");og.appendTo(document.body);$("#bvInfo").css({display:"flex","flex-direction":"column"});$("#bvLink").attr("target","_blank");var pg=$("#biovizJSInfo").dialog({autoOpen:!1,
modal:!0,position:{my:"center",at:"center",of:$("#content")}});og.css({"font-size":"0.8em"});return pg}function fl(og,pg){this.div=og;this.menu=null;this.Hj=!1;this.Pi(pg);this.uk=this.Dk=this.ae=this.Qb=this.de=this.Wd=this.$a=this.ab=this.Ua=null;this.Dh=this.Eh=!1;this.ca=Xk.ba().ca;this.u=this.ca.u;this.Hk=""}xg=fl.prototype;xg.moveTo=function(og){this.menu.getMenu().detach().appendTo(og)};
xg.lu=function(og,pg){var qg=[];if(pg){var rg={title:"Load",cmd:"load",children:[{title:"Load&nbspURL",cmd:"loadUrl"},{title:"Load&nbspFrom&nbsp"+og,cmd:"loadPDB"},{title:"Load&nbspFrom&nbspLocal&nbspFile",cmd:"loadFile"}]};null!=Xk.ba().Sd&&rg.children.push({title:"Load&nbspScript",cmd:"loadScript"},{title:"Load&nbspScript&nbspFile",cmd:"loadScriptFile"});qg.push({title:"File",children:[rg,{title:"Options",cmd:"options"},{title:"Reset",cmd:"reset"}]})}else qg.push({title:"File",children:[{title:"Options",
cmd:"options"},{title:"Reset",cmd:"reset"}]});rg={title:"Model",cmd:"model",children:[{title:"Clear&nbsprotation&nbspanchor",cmd:"clearAnchor"}]};null!=Xk.ba().ob&&null!=Xk.ba().ob.Jc("Representation")&&rg.children.push({title:"Manage&nbsprepresentations",cmd:"manageRep"});qg.push(rg);null!=Xk.ba().ob&&(rg={title:"Tools",children:[]},null!=Xk.ba().ob.Jc("Bioassembly")&&rg.children.push({title:"Biological Assemblies",cmd:"bioassembly"}),null!=Xk.ba().ob.Jc("Measurements")&&rg.children.push({title:"Measurements",
cmd:"measurements"}),null!=Xk.ba().ob.Jc("Legend")&&rg.children.push({title:"Legend",cmd:"legend"}),null!=Xk.ba().ob.Jc("Clipping")&&rg.children.push({title:"Clipping",cmd:"clipping"}),rg.children.push({title:"Screenshot",cmd:"screenshot"}),qg.push(rg));qg.push({title:"Misc",children:[{title:"Stereoscopy",cmd:"stereo"},{title:"Anaglyph",cmd:"anaglyph"},{title:"Fullscreen",cmd:"fullscreen"},{title:"Zoom",children:[{title:"25%",cmd:"zoom25"},{title:"50%",cmd:"zoom50"},{title:"100%",cmd:"zoom100"},{title:"200%",
cmd:"zoom200"},{title:"400%",cmd:"zoom400"}]},{title:"Spin",cmd:"spin"}]});qg.push({title:"About",children:[{title:"Controls",cmd:"controls"},{title:"BiovizJS",cmd:"biovizJS"},{title:"System",cmd:"System"}]});return qg};
xg.Pi=function(og){var pg=this,qg=Wk(this),rg=Yk(this),sg=Zk(this),tg=$k(this);Uk();var ug=al(this),yg=bl(),Bg=cl(),Cg=dl(),Ag={title:"Move",cmd:"move"},wg={title:"Reset&nbspposition",cmd:"resetPos"},Dg={title:"Center",cmd:"center"},Eg={title:"Zoom",cmd:"zoom"},Fg={title:"As&nbsprotation&nbspanchor",cmd:"anchor"},Jg={title:"Structure&nbspname",cmd:"labelStr"},Ig={title:"Molecule&nbspname",cmd:"labelMol"},Lg={title:"Residue&nbspname",cmd:"labelRes"},Kg={title:"Atom&nbspname",cmd:"labelAtom"},Mg={title:"vdW",
cmd:"labelVdw"},Og={title:"Clear",cmd:"labelClear"},Sg={title:"Remove",cmd:"remove"},Qg=Xk.ba().Vo,Qg=Qg.split("${id}")[0];og=this.lu(Qg,og);this.menu=this.div.contextmenu({delegate:".hasContextMenu",autoTrigger:!1,preventContextMenuForPopup:!0,menu:og,position:function(og){return{my:"left top",at:"left+"+og.extraData.pageX+" top+"+og.extraData.pageY,of:parent.$(document),collision:og.extraData.as?"none":"fit"}},beforeOpen:function(og){pg.Wd=og.extraData.target;null!==pg.Wd?(pg.fv(),og=pg.de.Vn()?
{title:"Model",cmd:"model",children:[{title:"Clear&nbsprotation&nbspanchor",cmd:"clearAnchor"},{title:"----"},{title:pg.Ua.toString(),cmd:"structure",children:[Ag,wg,Fg,{title:"----"},Dg,Eg,{title:"----"},Sg]}]}:{title:"Model",cmd:"model",children:[{title:"Clear&nbsprotation&nbspanchor",cmd:"clearAnchor"},{title:"----"},{title:pg.Ua.toString(),cmd:"structure",children:[Ag,wg,Fg,{title:"----"},Dg,Eg,{title:"----"},{title:"Labels",children:[Jg,Ig,Lg,Kg,Mg,{title:"----"},Og]},{title:"----"},Sg]},{title:pg.ab.toString(),
cmd:"molecule",children:[Ag,wg,Fg,{title:"----"},Dg,Eg,{title:"----"},{title:"Labels",children:[Ig,Lg,Kg,Mg,{title:"----"},Og]}]},{title:pg.$a.toString(),cmd:"residue",children:[Fg,{title:"----"},Dg,Eg,{title:"----"},{title:"Labels",children:[Lg,Kg,Mg,{title:"----"},Og]}]},{title:pg.Wd.toString(),cmd:"atom",children:[Fg,{title:"----"},Dg,Eg,{title:"----"},{title:"Labels",children:[Kg,Mg,{title:"----"},Og]}]}]},null!=Xk.ba().ob&&null!=Xk.ba().ob.Jc("Representation")&&og.children.push({title:"----"},
{title:"Manage&nbsprepresentations",cmd:"manageRep"}),pg.div.contextmenu("setEntry","model",og)):(og={title:"Model",cmd:"model",children:[{title:"Clear&nbsprotation&nbspanchor",cmd:"clearAnchor"}]},null!=Xk.ba().ob&&null!=Xk.ba().ob.Jc("Representation")&&og.children.push({title:"Manage&nbsprepresentations",cmd:"manageRep"}),pg.div.contextmenu("setEntry","model",{title:"Model",cmd:"model",children:og}))},select:function(og,wg){og.stopPropagation();switch(wg.cmd){case "loadUrl":pg.Hj=!0;qg.dialog("open");
break;case "loadPDB":pg.Hj=!1;qg.dialog("open");break;case "loadFile":rg.dialog("open");break;case "loadScript":sg.dialog("open");break;case "loadScriptFile":tg.dialog("open");break;case "reset":pg.u.reset();break;case "options":ug.dialog("open");break;case "legend":Xk.ba().ob.Uj("Legend");break;case "clipping":Xk.ba().ob.Uj("Clipping");break;case "bioassembly":Xk.ba().ob.Uj("Bioassembly");break;case "screenshot":biovizAPI.fh();break;case "fullscreen":pg.ca.u.$l();break;case "stereo":pg.Eh=!pg.Eh;
pg.Dh=pg.ca.Eh(pg.Eh);break;case "anaglyph":pg.Dh=!pg.Dh;pg.Eh=pg.ca.Dh(pg.Dh);break;case "zoom25":case "zoom50":case "zoom100":case "zoom200":case "zoom400":pg.ca.kd(null,!0,parseFloat(wg.cmd.split("zoom").pop())/100);break;case "spin":null===pg.ca.bh?pg.ca.Vl():pg.ca.Xj();break;case "measurements":Xk.ba().ob.Uj("Measurements");break;case "controls":yg.dialog("open");break;case "biovizJS":Cg.dialog("open");break;case "System":Bg.dialog("open");break;case "move":var Ag=wg.item.context.parentElement.parentElement.dataset.command;
switch(Ag){case "structure":pg.ca.Ib=pg.de;pg.u.zc(pg.de);break;case "molecule":pg.ca.Ib=pg.ae;pg.u.zc(pg.ae);break;default:throw Error("Parent command type "+Ag+" is not handled");}break;case "resetPos":Ag=wg.item.context.parentElement.parentElement.dataset.command;switch(Ag){case "structure":pg.de.lf();break;case "molecule":pg.ae.lf();break;default:throw Error("Parent command type "+Ag+" is not handled");}break;case "clearAnchor":pg.u.zc(null);break;case "anchor":Ag=wg.item.context.parentElement.parentElement.dataset.command;
switch(Ag){case "structure":pg.u.zc(pg.de);break;case "molecule":pg.u.zc(pg.ae);break;case "residue":pg.Om();pg.u.zc(pg.Dk);break;case "atom":pg.Km();pg.u.zc(pg.uk);break;default:throw Error("Parent command type "+Ag+" is not handled");}break;case "center":Ag=wg.item.context.parentElement.parentElement.dataset.command;switch(Ag){case "structure":pg.ca.kd(pg.de);break;case "molecule":pg.ca.kd(pg.ae);break;case "residue":pg.Om();pg.ca.kd(pg.Dk);break;case "atom":pg.Km();pg.ca.kd(pg.uk);break;default:throw Error("Parent command type "+
Ag+" is not handled");}break;case "zoom":Ag=wg.item.context.parentElement.parentElement.dataset.command;switch(Ag){case "structure":pg.ca.u.kj(pg.de,1E3,!0,.65);break;case "molecule":pg.ca.u.kj(pg.ae,1E3,!0,.65);break;case "residue":pg.Om();pg.ca.u.kj(pg.Dk,1E3,!0,.65);break;case "atom":pg.Km();pg.ca.u.kj(pg.uk,1E3,!0,.65);break;default:throw Error("Parent command type "+Ag+" is not handled");}break;case "remove":pg.ca.so(pg.de);break;case "labelStr":Ag=wg.item.context.parentElement.parentElement.parentElement.parentElement.dataset.command;
pg.th(Ag);var Dg;"structure"===Ag&&(Dg=pg.Ua);pg.Qb.gc(Dg,gl.Ia.om);break;case "labelMol":Ag=wg.item.context.parentElement.parentElement.parentElement.parentElement.dataset.command;pg.th(Ag);"molecule"===Ag&&(Dg=pg.ab);pg.Qb.gc(Dg,gl.Ia.oc);break;case "labelRes":Ag=wg.item.context.parentElement.parentElement.parentElement.parentElement.dataset.command;pg.th(Ag);switch(Ag){case "structure":break;case "molecule":Dg=pg.ab;break;case "residue":Dg=pg.$a;break;default:throw Error("Parent command type "+
Ag+" is not handled");}pg.Qb.gc(Dg,gl.Ia.Ud);break;case "labelAtom":Ag=wg.item.context.parentElement.parentElement.parentElement.parentElement.dataset.command;pg.th(Ag);switch(Ag){case "structure":pg.Qb.gc(void 0,gl.Ia.Fb);break;case "molecule":pg.Qb.gc(pg.ab,gl.Ia.Fb);break;case "residue":pg.Qb.gc(pg.$a,gl.Ia.Fb);break;case "atom":pg.Qb.gc(pg.Wd,gl.Ia.Fb);break;default:throw Error("Parent command type "+Ag+" is not handled");}break;case "labelVdw":Ag=wg.item.context.parentElement.parentElement.parentElement.parentElement.dataset.command;
pg.th(Ag);switch(Ag){case "structure":pg.Qb.gc(void 0,gl.Ia.Vd);break;case "molecule":pg.Qb.gc(pg.ab,gl.Ia.Vd);break;case "residue":var Ag=pg.$a.Qa(),Eg;for(Eg in Ag)pg.Qb.gc(Ag[Eg],gl.Ia.Vd);break;case "atom":pg.Qb.gc(pg.Wd,gl.Ia.Vd);break;default:throw Error("Parent command type "+Ag+" is not handled");}break;case "labelClear":Ag=wg.item.context.parentElement.parentElement.parentElement.parentElement.dataset.command;pg.th(Ag);break;case "manageRep":Xk.ba().ob.Uj("Representation");Xk.ba().ob.Jc("Representation").dn(pg.Wd);
break;default:throw Error("Command "+wg.cmd+" not handled by ContextMenu");}}}).contextmenu("instance")};xg.th=function(og){switch(og){case "structure":this.Qb.Od();break;case "molecule":this.Qb.Od(this.ae);this.Qb.Od(this.ae.pa.ka);this.Qb.Od(this.ae.pa.Qa());break;case "residue":this.Qb.Od(this.$a);this.Qb.Od(this.$a.Qa());break;case "atom":this.Qb.Od(this.Wd);break;default:throw Error("Parent command type "+og+" is not handled");}};
xg.fv=function(){var og=Xk.ba().ca;this.$a=this.Wd.wa();this.ab=this.$a.Ja();this.Ua=this.ab.Ua;this.de=og.tb(this.Ua.oa());this.Qb=this.de.Ea();this.ae=og.Tf(this.Ua.oa(),this.ab.ja.name,this.ab.id)[0]};xg.Om=function(){this.Dk=Xk.ba().ca.ic(this.Ua.oa(),this.ab.ja.name,this.ab.id,this.$a._id,!0)[0]};xg.Km=function(){this.uk=Xk.ba().ca.le(this.Ua.oa(),this.ab.ja.name,this.ab.id,this.Wd.id,this.Wd.Le,!0)[0]};
function EventTarget(og){this._listeners={};var pg=this;og&&!og.addListener&&(og.addListener=function(og,rg){pg.addListener(og,rg)},og.removeListener=function(og,rg){pg.removeListener(og,rg)},og.Hb=function(og){pg.fire(og)})}EventTarget.prototype.addListener=function(og,pg){void 0===this._listeners[og]&&(this._listeners[og]=[]);this._listeners[og].push(pg)};
EventTarget.prototype.removeListener=function(og,pg){var qg=this._listeners[og];if(void 0!==qg)for(var rg=qg.length,sg=0;sg<rg;sg++)if(qg[sg]===pg){qg.splice(sg,1);break}};EventTarget.prototype.fire=function(og){"string"===typeof og&&(og={type:og});og.target||(og.target=this);if(!og.type)throw Error("Event object type must be defined");var pg=this._listeners[og.type];if(void 0!==pg)for(var qg=pg.length,rg=0;rg<qg;rg++)pg[rg].call(this,og)};
function hl(og,pg){ci.call(this);this.duration=-1;this.speed=pg;this.target=og;var qg=this.target.Gc();this.vo=new THREE.Vector3(-qg.x,-qg.y,-qg.z);this.Ml=(new THREE.Matrix4).setPosition(this.vo);this.Nl=qg.clone();this.uo=(new THREE.Matrix4).setPosition(this.Nl)}hl.prototype=Object.create(ci.prototype);hl.prototype.constructor=hl;
hl.prototype.Ke=function(og){var pg=new THREE.Matrix4;pg.copy(this.target.matrixWorld);var qg=new THREE.Matrix4;qg.getInverse(pg);var pg=new THREE.Vector3(qg.elements[0],qg.elements[1],qg.elements[2]),rg=new THREE.Vector3(qg.elements[4],qg.elements[5],qg.elements[6]),qg=(new THREE.Vector3).crossVectors(pg,rg),sg=new THREE.Matrix4;sg.Oh(og/1E3*this.speed*2*Math.PI,rg.x,rg.y,rg.z);og=new THREE.Matrix4;og.Oh(0,pg.x,pg.y,pg.z);pg=new THREE.Matrix4;pg.Oh(0,qg.x,qg.y,qg.z);new THREE.Matrix4;og=pg.multiply(og).multiply(sg);
og=(new THREE.Matrix4).multiply(this.uo).multiply(og).multiply(this.Ml);this.target.matrix.copy(this.target.matrix.multiply(og));this.target.matrixWorldNeedsUpdate=!0};hl.prototype.stop=function(){this.duration=0};function jl(og){this.isDirectionalLight=!0;this.Tk=null;this.u=og;this.Tk=new THREE.DirectionalLight(16777215,1);this.Tk.position.set(this.u.camera.position.x,this.u.camera.position.y,this.u.camera.position.z);this.Tk.matrixAutoUpdate=!0;this.u.Cc.add(this.Tk)}
function kl(og,pg,qg,rg){ci.call(this);this.duration=og;this.target=pg;this.u=qg;this.Pn=new THREE.Matrix4;this.Pn.copy(this.target.matrix);this.Gy=new THREE.Vector3;this.Qn=new THREE.Quaternion;this.Tn=new THREE.Vector3;this.Pn.decompose(this.Gy,this.Qn,this.Tn);this.Lh=rg;this.ex=new THREE.Vector3;this.qn=new THREE.Quaternion;this.rn=new THREE.Vector3;this.Lh.decompose(this.ex,this.qn,this.rn);og=this.target.Gc();null==og&&(og=this.target.Gc(!0));this.vo=new THREE.Vector3(-og.x,-og.y,-og.z);this.Ml=
(new THREE.Matrix4).setPosition(this.vo);this.Nl=og.clone();this.uo=(new THREE.Matrix4).setPosition(this.Nl);this.Jo=new THREE.Vector3;pg=new THREE.Matrix4;pg.multiply(this.Pn).multiply((new THREE.Matrix4).setPosition(og));this.Jo.setFromMatrixPosition(pg);pg=new THREE.Vector3;qg=new THREE.Matrix4;qg.multiply(this.Lh).multiply((new THREE.Matrix4).setPosition(og));pg.setFromMatrixPosition(qg);this.Yo=new THREE.Vector3;this.Yo.subVectors(this.Jo,og);this.bn=new THREE.Vector3;this.bn.subVectors(pg,this.Jo)}
kl.prototype=Object.create(ci.prototype);kl.prototype.constructor=kl;
kl.prototype.Ke=function(og){this.bb+=og;og=this.bb/this.duration;if(1<og||isNaN(og))this.target.matrix.copy(this.Lh);else{var pg=new THREE.Quaternion;THREE.Quaternion.slerp(this.Qn,this.qn,pg,og);var pg=(new THREE.Matrix4).makeRotationFromQuaternion(pg),qg=new THREE.Vector3;qg.lerp(this.bn,og);(new THREE.Matrix4).setPosition(qg);var rg=new THREE.Vector3;rg.lerpVectors(this.Tn,this.rn,og);(new THREE.Matrix4).scale(rg);og=(new THREE.Matrix4).setPosition(qg.add(this.Nl).add(this.Yo));og.multiply(pg);
og.multiply(this.Ml);this.target.matrix.copy(og)}this.target.matrixWorldNeedsUpdate=!0};
kl.prototype.test=function(){var og=new THREE.SphereGeometry(1,4,4);materialPivot=new THREE.MeshPhongMaterial({overdraw:!0,color:65280});materialCentroid=new THREE.MeshPhongMaterial({overdraw:!0,color:13421772});for(var pg=0;10>=pg;pg++){var qg=new THREE.Mesh(og.clone(),materialPivot),rg=this.target.Gc(),sg=new THREE.Mesh(og.clone(),materialCentroid);qg.position.copy(rg);qg.name=pg;var tg=pg/10,ug=new THREE.Quaternion;THREE.Quaternion.slerp(this.Qn,this.qn,ug,tg);var ug=(new THREE.Matrix4).makeRotationFromQuaternion(ug),
yg=new THREE.Vector3;yg.lerpVectors(new THREE.Vector3,this.bn,tg);var yg=(new THREE.Matrix4).setPosition(yg),Bg=new THREE.Vector3;Bg.lerpVectors(this.Tn,this.rn,tg);(new THREE.Matrix4).scale(Bg);tg=(new THREE.Matrix4).setPosition(this.Yo);tg.multiply(this.uo);tg.multiply(yg);tg.multiply(ug);tg.multiply(this.Ml);qg.position.setFromMatrixPosition(tg);sg.position.setFromMatrixPosition(tg.multiply((new THREE.Matrix4).setPosition(rg)));this.u.add(qg);this.u.add(sg)}};
function ll(og){new THREE.Clock;this.ga=Ph.ba();this.fd=[];this.pause=!1;this.u=og}xg=ll.prototype;xg.Wc=function(og){this.fd.push(og)};
xg.Ih=function(og,pg){if(null!=og)if(og===ei||og===gi){var qg=!0,rg=!1,sg=void 0;try{for(var tg=this.fd[Symbol.iterator](),ug;!(qg=(ug=tg.next()).done);qg=!0){var yg=ug.value;if(pg===yg.Ma&&og===yg.constructor){this.nn(yg);break}}}catch(Bg){rg=!0,sg=Bg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}}else{if(og===kl){tg=!0;ug=!1;yg=void 0;try{for(qg=this.fd[Symbol.iterator]();!(tg=(rg=qg.next()).done);tg=!0)if(sg=rg.value,pg===sg.target&&og===sg.constructor){this.nn(sg);break}}catch(Bg){ug=
!0,yg=Bg}finally{try{!tg&&qg["return"]&&qg["return"]()}finally{if(ug)throw yg;}}}}else this.fd.splice(0,this.fd.length)};xg.am=function(og,pg){if(!this.pause||pg)for(var qg=this.fd.length,rg=0;rg<qg;rg++){var sg=this.fd[rg];sg.Ke(og);sg.aa()&&(this.nn(rg),qg--)}};xg.nn=function(og){og instanceof ci?this.fd.splice(this.fd.indexOf(og),1):this.fd.splice(og,1)};xg.Rl=function(og){this.pause=og};function ml(og,pg,qg,rg){ci.call(this);this.duration=qg;this.u=pg;this.text=og;this.position=rg}
ml.prototype=Object.create(ci.prototype);ml.prototype.constructor=ml;ml.prototype.Ke=function(og){this.bb+=og;this.bb>=this.duration&&(og=this.u.dh.get(this.position),og.splice(og.indexOf(this.text)),this.u.Rd.remove(this.text),this.u.jb=!0)};function nl(og,pg,qg,rg){ci.call(this);this.r=og;this.g=pg;this.b=qg;this.duration=rg;this.us=this.ga.bgColor.r;this.Yq=this.ga.bgColor.g;this.qq=this.ga.bgColor.b}nl.prototype=Object.create(ci.prototype);nl.prototype.constructor=nl;
nl.prototype.Ke=function(og){this.bb+=og;og=this.bb/this.duration;1<og?this.ga.Pg(new THREE.Color(this.r,this.g,this.b)):this.ga.Pg(new THREE.Color(this.us+(this.r-this.us)*og,this.Yq+(this.g-this.Yq)*og,this.qq+(this.b-this.qq)*og))};function ol(og,pg,qg,rg,sg){ci.call(this);this.duration=qg;this.u=pg;this.Lh=new THREE.Matrix4;this.Tr=new THREE.Matrix4;this.Tr.copy(this.u.matrix);og=vi.yn(og,this.u,rg,sg);this.Lh.copy(og)}ol.prototype=Object.create(ci.prototype);ol.prototype.constructor=ol;
ol.prototype.Ke=function(og){this.bb+=og;og=this.bb/this.duration;1<og&&(og=1);var pg=new THREE.Matrix4;pg.lerp(this.Tr,this.Lh,og);this.u.matrix.copy(pg);this.u.matrixWorldNeedsUpdate=!0};
function pl(og,pg){Jh.call(this,og,pg);(this.Zq="getGamepads"in navigator)||console.warn("Gamepad API not supported, you can't use any 3D device to control BiovizJS");var qg=this;this.Mh=new Vg;this.Xb=null;this.Xn=this.Wn=this.fo=this.ho=!1;window.addEventListener("gamepadconnected",function(og){qg.tw(og)});window.addEventListener("gamepaddisconnected",function(og){qg.Nw(og)});this.iy="GamepadEvent"in window;var rg=window.chrome,sg=window.navigator.vendor,tg=-1<window.navigator.userAgent.indexOf("OPR"),
ug=-1<window.navigator.userAgent.indexOf("Edge");this.isChrome=null!==rg&&void 0!==rg&&"Google Inc."===sg&&0==tg&&0==ug}pl.prototype=Object.create(Jh.prototype);xg=pl.prototype;xg.constructor=pl;xg.kA=function(og){this.Xb=this.Mh.get(og)};xg.tw=function(og){this.fq(og.Xb)};xg.Nw=function(og){this.Oz(og.Xb)};
xg.update=function(){if(this.Zq&&(this.iy&&!this.isChrome||this.Yz(),null!=this.Xb)){var og=this.Xb.buttons[0];og&&og.pressed?this.Wn||(this.ho=!this.ho,this.Wn=!0):this.Wn=!1;(og=this.Xb.buttons[1])&&og.pressed?this.Xn||(this.fo=!this.fo,this.Xn=!0):this.Xn=!1;var og=this.Xb.axes[0]*Jh.pm*.1/Jh.yf,pg=this.Xb.axes[1]*Jh.pm*.1/Jh.yf,qg=this.Xb.axes[2]*Jh.pm*.1/Jh.yf,rg=this.Xb.axes[3]*Jh.jm,sg=this.Xb.axes[4]*Jh.jm,tg=this.Xb.axes[5]*Jh.jm;if(0!==og||0!==pg||0!==qg||0!==rg||0!==sg||0!==tg)this.fo||
this.u.ca.rotate(-tg,rg,sg),this.ho||this.u.ca.translate(og,-qg,pg)}};xg.fq=function(og){null!=og&&(og.nc=function(){return this.index+":"+this.id},this.Mh.set(og.index,og),null==this.Xb||og.id===ModellingProperties.ba().zh)&&(this.Xb=og)};xg.Oz=function(og){this.Xb.index==og.index&&(this.Xb=null);this.Mh.remove(og.index)};xg.Yz=function(){for(var og=navigator.getGamepads(),pg=0;pg<og.length;pg++){var qg=og[pg];qg&&(this.Mh.Kh(qg.index)?this.Mh.set(qg.index,qg):this.fq(qg))}};
function ql(og,pg){Jh.call(this,og,pg);this.Oa={NONE:-1,xf:0,mh:2,qh:3,qt:1};this.Va=this.Oa.NONE;this.Kd=1;var qg=this,rg;this.Yn=!1;this.mousedown=function(og){Xk.ba().gn();rg=og.timeStamp;Xk.ba().Ws(!1);if(qg.Va===qg.Oa.NONE)qg.Va=og.button;else if(qg.Va===qg.Oa.xf||qg.Va===qg.Oa.mh)qg.Va=qg.Oa.qh;qg.Va===qg.Oa.xf?qg.Ek=qg.Yi=qg.Ph(og.clientX,og.clientY):qg.Va===qg.Oa.Fi||qg.Va===qg.Oa.qh?qg.Ch=qg.Lf=qg.Ph(og.clientX,og.clientY):qg.Uc=qg.pc=qg.Ph(og.clientX,og.clientY)};this.mouseup=function(og){Xk.ba().Ws(!0);
if(qg.Va===qg.Oa.qt){if(qg.u.ca.rl){qg.Va=qg.Oa.NONE;return}var pg=og.offsetX/$("#content").width()*2-1,sg=2*-(og.offsetY/$("#content").height())+1,pg=qg.u.raycast(pg,sg),sg=null;pg&&(pg=pg.wa(),sg=pg.Ja(),sg=qg.u.ca.ic(sg.Ua.oa(),sg.ja.name,sg.id,pg._id,!0)[0]);qg.u.ca.kd(sg,og.ctrlKey||!sg?!0:!1,sg?.65:1);qg.u.ca.Ib=qg.u}else if(rg=og.timeStamp-rg,300>rg&&5>Math.abs(qg.pc.x-qg.Uc.x)&&5>Math.abs(qg.pc.y-qg.Uc.y))if(pg=og.offsetX/$("#content").width()*2-1,sg=2*-(og.offsetY/$("#content").height())+
1,pg=qg.u.raycast(pg,sg),2==og.button)Xk.ba().sz({target:null!=pg?pg:null,pageX:og.pageX,pageY:og.pageY});else if(0==og.button){for(og=0;og<qg.callback.length;og++)if("function"===typeof qg.callback[og]&&null!=pg)qg.callback[og](pg);null!=pg&&qg.Yn&&qg.u.Vm(pg)}qg.Va=qg.Oa.NONE};this.Vz=function(og){og.preventDefault()};this.mousemove=function(og){if(qg.Va===qg.Oa.NONE){var pg=og.offsetX/$("#content").width()*2-1;og=2*-(og.offsetY/$("#content").height())+1;pg=qg.u.raycast(pg,og);og=null;null!=pg&&
(og=pg.eb());qg.u.ca.Zm(og)}else qg.Va===qg.Oa.xf?qg.Yi=qg.Ph(og.clientX,og.clientY):qg.Va===qg.Oa.Fi||qg.Va===qg.Oa.qh?qg.Lf=qg.Ph(og.clientX,og.clientY):qg.Va===qg.Oa.mh&&(qg.pc=qg.Ph(og.clientX,og.clientY))};this.iz=function(og){og.preventDefault();og.stopPropagation();!0===og.ctrlKey?qg.u.fA(qg.u.uq+og.deltaY*Jh.cu):qg.u.ca.translate(0,0,-og.deltaY*og.deltaFactor*Jh.yf)};this.update=function(){if(qg.Va!==qg.Oa.NONE)if(qg.Va===qg.Oa.xf){var og=(this.Yi.x-this.Ek.x)*Jh.gk*this.Kd,pg=(this.Yi.y-
this.Ek.y)*Jh.gk*this.Kd;qg.u.ca.rotate(og,pg,0);this.Ek=this.Yi}else qg.Va===qg.Oa.Fi||qg.Va===qg.Oa.qh?(og=this.Lf.y-this.Ch.y,og=this.Va===this.Oa.qh?og*Jh.ip:og*Jh.yf,og*=this.Kd,qg.u.ca.translate(0,0,og),this.Ch=this.Lf):qg.Va===qg.Oa.mh&&(og=(this.pc.x-this.Uc.x)*Jh.fk*this.Kd,pg=(this.pc.y-this.Uc.y)*Jh.fk*this.Kd,qg.u.ca.translate(og,-pg,0),this.Uc=this.pc)};this.callback=[];this.qr=function(og){this.callback.push(og)};this.Fl=function(){this.callback=[]};this.dn=function(og){if(!qg.u.ca.rl){var pg=
[],rg;for(rg in qg.u.sa)pg=pg.concat(qg.u.sa[rg].vn());rg=og.offsetX/$("#content").width()*2-1;var sg=2*-(og.offsetY/$("#content").height())+1,pg=vi.raycast(qg.u,pg,rg,sg);null!==pg?(pg=qg.u.ca.rj(pg.wa().Ja().Ua.oa())[0],!0===og.ctrlKey&&(qg.u.ca.Ib=pg),qg.u.zc(pg),Xk.ba().bt(pg._id)):(qg.u.ca.Ib=qg.u,qg.u.zc(null),Xk.ba().bt(null))}};$(this.domElement).on("mousemove",this.mousemove);$(this.domElement).on("mousedown",this.mousedown);$(this.domElement).on("mouseup",this.mouseup);$(document.body).on("dragstart ondrop",
function(){return!1});$(this.domElement).on("click",function(){clearTimeout(void 0)});$(this.domElement).on("dblclick",function(og){og.preventDefault();og.stopPropagation();clearTimeout(void 0);qg.dn(og);return!1});$(this.domElement).on("contextmenu",this.Vz);$(this.domElement).on("mousewheel",this.iz)}ql.prototype=Object.create(Jh.prototype);ql.prototype.constructor=ql;ql.prototype.Ph=function(og,pg){var qg=this.domElement.getBoundingClientRect();return{x:og-qg.left,y:pg-qg.top}};
function rl(og,pg){Jh.call(this,og,pg);this.Oa={NONE:-1,xf:0,Fi:1,mh:2,qh:3};this.Va=this.Oa.NONE;this.Kd=.5;var qg=this,rg=new Hammer.Manager(this.domElement),sg=new Hammer.Swipe({direction:Hammer.DIRECTION_ALL}),tg=new Hammer.Pan({direction:Hammer.DIRECTION_ALL,pointers:0,threshold:50}),ug=new Hammer.Pinch({enable:!0,threshold:.3}),yg=new Hammer.Tap({enable:!0});rg.add(sg);rg.add(tg);rg.add(ug);rg.add(yg);tg.recognizeWith(sg);this.qz=function(og){if(qg.Va===qg.Oa.NONE&&"mouse"!==og.pointerType)switch(og.type){case "panstart":if(.5<
Math.abs(og.velocity)||0===og.velocity)break;var pg=og.center;qg.Uc={x:pg.x,y:pg.y};qg.pc={x:pg.x,y:pg.y};qg.Va=1===og.pointers.length?qg.Oa.xf:qg.Oa.mh;break;case "pinchstart":qg.Ch=og.scale;qg.Lf=og.scale;qg.Va=qg.Oa.Fi;break;case "swipeup":Xk.ba().Sd.show();break;case "swipeleft":Xk.ba().Zy.show(!0);break;case "swiperight":Xk.ba().iw.show();break;case "swipedown":Xk.ba().Sd.hide(),Xk.ba().Zy.show(!1),Xk.ba().iw.hide()}};this.oz=function(){qg.Va=qg.Oa.NONE};this.pz=function(og){if("mouse"!==og.pointerType)switch(og.type){case "panmove":og=
qg.Va===qg.Oa.xf?{x:og.pointers[0].clientX,y:og.pointers[0].clientY}:og.center;qg.pc={x:og.x,y:og.y};break;case "pinchmove":qg.Lf=og.scale}};this.update=function(){if(this.Va!==this.Oa.NONE)if(this.Va===this.Oa.xf){var og=(this.pc.x-this.Uc.x)*Jh.gk*this.Kd,pg=(this.pc.y-this.Uc.y)*Jh.gk*this.Kd;this.u.ca.rotate(og,pg,0);this.Uc=this.pc}else this.Va===this.Oa.Fi?(this.u.ca.translate(0,0,(this.Lf-this.Ch)*Jh.ip*30*this.Kd),this.Ch=this.Lf):this.Va===this.Oa.mh&&(og=(this.pc.x-this.Uc.x)*Jh.fk*this.Kd,
pg=(this.pc.y-this.Uc.y)*Jh.fk*this.Kd,this.u.ca.translate(og,-pg,0),this.Uc=this.pc)};rg.on("panstart pinchstart swipeleft swiperight swipeup swipedown press tap",this.qz);rg.on("panend pinchend",this.oz);rg.on("panmove pinchmove",this.pz)}rl.prototype=Object.create(Jh.prototype);rl.prototype.constructor=rl;function xl(){this.mq=this.gd=this.ec=this.hf=this.lc=this.Jd=this.type=null}xl.prototype=Object.create(yl.prototype);xl.prototype.constructor=xl;
xl.ea={qk:"SCENE",Di:"STRUCTURE",kk:"MOL_TYPE",yi:"MOLECULE",pk:"RESIDUE",bk:"ATOM"};xg=xl.prototype;xg.sb=function(){};xg.cf=function(og){switch(this.type){case xl.ea.qk:return og;case xl.ea.Di:return og.rj(this.lc);case xl.ea.kk:return og.Tf(this.lc,this.Jd);case xl.ea.yi:return og.Tf(this.lc,this.Jd,this.hf);case xl.ea.pk:return og.ic(this.lc,this.Jd,this.hf,this.ec,!0);case xl.ea.bk:return og.le(this.lc,this.Jd,this.hf,this.gd,this.mq,!0);default:return null}};xg.tb=function(og){return og.rj(this.lc)};
xg.Ea=function(og){return this.tb(og)};xg.Bb=function(og){return og.Tf(this.lc,this.Jd,this.hf)};xg.ic=function(og){return og.ic(this.lc,this.Jd,this.hf,this.ec,!0)};xg.le=function(og){return og.le(this.lc,this.Jd,this.hf,this.gd,this.mq,!0)};function yl(){}yl.prototype.sb=function(){};yl.prototype.ss=function(){return Promise.resolve()};
yl.Cn=function(og,pg,qg){var rg=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!0,sg=[],tg,ug,yg=ih.vi;switch(pg.type){case xl.ea.Di:ug=pg.Ea(og)[0].cc();var Bg=!0,Cg=!1,Ag=void 0;try{for(var wg=ug[Symbol.iterator](),Dg;!(Bg=(Dg=wg.next()).done);Bg=!0){var Eg=Dg.value;void 0===qg?(tg=Eg.vc(rg),0===tg.length&&(tg=Eg.hb(yg)),sg=sg.concat(tg)):(tg=Eg.hb(qg),sg.push(tg))}}catch(Fg){Cg=!0,Ag=Fg}finally{try{!Bg&&wg["return"]&&wg["return"]()}finally{if(Cg)throw Ag;}}break;case xl.ea.kk:ug=pg.cf(og);
wg=!0;Dg=!1;Eg=void 0;try{for(Bg=ug[Symbol.iterator]();!(wg=(Cg=Bg.next()).done);wg=!0)Ag=Cg.value,tg=Ag.vc(rg),void 0===qg?(0===tg.length&&(tg=Ag.hb(yg)),sg=sg.concat(tg)):(tg=Ag.hb(qg),sg.push(tg))}catch(Fg){Dg=!0,Eg=Fg}finally{try{!wg&&Bg["return"]&&Bg["return"]()}finally{if(Dg)throw Eg;}}break;case xl.ea.yi:ug=pg.Bb(og)[0];tg=ug.vc(rg);void 0===qg?(0===tg.length&&(tg=ug.hb(yg)),sg=sg.concat(tg)):(tg=ug.hb(qg),sg.push(tg));break;case xl.ea.pk:ug=pg.ic(og)[0];null!==ug&&void 0!==ug&&(tg=ug.vc(rg),
void 0===qg?(0===tg.length&&(tg=ug.hb(yg)),sg=sg.concat(tg)):(tg=ug.hb(qg),sg.push(tg)));break;case xl.ea.bk:ug=pg.le(og)[0],null!==ug&&void 0!==ug&&(tg=ug.vc(rg),void 0===qg?(0===tg.length&&(tg=ug.hb(yg)),sg=sg.concat(tg)):(tg=ug.hb(qg),sg.push(tg)))}return sg};function zl(og){this.duration=og}zl.prototype=Object.create(yl.prototype);zl.prototype.constructor=zl;zl.prototype.sb=function(){};
function ScriptEngine(og){this.u=og;this.eB=this.u.ca;this.Ad=this.u.animations;this.qe=!0;this.Ad.Rl(this.qe);this.ub=this.vl=this.hg=this.currentTime=this.si=null;this.ao=!1;new EventTarget(ScriptEngine.prototype)}xg=ScriptEngine.prototype;
xg.update=function(og){if(!this.qe){this.currentTime+=og;if(0<this.si)this.si-=og;else for(var pg=0;this.ub.length;pg++){var qg=this.ub.remove();if(!1===qg)break;else void 0!==qg&&void 0!==qg.sb||console.warn("WARNING : the command didn't return a class with execute function");if(qg instanceof zl){this.si=qg.duration;break}else try{qg.sb(this.u.ca)}catch(rg){console.warn("Error on parsing script : "+rg+"\nOn stack : "+(rg.stack?rg.stack:"Unknown")+"\nComing from command "+qg.constructor.name);break}}0!==
this.Ad.fd.length&&this.Ad.am(og);this.currentTime>this.hg&&(this.pause(),this.Hb("endScript"));this.Hb({type:"timeChanged",data:{currentTime:this.currentTime,progress:this.currentTime/this.hg}})}};
xg.ns=function(og){this.Im();this.Ad.Ih();this.currentTime=og.value*this.hg;var pg=0;og=[];for(var qg=0;this.ub.length;qg++){var rg=this.ub.remove();if(!1===rg)break;else void 0!==rg&&void 0!==rg.sb||console.warn("The command didn't return a class with execute function");if(rg instanceof zl){for(var rg=rg.duration,sg=og.length,qg=0;qg<sg;qg++)try{og[qg].sb(this.u.ca)}catch(tg){console.warn("Error on parsing script : "+tg+"\nOn stack : "+(tg.stack?tg.stack:"Unknown")+"\nComing from command "+og[qg].constructor.name);
break}og.splice(0,og.length);if(pg+rg>this.currentTime){pg=this.currentTime-pg;this.Ad.am(pg,!0);this.si=rg-pg;break}else this.Ad.am(rg,!0),pg+=rg}else og.push(rg)}sg=og.length;if(0<sg){for(qg=0;qg<sg;qg++)try{og[qg].sb(this.u.ca)}catch(tg){console.warn("Error on parsing script : "+tg+"\nOn stack : "+(tg.stack?tg.stack:"Unknown")+"\nComing from command "+og[qg].constructor.name);break}this.Hb("endScript")}};
xg.Tu=function(og){og=og.data;this.hg=0;this.vl=og.slice(0);this.Im();og=this.vl.length;for(var pg=0;pg<og;pg++){var qg=this.vl[pg];qg instanceof zl&&(this.hg+=qg.duration)}this.Uu()};xg.Wc=function(og){this.Ad.Wc(og)};xg.play=function(){var og=this;this.ao?setTimeout(function(){og.play()},500):(this.qe=!1,this.Ad.Rl(this.qe),this.ns({type:"update",value:this.currentTime/this.hg}))};
xg.stop=function(){this.qe=!0;this.Ad.Rl(this.qe);this.Im();this.Ad.Ih();this.u.reset();this.Hb({type:"timeChanged",data:{currentTime:this.currentTime,progress:this.currentTime/this.hg}})};xg.pause=function(){this.qe=!0;this.Ad.Rl(this.qe)};xg.Im=function(){this.si=this.currentTime=0;this.ub=this.vl.slice(0);this.ub.add=this.ub.push;this.ub.remove=this.ub.shift};
xg.Uu=function(){var og=this;this.ao=!0;(function qg(rg){var sg=og.ub[rg],tg=sg.target,ug=Promise.resolve();null!=tg&&null!=tg.lc&&null==tg.tb(og.eB)&&(ug=biovizAPI.re(tg.lc));return ug.then(function(){var qg=Promise.resolve();sg instanceof yl&&(qg=sg.ss(og.u.ca));return qg}).then(function(){if(rg+1<og.ub.length)return qg(rg+1);og.ao=!1;og.u.reset()})})(0)};
Vk.ph=function(og,pg,qg,rg){function sg(){var sg,Bg,Cg=1;void 0!==window.devicePixelRatio&&(Cg=window.devicePixelRatio);null==pg?(sg=window.vB,Bg=window.uB):(sg=pg.width(),Bg=pg.height());if(tg!==sg||ug!==Bg)tg=sg,ug=Bg,og instanceof THREE.EffectComposer&&(tg=Math.floor(tg*Cg)||1,ug=Math.floor(ug*Cg)||1),og.setSize(tg,ug),null!=qg&&(qg instanceof THREE.PerspectiveCamera?(qg.aspect=tg/ug,qg.fov=vi.sr(rg,qg),qg.updateProjectionMatrix(),rg.Nc=!0):qg instanceof THREE.OrthographicCamera?(qg.left=-tg/2,
qg.right=tg/2,qg.top=ug/2,qg.bottom=-ug/2,qg.updateProjectionMatrix()):console.warn("Unknown camera type")),null!=rg&&rg.kt()}var tg,ug;window.addEventListener("resize",sg,!1);return{stop:function(){window.removeEventListener("resize",sg)}}};Vk.ph.bind=function(og,pg,qg,rg){return Vk.ph(og,pg,qg,rg)};
Vk.iB=function(){var og=document.createElement("div");og.style.cssText="width:80px;opacity:0.9;cursor:pointer";var pg=document.createElement("div");pg.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#200;";og.appendChild(pg);var qg=document.createElement("div");qg.style.cssText="color:#f00;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";qg.innerHTML="WebGLRenderer";pg.appendChild(qg);for(var rg=[],qg=0;9>qg;qg++)rg[qg]=document.createElement("div"),
rg[qg].style.cssText="color:#f00;background-color:#311;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",pg.appendChild(rg[qg]),rg[qg].innerHTML="-";var sg=Date.now();return{domElement:og,update:function(og){console.assert(og instanceof THREE.WebGLRenderer);if(!(Date.now()-sg<1E3/30)){sg=Date.now();var pg=0;rg[pg++].textContent="== Memory =====";rg[pg++].textContent="Programs: "+og.info.memory.programs;rg[pg++].textContent="Geometries: "+og.info.memory.geometries;
rg[pg++].textContent="Textures: "+og.info.memory.textures;rg[pg++].textContent="== Render =====";rg[pg++].textContent="Calls: "+og.info.render.calls;rg[pg++].textContent="Vertices: "+og.info.render.vertices;rg[pg++].textContent="Faces: "+og.info.render.faces;rg[pg++].textContent="Points: "+og.info.render.points}}}};
function Al(og,pg,qg){this.kf=og;this.gg=pg;this.Xo=new THREE.Color(1,1,1);this.En=new THREE.Color(.1,.04,.02);this.Ww=0;this.dB=!1;this.Yw=1;this.Xw=3;this.Uk=2;this.xl=0;THREE.Pass.call(this);this.resolution=void 0!==qg?new THREE.Vector2(qg.x,qg.y):new THREE.Vector2(256,256);og={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat};pg=Math.round(this.resolution.x/this.Uk);qg=Math.round(this.resolution.y/this.Uk);this.fz=new THREE.MeshBasicMaterial({color:16777215});
this.fz.side=THREE.DoubleSide;this.$g=new THREE.WebGLRenderTarget(this.resolution.x,this.resolution.y,og);this.$g.texture.generateMipmaps=!1;this.$g.depthTexture=new THREE.DepthTexture;this.$g.depthTexture.type=THREE.UnsignedShortType;this.depthMaterial=new THREE.MeshDepthMaterial;this.depthMaterial.side=THREE.DoubleSide;this.depthMaterial.depthPacking=THREE.RGBADepthPacking;this.depthMaterial.blending=THREE.NoBlending;this.Lj=this.Ux();this.Lj.side=THREE.DoubleSide;this.ci=new THREE.WebGLRenderTarget(this.resolution.x,
this.resolution.y,og);this.ci.texture.generateMipmaps=!1;this.ci.depthTexture=new THREE.DepthTexture;this.ci.depthTexture.type=THREE.UnsignedShortType;this.di=new THREE.WebGLRenderTarget(this.resolution.x,this.resolution.y,og);this.di.texture.generateMipmaps=!1;this.di.depthTexture=new THREE.DepthTexture;this.di.depthTexture.type=THREE.UnsignedShortType;this.ei=new THREE.WebGLRenderTarget(pg,qg,og);this.ei.texture.generateMipmaps=!1;this.Gl=new THREE.WebGLRenderTarget(pg,qg,og);this.Gl.texture.generateMipmaps=
!1;this.Hl=new THREE.WebGLRenderTarget(Math.round(pg/2),Math.round(qg/2),og);this.Hl.texture.generateMipmaps=!1;this.pj=this.Bx();this.Zg=new THREE.WebGLRenderTarget(pg,qg,og);this.Zg.texture.generateMipmaps=!1;this.Il=new THREE.WebGLRenderTarget(Math.round(pg/2),Math.round(qg/2),og);this.Il.texture.generateMipmaps=!1;this.qf=this.wr(4);this.qf.uniforms.texSize.value=new THREE.Vector2(pg,qg);this.qf.uniforms.kernelRadius.value=1;this.ig=this.wr(4);this.ig.uniforms.texSize.value=new THREE.Vector2(Math.round(pg/
2),Math.round(qg/2));this.ig.uniforms.kernelRadius.value=4;this.ag=this.Rx();void 0===THREE.CopyShader&&console.error("OutlinePass relies on THREE.CopyShader");og=THREE.CopyShader;this.kn=THREE.UniformsUtils.clone(og.uniforms);this.kn.opacity.value=1;this.materialCopy=new THREE.ShaderMaterial({uniforms:this.kn,vertexShader:og.vertexShader,fragmentShader:og.fragmentShader,blending:THREE.NoBlending,depthTest:!1,depthWrite:!1,transparent:!0});this.enabled=!0;this.needsSwap=!1;this.oldClearColor=new THREE.Color;
this.oldClearAlpha=1;this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1);this.scene=new THREE.Scene;this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null);this.quad.frustumCulled=!1;this.scene.add(this.quad);this.Qo=new THREE.Color;this.Ro=new THREE.Color}
Al.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:Al,dispose:function(){},setSize:function(og,pg){this.ci.setSize(og,pg);this.di.setSize(og,pg);this.$g.setSize(og,pg);var qg=Math.round(og/this.Uk),rg=Math.round(pg/this.Uk);this.ei.setSize(qg,rg);this.Gl.setSize(qg,rg);this.Zg.setSize(qg,rg);this.qf.uniforms.texSize.value=new THREE.Vector2(qg,rg);qg=Math.round(qg/2);rg=Math.round(rg/2);this.Hl.setSize(qg,rg);this.Il.setSize(qg,rg);this.ig.uniforms.texSize.value=new THREE.Vector2(qg,
rg)},en:function(og){var pg=!1;this.kf.traverse(function(qg){qg.outline&&qg.Hd()&&(pg=!0,og?qg.children.forEach(function(pg){if(!(pg instanceof wi))if(pg instanceof THREE.Mesh||pg instanceof Ck||pg instanceof Hi){if(pg.material.uniforms)pg.material.uniforms.testUnhighlight.value=!1;else{var qg=!0,rg=!1,ug=void 0;try{for(var yg=pg.material[Symbol.iterator](),Bg;!(qg=(Bg=yg.next()).done);qg=!0){var Cg=Bg.value;Cg.uniforms.testUnhighlight.value=!1;Cg.needsUpdate=!0}}catch(Ag){rg=!0,ug=Ag}finally{try{!qg&&
yg["return"]&&yg["return"]()}finally{if(rg)throw ug;}}}pg.material.needsUpdate=!0}else pg.gj=pg.visible,pg.visible=og}):qg.children.forEach(function(pg){if(!(pg instanceof wi))if(pg instanceof THREE.Mesh||pg instanceof Ck||pg instanceof Hi){if(pg.material.uniforms)pg.material.uniforms.testUnhighlight.value=!0;else{var qg=!0,rg=!1,ug=void 0;try{for(var yg=pg.material[Symbol.iterator](),Bg;!(qg=(Bg=yg.next()).done);qg=!0){var Cg=Bg.value;Cg.uniforms.testUnhighlight.value=!0;Cg.needsUpdate=!0}}catch(Ag){rg=
!0,ug=Ag}finally{try{!qg&&yg["return"]&&yg["return"]()}finally{if(rg)throw ug;}}}pg.material.needsUpdate=!0}else pg.gj=pg.visible,pg.visible=og}))});return pg},zq:function(og){var pg=[];this.kf.traverse(function(qg){qg.outline&&qg.Hd()&&(pg.push(qg),og?qg.children.forEach(function(pg){if(!(pg instanceof wi))if(pg instanceof THREE.Mesh||pg instanceof Ck||pg instanceof Hi){if(pg.material.uniforms)pg.material.uniforms.testHighlight.value=!1;else{var qg=!0,rg=!1,sg=void 0;try{for(var tg=pg.material[Symbol.iterator](),
ug;!(qg=(ug=tg.next()).done);qg=!0){var Dg=ug.value;Dg.uniforms.testHighlight.value=!1;Dg.needsUpdate=!0}}catch(Eg){rg=!0,sg=Eg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}}pg.material.needsUpdate=!0}else pg.gj=pg.visible,pg.visible=og}):qg.children.forEach(function(pg){if(!(pg instanceof wi))if(pg instanceof THREE.Mesh||pg instanceof Ck||pg instanceof Hi){if(pg.material.uniforms)pg.material.uniforms.testHighlight.value=!0;else{var qg=!0,rg=!1,sg=void 0;try{for(var tg=pg.material[Symbol.iterator](),
ug;!(qg=(ug=tg.next()).done);qg=!0){var Dg=ug.value;Dg.uniforms.testHighlight.value=!0;Dg.needsUpdate=!0}}catch(Eg){rg=!0,sg=Eg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}}pg.material.needsUpdate=!0}else pg.gj=pg.visible,pg.visible=og}))});var qg=this;this.kf.traverse(function(rg){if(rg instanceof wi||null!=rg.parent&&rg.parent.parent===qg.kf){for(var sg=!1,tg=0;tg<pg.length;tg++)if(pg[tg].id===rg.id){sg=!0;break}if(!sg){sg=rg.visible;if(!og||rg.gj)rg.visible=og;rg.gj=
sg}}});for(var rg=0,sg=pg.length;rg<sg;rg++)pg[rg].traverseAncestors(function(og){og.visible=!0})},render:function(og,pg,qg,rg,sg){this.en(!1)&&(Ph.ba().tz?(this.oldClearColor.copy(og.getClearColor()),this.oldClearAlpha=og.getClearAlpha(),pg=og.autoClear,og.autoClear=!1,sg&&og.context.disable(og.context.STENCIL_TEST),og.setClearColor(16777215,1),og.render(this.kf,this.gg,this.ci,!0),this.en(!0),this.zq(!1),og.render(this.kf,this.gg,this.di,!0),this.zq(!0),this.quad.material=this.Lj,this.Lj.uniforms.cameraNearFar.value=
new THREE.Vector2(this.gg.near,this.gg.far),this.Lj.uniforms.depthTextureSelected.value=this.di.depthTexture,this.Lj.uniforms.depthTextureNonSelected.value=this.ci.depthTexture,og.render(this.scene,this.camera,this.$g,!0),this.quad.material=this.materialCopy,this.kn.tDiffuse.value=this.$g.texture,og.render(this.scene,this.camera,this.ei,!0),this.Qo.copy(this.Xo),this.Ro.copy(this.En),0<this.xl&&(rg=.625+.75*Math.cos(.01*performance.now()/this.xl)/2,this.Qo.multiplyScalar(rg),this.Ro.multiplyScalar(rg)),
this.quad.material=this.pj,this.pj.uniforms.maskTexture.value=this.ei.texture,this.pj.uniforms.texSize.value=new THREE.Vector2(this.ei.width,this.ei.height),this.pj.uniforms.visibleEdgeColor.value=this.Qo,this.pj.uniforms.hiddenEdgeColor.value=this.Ro,og.render(this.scene,this.camera,this.Zg,!0),this.quad.material=this.qf,this.qf.uniforms.colorTexture.value=this.Zg.texture,this.qf.uniforms.direction.value=Al.fp,this.qf.uniforms.kernelRadius.value=this.Yw,og.render(this.scene,this.camera,this.Gl,!0),
this.qf.uniforms.colorTexture.value=this.Gl.texture,this.qf.uniforms.direction.value=Al.gp,og.render(this.scene,this.camera,this.Zg,!0),this.quad.material=this.ig,this.ig.uniforms.colorTexture.value=this.Zg.texture,this.ig.uniforms.direction.value=Al.fp,og.render(this.scene,this.camera,this.Hl,!0),this.ig.uniforms.colorTexture.value=this.Hl.texture,this.ig.uniforms.direction.value=Al.gp,og.render(this.scene,this.camera,this.Il,!0),this.quad.material=this.ag,this.ag.uniforms.maskTexture.value=this.$g.texture,
this.ag.uniforms.edgeTexture1.value=this.Zg.texture,this.ag.uniforms.edgeTexture2.value=this.Il.texture,this.ag.uniforms.patternTexture.value=this.xB,this.ag.uniforms.edgeStrength.value=this.Xw,this.ag.uniforms.edgeGlow.value=this.Ww,this.ag.uniforms.usePatternTexture.value=this.dB,sg&&og.context.enable(og.context.STENCIL_TEST),og.render(this.scene,this.camera,qg,!1),og.setClearColor(this.oldClearColor,this.oldClearAlpha),og.autoClear=pg):(og.render(this.kf,this.gg,qg,!0),this.en(!0)))},Ux:function(){return new THREE.ShaderMaterial({uniforms:{depthTextureSelected:{value:null},
depthTextureNonSelected:{value:null},iResolution:{value:new THREE.Vector2},cameraNearFar:{value:new THREE.Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;                varying vec4 vPosition;                void main() {                    vUv = uv;                    vPosition = modelViewMatrix * vec4( position, 1.0 );                    vec4 worldPosition = modelMatrix * vec4( position, 1.0 );                    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n                }",
fragmentShader:"#include <packing>                varying vec2 vUv;                varying vec4 vPosition;                uniform sampler2D depthTextureSelected;                uniform sampler2D depthTextureNonSelected;                uniform vec2 iResolution;                uniform vec2 cameraNearFar;                                float readDepth (sampler2D depthSampler, vec2 coord) {                           float fragCoordZ = texture2D(depthSampler, coord).x;                           float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNearFar.x, cameraNearFar.y );                           return viewZToOrthographicDepth( viewZ, cameraNearFar.x, cameraNearFar.y );                }                                void main() {                    float viewSelectedZ = readDepth(depthTextureSelected, vUv);                    float viewNonSelectedZ = readDepth(depthTextureNonSelected, vUv);                    if (viewSelectedZ < 1.0) {                        float depthTest = (viewSelectedZ > viewNonSelectedZ) ? 1.0 : 0.0;                        gl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);                    } else {                        gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);                    }                }"})},
Bx:function(){return new THREE.ShaderMaterial({uniforms:{maskTexture:{value:null},texSize:{value:new THREE.Vector2(.5,.5)},visibleEdgeColor:{value:new THREE.Vector3(1,1,1)},hiddenEdgeColor:{value:new THREE.Vector3(1,1,1)}},vertexShader:"varying vec2 vUv;\n                void main() {\n                    vUv = uv;\n                    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n                }",fragmentShader:"varying vec2 vUv;                uniform sampler2D maskTexture;                uniform vec2 texSize;                uniform vec3 visibleEdgeColor;                uniform vec3 hiddenEdgeColor;                                void main() {\n                    vec2 invSize = 1.0 / texSize;                    vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);                    vec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);                    vec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);                    vec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);                    vec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);                    float diff1 = (c1.r - c2.r)*0.5;                    float diff2 = (c3.r - c4.r)*0.5;                    float d = length( vec2(diff1, diff2) );                    float a1 = min(c1.g, c2.g);                    float a2 = min(c3.g, c4.g);                    float visibilityFactor = min(a1, a2);                    vec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;                    gl_FragColor = vec4(edgeColor, 1.0) * vec4(d);                }"})},
wr:function(og){return new THREE.ShaderMaterial({defines:{MAX_RADIUS:og},uniforms:{colorTexture:{value:null},texSize:{value:new THREE.Vector2(.5,.5)},direction:{value:new THREE.Vector2(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n                void main() {\n                    vUv = uv;\n                    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n                }",fragmentShader:"#include <common>                varying vec2 vUv;                uniform sampler2D colorTexture;                uniform vec2 texSize;                uniform vec2 direction;                uniform float kernelRadius;                                float gaussianPdf(in float x, in float sigma) {                    return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;                }                void main() {                    vec2 invSize = 1.0 / texSize;                    float weightSum = gaussianPdf(0.0, kernelRadius);                    vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;                    vec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);                    vec2 uvOffset = delta;                    for( int i = 1; i <= MAX_RADIUS; i ++ ) {                        float w = gaussianPdf(uvOffset.x, kernelRadius);                        vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;                        vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;                        diffuseSum += ((sample1 + sample2) * w);                        weightSum += (2.0 * w);                        uvOffset += delta;                    }                    gl_FragColor = vec4(diffuseSum/weightSum, 1.0);                }"})},
Rx:function(){return new THREE.ShaderMaterial({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n                void main() {\n                    vUv = uv;\n                    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n                }",fragmentShader:"varying vec2 vUv;                uniform sampler2D maskTexture;                uniform sampler2D edgeTexture1;                uniform sampler2D edgeTexture2;                uniform sampler2D patternTexture;                uniform float edgeStrength;                uniform float edgeGlow;                uniform bool usePatternTexture;                                void main() {                    vec4 edgeValue1 = texture2D(edgeTexture1, vUv);                    vec4 edgeValue2 = texture2D(edgeTexture2, vUv);                    vec4 maskColor = texture2D(maskTexture, vUv);                    vec4 patternColor = texture2D(patternTexture, 6.0 * vUv);                    float visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;                    vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;                    vec4 finalColor = edgeStrength * maskColor.r * edgeValue;                    if(usePatternTexture)                        finalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);                    gl_FragColor = finalColor;                }",
blending:THREE.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0})}});Al.fp=new THREE.Vector2(1,0);Al.gp=new THREE.Vector2(0,1);
function Bl(og,pg,qg,rg){THREE.Pass.call(this);this.scene=og;this.camera=pg;this.clear=!0;this.needsSwap=!1;og={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat};this.$f=new THREE.WebGLRenderTarget(qg,rg,og);this.$f.depthTexture=new THREE.DepthTexture;this.$f.texture.generateMipmaps=!1;this.$f.stencilBuffer=!1;this.qg=new THREE.WebGLRenderTarget(qg,rg,og);this.qg.depthTexture=new THREE.DepthTexture;this.qg.texture.generateMipmaps=!1;this.qg.stencilBuffer=!1;this.rg=
new THREE.WebGLRenderTarget(qg,rg,og);this.rg.depthTexture=new THREE.DepthTexture;this.rg.texture.generateMipmaps=!1;this.rg.stencilBuffer=!1;this.hn=new THREE.ShaderMaterial({uniforms:{tOpaque:{type:"t",value:this.$f.texture},tTransparentBack:{type:"t",value:this.qg.texture},tTransparentFront:{type:"t",value:this.rg.texture},tOpaqueDepth:{type:"t",value:this.$f.depthTexture},tTransparentBackDepth:{type:"t",value:this.qg.depthTexture},tTransparentFrontDepth:{type:"t",value:this.rg.depthTexture},cameraNear:{type:"f",
value:null},cameraFar:{type:"f",value:null}},vertexShader:THREE.ShaderChunk.transparencyQuad_vert,fragmentShader:THREE.ShaderChunk.transparencyQuad_frag});this.quadCamera=new THREE.OrthographicCamera(-1,1,1,-1,0,1);this.quadScene=new THREE.Scene;this.quad=new THREE.Mesh(new THREE.PlaneGeometry(2,2),this.hn);this.quad.frustumCulled=!1;this.quadScene.add(this.quad)}Bl.prototype=Object.create(THREE.Pass.prototype);Bl.prototype.constructor=Bl;
Bl.prototype.render=function(og,pg,qg){pg=og.autoClear;og.autoClear=!1;og.clearTarget(this.$f);og.clearTarget(this.qg);og.clearTarget(this.rg);var rg=new Map,sg=!1;this.scene.traverse(function(og){og.material&&(rg.set(og.id,og.visible),og.material.transparent&&(null==og.Wa&&(og.Wa=og.material),sg=!0,og.visible=!1))});og.render(this.scene,this.camera,this.$f);sg&&(this.scene.traverse(function(og){if(og.material&&(og.material.transparent||(og.visible=!1),og.material.transparent)){if(null==og.Me)if(Array.isArray(og.Wa)){var pg=
[],qg=!0,sg=!1,tg=void 0;try{for(var Ag=og.Wa[Symbol.iterator](),wg;!(qg=(wg=Ag.next()).done);qg=!0){var Dg=wg.value.clone();Dg.side=THREE.BackSide;Dg.blending=THREE.CustomBlending;Dg.needsUpdate=!0;pg.push(Dg)}}catch(Eg){sg=!0,tg=Eg}finally{try{!qg&&Ag["return"]&&Ag["return"]()}finally{if(sg)throw tg;}}og.Me=pg}else Dg=og.Wa.clone(),Dg.side=THREE.BackSide,Dg.blending=THREE.CustomBlending,Dg.needsUpdate=!0,og.Me=Dg;if(og.Wa.ri)if(Array.isArray(og.Me))for(pg=og.Me,qg=0;qg<pg.length;qg++)pg[qg].uniforms=
og.Wa[qg].uniforms,pg[qg].defines=og.Wa[qg].defines,pg[qg].visible=og.Wa[qg].visible,pg[qg].needsUpdate=!0;else og.Me.uniforms=og.Wa.uniforms,og.Me.defines=og.Wa.defines,og.Me.visible=og.Wa.visible,og.Me.needsUpdate=!0;og.visible=rg.get(og.id)&&!og.Wa.wireframe;og.material=og.Me}}),og.render(this.scene,this.camera,this.qg),this.scene.traverse(function(og){if(og.material&&og.Wa&&og.Wa.transparent){if(null==og.Ve)if(Array.isArray(og.Wa)){var pg=[],qg=!0,sg=!1,tg=void 0;try{for(var Ag=og.Wa[Symbol.iterator](),
wg;!(qg=(wg=Ag.next()).done);qg=!0){var Dg=wg.value.clone();Dg.side=THREE.FrontSide;Dg.blending=THREE.CustomBlending;Dg.needsUpdate=!0;pg.push(Dg)}}catch(Eg){sg=!0,tg=Eg}finally{try{!qg&&Ag["return"]&&Ag["return"]()}finally{if(sg)throw tg;}}og.Ve=pg}else Dg=og.Wa.clone(),Dg.side=THREE.FrontSide,Dg.blending=THREE.CustomBlending,Dg.needsUpdate=!0,og.Ve=Dg;if(og.Wa.ri){if(Array.isArray(og.Ve))for(pg=og.Ve,qg=0;qg<pg.length;qg++)pg[qg].uniforms=og.Wa[qg].uniforms,pg[qg].defines=og.Wa[qg].defines,pg[qg].visible=
og.Wa[qg].visible,pg[qg].needsUpdate=!0;else og.Ve.uniforms=og.Wa.uniforms,og.Ve.defines=og.Wa.defines,og.Ve.visible=og.Wa.visible,og.Ve.needsUpdate=!0;og.Wa.ri=!1}og.visible=rg.get(og.id);og.material=og.Ve}}),og.render(this.scene,this.camera,this.rg),this.scene.traverse(function(og){og.material&&(null!=og.Wa&&og.Wa.transparent?og.Wa.transparent&&(og.material=og.Wa):og.visible=rg.get(og.id))}));this.hn.uniforms.cameraNear.value=this.camera.near;this.hn.uniforms.cameraFar.value=this.camera.far;og.render(this.quadScene,
this.quadCamera,this.renderToScreen?null:qg,this.clear);og.autoClear=pg};Bl.prototype.setSize=function(og,pg){this.$f.setSize(og,pg);this.qg.setSize(og,pg);this.rg.setSize(og,pg)};function Cl(og,pg,qg){this.dj=pg;this.ej=qg;this.cg=this.dj.pos.clone();this.dg=this.ej.pos.clone();this.ce=this.Bg=this.tl=this.oi=this.sl=this.ni=null;this.u=og;this.ga=Ph.ba();this.Aw()}xg=Cl.prototype;
xg.Aw=function(){var og=this.dj.wa().Ja(),pg=og.Ua;this.sl=this.u.ca.Tf(pg.oa(),og.ja.name,og.id)[0];this.ni=this.u.ca.tb(pg.oa());og=this.ej.wa().Ja();pg=og.Ua;this.tl=this.u.ca.Tf(pg.oa(),og.ja.name,og.id)[0];this.oi=this.u.ca.tb(pg.oa());this.cg.applyMatrix4(this.sl.matrixWorld);this.cg.applyMatrix4((new THREE.Matrix4).getInverse(this.u.matrixWorld));this.dg.applyMatrix4(this.tl.matrixWorld);this.dg.applyMatrix4((new THREE.Matrix4).getInverse(this.u.matrixWorld));og=new THREE.Geometry;og.vertices.push(this.cg);
og.vertices.push(this.dg);og.computeLineDistances();pg=new THREE.LineDashedMaterial({color:16760576,dashSize:.7,gapSize:.3,linewidth:1.5});this.Bg=new THREE.Line(og,pg);this.u.add(this.Bg);this.Ap()};
xg.Ap=function(){null!=this.ce&&this.u.remove(this.ce);var og=this.ga.ll(this.cg.distanceTo(this.dg).toFixed(2)),og=new THREE.SpriteMaterial({map:og});og.depthTest=!1;og.depthWrite=!1;this.ce=new THREE.Sprite(og);var pg=(new THREE.Vector3).addVectors(this.cg,this.dg).multiplyScalar(.5);this.ce.position.set(pg.x,pg.y,pg.z);this.ce.scale.set(og.map.image.width/40,og.map.image.height/40,1);this.u.add(this.ce)};
xg.update=function(){this.cg.set(this.dj.pos.x,this.dj.pos.y,this.dj.pos.z);this.cg.applyMatrix4(this.sl.matrix);this.cg.applyMatrix4(this.ni.matrix);this.dg.set(this.ej.pos.x,this.ej.pos.y,this.ej.pos.z);this.dg.applyMatrix4(this.tl.matrix);this.dg.applyMatrix4(this.oi.matrix);this.Bg.geometry.verticesNeedUpdate=!0;this.Ap()};xg.remove=function(){this.u.remove(this.ce);this.u.remove(this.Bg)};
xg.Av=function(og){return og.uuid===this.ni.uuid||og.uuid===this.oi.uuid||og.uuid===this.sl.uuid||og.uuid===this.tl.uuid?!0:!1};xg.cB=function(){var og=this.ni.visible&&this.oi.visible;this.Bg.visible=og;this.ce.visible=og};
function Dl(og){THREE.Group.call(this);this.ca=og;this.Cc=new THREE.Scene;this.la=this;this.Cc.add(this);this.ad=Xk.ba().canvas;this.Lq=this;this.sa=[];this.light=this.camera=this.renderer=null;this.ga=Ph.ba();this.animations=new ll(this);this.$j=new ll(this);this.yc=new ScriptEngine(this);this.Rd=this.ij=null;this.dh=new Map;for(var pg in El.location)this.dh.set(El.location[pg],[]);this.Ri=this.Ui=null;this.Mb=[];this.ul=new THREE.Plane(new THREE.Vector3(0,0,-1),0);this.Wk=new THREE.Plane(new THREE.Vector3(0,
0,1),0);this.init();Vk.Sa.zv()&&Vk.Sa.Bv({element:$(this.renderer.domElement.parent).get(0),Cv:Xk.ba()});og=this.ad.width();pg=this.ad.height();var qg={minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat};this.Jl=new THREE.WebGLRenderTarget(512,512,qg);this.Kl=new THREE.WebGLRenderTarget(512,512,qg);this.qs=new THREE.ShaderMaterial({uniforms:{mapLeft:{value:this.Jl.texture},mapRight:{value:this.Kl.texture}},vertexShader:"varying vec2 vUv;\nvoid main() {\n    vUv = vec2( uv.x, uv.y );\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:"uniform sampler2D mapLeft;\nuniform sampler2D mapRight;\nvarying vec2 vUv;\nvoid main() {\n    vec2 uv = vUv;\n    if ( ( mod( gl_FragCoord.y, 2.0 ) ) > 1.00 ) {\n        gl_FragColor = texture2D( mapLeft, uv );\n    } else {\n        gl_FragColor = texture2D( mapRight, uv );\n    }\n}"});var qg=(new THREE.Matrix3).fromArray([1.0671679973602295,-.0016435992438346148,1.777536963345483E-4,-.028107794001698494,-1.9593400065787137E-4,-2.875397040043026E-4,-.04279090091586113,1.5809757314855233E-5,
-2.4287120322696865E-4]),rg=(new THREE.Matrix3).fromArray([-.0355340838432312,-.06440307199954987,.018319187685847282,-.10269022732973099,.8079727292060852,-.04835830628871918,1.224992738571018E-4,-.009558862075209618,.567823588848114]);this.tv=new THREE.ShaderMaterial({uniforms:{mapLeft:{value:this.Jl.texture},mapRight:{value:this.Kl.texture},colorMatrixLeft:{value:qg},colorMatrixRight:{value:rg}},vertexShader:"varying vec2 vUv;\nvoid main() {\n    vUv = vec2( uv.x, uv.y );\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:"uniform sampler2D mapLeft;\nuniform sampler2D mapRight;\nvarying vec2 vUv;\nuniform mat3 colorMatrixLeft;\nuniform mat3 colorMatrixRight;\nfloat lin( float c ) {\n    return c <= 0.04045 ? c * 0.0773993808 :\n            pow( c * 0.9478672986 + 0.0521327014, 2.4 );\n}\nvec4 lin( vec4 c ) {\n    return vec4( lin( c.r ), lin( c.g ), lin( c.b ), c.a );\n}\nfloat dev( float c ) {\n    return c <= 0.0031308 ? c * 12.92\n            : pow( c, 0.41666 ) * 1.055 - 0.055;\n}\nvoid main() {\n    vec2 uv = vUv;\n    vec4 colorL = lin( texture2D( mapLeft, uv ) );\n    vec4 colorR = lin( texture2D( mapRight, uv ) );\n    vec3 color = clamp(\n            colorMatrixLeft * colorL.rgb +\n            colorMatrixRight * colorR.rgb, 0., 1. );\n    gl_FragColor = vec4(\n            dev( color.r ), dev( color.g ), dev( color.b ),\n            max( colorL.a, colorR.a ) );\n}"});
this.Ys=new THREE.Scene;this.RA=new THREE.OrthographicCamera(-1,1,1,-1,0,1);this.Wj=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),this.qs);this.Ys.add(this.Wj);this.Dd=new THREE.EffectComposer(this.renderer);this.ke=new THREE.EffectComposer(this.renderer);qg=null!=window.devicePixelRatio?window.devicePixelRatio:1;this.Zi=new THREE.StereoCamera;this.Qg=new THREE.ClearPass(this.ga.bgColor,1);this.ih=null;this.ih=this.ga.aB?new Bl(this.Cc,this.camera,og,pg):new THREE.RenderPass(this.Cc,this.camera);
this.ih.clear=!1;this.rd=new THREE.SAOPass(this.Cc,this.camera,!0);this.rd.saoMaterial.defines.NUM_SAMPLES=9;this.rd.saoMaterial.defines.NUM_RINGS=7;this.rd.params.output=this.ga.dc.nf?THREE.SAOPass.OUTPUT.Default:THREE.SAOPass.OUTPUT.Beauty;this.rd.params.saoBias=.5;this.rd.params.saoIntensity=.02;this.rd.params.saoScale=this.ga.Kf;this.rd.params.saoKernelRadius=12;this.rd.params.saoMinResolution=5E-4;this.Ld=new Al(this.Cc,this.camera);this.Ld.Xo=Ph.ba().ef;this.Ld.En=Ph.ba().df;this.Ld.xl=Ph.ba().we;
var sg=new THREE.ShaderPass(THREE.FXAAShader);sg.setSize=function(og,pg){sg.uniforms.resolution.value.set(1/og,1/pg);sg.material.needsUpdate=!0};this.copyPass=new THREE.ShaderPass(THREE.CopyShader);this.copyPass.renderToScreen=!0;this.Dd.addPass(this.Qg);this.Dd.addPass(this.ih);this.ga.ys&&this.Dd.addPass(this.rd);this.Dd.addPass(sg);this.Dd.addPass(this.Ld);this.Dd.addPass(this.copyPass);this.ke.addPass(this.Qg);this.ke.addPass(this.ih);this.ga.ys&&this.ke.addPass(this.rd);this.ke.addPass(sg);this.ke.addPass(this.Ld);
this.ke.addPass(this.copyPass);this.Dd.setSize(og*qg,pg*qg);this.ke.setSize(og*qg,pg*qg);Vk.ph.bind(this.Dd,this.ad);Vk.ph.bind(this.ke,this.ad);this.uq=this.camera.focus;this.js=new pl(this,this.renderer.domElement);this.jf=new ql(this,this.renderer.domElement);this.hz=new rl(this,this.renderer.domElement);this.fh=!1;this.ts=null;var tg=this,ug=new THREE.Clock;this.Nc=!0;requestAnimationFrame(function Bg(){requestAnimationFrame(Bg);var og=ug.getDelta();tg.yc.qe?0!==tg.$j.fd.length&&tg.$j.am(1E3*
og):tg.yc.update(1E3*og);tg.jf.update();tg.js.update();tg.hz.update();var pg=!1;tg.traverse(function(og){var qg=og.matrixWorldNeedsUpdate;if(qg&&!(og instanceof Dl))for(var rg=0;rg<tg.Mb.length;rg++)tg.Mb[rg].Av(og)&&tg.Mb[rg].update();var rg=og.outline,sg=null!=og.material&&og.material.needsUpdate,ug=null!=og.material&&og.material.transparent,wg=null==og.Wa&&ug,Ag=null!=og.Wa&&og.Wa.ri,Bg=og.jb,Cg=og.visible;og.traverseAncestors(function(og){og.visible||(Cg=!1)});var Og=!1;if(og.geometry)for(var Sg in og.geometry.attributes){var Qg=
og.geometry.attributes[Sg];null==Qg.qo&&Qg.qo==Qg.version;Qg.qo!=Qg.version&&Cg&&(Og=!0,Qg.qo=Qg.version)}if(rg||qg||Og||sg&&!ug||Ag&&ug||wg||Bg)if(Cg||Bg)pg=!0;og.jb=!1});if(pg||tg.Nc)tg.Nc=!1,tg.kf(og)});this.ga.subscribe(this)}Dl.prototype=Object.create(THREE.Group.prototype);Dl.prototype.constructor=Dl;var El=Object;El.location=[];El.location.yt="CENTER";El.location.Yt="TOP";El.location.vt="BOTTOM";El.location.LEFT="LEFT";El.location.RIGHT="RIGHT";El.location.Zt="TOP_LEFT";El.location.wt="BOTTOM_LEFT";
El.location.xt="BOTTOM_RIGHT";El.location.$t="TOP_RIGHT";xg=Dl.prototype;xg.fA=function(og){this.uq=og;this.camera.focus=og;this.Nc=!0};xg.$l=function(){Vk.Sa.toggle(Xk.ba(),$(this.renderer.domElement.parent).get(0))};xg.Zz=function(og,pg){var qg=this;return(new Promise(function(rg){qg.fh=!0;qg.ht=pg;qg.mimeType=og;qg.Nc=!0;qg.ts=rg})).then(function(og){qg.Nc=!0;return og})};
xg.cn=function(og,pg){var qg=1.5*this.wb(!0).length(),rg=null,sg=null;null!=og&&(rg=this.camera.near-this.camera.position.z+og/100*(qg-this.camera.near));null!=pg&&(sg=this.camera.near-this.camera.position.z+pg/100*(qg-this.camera.near));this.vq(rg,sg)};xg.vq=function(og,pg){null!=og&&(this.ul.constant=-og);null!=pg&&(this.Wk.constant=pg);this.Nc=!0};xg.wq=function(og,pg){og-=this.camera.position.z;pg-=this.camera.position.z;this.vq(og,pg)};
xg.sv=function(og){for(var pg=this.sa.length,qg=og.af(),rg=0,sg=0;sg<pg;sg++)this.sa[sg].af().substring(0,4)===qg&&rg++;0<rg&&og.ia.xe(qg+"_"+rg);this.add(og);this.aj(og)};xg.aj=function(og){this.sa.push(og)};xg.ws=function(og){this.sa.splice(this.sa.indexOf(og),1)};
xg.kf=function(og){var pg=this,qg=new Map;this.traverse(function(og){og.material&&(qg.set(og.id,og.visible),og instanceof THREE.Sprite&&(og.visible=!1))});this.renderer.clear();this.fh&&this.ht&&(this.renderer.setClearColor(new THREE.Color,0),this.Qg.clearAlpha=0,this.Qg.clearColor=new THREE.Color,this.Cc.fog.color=new THREE.Color);this.ca.eh||this.ca.Hh?(this.Wj.material=this.ca.eh?this.qs:this.tv,this.Cc.updateMatrixWorld(),null===this.camera.parent&&this.camera.updateMatrixWorld(),this.Zi.update(this.camera),
this.copyPass.renderToScreen=!1,this.ih.camera=this.Zi.cameraL,this.Ld.gg=this.Zi.cameraL,this.Dd.render(og),this.Jl=this.Dd.renderTarget1,this.ih.camera=this.Zi.cameraR,this.Ld.gg=this.Zi.cameraR,this.ke.render(og),this.Kl=this.ke.renderTarget1,this.Wj.material.uniforms.mapLeft.value=this.Jl.texture,this.Wj.material.uniforms.mapRight.value=this.Kl.texture,this.Wj.material.needsUpdate=!0,this.renderer.render(this.Ys,this.RA)):(this.copyPass.renderToScreen=!0,this.ih.camera=this.camera,this.Ld.gg=
this.camera,this.Dd.render(og));this.traverse(function(og){og.material&&(og.visible=og instanceof THREE.Sprite?qg.get(og.id):!1)});this.renderer.render(this.Cc,this.camera);this.traverse(function(og){og.material&&(og.visible=qg.get(og.id))});null!=this.Rd&&(this.renderer.clearDepth(),this.renderer.render(this.Rd,this.ij));this.fh&&(this.ht=this.fh=!1,this.renderer.setClearColor(this.ga.bgColor,1),this.Qg.clearAlpha=1,this.Qg.clearColor=this.ga.bgColor,this.Cc.fog.color=this.ga.bgColor,this.renderer.domElement.toBlob(function(og){pg.ts(og)},
this.mimeType))};xg.init=function(){this.camera=this.ca.camera;this.camera.position.set(0,0,50);this.light=new jl(this);this.matrixAutoUpdate=!1;var og=new THREE.AmbientLight(6710886);this.Cc.add(og);this.Cc.fog=new THREE.Fog(this.ga.bgColor,0,0);this.Fy()};
xg.Fy=function(){this.renderer=new THREE.WebGLRenderer({antialias:this.ga.dc.antialias,alpha:!0,premultipliedAlpha:!1});this.renderer.autoClear=!1;this.renderer.setSize(this.ad.width(),this.ad.height());this.renderer.setPixelRatio(window.devicePixelRatio);this.renderer.setClearColor(this.ga.bgColor,1);this.renderer.domElement.className+=" hasContextMenu";this.ad.prepend(this.renderer.domElement);this.renderer.getContext();this.renderer.clippingPlanes=[this.ul,this.Wk];Vk.ph.bind(this.renderer,this.ad,
this.camera,this);var og=this.renderer.getContext();this.ga.ew(og)};xg.xq=function(og,pg){var qg=this.camera.near+(this.camera.far-this.camera.near)*pg/100;this.Cc.fog.near=this.camera.near+(this.camera.far-this.camera.near)*og/100;this.Cc.fog.far=qg;this.Nc=!0};xg.zc=function(og){this.ca.je=og};xg.Ks=function(og){this.Lq=og||this};xg.raycast=function(og,pg){for(var qg=[],rg=0,sg=this.sa.length;rg<sg;rg++)qg=qg.concat(this.sa[rg].vn());return vi.raycast(this,qg,og,pg)};
xg.clear=function(){for(var og=0;og<this.sa.length;og++)this.remove(this.sa);this.sa=[]};xg.Pg=function(og,pg){null==pg&&(pg=.1);var qg=new nl(og.r,og.g,og.b,pg);this.animations.Wc(qg)};xg.Px=function(og){for(var pg=0;pg<this.sa.length;pg++)if(this.sa[pg].af().toUpperCase()===og.toUpperCase())return this.sa[pg]};xg.jv=function(og,pg,qg){void 0===og&&(og=this.sa[0]);void 0===pg&&(pg=1E3);void 0===qg&&(qg=!0);og=new ol(og,this,pg,qg);this.animations.Wc(og)};
xg.kj=function(og){var pg=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1E3,qg=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0,rg=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;void 0===og&&(og=this.sa[0]);qg&&this.zc(og);pg=new ol(og,this,pg,qg,rg);this.$j.Wc(pg)};xg.gq=function(og,pg,qg){void 0===og&&(og=this.sa[0]);void 0===qg&&(qg=1E3);og=new kl(qg,og,this,pg);this.animations.Wc(og)};xg.toString=function(){return"scene"};
xg.update=function(og){og.bgColor&&(this.renderer.setClearColor(this.ga.bgColor,1),this.Qg.clearColor=this.ga.bgColor,this.Cc.fog.color=this.ga.bgColor);og.ef&&(this.Ld.Xo=this.ga.ef);og.df&&(this.Ld.En=this.ga.df);og.we&&(this.Ld.xl=this.ga.we);og.nf&&(this.rd.params.output=this.ga.dc.nf?THREE.SAOPass.OUTPUT.Default:THREE.SAOPass.OUTPUT.Beauty);og.saoScale&&(this.rd.params.saoScale=this.ga.Kf)};
xg.Ol=function(og,pg,qg,rg,sg){function tg(og){return"#"===og.charAt(0)?og.substring(1,7):"x"===og.charAt(1)?og.substring(2,8):og}var ug=this.ad.height(),yg=this.ad.width();null==pg&&(pg=El.location.$t);null!=qg?"string"===typeof qg&&qg.endsWith("%")&&(qg=ug*qg.substr(0,qg.length-1)/100):qg=ug*this.ga.Fg/100;null==rg&&(rg="#00ff00");null==sg&&(sg=2E3);null===this.Rd&&(this.ij=new THREE.OrthographicCamera(-yg/2,yg/2,ug/2,-ug/2,1,10),this.ij.position.z=10,this.Rd=new THREE.Scene,Vk.ph.bind(this.renderer,
this.ad,this.ij,this));if(""===og){var Bg;(Bg=this.Rd).remove.apply(Bg,Wh(this.dh.get(pg)));this.dh.set(pg,[]);this.renderer.render(this.Rd,this.ij)}else void 0!==og&&(og=this.ga.fs(og,{fontsize:qg,sn:{r:parseInt(tg(rg).substring(0,2),16),g:parseInt(tg(rg).substring(2,4),16),b:parseInt(tg(rg).substring(4,6),16),a:1},maxWidth:yg-10,maxHeight:ug-10}),rg=new THREE.SpriteMaterial({map:og}),og=rg.map.image.width,qg=rg.map.image.height,rg=new THREE.Sprite(rg),rg.scale.set(og,qg,1),this.dh.get(pg).push(rg),
this.kt(),this.Rd.add(rg),this.jb=!0,void 0!==sg&&(pg=new ml(rg,this,sg,pg),this.yc.qe?this.$j.Wc(pg):this.animations.Wc(pg)))};
xg.kt=function(){var og=this.ad.width()/2,pg=this.ad.height()/2,qg;for(qg in El.location){var rg=El.location[qg],sg=this.dh.get(rg),tg=!0,ug=!1,yg=void 0;try{for(var Bg=sg[Symbol.iterator](),Cg;!(tg=(Cg=Bg.next()).done);tg=!0){var Ag=Cg.value,wg=Ag.material.map.image.width/2,Dg=Ag.material.map.image.height/2;switch(rg){case El.location.yt:Ag.position.set(0,0,1);break;case El.location.Yt:Ag.position.set(0,pg-Dg,1);break;case El.location.vt:Ag.position.set(0,-pg+Dg,1);break;case El.location.LEFT:Ag.position.set(-og+
wg,0,1);break;case El.location.RIGHT:Ag.position.set(og-wg,0,1);break;case El.location.Zt:Ag.position.set(-og+wg,pg-Dg,1);break;case El.location.wt:Ag.position.set(-og+wg,-pg+Dg,1);break;case El.location.xt:Ag.position.set(og-wg,-pg+Dg,1);break;default:Ag.position.set(og-wg,pg-Dg,1)}}}catch(Eg){ug=!0,yg=Eg}finally{try{!tg&&Bg["return"]&&Bg["return"]()}finally{if(ug)throw yg;}}}};xg.ah=function(){for(var og=0;og<this.sa.length;og++)this.sa[og].ah()};
xg.mf=function(){for(var og=0;og<this.sa.length;og++)this.sa[og].mf();Xk.ba().fi()};xg.Ll=function(){this.matrix.identity();for(var og=0;og<this.sa.length;og++)this.sa[og].lf();this.updateMatrixWorld(!0);this.ca.kd(this.ca.Ib,!0)};
xg.reset=function(){this.Ll();this.mf();this.ah();var og=!0,pg=!1,qg=void 0;try{for(var rg=this.dh.values()[Symbol.iterator](),sg;!(og=(sg=rg.next()).done);og=!0)sg.value.splice()}catch(ug){pg=!0,qg=ug}finally{try{!og&&rg["return"]&&rg["return"]()}finally{if(pg)throw qg;}}if(null!=this.Rd){var tg;(tg=this.Rd).remove.apply(tg,Wh(this.Rd.children))}this.Jh();this.cn(0,100);Xk.ba().fi()};xg.xb=function(){return new THREE.Vector3};
xg.Gc=function(){var og=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!1,pg=this.wb(og).getCenter();null!=pg||og||(pg=this.wb(!0).getCenter());null==pg&&(pg=new THREE.Vector3);return pg};
xg.wb=function(){var og=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!1,pg=new Hg,qg=!0,rg=!1,sg=void 0;try{for(var tg=this.sa[Symbol.iterator](),ug;!(qg=(ug=tg.next()).done);qg=!0){var yg=ug.value,Bg=yg.wb(og).clone();Bg.applyMatrix4(yg.matrix);pg=pg.merge(Bg)}}catch(Cg){rg=!0,sg=Cg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}return pg};xg.mi=function(og){this.jf.Yn=!0;this.Ui=void 0!=og?og:null};xg.uf=function(){this.Ui=this.Ri=null;this.jf.Yn=!1};
xg.Jh=function(og){if(null!=og)for(var pg=0;pg<og.length;pg++){var qg=this.Mb.indexOf(og[pg]);this.Mb[qg].remove();this.Mb.splice(qg,1)}else{og=this.Mb.length;for(pg=0;pg<og;pg++)this.Mb[pg].remove();this.Mb=[]}this.Nc=!0};
xg.Vm=function(og){if(og!=this.Ui)if(this.ca.rj(og.wa().Ja().Ua.oa())[0].tb().Vn())this.uf(),Xk.ba().Hb({type:"WidgetNotAvailableForBioassembly"});else if(null==this.Ui&&null==this.Ri)this.Ri=og;else return og=new Cl(this,this.Ui||this.Ri,og),this.Mb.push(og),this.Ri=null,[og.Bg,og.ce]};
xg.Uo=function(og,pg){var qg=this.Mb.length;if(void 0==og)for(var rg=0;rg<qg;rg++)this.Mb[rg].cB();else for(rg=0;rg<qg;rg++)if(og.uuid===this.Mb[rg].ni.uuid||og.uuid===this.Mb[rg].oi.uuid)this.Mb[rg].Bg.visible=pg,this.Mb[rg].ce.visible=pg};xg.Jw=function(og){for(var pg=this.Mb.length,qg=[],rg=0;rg<pg;rg++)og.uuid!==this.Mb[rg].ni.uuid&&og.uuid!==this.Mb[rg].oi.uuid||qg.push(this.Mb[rg]);this.Jh(qg)};
function Fl(og,pg){var qg=["","",""],rg=og.indexOf(pg);-1==rg?qg[0]=og:(qg[0]=og.substr(0,rg),qg[1]=pg,qg[2]=og.substr(rg+1));return qg}function Gl(og){this.rs=og;this.length=0;this.Dl=-1;this.El=[];this.ls=!1}
Gl.prototype.nv=function(og){og=Fl(og,".");var pg=this.rs.currentTarget[this.rs.currentTarget.length-2];og[1]?(pg.hasOwnProperty(og[0])||(pg[og[0]]={}),pg[og[0]].hasOwnProperty(og[2])||(pg[og[0]][og[2]]=[]),this.El.push(pg[og[0]][og[2]])):(pg.hasOwnProperty(og[0])||(pg[og[0]]=[]),this.El.push(pg[og[0]]));this.length=this.El.length};Gl.prototype.Jz=function(og){this.ls=!0;var pg=this.lz();"stop_"==og?this.SA():pg.push(og)};Gl.prototype.lz=function(){this.Dl=(this.Dl+1)%this.length;return this.El[this.Dl]};
Gl.prototype.SA=function(){this.Dl=-1};function Hl(){this.data={};this.se=this.currentTarget=null;this.zs()}xg=Hl.prototype;xg.parse=function(og){og=og.split("\n");for(var pg,qg=[],rg=!1,sg,tg=0;tg<og.length;tg++)sg=og[tg].substr(0,1),pg=og[tg].trim(),";"==sg&&(rg?this.Js(qg.join("\n")):qg=[],rg=!rg,pg=pg.substr(1).trim()),rg?qg.push(pg):this.Bz(this.IA(pg))};
xg.IA=function(og){for(var pg=[["",!1]],qg=!1,rg=og.length,sg,tg=0,ug=0;ug<rg;ug++)if(sg=" "==og[ug]||"\t"==og[ug],!("'"!=og[ug]&&'"'!=og[ug]||0!=ug&&" "!=og[ug-1]&&"\t"!=og[ug-1]&&ug!=rg-1&&" "!=og[ug+1]&&"\t"!=og[ug+1]))qg=!qg;else if(!qg&&sg&&""!=pg[tg][0])pg.push(["",!1]),tg++;else if(!qg&&"#"==og[ug])break;else if(!sg||qg)pg[tg][0]+=og[ug],pg[tg][1]=qg;""==pg[tg][0]&&pg.pop();return pg};
xg.Bz=function(og){for(var pg=0;pg<og.length;pg++)"global_"!=og[pg][0]||og[pg][0]?"data_"!=og[pg][0].substr(0,5)||og[pg][1]?"save_"!=og[pg][0].substr(0,5)||og[pg][1]?"loop_"!=og[pg][0]||og[pg][1]?"_"!=og[pg][0].substr(0,1)||og[pg][1]?this.Js(og[pg][0]):this.hA(og[pg][0].substr(1)):this.se=new Gl(this):(this.se=null,og[pg][0].substr(5).length?this.aA(og[pg][0]):this.Zw()):(this.se=null,this.$z(og[pg][0])):(this.se=null,this.zs())};
xg.hA=function(og){if(null!=this.se)if(this.se.ls)this.se=null;else{this.se.nv(og);return}og=Fl(og,".");this.currentTarget.pop();og[1]?(this.currentTarget[this.currentTarget.length-1].hasOwnProperty(og[0])||(this.currentTarget[this.currentTarget.length-1][og[0]]={}),this.currentTarget[this.currentTarget.length-1][og[0]][og[2]]="",this.currentTarget.push([this.currentTarget[this.currentTarget.length-1][og[0]],og[2]])):(this.currentTarget[this.currentTarget.length-1][og[0]]="",this.currentTarget.push([this.currentTarget[this.currentTarget.length-
1],og[0]]))};xg.Js=function(og){if(null!=this.se)this.se.Jz(og);else{var pg=this.currentTarget[this.currentTarget.length-1];pg[0][pg[1]]=[og]}};xg.zs=function(){this.currentTarget=[this.data,this.data,null]};xg.$z=function(og){this.data.hasOwnProperty(og)||(this.data[og]={});this.currentTarget=[this.data,this.data[og],null]};
xg.aA=function(og){this.currentTarget[1].hasOwnProperty(og)||(this.currentTarget[1][og]={});this.currentTarget=this.currentTarget.slice(0,2);this.currentTarget.push(this.currentTarget[1][og]);this.currentTarget.push(null)};xg.Zw=function(){this.currentTarget=this.currentTarget.slice(0,3)};Hl.__deps=[Gl,Fl];
function Il(){var og=new CallRemote("GET");og.oB("/mmcif_pdbx_v40.dic");var pg=new Hl;pg.parse(og.request.responseText);var pg=pg.data["data_mmcif_pdbx.dic"],qg,og={},rg;for(rg in pg)"object"!=Vh(pg[rg])||pg[rg]instanceof Array||!pg[rg].hasOwnProperty("item_type")||(qg=Fl(rg.substr(6),"."),og.hasOwnProperty(qg[0])||(og[qg[0]]={}),og[qg[0]][qg[2]]=pg[rg].wB.code.trim());var pg={},sg;for(rg in og)for(sg in og[rg])"int"==og[rg][sg]?(pg.hasOwnProperty(rg)||(pg[rg]={}),pg[rg][sg]=parseInt):"float"==og[rg][sg]?
(pg.hasOwnProperty(rg)||(pg[rg]={}),pg[rg][sg]=parseFloat):"int-range"==og[rg][sg]?(pg.hasOwnProperty(rg)||(pg[rg]={}),pg[rg][sg]=Jl):"float-range"==og[rg][sg]&&(pg.hasOwnProperty(rg)||(pg[rg]={}),pg[rg][sg]=Kl);__CIFDICT__=pg}Il.__deps=[Jl,Kl];function Jl(og){try{var pg=og.indexOf("-",1);if(-1==pg)throw-1;return[parseInt(og.substr(0,pg)),parseInt(og.substr(pg+1))]}catch(qg){return[parseInt(og)]}}
function Kl(){try{var og=inp.indexOf("-",1);if(-1==og)throw-1;return[parseFloat(inp.substr(0,og)),parseFloat(inp.substr(og+1))]}catch(pg){return[parseFloat(inp)]}}
function Ll(og,pg){var qg=new Hl;qg.parse(og);if(pg)return qg.data;window.pB||Il();var rg,sg,tg,ug;for(rg in qg.data)for(sg in qg.data[rg])for(tg in qg.data[rg][sg])if(qg.data[rg][sg][tg]instanceof Array)for(ug=0;ug<qg.data[rg][sg][tg].length;ug++)qg.data[rg][sg][tg][ug]="?"!=qg.data[rg][sg][tg][ug]&&"."!=qg.data[rg][sg][tg][ug]?qg.data[rg][sg][tg][ug]:null;else qg.data[rg][sg][tg]="?"!=qg.data[rg][sg][tg]&&"."!=qg.data[rg][sg][tg]?qg.data[rg][sg][tg]:null;var yg;for(rg in qg.data)for(sg in qg.data[rg])if(__CIFDICT__.hasOwnProperty(sg))for(tg in qg.data[rg][sg])if(__CIFDICT__[sg].hasOwnProperty(tg))if(yg=
__CIFDICT__[sg][tg],qg.data[rg][sg][tg]instanceof Array)for(ug=0;ug<qg.data[rg][sg][tg].length;ug++)qg.data[rg][sg][tg][ug]=yg.call(null,qg.data[rg][sg][tg][ug]);else qg.data[rg][sg][tg]=yg.call(null,qg.data[rg][sg][tg]);return qg.data}Ll.__deps=[Il,Hl];function Ml(){this.Fw=this.Kq=this.Ew=this.Jq=this.Iq=this.Hq=this.Gq=this.Vr=this.Fs=this.Ur=this.Bs=this.Nk=null}function Nl(){this.description=this.Ko=this.name=null}
function Ol(og,pg,qg){null===og&&console.warn("chainId null in Residue.Id");this.Fc=og;this.ec=pg;this.Kc=qg||"";this.toString=function(){return isNaN(this.Kc.charCodeAt(0))?this.Fc+":"+this.ec:this.Fc+":"+this.ec+":"+this.Kc};this.nc=function(){return isNaN(this.Kc.charCodeAt(0))?this.Fc+":"+this.ec:this.Fc+":"+this.ec+":"+this.Kc}}
function Pl(){var og=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this.id=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this.name=og;this.$s=[];this.description=this.Zk=null}Pl.sk=new Pl("WATER","HOH");function Ql(){this.Ua=null;this.fc=new ch;this.Dg=[];this.wm=this.Gb=this.na=null}xg=Ql.prototype;xg.eb=function(){return this.Ua.toString()};xg.ii=function(og){this.Ua=og;og=this.Dg.length;for(var pg=0;pg<og;pg++)pg.ii(this.Ua)};
xg.add=function(og){if(og instanceof Rg)return og=this.fc.Jg(og),this.td(),og;og instanceof fh?((null!==og.$d&&og.$d!==this||og.$d===this)&&console.warn("ERROR: ",og,"already belongs to",og.$d),null===og.$d&&(this.Dg.push(og),og.ii(this.Ua),og.Ns(this),this.td())):console.warn("ERROR : a is not an atom or a molecule")};
xg.remove=function(og){og instanceof Rg?(og=this.fc.findNode(atom),-1<og&&(delete this.fc[og],this.td())):og instanceof fh&&(null===molecule&&console.warn("molecule null in function remove in model"),molecule.$d===this&&(this.Dg.splice(this.Dg.tB(molecule),1),molecule.ii(null),molecule.Ns(null),this.td()))};xg.Qa=function(){return this.fc.values()};
xg.hd=function(){if(!this.wm){this.fc.fw();this.Gb=this.bounds();for(var og=new Lk(this.Gb.$e(),this.Gb.Ze(),32),pg=this.Qa(),qg=0,rg=pg.length;qg<rg;qg++)og.add(new Mk(pg[qg]));og.optimize();rg=pg.length;for(qg=0;qg<rg;qg++)for(var sg=pg[qg],tg=sg.symbol,tg=tg.charAt(0).toUpperCase()+tg.slice(1).toLowerCase(),ug=parseFloat(Pg.bf(tg)[6]),yg=og.Xk(sg.pos,5),Bg=yg.length,Cg=0;Cg<Bg;Cg++){var Ag=yg[Cg].getPoint();if(Ag!==sg){var tg=Ag.symbol,tg=tg.charAt(0).toUpperCase()+tg.slice(1).toLowerCase(),tg=
parseFloat(Pg.bf(tg)[6]),wg=ug+tg+.4,Dg=sg.distanceTo(Ag);Dg>=ug+tg-.4&&Dg<=wg&&this.iv(sg,Ag)}}this.wm=!0}return this.fc};xg.iv=function(og,pg){var qg=this.fc.findNode(og),rg=this.fc.findNode(pg);void 0!==qg&&void 0!==rg||console.warn("Couldn't find atoms ",og," and/or ",pg," in model ",this);qg.Mr(rg)||this.fc.Gh(qg,rg).setAttribute("BondType","SIMPLE")};xg.td=function(){this.Gb=this.na=null;this.wm=!1};
xg.xb=function(){if(null===this.na){this.na=new THREE.Vector3;for(var og=this.Qa(),pg=0,qg=0,rg=0,sg=og.length,tg=0;tg<sg;tg++)var ug=og[tg].pos,pg=pg+parseInt(ug.x),qg=qg+parseInt(ug.y),rg=rg+parseInt(ug.z);this.na.set(pg/sg,qg/sg,rg/sg)}return this.na};
xg.bounds=function(){if(null===this.Gb){for(var og=new THREE.Vector3(Infinity,Infinity,Infinity),pg=new THREE.Vector3(-Infinity,-Infinity,-Infinity),qg=this.Qa(),rg=0,sg=qg.length;rg<sg;rg++){var tg=qg[rg].pos;og.x=Math.min(og.x,tg.x);og.y=Math.min(og.y,tg.y);og.z=Math.min(og.z,tg.z);pg.x=Math.max(pg.x,tg.x);pg.y=Math.max(pg.y,tg.y);pg.z=Math.max(pg.z,tg.z)}this.Gb=new Hg(og,pg)}return this.Gb};
function Rl(){this._id=this.wd=this.gb=this.ab=this.Eb=this.ja=this.tf=null;this.Ha="\x00";this.fc=new Map;this.Gb=this.Hi=this.na=null}xg=Rl.prototype;xg.Sl=function(og){this.wd=og.Fc;this._id=og.ec;this.Ha=og.Kc};xg.hd=function(){return this.ab.hd()};xg.Ja=function(){return this.ab};xg.Ps=function(og){this.ab=og;null!==og&&void 0!==og&&this.lg(og.oa())};xg.oa=function(){return this._id};xg.dl=function(){var og=this._id;"\x00"!==this.Ha&&(og+=this.Ha);return og};
xg.xe=function(og){if(this._id!=og){this._id=og;var pg=!0,qg=!1,rg=void 0;try{for(var sg=this.Ed()[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0)tg.value.Ao(og)}catch(ug){qg=!0,rg=ug}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}}};
xg.Rj=function(og){if(this.Ha!=og){this.Ha=og;var pg=!0,qg=!1,rg=void 0;try{for(var sg=this.Ed()[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0)tg.value.Rj(og)}catch(ug){qg=!0,rg=ug}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}}};
xg.hi=function(og){if(this.gb!=og){this.gb=og;var pg=!0,qg=!1,rg=void 0;try{for(var sg=this.Ed()[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0)tg.value.hi(og)}catch(ug){qg=!0,rg=ug}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}}};
xg.lg=function(og){if(this.wd!=og){this.wd=og;null!==this.ab&&this.ab.xe(og);var pg=!0,qg=!1,rg=void 0;try{for(var sg=this.Ed()[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0)tg.value.lg(og)}catch(ug){qg=!0,rg=ug}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}}};
xg.Qj=function(og){if(this.sh!=og){this.sh=og;null!==this.ab&&this.ab.Ms(og);var pg=!0,qg=!1,rg=void 0;try{for(var sg=this.Ed()[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0)tg.value.lg(og)}catch(ug){qg=!0,rg=ug}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}}};
xg.add=function(og){null===og&&console.warn("atom = null in Residue");null!==og.wa()&&og.wa()!==this&&console.warn(og," already belongs to ",og.wa());if(null===og.wa()){var pg=this.fc.get(og.Le);null==pg&&(pg=[],this.fc.set(og.Le,pg));pg.push(og);og.Sl(this)}};xg.remove=function(og){null===og&&console.warn("atom = null in Residue");if(og.wa()===this){var pg=this.fc.get(og.Le);null!=pg&&(pg.splice(pg.indexOf(og),1),0===pg.length&&this.fc["delete"](og.Le),og.Sl(null))}};
xg.fy=function(){return 0<Array.from(this.fc.keys()).filter(function(og){return"\x00"!=og}).length};xg.px=function(){return this.fy()?Array.from(this.fc.keys()).filter(function(og){return"\x00"!=og}).sort():[]};xg.Ed=function(){var og=[],pg=!0,qg=!1,rg=void 0;try{for(var sg=this.fc.values()[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0)og=og.concat(tg.value)}catch(ug){qg=!0,rg=ug}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}return og};
xg.rA=function(og){this.Eb=null!=og?og:Tg.ek};xg.Qa=function(og){if(null==og){var pg=this.px()[0];null==pg&&(pg="\x00");return this.Qa(pg)}return this.Ed().filter(function(pg){return"\x00"==pg.Le||pg.Le==og})};xg.ar=function(og){var pg=!0,qg=!1,rg=void 0;try{for(var sg=this.Ed()[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0){var ug=tg.value;if(ug.oa()==og)return ug}}catch(yg){qg=!0,rg=yg}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}return null};
xg.md=function(og){return this.Qa(void 0).filter(function(pg){return pg.name===og})[0]};xg.td=function(){this.Gb=this.na=null;null!==this.ab&&this.ab.td()};
xg.xb=function(){if(null==this.na){this.na=new THREE.Vector3;var og=this.Ed(),pg=og.length,qg=!0,rg=!1,sg=void 0;try{for(var tg=og[Symbol.iterator](),ug;!(qg=(ug=tg.next()).done);qg=!0){var yg=ug.value.pos;this.na.x+=yg.x;this.na.y+=yg.y;this.na.z+=yg.z}}catch(Bg){rg=!0,sg=Bg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}this.na.x/=pg;this.na.y/=pg;this.na.z/=pg}return this.na};
xg.bl=function(){if(null==this.Hi){var og=!0,pg=!1,qg=void 0;try{for(var rg=this.Ed()[Symbol.iterator](),sg;!(og=(sg=rg.next()).done);og=!0){var tg=sg.value;if("CA"===tg.name){this.Hi=tg.pos.clone();break}}}catch(Ag){pg=!0,qg=Ag}finally{try{!og&&rg["return"]&&rg["return"]()}finally{if(pg)throw qg;}}}if(null==this.Hi){og=this.xb();pg=null;qg=Infinity;rg=!0;sg=!1;var ug=void 0;try{for(var yg=this.Ed()[Symbol.iterator](),Bg;!(rg=(Bg=yg.next()).done);rg=!0){var tg=Bg.value,Cg=og.distanceTo(tg.pos);Cg<
qg&&(pg=tg,qg=Cg)}}catch(Ag){sg=!0,ug=Ag}finally{try{!rg&&yg["return"]&&yg["return"]()}finally{if(sg)throw ug;}}this.Hi=pg.clone()}return this.Hi};
xg.bounds=function(){if(null===this.Gb){var og=new THREE.Vector3(Infinity,Infinity,Infinity),pg=new THREE.Vector3(-Infinity,-Infinity,-Infinity),qg=!0,rg=!1,sg=void 0;try{for(var tg=this.Ed()[Symbol.iterator](),ug;!(qg=(ug=tg.next()).done);qg=!0){var yg=ug.value;og.x=Math.min(og.x,yg.pos.x);og.y=Math.min(og.y,yg.pos.y);og.z=Math.min(og.z,yg.pos.z);pg.x=Math.max(pg.x,yg.pos.x);pg.y=Math.max(pg.y,yg.pos.y);pg.z=Math.max(pg.z,yg.pos.z)}}catch(Bg){rg=!0,sg=Bg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;
}}this.Gb=new Hg(og,pg)}return this.Gb};xg.Xh=function(){return this.ja==fh.ea.wi||this.ja==fh.ea.Ai};xg.Xf=function(){return this.ja==fh.ea.Td||this.ja==fh.ea.vg||this.ja==fh.ea.wg};
xg.tr=function(){switch(null!==this.tf?this.tf:this.gb){case "GLY":return"G";case "ALA":return"A";case "VAL":return"V";case "LEU":return"L";case "ILE":return"I";case "PRO":return"P";case "PHE":return"F";case "MET":return"M";case "TRP":return"W";case "SER":return"S";case "THR":return"T";case "ASN":return"N";case "GLN":return"Q";case "ASP":return"D";case "GLU":return"E";case "CYS":return"C";case "TYR":return"Y";case "HIS":return"H";case "LYS":return"K";case "ARG":return"R";case "ASX":return"B";case "GLX":return"Z";
case "A":case "DA":case "+A":return"A";case "C":case "DC":case "+C":return"C";case "G":case "DG":case "+G":return"G";case "T":case "DT":case "+T":return"T";case "U":case "DU":case "+U":return"U";case "I":case "DI":case "+I":return"I"}return null!=this.ab.ja.name&&"Protein"===this.ab.ja.name?"X":null==this.ab.ja.name||"RNA"!==this.ab.ja.name&&"DNA"!==this.ab.ja.name?"?":"N"};xg.toString=function(){return this.gb+":"+this.dl()};xg.nc=function(){return this.gb+":"+this._id+":"+this.wd};
xg.eb=function(){return this.ab.eb()+":"+this.toString()};xg.getTypeName=function(){return null==this.ja?null:this.ja.name};
xg.Hu=function(og){null===this.tf&&console.warn("Error : stdResName must be set before guessing residue type");-1!==Rl.Rt.indexOf(this.tf)?this.ja=fh.ea.wi:-1!==Rl.Tt.indexOf(this.tf)?this.ja=fh.ea.Ai:-1!==Rl.St.indexOf(this.tf)?this.ja=fh.ea.Td:-1!==Rl.Qt.indexOf(this.gb)?this.ja=fh.ea.sp:-1!==Rl.Ut.indexOf(this.gb)?this.ja=null:(og=og.get(this.oa()),null!=og&&og.name.endsWith(" ION")&&(this.ja=fh.ea.lp),this.ja=fh.ea.xi)};Rl.St="GLY ALA VAL LEU ILE PRO PHE MET TRP SER THR ASN GLN ASP GLU CYS TYR HIS LYS ARG".split(" ");
Rl.Tt=["A","C","G","U","I"];Rl.Rt="DA DC DG DT DI DU +A +C +G +T +I +U T".split(" ");Rl.Ut="UNK ASX GLX N DN UNL UNX".split(" ");Rl.mB=["UNK","ASX","GLX"];Rl.nB=["N"];Rl.kB=["N","DN"];Rl.lB=["UNL"];Rl.jB=["UNX"];Rl.Qt=["HOH","DOD","GOL","EDO"];
Rl.It=function(og,pg,qg){null===og&&console.warn("chainId null in Residue.Id");this.Fc=og;this.ec=pg;this.Kc=qg||"\x00";this.toString=function(){return"\x00"!=this.Kc?this.Fc+":"+this.ec+":"+this.Kc:this.Fc+":"+this.ec};this.nc=function(){return"\x00"!=this.Kc?this.Fc+":"+this.ec+":"+this.Kc:this.Fc+":"+this.ec}};
function Sl(){this.Vy=!0;this._id=this.Xp=null;this.cq=NaN;this.Ip=new Date;this.Jm=null;this.Hm=[];this.Gp=[];this.Cg=new Vg;this.zg=new Vg;this.dd=new Vg;this.fu=[];this.yh=[];this.Pj=new Vg;this.na=null;this.Af=new Vg;this.rh=new Vg;this.Bf=new Vg}xg=Sl.prototype;xg.Is=function(og){this.Bf=og};
xg.xb=function(){if(null===this.na){this.na=new THREE.Vector3;for(var og=this.yh[0].Dg,pg=0;pg<og.length;pg++){var qg=og[pg].xb();this.na.x+=qg.x;this.na.y+=qg.y;this.na.z+=qg.z}this.na.x/=og.length;this.na.y/=og.length;this.na.z/=og.length}return this.na};xg.hd=function(){return this.yh[0].hd()};xg.oa=function(){return this._id};xg.xe=function(og){null==this._id&&(this.Xp=og);this._id=og};xg.sA=function(og){this.cq=og};xg.Zx=function(og){return this.Pj.get(og)};xg.getDate=function(){return this.Ip};
xg.setDate=function(og){this.Ip=og};xg.Qs=function(og){this.Jm=og};xg.Yx=function(og){return null==og?this.Hm:this.Hm[og]};xg.iq=function(og,pg){null==this.Yx(og)&&(this.Hm[og]=pg)};xg.gA=function(og){this.Gp=og};xg.add=function(og){null===og&&console.warn("Error on adding model to structure : model = NULL");null!=og.Ua&&og.Ua!=this&&console.warn(og," already belongs to ",og.Ua);null==og.Ua&&(this.yh.push(og),og.ii(this))};
xg.remove=function(og){null===og&&console.warn("Error on removing structure");og.Ua==this&&(this.yh.remove(og),og.ii(null))};xg.gl=function(){return this.yh[0]};xg.toString=function(){return this._id};xg.nc=function(){return this.toString()};xg.eb=function(){return this.toString()};xg.Dw=function(og){this.Iu();this.iu(og);this.mu()};
xg.Iu=function(){this.Cg.__proto__=Vg.prototype;this.Cg.Vg();this.dd.__proto__=Vg.prototype;this.dd.Vg();this.zg.__proto__=Vg.prototype;this.zg.Vg();this.Pj.__proto__=Vg.prototype;this.Pj.Vg();this.Af.__proto__=Vg.prototype;this.Af.Vg();this.rh.__proto__=Vg.prototype;this.rh.Vg();this.Bf.__proto__=Vg.prototype;this.Bf.Vg()};
xg.iu=function(og){for(var pg=og.length,qg=0;qg<pg;qg++){var rg=new Ql;this.add(rg);for(var sg=og[qg],tg=sg.length,ug=0;ug<tg;ug++){var yg=new Rg;yg.ja=sg[ug][0];yg.id=sg[ug][1];yg.name=sg[ug][2];yg.Le=sg[ug][3];yg.hi(sg[ug][4]);yg.lg(sg[ug][5]);yg.Ao(sg[ug][6]);yg.Rj(sg[ug][7]);yg.pos.x=sg[ug][8];yg.pos.y=sg[ug][9];yg.pos.z=sg[ug][10];yg.nz=sg[ug][11];yg.$A=sg[ug][12];yg.symbol=sg[ug][13];yg.dw=sg[ug][14];yg.Qj(sg[ug][15]);rg.add(yg)}}};
xg.mu=function(){var og=this.Cg,pg=this.zg,qg=this.dd,rg=this.yh,sg=!1,tg,ug=rg.length,yg=new Vg;for(tg=0;tg<ug;tg++){for(var Bg=rg[tg],Cg=[],Ag=Bg.Qa(),wg=Ag.length,Dg=0;Dg<wg;Dg++){var Eg=Ag[Dg],Fg=void 0,Jg=new Rl.It(Eg.wd,Eg.Xi,Eg.Ha),Fg=yg.get(Jg);if(null==Fg){Fg=new Rl;Fg.Sl(Jg);Fg.hi(Eg.gb);Fg.Qj(Eg.sh);var Ig=og.get(Jg);Fg.tf=Ig?Ig.Ko:Fg.gb;Fg.Hu(pg);Ig=qg.get(Jg);Fg.rA(Ig);null!=Ig&&(sg||(sg=!0));Cg.push([Fg,Jg]);yg.set(Jg,Fg)}Fg.add(Eg)}Eg=void 0;for(Fg=0;Fg<Cg.length;Fg++){Ag=Cg[Fg][0];
wg=Cg[Fg][1];Fg=Ag;for(Dg=[];void 0!==Fg&&null!==Fg&&-1===Dg.indexOf(wg)&&!Fg.Xf()&&!Fg.Xh();)if(Dg.push(wg),Eg=this.Zx(wg),null!=Eg){for(var Eg=Eg.to.Fc===wg.Fc&&Eg.to.ec===wg.ec&&Eg.to.Kc===wg.Kc?Eg.yB:Eg.to,Lg,Fg=0;Fg<Cg.length;Fg++)Jg=Cg[Fg],Eg.Fc===Jg.Fc&&Eg.ec===Jg.ec&&Eg.Kc===Jg.Kc&&(Lg=Fg);Fg=Cg[Lg][0]}void 0!==Fg&&Fg.ja!==Ag.ja&&(Ag.ja=Fg.ja)}Ag=new Map;for(Fg=0;Fg<Cg.length;Fg++)wg=Cg[Fg][0],Dg=wg.wd,Eg=wg.getTypeName()+" "+Dg,Jg=Ag.get(Eg),void 0===Jg&&(Jg=new fh(Dg),Jg.Ms(wg.sh),Bg.add(Jg),
Ag.set(Eg,Jg)),Jg.add(wg),Jg.Gk=sg;Bg=function(og,pg){return og.ym<pg.ym?-1:og.ym>pg.ym?1:og._id<pg._id?-1:og._id>pg._id?1:og.Ha<pg.Ha?-1:og.Ha>pg.Ha?1:0};Cg=!0;Fg=!1;wg=void 0;try{for(var Kg=Ag.values()[Symbol.iterator](),Mg;!(Cg=(Mg=Kg.next()).done);Cg=!0){var Og=Mg.value;Og.ka.sort(Bg);Og.Gu()}}catch(Sg){Fg=!0,wg=Sg}finally{try{!Cg&&Kg["return"]&&Kg["return"]()}finally{if(Fg)throw wg;}}}};
function Tl(){var og=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!1,pg=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this.ia=null;this.gf=[];this.io=[];this.ds=!1;this.wz=!0;this.Zl=[];this.Ss=new Vg;this.hu=og;this.Zp=pg}xg=Tl.prototype;xg.parse=function(og,pg){this.ia=new Sl;this.Zl[Pl.sk.id]=Pl.sk;var qg=Ll(og,1);this.parseJSON(qg);this.ia.Cg.Mc();this.ia.dd.Mc();this.ia.zg.Mc();this.ia.Af.Mc();this.ia.rh.Mc();this.ia.Bf.Mc();this.ia.Pj.Mc();pg.apply(this,[this.ia,this.gf])};
xg.getFloatValue=function(og){og=parseFloat(this.io[og]);isNaN(og)&&(og=0);return og};xg.getStringValue=function(og,pg){var qg=this.io[og];null==qg&&null!=pg&&(qg=this.io[pg]);if("."===qg||"?"===qg)return"";void 0!==qg&&(qg=qg.replace('"',""));return qg};
xg.parseJSON=function(og){for(var pg in og){var qg=og[pg];this.ia.xe(qg.entry.id[0]);this.mA(qg);this.Cz(qg.atom_site);this.Iz(qg.pdbx_struct_mod_residue);this.Ez(qg.pdbx_nonpoly_scheme);this.Dz(qg.chem_comp);this.Hz(qg.struct_conf);this.Fz(qg.struct_sheet_order);this.Gz(qg.struct_sheet_range);this.kg(qg.pdbx_struct_assembly_gen);this.eA(qg.pdbx_struct_assembly);this.Is(qg.pdbx_struct_oper_list)}};
xg.Cz=function(og){for(var pg="N CA C P O5' O3'".split(" "),qg=0,rg=og.id.length;qg<rg;qg++){var sg=parseInt(og.pdbx_PDB_model_num[qg]);if(!(this.wz&&1<sg)){var tg=this.xa(og.label_entity_id[qg]),ug=this.xa(og.auth_asym_id[qg],og.label_asym_id[qg]);if(null==this.Zp||this.no.includes(tg)||this.Zp==ug)if(ug=this.gf[sg-1],void 0===ug&&(ug=[],this.gf[sg-1]=ug),sg=this.xa(og.label_atom_id[qg]),!this.hu||pg.includes(sg)||this.no.includes(tg))tg=[],sg=og.type_symbol[qg],null!==sg&"H"===sg&&!this.ds||(tg.push(this.xa(og.group_PDB[qg])),
tg.push(this.We(og.id[qg])),tg.push(this.xa(og.auth_atom_id[qg],og.label_atom_id[qg]).replace(/"/g,"")),tg.push(this.xa(og.label_alt_id[qg].replace(/"/g),"\x00")),tg.push(this.xa(og.auth_comp_id[qg],og.label_comp_id[qg])),tg.push(this.xa(og.auth_asym_id[qg],og.label_asym_id[qg])),tg.push(this.We(og.auth_seq_id[qg])),tg.push(this.xa(og.pdbx_PDB_ins_code[qg])),tg.push(this.Nh(og.Cartn_x[qg])),tg.push(this.Nh(og.Cartn_y[qg])),tg.push(this.Nh(og.Cartn_z[qg])),tg.push(this.Nh(og.occupancy[qg])),tg.push(this.Nh(og.B_iso_or_equiv[qg])),
tg.push(this.xa(og.type_symbol[qg])),tg.push(this.We(og.pdbx_formal_charge[qg])),tg.push(this.xa(og.label_asym_id[qg])),ug.push(tg))}}};xg.Iz=function(og){if(null!=og)for(var pg=0,qg=og.id.length;pg<qg;pg++){var rg=new Nl;rg.name=this.xa(og.auth_comp_id[pg]);rg.Ko=this.xa(og.parent_comp_id[pg]);rg.description=this.xa(og.details[pg]);var sg=this.xa(og.auth_asym_id[pg]),tg=this.We(og.auth_seq_id[pg]),ug=this.xa(og.PDB_ins_code[pg]);this.ia.Cg.set(new Ol(sg,tg,ug),rg)}};
xg.Ez=function(og){if(null!=og)for(var pg=0,qg=og.asym_id.length;pg<qg;pg++){var rg=this.xa(og.mon_id[pg]),sg=this.Zl[rg];void 0===sg&&(sg=new Pl,sg.id=rg,this.Zl[rg]=sg);var rg=this.xa(og.pdb_strand_id[pg]),tg=this.We(og.pdb_seq_num[pg]),ug=this.xa(og.pdb_ins_code[pg]);this.ia.zg.set(new Ol(rg,tg,ug),sg)}};
xg.Dz=function(og){if(null!=og)for(var pg=0,qg=og.id.length;pg<qg;pg++){var rg=this.xa(og.id[pg]),rg=this.Zl[rg];void 0!==rg&&(rg.name=this.xa(og.name[pg]),null!=this.xa(og.pdbx_synonyms[pg])&&this.xa(og.pdbx_synonyms[pg]),rg.Zk=this.xa(og.formula[pg]))}};
xg.Hz=function(og){if(null!=og)for(var pg=0,qg=og.id.length;pg<qg;pg++){this.xa(og.conf_type_id[pg]);var rg=this.xa(og.beg_auth_asym_id[pg]),sg=this.We(og.beg_auth_seq_id[pg]),tg=this.xa(og.pdbx_beg_PDB_ins_code[pg]);this.xa(og.end_auth_asym_id[pg]);var ug=this.We(og.end_auth_seq_id[pg]);this.xa(og.pdbx_end_PDB_ins_code[pg]);ug=parseInt(ug);for(sg=parseInt(sg);sg<ug;sg++)this.ia.dd.set(new Ol(rg,sg,tg),Tg.ug);this.ia.dd.set(new Ol(rg,ug,tg),Tg.Gt)}};
xg.Gz=function(og){if(null!=og)for(var pg=0,qg=og.id.length;pg<qg;pg++){var rg=Tg.nh,sg=this.xa(og.beg_auth_asym_id[pg]),tg=this.We(og.beg_auth_seq_id[pg]),ug=this.xa(og.pdbx_beg_PDB_ins_code[pg]);this.xa(og.end_auth_asym_id[pg]);var yg=this.We(og.end_auth_seq_id[pg]);this.xa(og.pdbx_end_PDB_ins_code[pg]);var Bg=this.xa(og.id[pg]),Bg=this.Ss.get(new Ol(sg,Bg,"0"));"anti-parallel"===Bg&&(rg=Tg.jh);yg=parseInt(yg);for(tg=parseInt(tg);tg<yg;tg++)this.ia.dd.set(new Ol(sg,tg,ug),rg);"anti-parallel"===
Bg?this.ia.dd.set(new Ol(sg,yg,ug),Tg.rt):this.ia.dd.set(new Ol(sg,yg,ug),Tg.Lt)}};xg.Fz=function(og){if(null!=og)for(var pg=0,qg=og.sheet_id.length;pg<qg;pg++){var rg=this.xa(og.sheet_id[pg]);this.xa(og.range_id_1[pg]);var sg=this.xa(og.range_id_2[pg]),tg=this.xa(og.sense[pg]);this.Ss.set(new Ol(rg,sg),tg)}};
xg.mA=function(og){var pg=og.struct_keywords;if(pg&&pg.pdbx_keywords&&pg.text){this.xa(pg.pdbx_keywords[0]);for(var qg=0,rg=pg.text.length;qg<rg;qg++)this.xa(pg.text[qg])}if((pg=og.audit_author)&&pg.name)for(qg=0,rg=pg.name.length;qg<rg;qg++)this.ia.fu.push(this.xa(pg.name[qg]));if((pg=og.database_PDB_rev)&&pg.num&&pg.date_original)for(qg=0,rg=pg.num.length;qg<rg;qg++){var sg=this.xa(pg.date_original[qg]);null!==sg&&this.ia.setDate(sg)}(qg=og.struct)&&qg.title&&this.ia.Qs(this.xa(qg.title[0]));if((og=
og.entity)&&og.formula_weight){pg=0;this.no=[];qg=0;for(rg=og.formula_weight.length;qg<rg;qg++)pg+=this.Nh(og.formula_weight[qg]),"polymer"!=og.type[qg]&&this.no.push(og.id[qg]);this.ia.sA(pg)}};
xg.kg=function(og){if(null!=og)for(var pg=0,qg=og.oper_expression.length;pg<qg;pg++){for(var rg=[],sg=[],tg=this.$q(og.asym_id_list[pg]),ug=og.oper_expression[pg].split(")("),yg=0;yg<ug.length;yg++){ug[yg]=ug[yg].replace(")","").replace("(","");for(var Bg=ug[yg].split(","),Cg=0;Cg<Bg.length;Cg++)rg=rg.concat(this.$q(Bg[Cg]));sg.push(rg);rg=[]}this.ia.Af.set(og.assembly_id[pg],[sg,tg])}};xg.eA=function(og){if(null!=og)for(var pg=this.ia.rh,qg=0,rg=og.id.length;qg<rg;qg++)pg.set(og.id[qg],og.details[qg])};
xg.Is=function(og){if(null!=og)for(var pg=0,qg=og.id.length;pg<qg;pg++)this.ia.Bf.set(og.id[pg],[parseFloat(og["matrix[1][1]"][pg]),parseFloat(og["matrix[1][2]"][pg]),parseFloat(og["matrix[1][3]"][pg]),parseFloat(og["vector[1]"][pg]),parseFloat(og["matrix[2][1]"][pg]),parseFloat(og["matrix[2][2]"][pg]),parseFloat(og["matrix[2][3]"][pg]),parseFloat(og["vector[2]"][pg]),parseFloat(og["matrix[3][1]"][pg]),parseFloat(og["matrix[3][2]"][pg]),parseFloat(og["matrix[3][3]"][pg]),parseFloat(og["vector[3]"][pg])])};
xg.$q=function(og){var pg=[];if(0<=og.indexOf("-")){og=og.split("-");for(var qg=parseInt(og[0]);qg<parseInt(og[1])+1;qg++)pg.push(qg.toString())}else pg=og.split(",");return pg};xg.We=function(og){og=parseInt(og);isNaN(og)&&(og=0);return og};xg.Nh=function(og){og=parseFloat(og);isNaN(og)&&(og=0);return og};xg.xa=function(og,pg){var qg=og;null==qg&&null!=defaultTag&&(qg=pg);if("."===qg||"?"===qg)qg=null!=pg?pg:"";void 0!==qg&&(qg=qg.replace('"',""));return qg};Tl.__deps=[Tg,Pl,Ml,Nl,Ol,Vg,Sl,Ll];
function Zl(og){this.ia=this.file=null;this.gf=[];this.source=this.$m=this.keywords=this.title=null;this.ready=!1;this.Vf=[];this.Vf[Pl.sk.id]=Pl.sk;this.Uh=[];this.resolution=null;null==og&&(og=!1);this.nu=og;this.Ep=null}Zl.Ct="ENDMDL";Zl.Vt="TER";Zl.Bt="END";Zl.hB="PDB";Zl.xp=1;Zl.prototype.parse=function(og,pg){this.Ep=pg;this.ia=new Sl;this.vz(og)};
Zl.prototype.vz=function(og){og=og.split("\n");var pg,qg=null,rg;for(rg in og){var sg=og[rg];if(sg===this.Vt||sg===this.Bt)return;if(sg===this.Ct){this.gf.push([]);return}var tg=sg.substring(0,6).trim(),ug=null,yg;switch(tg){case "ATOM":case "HETATM":var ug=sg.substring(76,78).trim(),Bg=sg.substring(12,16).trim();""===ug&&(ug=Bg[0]);var Cg=this.gf[this.gf.length-1];void 0===Cg&&(Cg=[],this.gf.push(Cg));if(this.nu&&"CA"!==Bg)break;if(!(null!==ug&"H"===ug)||this.ds){var Ag=[];yg=sg.charAt(21);Ag.push(tg);
Ag.push(sg.substring(6,11).trim());Ag.push(Bg);Ag.push(" "!=sg.charAt(16)?sg.charAt(16):"\x00");Ag.push(sg.substring(17,20).trim());Ag.push(yg);Ag.push(parseFloat(sg.substring(22,26).trim()));Ag.push(" "!=sg.charAt(26)?sg.charAt(26):"");Ag.push(parseFloat(sg.substring(30,38).trim()));Ag.push(parseFloat(sg.substring(38,46).trim()));Ag.push(parseFloat(sg.substring(46,54).trim()));Ag.push(sg.substring(54,60).trim());Ag.push(sg.substring(60,66).trim());Ag.push(ug);79<=sg.length&&Ag.push(toString(sg.charAt(79))+
toString(sg.charAt(78)));Cg.push(Ag)}break;case "HEADER":59<sg.length?this.ia.xe(sg.substring(62,66).trim()):this.ia.xe(file.getName().replaceAll("\\..*$","").toUpperCase());this.ia.setDate(sg.substring(50,59));break;case "TITLE":this.title=null===this.title?sg.substring(10):this.title+(" "+sg.substring(10));this.ia.Qs(this.title);break;case "SOURCE":this.source+=sg.substring(10);break;case "KEYWDS":this.keywords+=sg.substring(10);break;case "AUTHOR":this.$m+=sg.substring(10);break;case "DBREF":qg=
new Ml;qg.Nk=sg.charAt(12);qg.Bs=sg.substring(14,18).trim();qg.Ur=" "!==sg.charAt(18)?sg.charAt(18):"";qg.Fs=sg.substring(20,24).trim();qg.Vr=" "!=sg.charAt(24)?sg.charAt(24):"";qg.Gq=sg.substring(26,32).trim();qg.Hq=sg.substring(33,41).trim();qg.Iq=sg.substring(42,54).trim();qg.Jq=sg.substring(55,60).trim();qg.Ew=" "!=sg.charAt(60)?sg.charAt(60):"";qg.Kq=sg.substring(62,67<=sg.length?67:sg.length).trim();qg.Fw=68<=sg.length?sg.charAt(67):"";this.ia.iq(qg.Nk,qg);break;case "DBREF1":qg=new Ml;qg.Nk=
sg.charAt(12);qg.Bs=sg.substring(14,18).trim();qg.Ur=" "!=sg.charAt(18)?sg.charAt(18):"";qg.Fs=sg.substring(20,24).trim();qg.Vr=" "!=sg.charAt(24)?sg.charAt(24):"";qg.Gq=sg.substring(26,32).trim();qg.Iq=sg.substring(47,67<=sg.length?67:sg.length).trim();this.ia.iq(qg.Nk,qg);break;case "DBREF2":qg.Hq=sg.substring(18,40).trim();qg.Jq=sg.substring(45,55).trim();qg.Kq=sg.substring(57,67<=sg.length?67:sg.length).trim();break;case "MODRES":ug=new Nl;ug.name=sg.substring(12,15).trim();yg=sg.charAt(16);tg=
sg.substring(18,22).trim();Bg=" "!=sg.charAt(22)?sg.charAt(22):"";ug.Ko=sg.substring(24,27).trim();ug.description=30<=sg.length?sg.substring(29).trim():null;this.ia.Cg.set(new Ol(yg,tg,Bg),ug);break;case "HET":yg=sg.substring(7,10).trim();for(pg in this.Vf)if(pg[0]===yg){ug=pg[1];break}null===ug&&(ug=new Pl,ug.id=yg,ug.description=31<=sg.length?sg.substring(30):null,this.Vf[yg]=ug);yg=sg.charAt(12);tg=sg.substring(13,17).trim();Bg=" "!=sg.charAt(17)?sg.charAt(17):"";this.ia.zg.set(new Ol(yg,tg,Bg),
ug);break;case "HETNAM":yg=sg.substring(11,14).trim();ug=this.Vf[yg];null==ug&&(ug=new Pl,ug.id=yg,this.Vf[yg]=ug);ug.name=null===ug.name?sg.substring(15):ug.name+sg.substring(15);break;case "HETSYN":yg=sg.substring(11,14).trim();this.Uh[yg]=void 0===this.Uh[yg]?sg.substring(15):this.Uh[yg]+sg.substring(15);break;case "FORMUL":yg=sg.substring(12,15).trim();ug=this.Vf[yg];ug.Zk=null===ug.Zk?sg.substring(19):ug.Zk+sg.substring(19);break;case "HELIX":yg=sg.charAt(19);ug=parseInt(sg.substring(21,25));
tg=sg.charAt(25);" "===tg&&(tg="");pg=parseInt(sg.substring(33,37));ug=parseInt(ug);Bg=parseInt(pg);for(pg=ug;pg<=Bg;pg++)this.ia.dd.set(new Ol(yg,pg,tg),Tg.ug);break;case "SHEET":for(yg=sg.charAt(21),ug=parseInt(sg.substring(22,26)),tg=sg.charAt(26)," "===tg&&(tg=""),pg=parseInt(sg.substring(33,37)),sg=-1===parseInt(sg.substring(38,40))?Tg.jh:Tg.nh,ug=parseInt(ug),Bg=parseInt(pg),pg=ug;pg<=Bg;pg++)this.ia.dd.set(new Ol(yg,pg,tg),sg)}}this.finish();this.ready=!0};
Zl.prototype.finish=function(){this.ia.gA(this.ia.Gp.concat(null));this.$m=this.keywords=this.source=null;for(var og in this.Uh){var pg=this.Vf[og];pg.$s=pg.$s.concat(this.Uh[og].split("\\s*;\\s*"))}this.Uh=this.Vf=null;null==this.ia._id&&(this.ia.xe("Unknown_"+Zl.xp),Zl.xp++);this.ia.Cg.Mc();this.ia.dd.Mc();this.ia.zg.Mc();this.ia.Af.Mc();this.ia.rh.Mc();this.ia.Bf.Mc();this.ia.Pj.Mc();this.Ep.apply(this,[this.ia,this.gf])};Zl.__deps=[Tg,Pl,Nl,Ml,Ol,Sl];
function $l(og){function pg(og,pg){postMessage(JSON.stringify(og));postMessage(JSON.stringify(pg))}var qg=og.data[0],rg=og.data[2],sg=og.data[3],tg;tg=og.data[1]?new Tl(sg):new Zl;rg?(og=new FileReader,og.onload=function(og){postMessage(qg);tg.parse(og.target.result,pg)},og.readAsText(qg)):(self.xhr=new XMLHttpRequest,self.xhr.open("GET",qg,!0),self.xhr.onreadystatechange=function(){var og=self.xhr.status;if(4==self.xhr.readyState)if(200==og)postMessage(new Blob([self.xhr.responseText],{type:"text/plain"})),
tg.parse(self.xhr.responseText,pg);else{var rg={type:"error",msg:""};switch(og){case 404:rg.msg="File not found, "+qg;break;case 500:rg.msg="Server error";break;case 0:rg.msg="Request aborted, cannot find file "+qg;break;default:rg.msg="Unknown error "+og}postMessage(JSON.stringify(rg))}},self.xhr.send(null))}$l.__deps=[Tl,Zl];
function am(og,pg){this.name="StructureTooLargeError";this.message="Structure is too large";this.stack=Error().stack;this.ia=og;this.fa=pg;this.name=this.name;this.message=this.message;this.stack=this.stack}am.prototype=Object.create(Error.prototype);am.prototype.constructor=am;function bm(){this.name="LoadingCanceledError";this.message="Loading structure canceled";this.stack=Error().stack;this.name=this.name;this.message=this.message;this.stack=this.stack}bm.prototype=Object.create(Error.prototype);
bm.prototype.constructor=bm;function cm(og,pg,qg){var rg=3<arguments.length&&void 0!==arguments[3]?arguments[3]:Infinity,sg=4<arguments.length&&void 0!==arguments[4]?arguments[4]:!1;this.ia=null;this.Xg=pg;this.VA=og;this.UA=qg;this.My=sg;this.EA=rg;this.hh=Jj.Xq($l);this.reject=this.blob=null}
cm.prototype.vu=function(og,pg,qg){if(og.data instanceof Blob)this.blob=og.data;else{var rg=JSON.parse(og.data);rg.Vy?(rg.__proto__=Sl.prototype,this.ia=rg,this.ia.blob=this.blob):"error"===rg.type?qg(Error(rg.msg)):(null!=og.Kk&&this.ia.xe(og.Kk),rg[0].length>this.EA&&!window.confirm("Structure is too large and may result in freezing your app.\nDo you want to continue loading ?")?(this.hh.terminate(),qg(new am(this.ia,rg))):(this.ia.Dw(rg),this.hh.terminate(),pg(this.ia)))}};
cm.prototype.load=function(){var og=this;return new Promise(function(pg,qg){og.reject=qg;og.hh.onmessage=function(rg){rg.Kk=og.UA;og.vu(rg,pg,qg)};og.hh.postMessage([og.VA,og.Xg,og.My])})};cm.prototype.abort=function(){this.hh.terminate();this.hh=null;this.reject(new bm)};
function dm(){this.ga=new Ph;var og=$("#content").width()/$("#content").height();this.camera=new THREE.PerspectiveCamera(45,og,5,1E3);this.Ib=this.u=new Dl(this);this.je=null;this.domElement=this.u.renderer.domElement;this.effect=null;this.Hh=this.eh=!1;this.bh=this.jj=null;this.rl=!1;this.Lo=Infinity;this.Nq=!1}xg=dm.prototype;xg.Zm=function(og){Xk.ba().Zm(og)};
xg.re=function(og,pg){if(void 0===og)throw Error("Structure's identifier to load is undefined");var qg;-1!=og.indexOf("/")?qg=og:(qg=Xk.ba().Vo.slice().replace("${id}",og),qg=qg.replace("${divided}",og.substring(1,2)));var rg=new cm(qg,Xk.ba().Xg,pg,this.Lo);Xk.ba().Oc("Downloading "+og,!0,function(){rg.abort();Xk.ba().Oc("Canceled loading structure")});return rg.load().then(function(og){Xk.ba().Oc();return og})["catch"](function(og){Xk.ba().Oc(og.message);return Promise.reject(og)})};
xg.ql=function(og,pg){var qg=new cm(og,Xk.ba().Xg,pg,this.Lo,!0);Xk.ba().Oc("Parsing...",!0,function(){qg.hh.terminate();Xk.ba().Oc("Canceled parsing structure")});return qg.load().then(function(og){Xk.ba().Oc();return og})["catch"](function(og){Xk.ba().Oc(og.message);return Promise.reject(og)})};
xg.Em=function(og){var pg=this;Xk.ba().Oc("Loading 3D Objects",!0);var qg=null;null!=og&&(qg=new em(og),Xk.ba().Oc());this.u.sv(qg);return(new Promise(function(og,sg){Xk.ba().Oc();pg.Nq?qg.Ea().Zu().then(function(){og(qg)})["catch"](function(){sg()}):og(qg)})).then(function(og){Xk.ba().Zs(qg.ia._id);Xk.ba().fi();pg.gh();return og})["catch"](function(og){Xk.ba().Zs(null);return og})};
xg.gh=function(){var og=1.5*this.u.wb(!0).length();0===og&&(og=1E3);this.camera.far=og;Jh.Do(og/5E3);this.camera.fov=vi.sr(this.u,this.camera);this.camera.updateProjectionMatrix();this.u.cn(0,100);this.u.xq(this.ga.Uq,100)};xg.so=function(og){var pg=this;og.traverse(function(og){og===pg.je&&(pg.je=null);og===pg.Ib&&(pg.Ib=pg.u)});var qg=this.u.sa.indexOf(og);0<=qg&&this.u.sa.splice(qg,1);this.u.Jw(og);og["delete"]();this.gh();this.u.Nc=!0;Xk.ba().fi()};
xg.translate=function(og,pg,qg){this.Ib.updateMatrixWorld(!0);og=new THREE.Vector3(og,pg,qg);this.Ib===this.u?(og=(new THREE.Matrix4).setPosition(og),og=og.multiply(this.Ib.matrixWorld),this.Ib.matrix.copy(og)):(pg=new THREE.Matrix4,pg.copy(this.Ib.matrixWorld),qg=new THREE.Matrix4,qg.getInverse(pg),pg=qg.ks(og),og=new THREE.Matrix4,og.makeTranslation(pg.x,pg.y,pg.z),pg=new THREE.Matrix4,pg.copy(this.Ib.matrix),pg.multiply(og),this.Ib.matrix.copy(pg));this.Ib.matrixWorldNeedsUpdate=!0};
xg.rotate=function(og,pg,qg){var rg=this.Ib||this.u,sg=rg;null!=this.je&&null!=this.je.parent&&(sg=this.je);rg.updateMatrixWorld(!0);var tg=new THREE.Matrix4;tg.copy(rg.matrixWorld);var ug=new THREE.Matrix4;ug.getInverse(tg);og=vi.ay(rg,og,pg,qg);ug=vi.qx(sg,ug);sg=new THREE.Matrix4;sg=sg.multiply(ug[0]).multiply(og).multiply(ug[1]);ug=new THREE.Matrix4;rg.matrix.copy((null!==rg.matrix?rg.matrix:ug).multiply(sg));rg.matrixWorldNeedsUpdate=!0};
xg.kd=function(og,pg,qg){og=og||this.u.Lq;pg=vi.yn(og,this.u,pg,qg);this.u.matrix.copy(pg);this.u.matrixWorldNeedsUpdate=!0;this.u.zc(og)};xg.Vl=function(og){null!==this.bh&&this.Xj();void 0==og&&(og=.1);this.bh=new hl(this.u,og);this.u.$j.Wc(this.bh)};xg.Xj=function(){this.bh&&(this.bh.stop(),this.bh=null)};xg.Eh=function(og){(this.eh=og)&&this.Hh&&(this.Hh=!1);this.u.Nc=!0;return this.Hh};xg.Dh=function(og){(this.Hh=og)&&this.eh&&(this.eh=!1);this.u.Nc=!0;return this.eh};
xg.tb=function(og){for(var pg in this.u.sa)if(this.u.sa[pg].af()===og)return this.u.sa[pg]};xg.rj=function(og){og=this.tb(og);return null==og?null:[og.Ea()]};
xg.Tf=function(og,pg,qg){var rg=[];if(void 0===pg)for(var sg=0;sg<this.u.sa.length;sg++)this.u.sa[sg].af().toUpperCase()===og.toUpperCase()&&(rg=rg.concat(this.u.sa[sg].Ea().cc()));else if(void 0===qg)for(sg=0;sg<this.u.sa.length;sg++){if(this.u.sa[sg].af().toUpperCase()===og.toUpperCase())for(var tg=this.u.sa[sg].Ea().cc(),ug=0;ug<tg.length;ug++)pg.toUpperCase()!==tg[ug].pa.ja.name.toUpperCase()&&pg.toUpperCase()!==tg[ug].pa.ja.es.toUpperCase()||rg.push(tg[ug])}else for(sg=0;sg<this.u.sa.length;sg++)if(this.u.sa[sg].af().toUpperCase()===
og.toUpperCase())for(tg=this.u.sa[sg].Ea().cc(),ug=0;ug<tg.length;ug++)if(qg.toUpperCase()===tg[ug].pa.id.toUpperCase()&&(pg.toUpperCase()===tg[ug].pa.ja.name.toUpperCase()||pg.toUpperCase()===tg[ug].pa.ja.es.toUpperCase()))return[tg[ug]];return rg};xg.ic=function(og,pg,qg,rg,sg){og=this.Tf(og,pg,qg)[0];if(null!==og)for(pg=og.pa.ka,qg=0;qg<pg.length;qg++){var tg=pg[qg];if(tg.dl()==rg||tg.dl()==parseInt(rg))return[og.ic(tg,sg)]}return null};
xg.le=function(og,pg,qg,rg,sg,tg){og=this.Tf(og,pg,qg)[0];if(null!==og){pg=og.pa.Qa();qg=!0;var ug=!1,yg=void 0;try{for(var Bg=pg[Symbol.iterator](),Cg;!(qg=(Cg=Bg.next()).done);qg=!0){var Ag=Cg.value;if(!(Ag.id!==rg&&parseInt(Ag.id)!==rg||null!=sg&&Ag.Le!==sg)){var wg=og.ic(Ag.wa(),tg);if(null!==wg&&void 0!==wg)return[wg.le(Ag,tg)]}}}catch(Dg){ug=!0,yg=Dg}finally{try{!qg&&Bg["return"]&&Bg["return"]()}finally{if(ug)throw yg;}}}return null};xg.Gs=function(og,pg){pg&&0<pg?this.u.Pg(og,pg):this.ga.Pg(og)};
xg.capture=function(og){this.jj=new THREE.Matrix4;this.jj.copy(og.matrix);var pg;pg="["+this.jj.elements[0];for(var qg=this.jj.elements.length,rg=1;rg<qg;rg++)pg+=","+this.jj.elements[rg];console.log(og+" : "+(pg+"]"))};function fm(og,pg){this.name="display";this.text=og.normalize("NFC");this.position=null==pg?void 0:pg.get("location");this.size=null==pg?void 0:pg.get("size");this.color=null==pg?void 0:pg.get("color");this.duration=null==pg?void 0:pg.get("duration")}fm.prototype=Object.create(yl.prototype);
fm.prototype.constructor=fm;fm.prototype.sb=function(og){og.u.Ol(this.text,this.position,this.size,this.color,this.duration)};function gm(og,pg){this.name="load";this.Gn=og;this.Kk=pg}gm.prototype=Object.create(yl.prototype);gm.prototype.constructor=gm;gm.prototype.sb=function(){biovizAPI.re(this.Gn,this.Kk)};function hm(og){this.Gn=og}hm.prototype=Object.create(yl.prototype);hm.prototype.constructor=hm;hm.prototype.sb=function(og){var pg=og.rj(this.Gn);void 0!==pg&&void 0!==pg[0].remove&&og.so(pg[0])};
function im(og,pg,qg){this.fB=og;this.value=pg;this.duration=null==qg?void 0:qg.get("duration")}im.prototype=Object.create(yl.prototype);im.prototype.constructor=im;im.st="background";im.Ot="quality";im.prototype.sb=function(og){switch(this.fB){case im.st:og.Gs(new THREE.Color(this.value),this.duration);break;case im.Ot:og.ue.yq(this.value)}};function jm(og,pg,qg){this.target=og;this.zoom=qg;this.duration=pg?pg.get("duration"):0}jm.prototype=Object.create(yl.prototype);jm.prototype.constructor=jm;
jm.prototype.sb=function(og){var pg=this.target.tb(og)[0];void 0!==pg&&(0>=this.duration?(og.kd(pg,this.zoom),og.u.zc(null)):og.u.jv(pg,this.duration,this.zoom))};function km(og,pg){this.target=og;this.show=pg}km.prototype=Object.create(yl.prototype);km.prototype.constructor=km;km.prototype.sb=function(og){var pg=this.target.type==xl.ea.qk?og.u.sa:this.target.cf(og);for(og=0;og<pg.length;og++)this.show?pg[og].show():pg[og].hide()};function lm(og,pg,qg){this.target=og;this.Ma=pg;this.enable=qg}
lm.prototype=Object.create(yl.prototype);lm.prototype.constructor=lm;lm.prototype.sb=function(og){og=this.target.cf(og);for(var pg in og){var qg;qg=og[pg].$n?og[pg].cc():[og[pg]];for(var rg in qg)this.enable?qg[rg].show(this.Ma):qg[rg].hide(this.Ma)}};
lm.prototype.ss=function(og){var pg=this,qg=[Promise.resolve()],rg=this.target.cf(og);og=!0;var sg=!1,tg=void 0;try{for(var ug=rg[Symbol.iterator](),yg;!(og=(yg=ug.next()).done);og=!0){var Bg=yg.value,Cg;Cg=Bg.$n?Bg.cc():[Bg];var rg=!0,Ag=!1,wg=void 0;try{for(var Dg=Cg[Symbol.iterator](),Eg;!(rg=(Eg=Dg.next()).done);rg=!0){var Fg=Eg.value;if(this.enable){var Jg=Fg.show(this.Ma);qg.push(Jg);Jg.then(function(){Fg.hide(pg.Ma)})}}}catch(Ig){Ag=!0,wg=Ig}finally{try{!rg&&Dg["return"]&&Dg["return"]()}finally{if(Ag)throw wg;
}}}}catch(Ig){sg=!0,tg=Ig}finally{try{!og&&ug["return"]&&ug["return"]()}finally{if(sg)throw tg;}}return qg};function mm(og,pg,qg,rg){this.target=og;this.color=pg;this.Qd=qg;this.duration=rg?rg.get("duration"):void 0}mm.prototype=Object.create(yl.prototype);mm.prototype.constructor=mm;
mm.prototype.sb=function(og){var pg=yl.Cn(og,this.target,this.Qd,!1),qg,rg=this.color;void 0!=hi.za.An(this.color)&&(rg=hi.za.An(this.color));for(var sg=0;sg<pg.length;sg++)og.u.animations.Ih(gi,pg[sg]),qg=pg[sg].color(rg,this.duration),null!=qg&&og.u.animations.Wc(qg)};function nm(og,pg,qg){this.target=og;this.matrix=pg;this.duration=qg?qg.get("duration"):0}nm.prototype=Object.create(yl.prototype);nm.prototype.constructor=nm;
nm.prototype.sb=function(og){var pg;if(this.target.type==xl.ea.qk)pg=og.u;else if(this.target.type==xl.ea.Di)pg=this.target.tb(og)[0];else if(this.target.type==xl.ea.yi)pg=this.target.cf(og)[0];else throw"MoveCommand only applies to Scene, Structure and Molecule targets";var qg=new THREE.Matrix4;qg.set(this.matrix[0],this.matrix[4],this.matrix[8],this.matrix[12],this.matrix[1],this.matrix[5],this.matrix[9],this.matrix[13],this.matrix[2],this.matrix[6],this.matrix[10],this.matrix[14],this.matrix[3],
this.matrix[7],this.matrix[11],this.matrix[15]);void 0!==pg&&(og.u.animations.Ih(kl,pg),og.u.gq(pg,qg,this.duration))};function om(){this.Fk=this.Gi=null;this.Eg=NaN}om.km="SRC:";om.fm="DST:";xg=om.prototype;
xg.align=function(og,pg){this.Fk=this.Gi=null;this.Eg=NaN;if(og&&pg)if(og!==pg){this.Gi=this.qu(og,pg);var qg=this.Up(og,this.Gi.Tg(om.km+og.toString())),rg=this.Up(pg,this.Gi.Tg(om.fm+pg.toString())),sg=this.Wu(qg,rg),tg=sg[0],sg=sg[1];if(3>qg.length)console.error("Need at least 3 paired coordinates. Found only "+qg.length);else{sg=numeric.transpose(sg);sg=numeric.dot(sg,tg);tg=numeric.svd(sg);sg=[[1,0,0],[0,1,0],[0,0,Math.sign(numeric.det(sg))]];sg=numeric.dot(numeric.dot(tg.V,sg),numeric.transpose(tg.U));
tg=new THREE.Matrix4;tg.set(sg[0][0],sg[1][0],sg[2][0],0,sg[0][1],sg[1][1],sg[2][1],0,sg[0][2],sg[1][2],sg[2][2],0,0,0,0,1);this.Eg=0;for(var sg=qg.length,ug=0;ug<sg;ug++){var yg=qg[ug],Bg=rg[ug];null!==yg&&null!==Bg&&(yg=yg.clone().applyMatrix4(tg),Bg=Bg.clone(),this.Eg+=yg.distanceToSquared(Bg))}this.Fk=tg;this.Eg=Math.sqrt(this.Eg/qg.length)}}else console.warn("Same src and dst molecule, resolving alignement"),qg=[],qg.push(this.tk(om.km,og)),qg.push(this.tk(om.fm,pg)),this.Gi=new Yg(qg),this.Fk=
new THREE.Matrix4,this.Eg=0;else console.error("Source ("+og+") or dest ("+pg+") is not a polymer")};xg.qu=function(og,pg){var qg=og.Xf()?new Zg:new Zg(Zg.lk.ik),rg=[];rg.push(this.tk(om.km,og));rg.push(this.tk(om.fm,pg));return qg.align(rg)};
xg.Up=function(og,pg){for(var qg=[],rg=og.ka.slice(0),sg=pg.Je,tg=og.xb(),ug=og.Xf()?"CA":"C4'",yg=sg.length,Bg=0;Bg<yg;Bg++)if("-"!=sg.charAt(Bg)){var Cg=rg[pg.Rr(Bg)].md(ug);if(null!==Cg){var Ag=new THREE.Vector3;Ag.subVectors(Cg.pos,tg);qg.push(Ag)}else qg.push(null)}else qg.push(null);return qg};
xg.Wu=function(og,pg){if(null===og||null===pg||og.length!==pg.length)throw"Illegal argument exception";for(var qg=[],rg=[],sg=og.length,tg=0;tg<sg;tg++){var ug=og[tg],yg=pg[tg];null!==ug&&null!==yg&&(qg.push([ug.x,ug.y,ug.z]),rg.push([yg.x,yg.y,yg.z]))}return[qg,rg]};xg.tk=function(og,pg){return new $g((null!==og?og:"")+pg.toString(),pg.Tg(!1))};function pm(og,pg,qg){this.Wp=og;this.zd=pg;this.Qp=qg?qg.get("full"):!1;this.Lp=qg?qg.get("duration"):0}pm.prototype=Object.create(yl.prototype);
pm.prototype.constructor=pm;pm.prototype.sb=function(og){var pg=this.nx(og),qg=this.mr(og);og.u.animations.Ih(kl,qg);0<=this.Lp?(pg=qg.matrix.clone().multiply(pg),og.u.gq(qg,pg,this.Lp)):(qg.matrix.multiply(pg),qg.matrixWorldNeedsUpdate=!0)};
pm.prototype.nx=function(og){var pg=this.Wp.Bb(og)[0],qg=this.zd.Bb(og)[0],rg=new om;rg.align(pg.pa,qg.pa);rg=rg.Fk;if(null!==rg){var sg=this.mr(og).matrixWorld;og=(new THREE.Matrix4).getInverse(sg);var tg=pg.matrixWorld,ug=qg.matrixWorld,sg=(new THREE.Matrix4).extractRotation(sg),yg=(new THREE.Matrix4).extractRotation(ug),Bg=this.Qp?(new THREE.Matrix4).extractRotation((new THREE.Matrix4).getInverse(pg.matrix)):new THREE.Matrix4,pg=pg.pa.xb().clone().applyMatrix4(tg),ug=qg.pa.xb().clone().applyMatrix4(ug),
qg=new THREE.Vector3;qg.setFromMatrixPosition((new THREE.Matrix4).multiply(og).multiply((new THREE.Matrix4).setPosition(pg)));pg=(new THREE.Vector3).subVectors(ug,pg);return(new THREE.Matrix4).multiply((new THREE.Matrix4).setPosition(og.ks(pg))).multiply((new THREE.Matrix4).setPosition(qg)).multiply((new THREE.Matrix4).getInverse(sg)).multiply(yg).multiply(rg).multiply(Bg).multiply((new THREE.Matrix4).setPosition(qg.clone().negate()))}return null};
pm.prototype.mr=function(og){og=this.Wp.Bb(og)[0];return this.Qp?og.Ea():og};function qm(og,pg,qg){this.target=og;this.Qd=pg;this.enable=qg}qm.prototype=Object.create(yl.prototype);qm.prototype.constructor=qm;
qm.prototype.sb=function(og){var pg=this.target.cf(og);switch(this.target.type){case xl.ea.Di:pg=pg[0].cc();for(og=0;og<pg.length;og++)pg[og].yb(this.enable,null,this.Qd);break;case xl.ea.kk:case xl.ea.yi:for(og=0;og<pg.length;og++)pg[og].yb(this.enable,null,this.Qd);break;case xl.ea.pk:og=pg[0];og.yb(this.enable,null,this.Qd);pg=og.Bb();pg.yb(this.enable,og.bc.Qa(),this.Qd);break;case xl.ea.bk:var qg=pg[0];qg.yb(this.enable,null,this.Qd);og=qg.ic();og.yb(this.enable,[qg.Xc],this.Qd);pg=qg.Bb();pg.yb(this.enable,
[qg.Xc],this.Qd)}};function rm(og,pg,qg,rg){ci.call(this);this.bb=0;this.u=og;this.duration=pg;this.mj=qg;this.lj=rg}rm.prototype=Object.create(ci.prototype);rm.prototype.constructor=rm;
rm.prototype.Ke=function(og){null==this.Kn&&(this.Kn=-this.u.ul.constant+this.u.camera.position.z);null==this.Jn&&(this.Jn=this.u.Wk.constant+this.u.camera.position.z);var pg;this.bb+=og;pg=this.bb/this.duration;1<pg&&(pg=1);1===pg?(og=this.mj,pg=this.lj):(og=this.Kn+(this.mj-this.Kn)*pg,pg=this.Jn+(this.lj-this.Jn)*pg);this.u.wq(og,pg)};function Em(og,pg,qg,rg){this.target=og;this.mj=pg;this.lj=qg;this.duration=rg?rg.get("duration"):void 0}Em.prototype=Object.create(yl.prototype);
Em.prototype.constructor=Em;Em.prototype.sb=function(og){if(0<this.duration){var pg=new rm(og.u,this.duration,this.mj,this.lj);og.u.animations.Wc(pg)}else og.u.wq(this.mj,this.lj)};function Fm(og,pg,qg,rg){this.alpha=pg;this.target=og;this.Qd=rg;this.duration=qg?qg.get("duration"):void 0}Fm.prototype=Object.create(yl.prototype);Fm.prototype.constructor=Fm;
Fm.prototype.sb=function(og){for(var pg=yl.Cn(og,this.target,this.Qd,!1),qg=0;qg<pg.length;qg++){og.u.animations.Ih(ei,pg[qg]);var rg=pg[qg].jg(this.alpha,this.duration);null!=rg&&og.u.animations.Wc(rg)}};function Gm(){}Gm.prototype=Object.create(yl.prototype);Gm.prototype.constructor=Gm;Gm.prototype.sb=function(og){og.u.reset()};function Hm(og,pg,qg){this.YA=og;this.ZA=pg;this.duration=qg?qg.get("duration"):void 0}Hm.prototype=Object.create(yl.prototype);Hm.prototype.constructor=Hm;
Hm.prototype.sb=function(og){og.u.mi();og.u.Vm(this.YA.le(og)[0].la);var pg=og.u.Vm(this.ZA.le(og)[0].la);og.u.uf();0<this.duration&&(pg=new Im(og.u,pg,this.duration),og.u.animations.Wc(pg))};function Im(og,pg,qg){ci.call(this);this.items=pg;this.scene=og;this.duration=qg}Im.prototype=Object.create(ci.prototype);Im.prototype.constructor=Im;Im.prototype.Ke=function(og){this.bb+=og;og=this.bb/this.duration;1<og&&(og=1);1===og&&this.scene.Jh(this.items)};
var Jm=function(){function og(pg,qg,rg,sg){this.message=pg;this.location=sg;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,og)}(function(og,qg){function pg(){this.constructor=og}pg.prototype=qg.prototype;og.prototype=new pg})(og,Error);return{SyntaxError:og,parse:function(pg){function qg(og){switch(og){case "\\n":return"\n";case "\\r":return"\r";case "\\t":return"\t";case "\\r\\n":return"\r\n";default:return og[1]}}function rg(og){var qg=yj[og],rg,
sg;if(!qg){for(rg=og-1;!yj[rg];)rg--;qg=yj[rg];for(qg={line:qg.line,Pe:qg.Pe,gi:qg.gi};rg<og;)sg=pg.charAt(rg),"\n"===sg?(qg.gi||qg.line++,qg.Pe=1,qg.gi=!1):"\r"===sg||"\u2028"===sg||"\u2029"===sg?(qg.line++,qg.Pe=1,qg.gi=!0):(qg.Pe++,qg.gi=!1),rg++;yj[og]=qg}return qg}function sg(og,pg){var qg=rg(og),sg=rg(pg);return{start:{offset:og,line:qg.line,Pe:qg.Pe},end:{offset:pg,line:sg.line,Pe:sg.Pe}}}function tg(og){zg<Sh||(zg>Sh&&(Sh=zg,Mj=[]),Mj.push(og))}function ug(){var og,pg,qg,rg;og=zg;pg=[];for(qg=
yg();qg!==vg;)pg.push(qg),qg=yg();if(pg!==vg){qg=[];for(pg=Pm();pg!==vg;)qg.push(pg),pg=Pm();if(qg!==vg){pg=[];for(rg=yg();rg!==vg;)pg.push(rg),rg=yg();if(pg!==vg){og=qg;qg=[];for(var sg in og)qg.push(og[sg]);og=qg}else zg=og,og=vg}else zg=og,og=vg}else zg=og,og=vg;if(og===vg)for(og=[],pg=yg();pg!==vg;)og.push(pg),pg=yg();return og}function yg(){var og;32===pg.charCodeAt(zg)?(og=Qm,zg++):(og=vg,0===Gg&&tg(Rm));og===vg&&(9===pg.charCodeAt(zg)?(og=Co,zg++):(og=vg,0===Gg&&tg(Do)));return og}function Bg(){var og;
10===pg.charCodeAt(zg)?(og=Eo,zg++):(og=vg,0===Gg&&tg(Fo));og===vg&&(13===pg.charCodeAt(zg)?(og=Go,zg++):(og=vg,0===Gg&&tg(Ho)),og===vg&&(pg.substr(zg,2)===Sm?(og=Sm,zg+=2):(og=vg,0===Gg&&tg(Io))));return og}function Cg(){var og;Tm.test(pg.charAt(zg))?(og=pg.charAt(zg),zg++):(og=vg,0===Gg&&tg(Um));return og}function Ag(){var og;Jo.test(pg.charAt(zg))?(og=pg.charAt(zg),zg++):(og=vg,0===Gg&&tg(Ko));return og}function wg(){var og,qg,rg;og=zg;Lo.test(pg.charAt(zg))?(qg=pg.charAt(zg),zg++):(qg=vg,0===
Gg&&tg(Mo));qg!==vg?(rg=Kg(),rg!==vg?og=qg=[qg,rg]:(zg=og,og=vg)):(zg=og,og=vg);return og}function Dg(){var og;32===pg.charCodeAt(zg)?(og=Qm,zg++):(og=vg,0===Gg&&tg(Rm));og===vg&&(33===pg.charCodeAt(zg)?(og=No,zg++):(og=vg,0===Gg&&tg(Oo)),og===vg&&(35===pg.charCodeAt(zg)?(og=Vm,zg++):(og=vg,0===Gg&&tg(Wm)),og===vg&&(36===pg.charCodeAt(zg)?(og=Po,zg++):(og=vg,0===Gg&&tg(Qo)),og===vg&&(37===pg.charCodeAt(zg)?(og=Xm,zg++):(og=vg,0===Gg&&tg(Ym)),og===vg&&(38===pg.charCodeAt(zg)?(og=Ro,zg++):(og=vg,0===
Gg&&tg(So)),og===vg&&(40===pg.charCodeAt(zg)?(og=Zm,zg++):(og=vg,0===Gg&&tg($m)),og===vg&&(41===pg.charCodeAt(zg)?(og=Nj,zg++):(og=vg,0===Gg&&tg(Oj)),og===vg&&(42===pg.charCodeAt(zg)?(og=To,zg++):(og=vg,0===Gg&&tg(Uo)),og===vg&&(43===pg.charCodeAt(zg)?(og=Pj,zg++):(og=vg,0===Gg&&tg(Qj)),og===vg&&(44===pg.charCodeAt(zg)?(og=an,zg++):(og=vg,0===Gg&&tg(bn)),og===vg&&(45===pg.charCodeAt(zg)?(og=Rj,zg++):(og=vg,0===Gg&&tg(Sj)),og===vg&&(46===pg.charCodeAt(zg)?(og=cn,zg++):(og=vg,0===Gg&&tg(dn)),og===vg&&
(47===pg.charCodeAt(zg)?(og=en,zg++):(og=vg,0===Gg&&tg(gn)),og===vg&&(Tm.test(pg.charAt(zg))?(og=pg.charAt(zg),zg++):(og=vg,0===Gg&&tg(Um)),og===vg&&(58===pg.charCodeAt(zg)?(og=Gh,zg++):(og=vg,0===Gg&&tg(oh)),og===vg&&(59===pg.charCodeAt(zg)?(og=hn,zg++):(og=vg,0===Gg&&tg(jn)),og===vg&&(60===pg.charCodeAt(zg)?(og=Vo,zg++):(og=vg,0===Gg&&tg(Wo)),og===vg&&(61===pg.charCodeAt(zg)?(og=Tj,zg++):(og=vg,0===Gg&&tg(Uj)),og===vg&&(62===pg.charCodeAt(zg)?(og=Xo,zg++):(og=vg,0===Gg&&tg(Yo)),og===vg&&(63===pg.charCodeAt(zg)?
(og=Zo,zg++):(og=vg,0===Gg&&tg($o)),og===vg&&(64===pg.charCodeAt(zg)?(og=ap,zg++):(og=vg,0===Gg&&tg(bp)),og===vg&&(cp.test(pg.charAt(zg))?(og=pg.charAt(zg),zg++):(og=vg,0===Gg&&tg(dp)),og===vg&&(91===pg.charCodeAt(zg)?(og=kn,zg++):(og=vg,0===Gg&&tg(ln)),og===vg&&(93===pg.charCodeAt(zg)?(og=mn,zg++):(og=vg,0===Gg&&tg(nn)),og===vg&&(94===pg.charCodeAt(zg)?(og=ep,zg++):(og=vg,0===Gg&&tg(fp)),og===vg&&(95===pg.charCodeAt(zg)?(og=gp,zg++):(og=vg,0===Gg&&tg(hp)),og===vg&&(96===pg.charCodeAt(zg)?(og=ip,
zg++):(og=vg,0===Gg&&tg(jp)),og===vg&&(kp.test(pg.charAt(zg))?(og=pg.charAt(zg),zg++):(og=vg,0===Gg&&tg(lp)),og===vg&&(123===pg.charCodeAt(zg)?(og=mp,zg++):(og=vg,0===Gg&&tg(np)),og===vg&&(47===pg.charCodeAt(zg)?(og=en,zg++):(og=vg,0===Gg&&tg(gn)),og===vg&&(125===pg.charCodeAt(zg)?(og=op,zg++):(og=vg,0===Gg&&tg(pp)),og===vg&&(39===pg.charCodeAt(zg)?(og=Vj,zg++):(og=vg,0===Gg&&tg(Wj)),og===vg&&(126===pg.charCodeAt(zg)?(og=qp,zg++):(og=vg,0===Gg&&tg(rp)))))))))))))))))))))))))))))))))));return og}function Eg(){var og,
qg,rg,sg,ug,wg,yg;og=zg;pg.substr(zg,2)===on?(qg=on,zg+=2):(qg=vg,0===Gg&&tg(sp));qg!==vg?(rg=qg=zg,sg=Ag(),sg!==vg?(ug=Ag(),ug!==vg?(wg=Ag(),wg!==vg?(yg=Ag(),yg!==vg?rg=sg=[sg,ug,wg,yg]:(zg=rg,rg=vg)):(zg=rg,rg=vg)):(zg=rg,rg=vg)):(zg=rg,rg=vg),qg=rg!==vg?pg.substring(qg,zg):rg,qg!==vg?og=qg=String.fromCharCode(parseInt(qg,16)):(zg=og,og=vg)):(zg=og,og=vg);return og}function Fg(){var og,rg,sg;pg.substr(zg,2)===pn?(og=pn,zg+=2):(og=vg,0===Gg&&tg(tp));og===vg&&(pg.substr(zg,2)===qn?(og=qn,zg+=2):(og=
vg,0===Gg&&tg(up)),og===vg&&(pg.substr(zg,2)===rn?(og=rn,zg+=2):(og=vg,0===Gg&&tg(vp)),og===vg&&(pg.substr(zg,4)===sn?(og=sn,zg+=4):(og=vg,0===Gg&&tg(wp)),og===vg&&(og=zg,92===pg.charCodeAt(zg)?(rg=xp,zg++):(rg=vg,0===Gg&&tg(yp)),rg!==vg?(pg.length>zg?(sg=pg.charAt(zg),zg++):(sg=vg,0===Gg&&tg(zp)),sg!==vg?og=rg=[rg,sg]:(zg=og,og=vg)):(zg=og,og=vg)))));og!==vg&&(og=qg(og));return og}function Jg(){var og;44===pg.charCodeAt(zg)?(og=an,zg++):(og=vg,0===Gg&&tg(bn));return og}function Ig(){var og,pg,qg,
rg,sg;og=zg;pg=[];for(qg=yg();qg!==vg;)pg.push(qg),qg=yg();if(pg!==vg)if(qg=Jg(),qg!==vg){rg=[];for(sg=yg();sg!==vg;)rg.push(sg),sg=yg();rg!==vg?og=pg=[pg,qg,rg]:(zg=og,og=vg)}else zg=og,og=vg;else zg=og,og=vg;return og}function Lg(){var og,pg;og=[];pg=Cg();if(pg!==vg)for(;pg!==vg;)og.push(pg),pg=Cg();else og=vg;og!==vg&&(og=parseInt(og.join(""),10));return og}function Kg(){var og,qg,rg;og=zg;43===pg.charCodeAt(zg)?(qg=Pj,zg++):(qg=vg,0===Gg&&tg(Qj));qg===vg&&(45===pg.charCodeAt(zg)?(qg=Rj,zg++):
(qg=vg,0===Gg&&tg(Sj)));qg===vg&&(qg=null);qg!==vg?(rg=Lg(),rg!==vg?og=qg=parseInt(qg+rg,10):(zg=og,og=vg)):(zg=og,og=vg);return og}function Mg(){var og,qg,rg,sg,ug,yg,Ag;og=zg;qg=Kg();qg!==vg?(rg=wg(),rg!==vg?og=qg=parseFloat(qg+rg.join("")):(zg=og,og=vg)):(zg=og,og=vg);if(og===vg)if(og=zg,43===pg.charCodeAt(zg)?(qg=Pj,zg++):(qg=vg,0===Gg&&tg(Qj)),qg===vg&&(45===pg.charCodeAt(zg)?(qg=Rj,zg++):(qg=vg,0===Gg&&tg(Sj))),qg===vg&&(qg=null),qg!==vg){rg=[];for(sg=Cg();sg!==vg;)rg.push(sg),sg=Cg();rg!==
vg?(ug=sg=zg,46===pg.charCodeAt(zg)?(yg=cn,zg++):(yg=vg,0===Gg&&tg(dn)),yg!==vg?(Ag=Lg(),Ag!==vg?ug=yg=[yg,Ag]:(zg=ug,ug=vg)):(zg=ug,ug=vg),ug===vg&&(ug=null),sg=ug!==vg?pg.substring(sg,zg):ug,sg!==vg?(ug=wg(),ug===vg&&(ug=null),ug!==vg?og=qg=parseFloat((qg?qg:"")+(rg?rg.join(""):"")+(sg?sg:"")+(ug?ug.join(""):"")):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)}else zg=og,og=vg;return og}function Og(){var og;og=Mg();og===vg&&(og=Kg());return og}function Sg(){var og,qg,rg,sg,ug,wg,Ag,Bg,Cg,Dg,Eg,Fg,Lg,
Kg,Jg,Mg,Qg,Sg,dh;og=zg;91===pg.charCodeAt(zg)?(qg=kn,zg++):(qg=vg,0===Gg&&tg(ln));if(qg!==vg){rg=[];for(qg=yg();qg!==vg;)rg.push(qg),qg=yg();if(rg!==vg)if(qg=Og(),qg!==vg)if(rg=Ig(),rg!==vg)if(rg=Og(),rg!==vg)if(sg=Ig(),sg!==vg)if(sg=Og(),sg!==vg)if(ug=Ig(),ug!==vg)if(ug=Og(),ug!==vg)if(wg=Ig(),wg!==vg)if(wg=Og(),wg!==vg)if(Ag=Ig(),Ag!==vg)if(Ag=Og(),Ag!==vg)if(Bg=Ig(),Bg!==vg)if(Bg=Og(),Bg!==vg)if(Cg=Ig(),Cg!==vg)if(Cg=Og(),Cg!==vg)if(Dg=Ig(),Dg!==vg)if(Dg=Og(),Dg!==vg)if(Eg=Ig(),Eg!==vg)if(Eg=
Og(),Eg!==vg)if(Fg=Ig(),Fg!==vg)if(Fg=Og(),Fg!==vg)if(Lg=Ig(),Lg!==vg)if(Lg=Og(),Lg!==vg)if(Kg=Ig(),Kg!==vg)if(Kg=Og(),Kg!==vg)if(Jg=Ig(),Jg!==vg)if(Jg=Og(),Jg!==vg)if(Mg=Ig(),Mg!==vg)if(Mg=Og(),Mg!==vg)if(Qg=Ig(),Qg!==vg)if(Qg=Og(),Qg!==vg){Sg=[];for(dh=yg();dh!==vg;)Sg.push(dh),dh=yg();Sg!==vg?(93===pg.charCodeAt(zg)?(dh=mn,zg++):(dh=vg,0===Gg&&tg(nn)),dh!==vg?og=qg=[qg,rg,sg,ug,wg,Ag,Bg,Cg,Dg,Eg,Fg,Lg,Kg,Jg,Mg,Qg]:(zg=og,og=vg)):(zg=og,og=vg)}else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;
else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg}else zg=
og,og=vg;return og}function Qg(){var og,qg;og=[];tn.test(pg.charAt(zg))?(qg=pg.charAt(zg),zg++):(qg=vg,0===Gg&&tg(un));if(qg!==vg)for(;qg!==vg;)og.push(qg),tn.test(pg.charAt(zg))?(qg=pg.charAt(zg),zg++):(qg=vg,0===Gg&&tg(un));else og=vg;og!==vg&&(og=og.join(""));return og}function vh(){var og,qg,rg;og=zg;39===pg.charCodeAt(zg)?(qg=Vj,zg++):(qg=vg,0===Gg&&tg(Wj));if(qg!==vg){qg=[];rg=Eg();rg===vg&&(rg=Fg(),rg===vg&&(rg=Dg()));for(;rg!==vg;)qg.push(rg),rg=Eg(),rg===vg&&(rg=Fg(),rg===vg&&(rg=Dg()));
qg!==vg?(39===pg.charCodeAt(zg)?(rg=Vj,zg++):(rg=vg,0===Gg&&tg(Wj)),rg!==vg?og=qg=qg.join(""):(zg=og,og=vg)):(zg=og,og=vg)}else zg=og,og=vg;if(og===vg)if(og=zg,34===pg.charCodeAt(zg)?(qg=vn,zg++):(qg=vg,0===Gg&&tg(wn)),qg!==vg){qg=[];rg=Eg();rg===vg&&(rg=Fg(),rg===vg&&(rg=Dg()));for(;rg!==vg;)qg.push(rg),rg=Eg(),rg===vg&&(rg=Fg(),rg===vg&&(rg=Dg()));qg!==vg?(34===pg.charCodeAt(zg)?(rg=vn,zg++):(rg=vg,0===Gg&&tg(wn)),rg!==vg?og=qg=qg.join(""):(zg=og,og=vg)):(zg=og,og=vg)}else zg=og,og=vg;return og}
function dh(){var og,qg,rg,sg,ug,wg;qg=zg;var Bg,Cg,Dg;og=zg;35===pg.charCodeAt(zg)?(rg=Vm,zg++):(rg=vg,0===Gg&&tg(Wm));rg===vg&&(pg.substr(zg,2)===xn?(rg=xn,zg+=2):(rg=vg,0===Gg&&tg(Ap)));rg!==vg?(sg=Ag(),sg!==vg?(ug=Ag(),ug!==vg?(wg=Ag(),wg!==vg?(Bg=Ag(),Bg!==vg?(Cg=Ag(),Cg!==vg?(Dg=Ag(),Dg!==vg?og=rg=[rg,sg,ug,wg,Bg,Cg,Dg]:(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg);rg=og;og=qg=rg!==vg?pg.substring(qg,zg):rg;if(og===vg)if(og=zg,pg.substr(zg,
4)===yn?(qg=yn,zg+=4):(qg=vg,0===Gg&&tg(Bp)),qg!==vg){rg=[];for(qg=yg();qg!==vg;)rg.push(qg),qg=yg();if(rg!==vg)if(qg=Og(),qg!==vg)if(rg=Ig(),rg!==vg)if(rg=Og(),rg!==vg)if(sg=Ig(),sg!==vg)if(sg=Og(),sg!==vg){ug=[];for(wg=yg();wg!==vg;)ug.push(wg),wg=yg();ug!==vg?(41===pg.charCodeAt(zg)?(wg=Nj,zg++):(wg=vg,0===Gg&&tg(Oj)),wg!==vg?og=qg="#"+("0"+qg.toString(16)).slice(-2)+("0"+rg.toString(16)).slice(-2)+("0"+sg.toString(16)).slice(-2):(zg=og,og=vg)):(zg=og,og=vg)}else zg=og,og=vg;else zg=og,og=vg;else zg=
og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg}else zg=og,og=vg;return og}function di(){var og;og=dh();og===vg&&(og=Qg());return og}function Fh(){var og,qg;og=zg;var rg,sg,ug,wg;qg=zg;84===pg.charCodeAt(zg)?(rg=ki,zg++):(rg=vg,0===Gg&&tg(zj));rg===vg&&(116===pg.charCodeAt(zg)?(rg=li,zg++):(rg=vg,0===Gg&&tg(Oi)));rg!==vg?(82===pg.charCodeAt(zg)?(sg=Xj,zg++):(sg=vg,0===Gg&&tg(Yj)),sg===vg&&(114===pg.charCodeAt(zg)?(sg=Zj,zg++):(sg=vg,0===Gg&&tg(ak))),sg!==vg?(85===pg.charCodeAt(zg)?(ug=
Cp,zg++):(ug=vg,0===Gg&&tg(Dp)),ug===vg&&(117===pg.charCodeAt(zg)?(ug=Ep,zg++):(ug=vg,0===Gg&&tg(Fp))),ug!==vg?(69===pg.charCodeAt(zg)?(wg=Kh,zg++):(wg=vg,0===Gg&&tg(fi)),wg===vg&&(101===pg.charCodeAt(zg)?(wg=mi,zg++):(wg=vg,0===Gg&&tg(Lh))),wg!==vg?qg=rg=[rg,sg,ug,wg]:(zg=qg,qg=vg)):(zg=qg,qg=vg)):(zg=qg,qg=vg)):(zg=qg,qg=vg);qg===vg&&(qg=zg,79===pg.charCodeAt(zg)?(rg=zi,zg++):(rg=vg,0===Gg&&tg(Pi)),rg===vg&&(111===pg.charCodeAt(zg)?(rg=Qi,zg++):(rg=vg,0===Gg&&tg(Ri))),rg!==vg?(78===pg.charCodeAt(zg)?
(sg=Mh,zg++):(sg=vg,0===Gg&&tg(ni)),sg===vg&&(110===pg.charCodeAt(zg)?(sg=Nh,zg++):(sg=vg,0===Gg&&tg(oi))),sg!==vg?qg=rg=[rg,sg]:(zg=qg,qg=vg)):(zg=qg,qg=vg));if(qg===vg){var yg;qg=zg;70===pg.charCodeAt(zg)?(rg=sm,zg++):(rg=vg,0===Gg&&tg(tm));rg===vg&&(102===pg.charCodeAt(zg)?(rg=um,zg++):(rg=vg,0===Gg&&tg(vm)));rg!==vg?(65===pg.charCodeAt(zg)?(sg=Ai,zg++):(sg=vg,0===Gg&&tg(Si)),sg===vg&&(97===pg.charCodeAt(zg)?(sg=Ti,zg++):(sg=vg,0===Gg&&tg(Ui))),sg!==vg?(76===pg.charCodeAt(zg)?(ug=pi,zg++):(ug=
vg,0===Gg&&tg(Bi)),ug===vg&&(108===pg.charCodeAt(zg)?(ug=Vi,zg++):(ug=vg,0===Gg&&tg(Wi))),ug!==vg?(83===pg.charCodeAt(zg)?(wg=wm,zg++):(wg=vg,0===Gg&&tg(xm)),wg===vg&&(115===pg.charCodeAt(zg)?(wg=ym,zg++):(wg=vg,0===Gg&&tg(zm))),wg!==vg?(69===pg.charCodeAt(zg)?(yg=Kh,zg++):(yg=vg,0===Gg&&tg(fi)),yg===vg&&(101===pg.charCodeAt(zg)?(yg=mi,zg++):(yg=vg,0===Gg&&tg(Lh))),yg!==vg?qg=rg=[rg,sg,ug,wg,yg]:(zg=qg,qg=vg)):(zg=qg,qg=vg)):(zg=qg,qg=vg)):(zg=qg,qg=vg)):(zg=qg,qg=vg);qg===vg&&(qg=zg,79===pg.charCodeAt(zg)?
(rg=zi,zg++):(rg=vg,0===Gg&&tg(Pi)),rg===vg&&(111===pg.charCodeAt(zg)?(rg=Qi,zg++):(rg=vg,0===Gg&&tg(Ri))),rg!==vg?(70===pg.charCodeAt(zg)?(sg=sm,zg++):(sg=vg,0===Gg&&tg(tm)),sg===vg&&(102===pg.charCodeAt(zg)?(sg=um,zg++):(sg=vg,0===Gg&&tg(vm))),sg!==vg?(70===pg.charCodeAt(zg)?(ug=sm,zg++):(ug=vg,0===Gg&&tg(tm)),ug===vg&&(102===pg.charCodeAt(zg)?(ug=um,zg++):(ug=vg,0===Gg&&tg(vm))),ug!==vg?qg=rg=[rg,sg,ug]:(zg=qg,qg=vg)):(zg=qg,qg=vg)):(zg=qg,qg=vg))}og=qg!==vg?pg.substring(og,zg):qg;og!==vg&&(og=
"true"===og.toLowerCase()||"on"===og.toLowerCase());return og}function xh(){var og;og=Qg();if(og===vg&&(og=dh(),og===vg)){var qg,rg;og=zg;qg=Og();qg!==vg?(37===pg.charCodeAt(zg)?(rg=Xm,zg++):(rg=vg,0===Gg&&tg(Ym)),rg!==vg?og=qg=[qg,rg]:(zg=og,og=vg)):(zg=og,og=vg);og!==vg&&(og=og.join(""));og===vg&&(og=Og(),og===vg&&(og=Oh(),og===vg&&(og=Sg(),og===vg&&(og=vh(),og===vg&&(og=Fh())))))}return og}function wh(){var og,qg,rg,sg;og=zg;40===pg.charCodeAt(zg)?(qg=Zm,zg++):(qg=vg,0===Gg&&tg($m));if(qg!==vg){var ug,
wg;qg=zg;rg=Qg();if(rg!==vg){sg=[];for(ug=yg();ug!==vg;)sg.push(ug),ug=yg();if(sg!==vg)if(61===pg.charCodeAt(zg)?(ug=Tj,zg++):(ug=vg,0===Gg&&tg(Uj)),ug!==vg){ug=[];for(sg=yg();sg!==vg;)ug.push(sg),sg=yg();if(ug!==vg)if(sg=xh(),sg!==vg){ug=[];for(wg=yg();wg!==vg;)ug.push(wg),wg=yg();ug!==vg?qg=rg=[rg,sg]:(zg=qg,qg=vg)}else zg=qg,qg=vg;else zg=qg,qg=vg}else zg=qg,qg=vg;else zg=qg,qg=vg}else zg=qg,qg=vg;rg=qg;if(rg!==vg){qg=[];for(sg=eh();sg!==vg;)qg.push(sg),sg=eh();if(qg!==vg)if(41===pg.charCodeAt(zg)?
(sg=Nj,zg++):(sg=vg,0===Gg&&tg(Oj)),sg!==vg){og=new Map;og.set(rg[0],rg[1]);for(var Ag in qg)rg=qg[Ag],og.set(rg[0],rg[1])}else zg=og,og=vg;else zg=og,og=vg}else zg=og,og=vg}else zg=og,og=vg;return og}function eh(){var og,qg,rg,sg,ug;og=zg;qg=[];for(rg=yg();rg!==vg;)qg.push(rg),rg=yg();if(qg!==vg)if(rg=Jg(),rg!==vg){rg=[];for(qg=yg();qg!==vg;)rg.push(qg),qg=yg();if(rg!==vg)if(qg=Qg(),qg!==vg){rg=[];for(sg=yg();sg!==vg;)rg.push(sg),sg=yg();if(rg!==vg)if(61===pg.charCodeAt(zg)?(sg=Tj,zg++):(sg=vg,0===
Gg&&tg(Uj)),sg!==vg){sg=[];for(rg=yg();rg!==vg;)sg.push(rg),rg=yg();if(sg!==vg)if(rg=xh(),rg!==vg){sg=[];for(ug=yg();ug!==vg;)sg.push(ug),ug=yg();sg!==vg?og=qg=[qg,rg]:(zg=og,og=vg)}else zg=og,og=vg;else zg=og,og=vg}else zg=og,og=vg;else zg=og,og=vg}else zg=og,og=vg;else zg=og,og=vg}else zg=og,og=vg;else zg=og,og=vg;return og}function uj(){var og,qg,rg,sg,ug,wg,yg,Ag;og=zg;80===pg.charCodeAt(zg)?(qg=Xi,zg++):(qg=vg,0===Gg&&tg(qi));qg===vg&&(112===pg.charCodeAt(zg)?(qg=Ci,zg++):(qg=vg,0===Gg&&tg(Yi)));
qg!==vg?(69===pg.charCodeAt(zg)?(rg=Kh,zg++):(rg=vg,0===Gg&&tg(fi)),rg===vg&&(101===pg.charCodeAt(zg)?(rg=mi,zg++):(rg=vg,0===Gg&&tg(Lh))),rg!==vg?(80===pg.charCodeAt(zg)?(sg=Xi,zg++):(sg=vg,0===Gg&&tg(qi)),sg===vg&&(112===pg.charCodeAt(zg)?(sg=Ci,zg++):(sg=vg,0===Gg&&tg(Yi))),sg!==vg?(84===pg.charCodeAt(zg)?(ug=ki,zg++):(ug=vg,0===Gg&&tg(zj)),ug===vg&&(116===pg.charCodeAt(zg)?(ug=li,zg++):(ug=vg,0===Gg&&tg(Oi))),ug!==vg?(73===pg.charCodeAt(zg)?(wg=Zi,zg++):(wg=vg,0===Gg&&tg(Aj)),wg===vg&&(105===
pg.charCodeAt(zg)?(wg=$i,zg++):(wg=vg,0===Gg&&tg(Bj))),wg!==vg?(68===pg.charCodeAt(zg)?(yg=Am,zg++):(yg=vg,0===Gg&&tg(Bm)),yg===vg&&(100===pg.charCodeAt(zg)?(yg=Cm,zg++):(yg=vg,0===Gg&&tg(Dm))),yg!==vg?(69===pg.charCodeAt(zg)?(Ag=Kh,zg++):(Ag=vg,0===Gg&&tg(fi)),Ag===vg&&(101===pg.charCodeAt(zg)?(Ag=mi,zg++):(Ag=vg,0===Gg&&tg(Lh))),Ag!==vg?og=qg=[qg,rg,sg,ug,wg,yg,Ag]:(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg);return og}function xi(){var og,
qg,rg,sg,ug,wg,Ag,Bg;og=zg;80===pg.charCodeAt(zg)?(qg=Xi,zg++):(qg=vg,0===Gg&&tg(qi));qg===vg&&(112===pg.charCodeAt(zg)?(qg=Ci,zg++):(qg=vg,0===Gg&&tg(Yi)));qg!==vg?(82===pg.charCodeAt(zg)?(rg=Xj,zg++):(rg=vg,0===Gg&&tg(Yj)),rg===vg&&(114===pg.charCodeAt(zg)?(rg=Zj,zg++):(rg=vg,0===Gg&&tg(ak))),rg!==vg?(79===pg.charCodeAt(zg)?(sg=zi,zg++):(sg=vg,0===Gg&&tg(Pi)),sg===vg&&(111===pg.charCodeAt(zg)?(sg=Qi,zg++):(sg=vg,0===Gg&&tg(Ri))),sg!==vg?(84===pg.charCodeAt(zg)?(ug=ki,zg++):(ug=vg,0===Gg&&tg(zj)),
ug===vg&&(116===pg.charCodeAt(zg)?(ug=li,zg++):(ug=vg,0===Gg&&tg(Oi))),ug!==vg?(69===pg.charCodeAt(zg)?(wg=Kh,zg++):(wg=vg,0===Gg&&tg(fi)),wg===vg&&(101===pg.charCodeAt(zg)?(wg=mi,zg++):(wg=vg,0===Gg&&tg(Lh))),wg!==vg?(73===pg.charCodeAt(zg)?(Ag=Zi,zg++):(Ag=vg,0===Gg&&tg(Aj)),Ag===vg&&(105===pg.charCodeAt(zg)?(Ag=$i,zg++):(Ag=vg,0===Gg&&tg(Bj))),Ag!==vg?(78===pg.charCodeAt(zg)?(Bg=Mh,zg++):(Bg=vg,0===Gg&&tg(ni)),Bg===vg&&(110===pg.charCodeAt(zg)?(Bg=Nh,zg++):(Bg=vg,0===Gg&&tg(oi))),Bg!==vg?og=qg=
[qg,rg,sg,ug,wg,Ag,Bg]:(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg);if(og===vg&&(og=uj(),og===vg)){var Cg;og=zg;83===pg.charCodeAt(zg)?(qg=wm,zg++):(qg=vg,0===Gg&&tg(xm));qg===vg&&(115===pg.charCodeAt(zg)?(qg=ym,zg++):(qg=vg,0===Gg&&tg(zm)));if(qg!==vg)if(77===pg.charCodeAt(zg)?(rg=Gp,zg++):(rg=vg,0===Gg&&tg(Hp)),rg===vg&&(109===pg.charCodeAt(zg)?(rg=Ip,zg++):(rg=vg,0===Gg&&tg(Jp))),rg!==vg)if(65===pg.charCodeAt(zg)?(sg=Ai,zg++):(sg=vg,0===
Gg&&tg(Si)),sg===vg&&(97===pg.charCodeAt(zg)?(sg=Ti,zg++):(sg=vg,0===Gg&&tg(Ui))),sg!==vg)if(76===pg.charCodeAt(zg)?(ug=pi,zg++):(ug=vg,0===Gg&&tg(Bi)),ug===vg&&(108===pg.charCodeAt(zg)?(ug=Vi,zg++):(ug=vg,0===Gg&&tg(Wi))),ug!==vg)if(76===pg.charCodeAt(zg)?(wg=pi,zg++):(wg=vg,0===Gg&&tg(Bi)),wg===vg&&(108===pg.charCodeAt(zg)?(wg=Vi,zg++):(wg=vg,0===Gg&&tg(Wi))),wg!==vg)if(Ag=yg(),Ag===vg&&(Ag=null),Ag!==vg){Bg=zg;var Dg,Eg,Fg,Ig;Cg=zg;80===pg.charCodeAt(zg)?(Dg=Xi,zg++):(Dg=vg,0===Gg&&tg(qi));Dg===
vg&&(112===pg.charCodeAt(zg)?(Dg=Ci,zg++):(Dg=vg,0===Gg&&tg(Yi)));Dg!==vg?(69===pg.charCodeAt(zg)?(Eg=Kh,zg++):(Eg=vg,0===Gg&&tg(fi)),Eg===vg&&(101===pg.charCodeAt(zg)?(Eg=mi,zg++):(Eg=vg,0===Gg&&tg(Lh))),Eg!==vg?(80===pg.charCodeAt(zg)?(Fg=Xi,zg++):(Fg=vg,0===Gg&&tg(qi)),Fg===vg&&(112===pg.charCodeAt(zg)?(Fg=Ci,zg++):(Fg=vg,0===Gg&&tg(Yi))),Fg!==vg?(84===pg.charCodeAt(zg)?(Ig=ki,zg++):(Ig=vg,0===Gg&&tg(zj)),Ig===vg&&(116===pg.charCodeAt(zg)?(Ig=li,zg++):(Ig=vg,0===Gg&&tg(Oi))),Ig!==vg?Cg=Dg=[Dg,
Eg,Fg,Ig]:(zg=Cg,Cg=vg)):(zg=Cg,Cg=vg)):(zg=Cg,Cg=vg)):(zg=Cg,Cg=vg);Cg===vg&&(Cg=uj());Bg=Cg!==vg?pg.substring(Bg,zg):Cg;Bg!==vg?og=qg=[qg,rg,sg,ug,wg,Ag,Bg]:(zg=og,og=vg)}else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;else zg=og,og=vg;og===vg&&(og=zg,82===pg.charCodeAt(zg)?(qg=Xj,zg++):(qg=vg,0===Gg&&tg(Yj)),qg===vg&&(114===pg.charCodeAt(zg)?(qg=Zj,zg++):(qg=vg,0===Gg&&tg(ak))),qg!==vg?(78===pg.charCodeAt(zg)?(rg=Mh,zg++):(rg=vg,0===Gg&&tg(ni)),rg===vg&&(110===
pg.charCodeAt(zg)?(rg=Nh,zg++):(rg=vg,0===Gg&&tg(oi))),rg!==vg?(65===pg.charCodeAt(zg)?(sg=Ai,zg++):(sg=vg,0===Gg&&tg(Si)),sg===vg&&(97===pg.charCodeAt(zg)?(sg=Ti,zg++):(sg=vg,0===Gg&&tg(Ui))),sg!==vg?og=qg=[qg,rg,sg]:(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg),og===vg&&(og=zg,68===pg.charCodeAt(zg)?(qg=Am,zg++):(qg=vg,0===Gg&&tg(Bm)),qg===vg&&(100===pg.charCodeAt(zg)?(qg=Cm,zg++):(qg=vg,0===Gg&&tg(Dm))),qg!==vg?(78===pg.charCodeAt(zg)?(rg=Mh,zg++):(rg=vg,0===Gg&&tg(ni)),rg===vg&&(110===pg.charCodeAt(zg)?
(rg=Nh,zg++):(rg=vg,0===Gg&&tg(oi))),rg!==vg?(65===pg.charCodeAt(zg)?(sg=Ai,zg++):(sg=vg,0===Gg&&tg(Si)),sg===vg&&(97===pg.charCodeAt(zg)?(sg=Ti,zg++):(sg=vg,0===Gg&&tg(Ui))),sg!==vg?og=qg=[qg,rg,sg]:(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg),og===vg&&(og=zg,76===pg.charCodeAt(zg)?(qg=pi,zg++):(qg=vg,0===Gg&&tg(Bi)),qg===vg&&(108===pg.charCodeAt(zg)?(qg=Vi,zg++):(qg=vg,0===Gg&&tg(Wi))),qg!==vg?(73===pg.charCodeAt(zg)?(rg=Zi,zg++):(rg=vg,0===Gg&&tg(Aj)),rg===vg&&(105===pg.charCodeAt(zg)?(rg=$i,zg++):
(rg=vg,0===Gg&&tg(Bj))),rg!==vg?(71===pg.charCodeAt(zg)?(sg=Kp,zg++):(sg=vg,0===Gg&&tg(Lp)),sg===vg&&(103===pg.charCodeAt(zg)?(sg=Mp,zg++):(sg=vg,0===Gg&&tg(Np))),sg!==vg?(65===pg.charCodeAt(zg)?(ug=Ai,zg++):(ug=vg,0===Gg&&tg(Si)),ug===vg&&(97===pg.charCodeAt(zg)?(ug=Ti,zg++):(ug=vg,0===Gg&&tg(Ui))),ug!==vg?(78===pg.charCodeAt(zg)?(wg=Mh,zg++):(wg=vg,0===Gg&&tg(ni)),wg===vg&&(110===pg.charCodeAt(zg)?(wg=Nh,zg++):(wg=vg,0===Gg&&tg(oi))),wg!==vg?(68===pg.charCodeAt(zg)?(Ag=Am,zg++):(Ag=vg,0===Gg&&tg(Bm)),
Ag===vg&&(100===pg.charCodeAt(zg)?(Ag=Cm,zg++):(Ag=vg,0===Gg&&tg(Dm))),Ag!==vg?og=qg=[qg,rg,sg,ug,wg,Ag]:(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg),og===vg&&(og=zg,73===pg.charCodeAt(zg)?(qg=Zi,zg++):(qg=vg,0===Gg&&tg(Aj)),qg===vg&&(105===pg.charCodeAt(zg)?(qg=$i,zg++):(qg=vg,0===Gg&&tg(Bj))),qg!==vg?(79===pg.charCodeAt(zg)?(rg=zi,zg++):(rg=vg,0===Gg&&tg(Pi)),rg===vg&&(111===pg.charCodeAt(zg)?(rg=Qi,zg++):(rg=vg,0===Gg&&tg(Ri))),rg!==vg?(78===pg.charCodeAt(zg)?
(sg=Mh,zg++):(sg=vg,0===Gg&&tg(ni)),sg===vg&&(110===pg.charCodeAt(zg)?(sg=Nh,zg++):(sg=vg,0===Gg&&tg(oi))),sg!==vg?og=qg=[qg,rg,sg]:(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg),og===vg&&(og=zg,83===pg.charCodeAt(zg)?(qg=wm,zg++):(qg=vg,0===Gg&&tg(xm)),qg===vg&&(115===pg.charCodeAt(zg)?(qg=ym,zg++):(qg=vg,0===Gg&&tg(zm))),qg!==vg?(79===pg.charCodeAt(zg)?(rg=zi,zg++):(rg=vg,0===Gg&&tg(Pi)),rg===vg&&(111===pg.charCodeAt(zg)?(rg=Qi,zg++):(rg=vg,0===Gg&&tg(Ri))),rg!==vg?(76===pg.charCodeAt(zg)?(sg=pi,zg++):
(sg=vg,0===Gg&&tg(Bi)),sg===vg&&(108===pg.charCodeAt(zg)?(sg=Vi,zg++):(sg=vg,0===Gg&&tg(Wi))),sg!==vg?(86===pg.charCodeAt(zg)?(ug=Op,zg++):(ug=vg,0===Gg&&tg(Pp)),ug===vg&&(118===pg.charCodeAt(zg)?(ug=Qp,zg++):(ug=vg,0===Gg&&tg(Rp))),ug!==vg?(69===pg.charCodeAt(zg)?(wg=Kh,zg++):(wg=vg,0===Gg&&tg(fi)),wg===vg&&(101===pg.charCodeAt(zg)?(wg=mi,zg++):(wg=vg,0===Gg&&tg(Lh))),wg!==vg?(78===pg.charCodeAt(zg)?(Ag=Mh,zg++):(Ag=vg,0===Gg&&tg(ni)),Ag===vg&&(110===pg.charCodeAt(zg)?(Ag=Nh,zg++):(Ag=vg,0===Gg&&
tg(oi))),Ag!==vg?(84===pg.charCodeAt(zg)?(Bg=ki,zg++):(Bg=vg,0===Gg&&tg(zj)),Bg===vg&&(116===pg.charCodeAt(zg)?(Bg=li,zg++):(Bg=vg,0===Gg&&tg(Oi))),Bg!==vg?og=qg=[qg,rg,sg,ug,wg,Ag,Bg]:(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg))))))}og!==vg&&(og=og.join(""));return og}function Oh(){var og;pg.substr(zg,5)===zn?(og=zn,zg+=5):(og=vg,0===Gg&&tg(Sp));og!==vg&&(og=new xl,og.type=xl.ea.qk);if(og===vg){var qg,rg;og=zg;pg.substr(zg,9)===An?(qg=An,
zg+=9):(qg=vg,0===Gg&&tg(Tp));if(qg!==vg){rg=[];for(qg=yg();qg!==vg;)rg.push(qg),qg=yg();rg!==vg?(qg=Qg(),qg!==vg?(og=new xl,og.type=xl.ea.Di,og.lc=qg.toUpperCase()):(zg=og,og=vg)):(zg=og,og=vg)}else zg=og,og=vg;if(og===vg){og=zg;pg.substr(zg,7)===Bn?(qg=Bn,zg+=7):(qg=vg,0===Gg&&tg(Up));if(qg!==vg){rg=[];for(qg=yg();qg!==vg;)rg.push(qg),qg=yg();rg!==vg?(qg=Qg(),qg!==vg?(58===pg.charCodeAt(zg)?(rg=Gh,zg++):(rg=vg,0===Gg&&tg(oh)),rg!==vg?(rg=xi(),rg!==vg?(og=new xl,og.type=xl.ea.kk,og.Jd=rg.toUpperCase(),
og.lc=qg.toUpperCase()):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)}else zg=og,og=vg;if(og===vg){var sg;og=zg;pg.substr(zg,8)===Cn?(qg=Cn,zg+=8):(qg=vg,0===Gg&&tg(Vp));if(qg!==vg){rg=[];for(qg=yg();qg!==vg;)rg.push(qg),qg=yg();rg!==vg?(qg=Qg(),qg!==vg?(58===pg.charCodeAt(zg)?(rg=Gh,zg++):(rg=vg,0===Gg&&tg(oh)),rg!==vg?(rg=xi(),rg!==vg?(58===pg.charCodeAt(zg)?(sg=Gh,zg++):(sg=vg,0===Gg&&tg(oh)),sg!==vg?(sg=Qg(),sg!==vg?(og=new xl,og.type=xl.ea.yi,og.lc=qg.toUpperCase(),og.Jd=rg.toUpperCase(),
og.hf=sg):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)}else zg=og,og=vg;if(og===vg){var ug,wg,Ag,Bg;og=zg;pg.substr(zg,7)===Dn?(qg=Dn,zg+=7):(qg=vg,0===Gg&&tg(Wp));if(qg!==vg){rg=[];for(qg=yg();qg!==vg;)rg.push(qg),qg=yg();rg!==vg?(qg=Qg(),qg!==vg?(58===pg.charCodeAt(zg)?(rg=Gh,zg++):(rg=vg,0===Gg&&tg(oh)),rg!==vg?(rg=xi(),rg!==vg?(58===pg.charCodeAt(zg)?(sg=Gh,zg++):(sg=vg,0===Gg&&tg(oh)),sg!==vg?(sg=Qg(),sg!==vg?(58===pg.charCodeAt(zg)?(ug=Gh,zg++):(ug=
vg,0===Gg&&tg(oh)),ug!==vg?(ug=wg=zg,Ag=Qg(),Ag!==vg?(58===pg.charCodeAt(zg)?(Bg=Gh,zg++):(Bg=vg,0===Gg&&tg(oh)),Bg!==vg?ug=Ag=[Ag,Bg]:(zg=ug,ug=vg)):(zg=ug,ug=vg),ug===vg&&(ug=null),wg=ug!==vg?pg.substring(wg,zg):ug,wg!==vg?(ug=zg,Ag=Qg(),ug=Ag!==vg?pg.substring(ug,zg):Ag,ug!==vg?(og=new xl,og.type=xl.ea.pk,og.lc=qg.toUpperCase(),og.Jd=rg.toUpperCase(),og.hf=sg,og.ec=ug):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,
og=vg)}else zg=og,og=vg;if(og===vg)if(og=zg,pg.substr(zg,4)===En?(qg=En,zg+=4):(qg=vg,0===Gg&&tg(Xp)),qg!==vg){rg=[];for(qg=yg();qg!==vg;)rg.push(qg),qg=yg();rg!==vg?(qg=Qg(),qg!==vg?(58===pg.charCodeAt(zg)?(rg=Gh,zg++):(rg=vg,0===Gg&&tg(oh)),rg!==vg?(rg=xi(),rg!==vg?(58===pg.charCodeAt(zg)?(sg=Gh,zg++):(sg=vg,0===Gg&&tg(oh)),sg!==vg?(sg=Qg(),sg!==vg?(58===pg.charCodeAt(zg)?(ug=Gh,zg++):(ug=vg,0===Gg&&tg(oh)),ug!==vg?(ug=wg=zg,Ag=Qg(),Ag!==vg?(58===pg.charCodeAt(zg)?(Bg=Gh,zg++):(Bg=vg,0===Gg&&tg(oh)),
Bg!==vg?ug=Ag=[Ag,Bg]:(zg=ug,ug=vg)):(zg=ug,ug=vg),ug===vg&&(ug=null),wg=ug!==vg?pg.substring(wg,zg):ug,wg!==vg?(ug=zg,Ag=Kg(),ug=Ag!==vg?pg.substring(ug,zg):Ag,ug!==vg?(og=new xl,og.type=xl.ea.bk,og.lc=qg.toUpperCase(),og.Jd=rg.toUpperCase(),og.hf=sg,og.gd=parseInt(ug)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)):(zg=og,og=vg)}else zg=og,og=vg}}}}return og}function Pm(){var og,qg,rg,sg,ug;og=zg;qg=[];for(rg=yg();rg!==vg;)qg.push(rg),
rg=yg();if(qg!==vg){var wg,Ag,Cg,Dg,Eg,Fg;wg=zg;pg.substr(zg,4)===Fn?(Ag=Fn,zg+=4):(Ag=vg,0===Gg&&tg(Yp));if(Ag!==vg){Cg=[];for(Dg=yg();Dg!==vg;)Cg.push(Dg),Dg=yg();if(Cg!==vg)if(Dg=Qg(),Dg!==vg){Eg=[];for(Fg=yg();Fg!==vg;)Eg.push(Fg),Fg=yg();if(Eg!==vg){var Ig,Kg,Jg,Og;Ig=zg;pg.substr(zg,2)===Gn?(Kg=Gn,zg+=2):(Kg=vg,0===Gg&&tg(Zp));if(Kg!==vg){Jg=[];for(Og=yg();Og!==vg;)Jg.push(Og),Og=yg();Jg!==vg?(Og=Qg(),Og!==vg?Ig=Kg=Og:(zg=Ig,Ig=vg)):(zg=Ig,Ig=vg)}else zg=Ig,Ig=vg;Fg=Ig;Fg===vg&&(Fg=null);Fg!==
vg?wg=Ag=new gm(Dg.toUpperCase(),Fg):(zg=wg,wg=vg)}else zg=wg,wg=vg}else zg=wg,wg=vg;else zg=wg,wg=vg}else zg=wg,wg=vg;rg=wg;if(rg===vg){var eh,xh,Gh,oh,Sh,Kh;eh=zg;pg.substr(zg,7)===Hn?(xh=Hn,zg+=7):(xh=vg,0===Gg&&tg($p));if(xh!==vg){Gh=[];for(oh=yg();oh!==vg;)Gh.push(oh),oh=yg();if(Gh!==vg)if(oh=wh(),oh===vg&&(oh=null),oh!==vg){Sh=[];for(Kh=yg();Kh!==vg;)Sh.push(Kh),Kh=yg();Sh!==vg?(Kh=vh(),Kh!==vg?eh=xh=new fm(Kh,oh):(zg=eh,eh=vg)):(zg=eh,eh=vg)}else zg=eh,eh=vg;else zg=eh,eh=vg}else zg=eh,eh=
vg;rg=eh;if(rg===vg){var aj,fi,mi,Lh;aj=zg;pg.substr(zg,6)===In?(fi=In,zg+=6):(fi=vg,0===Gg&&tg(aq));if(fi!==vg){mi=[];for(Lh=yg();Lh!==vg;)mi.push(Lh),Lh=yg();mi!==vg?(Lh=Qg(),Lh!==vg?aj=fi=new hm(Lh.toUpperCase()):(zg=aj,aj=vg)):(zg=aj,aj=vg)}else zg=aj,aj=vg;rg=aj;if(rg===vg){var zh,Mh,ni,Nh,oi,bj,xi,cj;zh=zg;pg.substr(zg,3)===Jn?(Mh=Jn,zg+=3):(Mh=vg,0===Gg&&tg(bq));if(Mh!==vg){ni=[];for(Nh=yg();Nh!==vg;)ni.push(Nh),Nh=yg();if(ni!==vg)if(Nh=Qg(),Nh!==vg){oi=[];for(bj=yg();bj!==vg;)oi.push(bj),
bj=yg();if(oi!==vg)if(bj=wh(),bj===vg&&(bj=null),bj!==vg){xi=[];for(cj=yg();cj!==vg;)xi.push(cj),cj=yg();if(xi!==vg)if(cj=dh(),cj===vg&&(cj=Qg()),cj!==vg){var ki=Nh,zj=bj,li=cj;"background"===ki?Mh=new im(ki,li,zj):"quality"===ki?(li=li.toUpperCase(),Mh=new im(ki,li,zj)):Mh=new im(ki,li);zh=Mh}else zg=zh,zh=vg;else zg=zh,zh=vg}else zg=zh,zh=vg;else zg=zh,zh=vg}else zg=zh,zh=vg;else zg=zh,zh=vg}else zg=zh,zh=vg;rg=zh;if(rg===vg){var dj,Cj,Oi,bk;dj=zg;pg.substr(zg,4)===Kn?(Cj=Kn,zg+=4):(Cj=vg,0===Gg&&
tg(cq));Cj===vg&&(pg.substr(zg,4)===Ln?(Cj=Ln,zg+=4):(Cj=vg,0===Gg&&tg(dq)));if(Cj!==vg){Oi=[];for(bk=yg();bk!==vg;)Oi.push(bk),bk=yg();Oi!==vg?(bk=Oh(),bk!==vg?dj=Cj=new km(bk,"show"===Cj):(zg=dj,dj=vg)):(zg=dj,dj=vg)}else zg=dj,dj=vg;rg=dj;if(rg===vg){var Ah,zi,Pi,ck,Qi,dk,Ri,ek;Ah=zg;pg.substr(zg,4)===Mn?(zi=Mn,zg+=4):(zi=vg,0===Gg&&tg(eq));if(zi!==vg){Pi=[];for(ck=yg();ck!==vg;)Pi.push(ck),ck=yg();if(Pi!==vg)if(ck=Oh(),ck!==vg){Qi=[];for(dk=yg();dk!==vg;)Qi.push(dk),dk=yg();if(Qi!==vg)if(dk=Qg(),
dk!==vg){Ri=[];for(ek=yg();ek!==vg;)Ri.push(ek),ek=yg();Ri!==vg?(ek=Fh(),ek!==vg?Ah=zi=new lm(ck,ih.il(dk.toUpperCase()),ek):(zg=Ah,Ah=vg)):(zg=Ah,Ah=vg)}else zg=Ah,Ah=vg;else zg=Ah,Ah=vg}else zg=Ah,Ah=vg;else zg=Ah,Ah=vg}else zg=Ah,Ah=vg;rg=Ah;if(rg===vg){var rh,Ai,Si,ej,Ti,fk,Ui,Di,Yh,ri,Ok,gk,pi,hk;rh=zg;pg.substr(zg,5)===Nn?(Ai=Nn,zg+=5):(Ai=vg,0===Gg&&tg(fq));if(Ai!==vg){Si=[];for(ej=yg();ej!==vg;)Si.push(ej),ej=yg();if(Si!==vg)if(ej=wh(),ej===vg&&(ej=null),ej!==vg){Ti=[];for(fk=yg();fk!==vg;)Ti.push(fk),
fk=yg();if(Ti!==vg)if(fk=Oh(),fk!==vg){Ui=[];for(Di=yg();Di!==vg;)Ui.push(Di),Di=yg();if(Ui!==vg){Yh=Di=zg;ri=Qg();if(ri!==vg){Ok=zg;Gg++;gk=zg;pi=[];for(hk=yg();hk!==vg;)pi.push(hk),hk=yg();pi!==vg?(hk=di(),hk!==vg?gk=pi=[pi,hk]:(zg=gk,gk=vg)):(zg=gk,gk=vg);Gg--;gk!==vg?(zg=Ok,Ok=void 0):Ok=vg;Ok!==vg?Yh=ri=[ri,Ok]:(zg=Yh,Yh=vg)}else zg=Yh,Yh=vg;Yh===vg&&(Yh=null);Di=Yh!==vg?pg.substring(Di,zg):Yh;if(Di!==vg){Yh=[];for(ri=yg();ri!==vg;)Yh.push(ri),ri=yg();Yh!==vg?(ri=di(),ri!==vg?rh=Ai=new mm(fk,
ri,ih.il((Di?Di.toUpperCase():"").toUpperCase()),ej):(zg=rh,rh=vg)):(zg=rh,rh=vg)}else zg=rh,rh=vg}else zg=rh,rh=vg}else zg=rh,rh=vg;else zg=rh,rh=vg}else zg=rh,rh=vg;else zg=rh,rh=vg}else zg=rh,rh=vg;rg=rh;if(rg===vg){var Bh,Bi,Vi,fj,Wi,ik,Xi,gj;Bh=zg;pg.substr(zg,4)===On?(Bi=On,zg+=4):(Bi=vg,0===Gg&&tg(gq));if(Bi!==vg){Vi=[];for(fj=yg();fj!==vg;)Vi.push(fj),fj=yg();if(Vi!==vg)if(fj=wh(),fj===vg&&(fj=null),fj!==vg){Wi=[];for(ik=yg();ik!==vg;)Wi.push(ik),ik=yg();if(Wi!==vg)if(ik=Oh(),ik!==vg){Xi=
[];for(gj=yg();gj!==vg;)Xi.push(gj),gj=yg();if(Xi!==vg){gj=Sg();if(gj===vg){var qi;pg.substr(zg,6)===Pn?(qi=Pn,zg+=6):(qi=vg,0===Gg&&tg(hq));qi!==vg&&(qi=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);gj=qi}gj!==vg?Bh=Bi=new nm(ik,gj,fj):(zg=Bh,Bh=vg)}else zg=Bh,Bh=vg}else zg=Bh,Bh=vg;else zg=Bh,Bh=vg}else zg=Bh,Bh=vg;else zg=Bh,Bh=vg}else zg=Bh,Bh=vg;rg=Bh;if(rg===vg){var Ch,Ci,Yi,hj,uj,jk,yj,kk;Ch=zg;pg.substr(zg,5)===Qn?(Ci=Qn,zg+=5):(Ci=vg,0===Gg&&tg(iq));if(Ci!==vg){Yi=[];for(hj=yg();hj!==vg;)Yi.push(hj),
hj=yg();if(Yi!==vg)if(hj=wh(),hj===vg&&(hj=null),hj!==vg){uj=[];for(jk=yg();jk!==vg;)uj.push(jk),jk=yg();if(uj!==vg)if(jk=Oh(),jk!==vg){yj=[];for(kk=yg();kk!==vg;)yj.push(kk),kk=yg();yj!==vg?(kk=Oh(),kk!==vg?Ch=Ci=new pm(jk,kk,hj):(zg=Ch,Ch=vg)):(zg=Ch,Ch=vg)}else zg=Ch,Ch=vg;else zg=Ch,Ch=vg}else zg=Ch,Ch=vg;else zg=Ch,Ch=vg}else zg=Ch,Ch=vg;rg=Ch;if(rg===vg){var ij,Zi,Aj,lk;ij=zg;pg.substr(zg,4)===Rn?(Zi=Rn,zg+=4):(Zi=vg,0===Gg&&tg(jq));if(Zi!==vg){Aj=[];for(lk=yg();lk!==vg;)Aj.push(lk),lk=yg();
Aj!==vg?(lk=Lg(),lk!==vg?ij=Zi=new zl(lk):(zg=ij,ij=vg)):(zg=ij,ij=vg)}else zg=ij,ij=vg;rg=ij;if(rg===vg){var Zh,$i,Bj,jj,Dj,mk;Zh=zg;pg.substr(zg,4)===Sn?($i=Sn,zg+=4):($i=vg,0===Gg&&tg(kq));if($i!==vg){Bj=[];for(jj=yg();jj!==vg;)Bj.push(jj),jj=yg();if(Bj!==vg)if(jj=wh(),jj===vg&&(jj=null),jj!==vg){Dj=[];for(mk=yg();mk!==vg;)Dj.push(mk),mk=yg();Dj!==vg?(mk=Oh(),mk!==vg?Zh=$i=new jm(mk,jj,!0):(zg=Zh,Zh=vg)):(zg=Zh,Zh=vg)}else zg=Zh,Zh=vg;else zg=Zh,Zh=vg}else zg=Zh,Zh=vg;rg=Zh;if(rg===vg){var Dh,
qj,Mj,nk,Nj,Ei,$h,si,Pk,ok,sl,pk;Dh=zg;pg.substr(zg,9)===Tn?(qj=Tn,zg+=9):(qj=vg,0===Gg&&tg(lq));if(qj!==vg){Mj=[];for(nk=yg();nk!==vg;)Mj.push(nk),nk=yg();if(Mj!==vg)if(nk=Oh(),nk!==vg){Nj=[];for(Ei=yg();Ei!==vg;)Nj.push(Ei),Ei=yg();if(Nj!==vg){$h=Ei=zg;si=Qg();if(si!==vg){Pk=zg;Gg++;ok=zg;sl=[];for(pk=yg();pk!==vg;)sl.push(pk),pk=yg();sl!==vg?(pk=Fh(),pk!==vg?ok=sl=[sl,pk]:(zg=ok,ok=vg)):(zg=ok,ok=vg);Gg--;ok!==vg?(zg=Pk,Pk=void 0):Pk=vg;Pk!==vg?$h=si=[si,Pk]:(zg=$h,$h=vg)}else zg=$h,$h=vg;$h===
vg&&($h=null);Ei=$h!==vg?pg.substring(Ei,zg):$h;if(Ei!==vg){$h=[];for(si=yg();si!==vg;)$h.push(si),si=yg();$h!==vg?(si=Fh(),si!==vg?Dh=qj=new qm(nk,ih.il((Ei?Ei.toUpperCase():"").toUpperCase()),si):(zg=Dh,Dh=vg)):(zg=Dh,Dh=vg)}else zg=Dh,Dh=vg}else zg=Dh,Dh=vg}else zg=Dh,Dh=vg;else zg=Dh,Dh=vg}else zg=Dh,Dh=vg;rg=Dh;if(rg===vg){var th,Ul,Oj,kj,Pj,qk,Qj,rk,Rj,sk;th=zg;pg.substr(zg,4)===Un?(Ul=Un,zg+=4):(Ul=vg,0===Gg&&tg(mq));if(Ul!==vg){Oj=[];for(kj=yg();kj!==vg;)Oj.push(kj),kj=yg();if(Oj!==vg)if(kj=
wh(),kj===vg&&(kj=null),kj!==vg){Pj=[];for(qk=yg();qk!==vg;)Pj.push(qk),qk=yg();if(Pj!==vg)if(qk=Oh(),qk!==vg){Qj=[];for(rk=yg();rk!==vg;)Qj.push(rk),rk=yg();if(Qj!==vg)if(rk=Mg(),rk!==vg){Rj=[];for(sk=yg();sk!==vg;)Rj.push(sk),sk=yg();Rj!==vg?(sk=Mg(),sk!==vg?th=Ul=new Em(qk,rk,sk,kj):(zg=th,th=vg)):(zg=th,th=vg)}else zg=th,th=vg;else zg=th,th=vg}else zg=th,th=vg;else zg=th,th=vg}else zg=th,th=vg;else zg=th,th=vg}else zg=th,th=vg;rg=th;if(rg===vg&&(rg=Vn(),rg===vg)){var ai,Vl,Sj,lj,Tj,tk;ai=zg;pg.substr(zg,
6)===Wn?(Vl=Wn,zg+=6):(Vl=vg,0===Gg&&tg(nq));if(Vl!==vg){Sj=[];for(lj=yg();lj!==vg;)Sj.push(lj),lj=yg();if(Sj!==vg)if(lj=wh(),lj===vg&&(lj=null),lj!==vg){Tj=[];for(tk=yg();tk!==vg;)Tj.push(tk),tk=yg();Tj!==vg?(tk=Oh(),tk!==vg?ai=Vl=new jm(tk,lj,!1):(zg=ai,ai=vg)):(zg=ai,ai=vg)}else zg=ai,ai=vg;else zg=ai,ai=vg}else zg=ai,ai=vg;rg=ai;if(rg===vg){var uh,Wl,Uj,mj,Vj,uk,Wj,Fi,bi,ti,Qk,vk,tl,wk;uh=zg;pg.substr(zg,7)===Xn?(Wl=Xn,zg+=7):(Wl=vg,0===Gg&&tg(oq));if(Wl!==vg){Uj=[];for(mj=yg();mj!==vg;)Uj.push(mj),
mj=yg();if(Uj!==vg)if(mj=wh(),mj===vg&&(mj=null),mj!==vg){Vj=[];for(uk=yg();uk!==vg;)Vj.push(uk),uk=yg();if(Vj!==vg)if(uk=Oh(),uk!==vg){Wj=[];for(Fi=yg();Fi!==vg;)Wj.push(Fi),Fi=yg();if(Wj!==vg){bi=Fi=zg;var xk,yk;xk=[];Yn.test(pg.charAt(zg))?(yk=pg.charAt(zg),zg++):(yk=vg,0===Gg&&tg(Zn));if(yk!==vg)for(;yk!==vg;)xk.push(yk),Yn.test(pg.charAt(zg))?(yk=pg.charAt(zg),zg++):(yk=vg,0===Gg&&tg(Zn));else xk=vg;xk!==vg&&(xk=xk.join(""));ti=xk;if(ti!==vg){Qk=zg;Gg++;vk=zg;tl=[];for(wk=yg();wk!==vg;)tl.push(wk),
wk=yg();tl!==vg?(wk=Mg(),wk!==vg?vk=tl=[tl,wk]:(zg=vk,vk=vg)):(zg=vk,vk=vg);Gg--;vk!==vg?(zg=Qk,Qk=void 0):Qk=vg;Qk!==vg?bi=ti=[ti,Qk]:(zg=bi,bi=vg)}else zg=bi,bi=vg;bi===vg&&(bi=null);Fi=bi!==vg?pg.substring(Fi,zg):bi;if(Fi!==vg){bi=[];for(ti=yg();ti!==vg;)bi.push(ti),ti=yg();bi!==vg?(ti=Mg(),ti!==vg?uh=Wl=new Fm(uk,ti,mj,ih.il((Fi?Fi.toUpperCase():"").toUpperCase())):(zg=uh,uh=vg)):(zg=uh,uh=vg)}else zg=uh,uh=vg}else zg=uh,uh=vg}else zg=uh,uh=vg;else zg=uh,uh=vg}else zg=uh,uh=vg;else zg=uh,uh=vg}else zg=
uh,uh=vg;rg=uh;if(rg===vg){var ul;pg.substr(zg,5)===$n?(ul=$n,zg+=5):(ul=vg,0===Gg&&tg(pq));ul!==vg&&(ul=new Gm);rg=ul;if(rg===vg&&(rg=Vn(),rg===vg)){var Eh,Xl,Xj,nj,Yj,zk,Zj,Ak;Eh=zg;pg.substr(zg,8)===ao?(Xl=ao,zg+=8):(Xl=vg,0===Gg&&tg(qq));if(Xl!==vg){Xj=[];for(nj=yg();nj!==vg;)Xj.push(nj),nj=yg();if(Xj!==vg)if(nj=wh(),nj===vg&&(nj=null),nj!==vg){Yj=[];for(zk=yg();zk!==vg;)Yj.push(zk),zk=yg();if(Yj!==vg)if(zk=Oh(),zk!==vg){Zj=[];for(Ak=yg();Ak!==vg;)Zj.push(Ak),Ak=yg();Zj!==vg?(Ak=Oh(),Ak!==vg?
Eh=Xl=new Hm(zk,Ak,nj):(zg=Eh,Eh=vg)):(zg=Eh,Eh=vg)}else zg=Eh,Eh=vg;else zg=Eh,Eh=vg}else zg=Eh,Eh=vg;else zg=Eh,Eh=vg}else zg=Eh,Eh=vg;rg=Eh;if(rg===vg){var oj,Yl,ak,Bk;oj=zg;pg.substr(zg,6)===bo?(Yl=bo,zg+=6):(Yl=vg,0===Gg&&tg(rq));if(Yl!==vg){ak=[];for(Bk=yg();Bk!==vg;)ak.push(Bk),Bk=yg();ak!==vg?(Bk=Oh(),Bk!==vg?oj=Yl=Bk:(zg=oj,oj=vg)):(zg=oj,oj=vg)}else zg=oj,oj=vg;rg=oj}}}}}}}}}}}}}}}}}if(rg!==vg){sg=[];for(ug=yg();ug!==vg;)sg.push(ug),ug=yg();if(sg!==vg){var pj,vl,wl;pj=zg;59===pg.charCodeAt(zg)?
(vl=hn,zg++):(vl=vg,0===Gg&&tg(jn));vl!==vg?(wl=Bg(),wl===vg&&(wl=null),wl!==vg?pj=vl=[vl,wl]:(zg=pj,pj=vg)):(zg=pj,pj=vg);pj===vg&&(pj=Bg());ug=pj;ug!==vg?og=qg=rg:(zg=og,og=vg)}else zg=og,og=vg}else zg=og,og=vg}else zg=og,og=vg;return og}function Vn(){var og;pg.substr(zg,6)===co?(og=co,zg+=6):(og=vg,0===Gg&&tg(sq));og!==vg&&(og=!1);return og}var Dj=1<arguments.length?arguments[1]:{},vg={},eo={start:ug},fo=ug,Qm=" ",Rm={type:"literal",value:" ",description:'" "'},Co="\t",Do={type:"literal",value:"\t",
description:'"\\t"'},Eo="\n",Fo={type:"literal",value:"\n",description:'"\\n"'},Go="\r",Ho={type:"literal",value:"\r",description:'"\\r"'},Sm="\r\n",Io={type:"literal",value:"\r\n",description:'"\\r\\n"'},hn=";",jn={type:"literal",value:";",description:'";"'},Vm="#",Wm={type:"literal",value:"#",description:'"#"'},Vj="'",Wj={type:"literal",value:"'",description:'"\'"'},vn='"',wn={type:"literal",value:'"',description:'"\\""'},Tm=/^[0-9]/,Um={type:"class",value:"[0-9]",description:"[0-9]"},Jo=/^[0-9, A-F, a-f]/,
Ko={type:"class",value:"[0-9, A-F, a-f]",description:"[0-9, A-F, a-f]"},Lo=/^[eE]/,Mo={type:"class",value:"[eE]",description:"[eE]"},No="!",Oo={type:"literal",value:"!",description:'"!"'},Po="$",Qo={type:"literal",value:"$",description:'"$"'},Xm="%",Ym={type:"literal",value:"%",description:'"%"'},Ro="&",So={type:"literal",value:"&",description:'"&"'},Zm="(",$m={type:"literal",value:"(",description:'"("'},Nj=")",Oj={type:"literal",value:")",description:'")"'},To="*",Uo={type:"literal",value:"*",description:'"*"'},
Pj="+",Qj={type:"literal",value:"+",description:'"+"'},an=",",bn={type:"literal",value:",",description:'","'},Rj="-",Sj={type:"literal",value:"-",description:'"-"'},cn=".",dn={type:"literal",value:".",description:'"."'},en="/",gn={type:"literal",value:"/",description:'"/"'},Gh=":",oh={type:"literal",value:":",description:'":"'},Vo="<",Wo={type:"literal",value:"<",description:'"<"'},Tj="=",Uj={type:"literal",value:"=",description:'"="'},Xo=">",Yo={type:"literal",value:">",description:'">"'},Zo="?",
$o={type:"literal",value:"?",description:'"?"'},ap="@",bp={type:"literal",value:"@",description:'"@"'},cp=/^[A-Z]/,dp={type:"class",value:"[A-Z]",description:"[A-Z]"},kn="[",ln={type:"literal",value:"[",description:'"["'},mn="]",nn={type:"literal",value:"]",description:'"]"'},ep="^",fp={type:"literal",value:"^",description:'"^"'},gp="_",hp={type:"literal",value:"_",description:'"_"'},ip="`",jp={type:"literal",value:"`",description:'"`"'},kp=/^[a-z]/,lp={type:"class",value:"[a-z]",description:"[a-z]"},
mp="{",np={type:"literal",value:"{",description:'"{"'},op="}",pp={type:"literal",value:"}",description:'"}"'},qp="~",rp={type:"literal",value:"~",description:'"~"'},xp="\\",yp={type:"literal",value:"\\",description:'"\\\\"'},on="\\u",sp={type:"literal",value:"\\u",description:'"\\\\u"'},pn="\\n",tp={type:"literal",value:"\\n",description:'"\\\\n"'},qn="\\r",up={type:"literal",value:"\\r",description:'"\\\\r"'},rn="\\t",vp={type:"literal",value:"\\t",description:'"\\\\t"'},sn="\\r\\n",wp={type:"literal",
value:"\\r\\n",description:'"\\\\r\\\\n"'},zp={type:"any",description:"any character"},ki="T",zj={type:"literal",value:"T",description:'"T"'},li="t",Oi={type:"literal",value:"t",description:'"t"'},Xj="R",Yj={type:"literal",value:"R",description:'"R"'},Zj="r",ak={type:"literal",value:"r",description:'"r"'},Cp="U",Dp={type:"literal",value:"U",description:'"U"'},Ep="u",Fp={type:"literal",value:"u",description:'"u"'},Kh="E",fi={type:"literal",value:"E",description:'"E"'},mi="e",Lh={type:"literal",value:"e",
description:'"e"'},zi="O",Pi={type:"literal",value:"O",description:'"O"'},Qi="o",Ri={type:"literal",value:"o",description:'"o"'},Mh="N",ni={type:"literal",value:"N",description:'"N"'},Nh="n",oi={type:"literal",value:"n",description:'"n"'},sm="F",tm={type:"literal",value:"F",description:'"F"'},um="f",vm={type:"literal",value:"f",description:'"f"'},Ai="A",Si={type:"literal",value:"A",description:'"A"'},Ti="a",Ui={type:"literal",value:"a",description:'"a"'},pi="L",Bi={type:"literal",value:"L",description:'"L"'},
Vi="l",Wi={type:"literal",value:"l",description:'"l"'},wm="S",xm={type:"literal",value:"S",description:'"S"'},ym="s",zm={type:"literal",value:"s",description:'"s"'},yn="rgb(",Bp={type:"literal",value:"rgb(",description:'"rgb("'},Pn="origin",hq={type:"literal",value:"origin",description:'"origin"'},tn=/^[0-9a-zA-Z_]/,un={type:"class",value:"[0-9a-zA-Z_]",description:"[0-9a-zA-Z_]"},Yn=/^[a-zA-Z_]/,Zn={type:"class",value:"[a-zA-Z_]",description:"[a-zA-Z_]"},Gn="as",Zp={type:"literal",value:"as",description:'"as"'},
xn="0x",Ap={type:"literal",value:"0x",description:'"0x"'},Xi="P",qi={type:"literal",value:"P",description:'"P"'},Ci="p",Yi={type:"literal",value:"p",description:'"p"'},Zi="I",Aj={type:"literal",value:"I",description:'"I"'},$i="i",Bj={type:"literal",value:"i",description:'"i"'},Am="D",Bm={type:"literal",value:"D",description:'"D"'},Cm="d",Dm={type:"literal",value:"d",description:'"d"'},Gp="M",Hp={type:"literal",value:"M",description:'"M"'},Ip="m",Jp={type:"literal",value:"m",description:'"m"'},Kp=
"G",Lp={type:"literal",value:"G",description:'"G"'},Mp="g",Np={type:"literal",value:"g",description:'"g"'},Op="V",Pp={type:"literal",value:"V",description:'"V"'},Qp="v",Rp={type:"literal",value:"v",description:'"v"'},zn="scene",Sp={type:"literal",value:"scene",description:'"scene"'},An="structure",Tp={type:"literal",value:"structure",description:'"structure"'},Bn="moltype",Up={type:"literal",value:"moltype",description:'"moltype"'},Cn="molecule",Vp={type:"literal",value:"molecule",description:'"molecule"'},
Dn="residue",Wp={type:"literal",value:"residue",description:'"residue"'},En="atom",Xp={type:"literal",value:"atom",description:'"atom"'},Hn="display",$p={type:"literal",value:"display",description:'"display"'},Fn="load",Yp={type:"literal",value:"load",description:'"load"'},In="remove",aq={type:"literal",value:"remove",description:'"remove"'},Jn="set",bq={type:"literal",value:"set",description:'"set"'},Wn="center",nq={type:"literal",value:"center",description:'"center"'},Kn="show",cq={type:"literal",
value:"show",description:'"show"'},Ln="hide",dq={type:"literal",value:"hide",description:'"hide"'},Mn="repr",eq={type:"literal",value:"repr",description:'"repr"'},Nn="color",fq={type:"literal",value:"color",description:'"color"'},On="move",gq={type:"literal",value:"move",description:'"move"'},Qn="align",iq={type:"literal",value:"align",description:'"align"'},Sn="zoom",kq={type:"literal",value:"zoom",description:'"zoom"'},Tn="highlight",lq={type:"literal",value:"highlight",description:'"highlight"'},
Un="clip",mq={type:"literal",value:"clip",description:'"clip"'},Rn="wait",jq={type:"literal",value:"wait",description:'"wait"'},Xn="opacity",oq={type:"literal",value:"opacity",description:'"opacity"'},$n="reset",pq={type:"literal",value:"reset",description:'"reset"'},co="finish",sq={type:"literal",value:"finish",description:'"finish"'},ao="distance",qq={type:"literal",value:"distance",description:'"distance"'},bo="target",rq={type:"literal",value:"target",description:'"target"'},zg=0,yj=[{line:1,
Pe:1,gi:!1}],Sh=0,Mj=[],Gg=0,qj;if("startRule"in Dj){if(!(Dj.Xs in eo))throw Error("Can't start parsing from rule \""+Dj.Xs+'".');fo=eo[Dj.Xs]}qj=fo();if(qj!==vg&&zg===pg.length)return qj;qj!==vg&&zg<pg.length&&tg({type:"end",description:"end of input"});throw function(pg,qg,rg,sg){function tg(og){var pg=1;for(og.sort(function(og,pg){return og.description<pg.description?-1:og.description>pg.description?1:0});pg<og.length;)og[pg-1]===og[pg]?og.splice(pg,1):pg++}function ug(og,pg){function qg(og){function pg(og){return og.charCodeAt(0).toString(16).toUpperCase()}
return og.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(og){return"\\x0"+pg(og)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(og){return"\\x"+pg(og)}).replace(/[\u0100-\u0FFF]/g,function(og){return"\\u0"+pg(og)}).replace(/[\u1000-\uFFFF]/g,function(og){return"\\u"+pg(og)})}var rg=Array(og.length),sg;for(sg=0;sg<og.length;sg++)rg[sg]=og[sg].description;rg=
1<og.length?rg.slice(0,-1).join(", ")+" or "+rg[og.length-1]:rg[0];sg=pg?'"'+qg(pg)+'"':"end of input";return"Expected "+rg+" but "+sg+" found."}null!==qg&&tg(qg);return new og(null!==pg?pg:ug(qg,rg),0,0,sg)}(null,Mj,Sh<pg.length?pg.charAt(Sh):null,Sh<pg.length?sg(Sh,Sh+1):sg(Sh,Sh));}}}();function Km(og){this.xz=Jm;this.ca=og;this.ub=[];new EventTarget(Km.prototype)}
Km.prototype.bA=function(og,pg){this.ub=this.xz.parse(og).slice(0);this.ub.add=this.ub.push;this.ub.remove=this.ub.shift;pg?this.Sq():(this.ub[0]instanceof Gm||this.ub.splice(0,0,new Gm),this.Hb({type:"commandParsed",data:this.ub}))};
Km.prototype.Sq=function(){if(0!==this.ub.length)for(var og=0;this.ub.length;og++){var pg=this.ub.remove();if(!1===pg)break;else void 0!==pg&&void 0!==pg.sb||console.warn("The command didn't return a class with execute function");if(pg instanceof zl){var qg=this;setTimeout(function(){qg.Sq()},pg.duration);break}else try{pg.sb(this.ca)}catch(rg){console.warn("Error on parsing script : "+rg+"\nOn stack : "+(rg.stack?rg.stack:"Unknown")+"\nComing from command "+pg.constructor.name);break}}};
function Lm(){this.div=Xk.ba().canvas;this.time=0;this.sq=this.Lk=this.eg=null;new EventTarget(Lm.prototype);this._listeners=[];this.Pi()}xg=Lm.prototype;
xg.Pi=function(){var og=this;$('<div id="scriptPlayerDiv"><table style="width:100%"><tr><td><button id="play">Play</button></td><td><button id="stop">Stop</button></td><td id="progressbar" style="width:90%"></td></tr></table></div>').css({position:"relative",top:"-50px",width:"95%","margin-left":"auto","margin-right":"auto"}).appendTo(this.div);this.bg=$("#scriptPlayerDiv");this.eg=$("#progressbar");this.Lk=$("#play");this.sq=$("#stop");setTimeout(function(){og.bg.fadeTo(1E3,0)},1E3);this.bg.on("mouseenter",
function(){og.bg.stop().fadeTo(500,1)});this.bg.on("mouseleave",function(){og.bg.stop().fadeTo(500,0)});this.eg.progressbar({value:!1});this.eg.bind("click",function(pg){pg=(pg.clientX-pg.currentTarget.offsetLeft-pg.currentTarget.offsetParent.offsetParent.offsetLeft)/pg.currentTarget.clientWidth;og.eg.progressbar("option","value",100*pg);og.Hb({type:"update",value:pg})});this.eg.bind("mousemove",function(pg){1===pg.buttons&&(pg=(pg.clientX-pg.currentTarget.offsetLeft-pg.currentTarget.offsetParent.offsetParent.offsetLeft)/
pg.currentTarget.clientWidth,og.eg.progressbar("option","value",100*pg),og.Hb({type:"update",value:pg}))});this.Lk.button({text:!1,label:"play",icons:{primary:"ui-icon-play"}}).click(function(){var pg;"play"===$(this).text()?(pg={label:"pause",icons:{primary:"ui-icon-pause"}},og.Hb("play")):(pg={label:"play",icons:{primary:"ui-icon-play"}},og.Hb("pause"));$(this).button("option",pg)});this.sq.button({text:!1,icons:{primary:"ui-icon-stop"}}).click(function(){og.Lk.button("option",{label:"play",icons:{primary:"ui-icon-play"}});
og.Hb("stop")});this.eg.find(".ui-progressbar-value")};xg.rz=function(){this.Lk.button("option",{label:"play",icons:{primary:"ui-icon-play"}})};xg.onProgress=function(og){this.eg.progressbar("option","value",100*og.data.progress)};xg.toggle=function(){this.bg.toggle()};xg.show=function(){this.bg.stop().fadeTo(0,1)};xg.hide=function(){this.bg.stop().fadeTo(0,0)};function Mm(og){this.parent=og;this.content=null;this.visible=!0}xg=Mm.prototype;
xg.show=function(){this.parent.Nr();this.content.show();this.visible=!0;var og=[];og.visible=!0;this.update(og)};xg.hide=function(){this.content.hide();this.visible=!1;var og=[];og.visible=!1;this.update(og);Xk.ba().ca.u.jf.Fl()};xg.toggle=function(){this.content.is(":visible")?this.hide():this.show()};xg.Kg=function(og,pg,qg){$(qg?'<option selected value="'+pg+'">'+pg+"</option>":'<option value="'+pg+'">'+pg+"</option>").appendTo(og)};
xg.Tp=function(og,pg){return""+('<input type="checkbox" id="widget'+og+'" title="'+pg+'">')+('<label class="hasMenu " for="widget'+og+'" title="'+pg+'">')+"</label>"};xg.update=function(){};function Nm(og){Mm.call(this,og);this.Fh=void 0;this.yd();this.xd()}Nm.prototype=Object.create(Mm.prototype);xg=Nm.prototype;xg.constructor=Nm;
xg.kz=function(og){void 0!=og&&og.blur();og=!1;var pg=$("#selectMap").text(),qg=null,rg;for(rg in this.ue.te){if(og){qg=rg;break}rg===pg&&(og=!0)}if(null===qg){for(var sg in this.ue.te)break;qg=sg}$("#selectMap").text(qg);this.Ql(qg)};xg.zz=function(og){void 0!=og&&og.blur();og=$("#selectMap").text();var pg=null,qg;for(qg in this.ue.te){if(null!=pg&&qg===og)break;pg=qg}$("#selectMap").text(pg);this.Ql(pg)};
xg.Ql=function(og){$("#mapping").empty();void 0===og&&(og="Atoms");$("selectMap").text()!==og&&$("#selectMap").text(og);"Atoms"===og||"Amino Acids"===og?this.Ok(og,4):"Nucleic Acids"===og?this.Ok(og,5):"Secondary Structure"===og?this.Ok(og,2):"Molecules"===og?this.Ok(og,4):"Rainbow"===og?this.Sv():"Hydrophobicity"===og?this.Zv():console.warn("Unknown legend mapping name : ",og)};
xg.Ok=function(og,pg){var qg=$('<table class="legend-array" style="display: inline-block;">'),rg,sg=this.ue.te[og],tg=0,ug=this,yg;for(yg in sg){0===tg%pg&&(rg=$("<tr></tr>"),rg.appendTo(qg));var Bg=$("<td></td>");Bg.appendTo(rg);var Cg=$('<div class="legend-mapping"></div>');Cg.appendTo(Bg);$('<input type="text" value="'+yg+'" readonly/>').appendTo(Cg);Bg='<div class="color-box" style="background-color:'+sg[yg]+';" data-mapping="'+og+'" data-mappingName="'+yg+'" data-color="'+sg[yg]+'"></div>';Bg=
$(Bg);Bg.click(function(){ug.Fh=$(this);ug.Yl.map=$(this).attr("data-mapping");ug.Yl.name=$(this).attr("data-mappingName");$("#mcp").minicolors("value",$(this).attr("data-color"));$("#mapColPick").show()});$(Bg).appendTo(Cg);tg++}qg.appendTo("#mapping")};
xg.Sv=function(){$('<span class="gradientLabelLeft">First</span><span class="gradientLabelRight">Last</span></br><canvas id="gradient"></canvas><br/>').appendTo("#mapping");$("#gradient").css({width:"90%",height:"20px",border:"1px solid #555"});for(var og=document.getElementById("gradient"),pg=og.getContext("2d"),qg=og.width,og=og.height,rg,sg=0;sg<qg;sg++)for(var tg=0;tg<og;tg++)rg="hsl("+sg+", 100%, 50%)",pg.fillStyle=rg,pg.fillRect(sg,tg,1,1)};
xg.Zv=function(){$('<span class="gradientLabelLeft">Hydrophilic</span><span class="gradientLabelRight">Hydrophobic</span></br><canvas id="gradient"></canvas><br/>').appendTo("#mapping");$("#gradient").css({width:"90%",height:"20px",border:"1px solid #555"});var og=document.getElementById("gradient"),pg=og.getContext("2d"),qg=og.width,og=og.height,rg=pg.createLinearGradient(0,0,qg,0);rg.addColorStop(0,this.ue.te.Hydrophobicity.Hydrophobic);rg.addColorStop(.5,"rgb(255,255,255)");rg.addColorStop(1,this.ue.te.Hydrophobicity.Hydrophilic);
pg.fillStyle=rg;pg.fillRect(0,0,qg,og)};
xg.yd=function(){this.content=$('<div id="legend"></div>');this.content.appendTo(this.parent.Ae);$('<button id="closeLegend" class="mapSelection">Close</button>').appendTo(this.content);$('<div id="mappingSelection" style="text-align: center;"></div><div id="mapping" style="text-align: center;"></div>').appendTo(this.content);$("#mappingSelection").css({color:"white",display:"inline-flex","justify-content":"center",width:"100%"});$('<button id="previousMapping" class="mapSelection">Previous</button><span id="selectMap" class="mapSelection"></span><button id="nextMapping" class="mapSelection">Next</button>').appendTo($("#mappingSelection"));$("#selectMap").css({width:"63%"});
this.toggle();this.Gv=$("#previousMapping");this.Fv=$("#nextMapping");this.ue=Ph.ba();var og=this;$("#previousMapping").css({width:"7%",right:"5px"});$("#nextMapping").css({width:"7%",left:"5px"});$("#closeLegend").button({text:!1,label:"Quit",icons:{primary:"ui-icon-close"}}).click(function(){og.hide()});$("#closeLegend").css({width:"15px",position:"absolute",right:"0px","margin-right":"10px"});this.Gv.button({text:!1,label:"Previous",icons:{primary:"ui-icon-triangle-1-w"}}).click(function(){og.zz(this);
$("#mapColPick").hide();og.Fh=void 0});this.Fv.button({text:!1,label:"Previous",icons:{primary:"ui-icon-triangle-1-e"}}).click(function(){og.kz(this);$("#mapColPick").hide();og.Fh=void 0});var pg=$(this.Tp("ResetButton","Reset")).button({text:!1,label:"Reset",icons:{primary:" ui-icon-arrowrefresh-1-e"}}).click(function(){og.ue.Sz();$("#mapColPick").hide();og.Ql();this.blur()}).css({width:"10%",height:"1em"}),qg=$(this.Tp("SaveButton","Save")).button({text:!1,label:"Save",icons:{primary:"ui-icon-arrowstop-1-s"}}).click(function(){og.ue.Wz();
this.blur()}).css({width:"10%",height:"1em"});qg.focus(function(){});pg.focus(function(){});qg.appendTo("#legend");pg.appendTo("#legend");$('<div id="mapColPick"><div id="mcp"></div></div>').appendTo(this.content);$("#mcp").minicolors({control:"hue",defaultValue:"#4fc8db",format:"hex",keywords:"",inline:"true",letterCase:"lowercase",position:"bottom left",swatches:[],change:function(pg){pg&&"object"===("undefined"===typeof console?"undefined":Vh(console))&&(og.ue.Xv(og.Yl.map,og.Yl.name,pg),void 0!==
og.Fh&&(og.Fh.css("background-color",pg),og.Fh.attr("data-color",pg)))}});$("#mapColPick").toggle();$("#mapColPick").hide()};xg.xd=function(){document.addEventListener("keypress",function(og,pg){return function(){return og.apply(pg,arguments)}}(function(og){108===og.which&&this.toggle()},this),!1);this.Ql();this.Yl={map:null,name:null,value:null}};
function Om(og){Mm.call(this,og);this.Cb=this.Pf=this.pd=null;this.mo=Ph.ba();this.dt=" (visible)";this.kq="All representations";this.mz="Click to select an object";this.enabled=!0;this.yd();this.xd();var pg=this;Xk.ba().addListener("sceneStateChanged",function(){if(pg.visible){var og=pg.Uf(),rg=pg.Ff(),sg=$("#objectSelection").html();pg.Cb=biovizAPI.Ic(sg,rg)[0];pg.Ah(rg,og);pg.$i()}})}Om.prototype=Object.create(Mm.prototype);xg=Om.prototype;xg.constructor=Om;
xg.Ff=function(){var og=$("input[type='radio'][name='radioSelectionLevel']:checked").attr("id"),og=og.replace("radioSelection","");return parseInt(og)};xg.Bp=function(og){0<og&&5>og&&(og="#radioSelection"+og,$(og)[0].checked=!0,$(og).button("refresh"))};xg.dn=function(og){og instanceof Rg&&($("#objectSelection").text(og.eb()),this.Bp(2),this.Cb=void 0,this.mt())};
xg.mt=function(){$("#reprcolorpicker").hide();var og=$("#objectSelection").html();if(biovizAPI.Fd(og.split(":")[0]))this.parent.ak("Representation management disabled for big bioassemblies"),$("#selectionLevel").buttonset({disabled:!0}),$("#repType").prop("disabled","disabled"),$("#col").prop("disabled","disabled"),$("#showhideRep").prop("disabled","disabled");else{var pg=this.Cb,qg=this.Ff(),rg=biovizAPI.Ic(og,qg)[0];this.parent.ak();$("#selectionLevel").buttonset({disabled:!1});$("#repType").prop("disabled",
!1);$("#col").prop("disabled",!1);$("#showhideRep").prop("disabled",!1);if(null!=pg)if(pg==rg)4>qg&&qg++;else{for(var sg=!1,tg=qg;pg.parent!=rg.parent&&0<qg;)if(qg--,pg=pg.parent,rg=rg.parent,null==pg||null==pg.parent){sg=!0;break}sg&&(qg=tg)}this.Bp(qg);this.Cb=rg=biovizAPI.Ic(og,qg)[0];this.Ah(qg)}};
xg.Ah=function(og,pg){if(void 0!=this.Cb){var qg=$("#objectSelection").html();this.Cb=biovizAPI.Ic(qg,og)[0];qg=this.Cb.tj();this.pd.html("<option selected>"+this.kq+"</option>");for(var rg in qg){var sg=qg[rg].name;if(biovizAPI.Dj([this.Cb],sg)){var tg=sg+this.dt;pg===sg?this.Kg(this.pd,tg,!0):this.Kg(this.pd,tg,!1)}else pg===sg?this.Kg(this.pd,sg,!0):this.Kg(this.pd,sg,!1)}}};xg.Uf=function(){return null!=this.pd.val()&&this.pd.val()!==this.kq?this.pd.val().replace(this.dt,""):null};
xg.$i=function(){var og=this.Ff(),pg=$("#objectSelection").html(),og=biovizAPI.Ic(pg,og)[0],pg=this.Uf();null==og||null==pg?$("#showhideRep").button({icons:{primary:" ui-icon-plus"},label:"Hide the representation"}):biovizAPI.Dj([og],pg)?$("#showhideRep").button({icons:{primary:" ui-icon-minus"},label:"Hide the representation"}):$("#showhideRep").button({icons:{primary:" ui-icon-plus"},label:"Show the representation"})};
xg.ev=function(){var og=this.Ff();1===og?$("#colPicker").minicolors("value","#D3D3D3"):2===og?$("#colPicker").minicolors("value","#"+this.mo.Hc(this.Cb.pa.id,"M").getHexString()):3===og?$("#colPicker").minicolors("value","#"+this.mo.Hc(this.Cb.bc.gb,"R").getHexString()):4===og&&(og=this.Cb.Xc,og=og.symbol.charAt(0).toUpperCase()+og.symbol.slice(1).toLowerCase(),$("#colPicker").minicolors("value","#"+this.mo.Hc(og,"A").getHexString()))};
xg.yd=function(){this.content=$('<div id="reprManagement"></div>');var og;og='<span id="managementTitle" class="mapSelection">Representation management</span><button id="closeManagementButton" class="mapSelection">Close</button>';var pg;pg=$("<div></div>");this.content.appendTo(this.parent.Ae);og=$(og);og.appendTo(pg);og=$("<div></div>");var qg='<button id="objectSelection"> '+this.mz+" </button> ",rg=$('<div id="selection"></div>');$(qg).appendTo($(rg));$('<div id="selectionLevel"><input type="radio" id="radioSelection1" name="radioSelectionLevel"><label for="radioSelection1" title="Structure">S</label><input type="radio" id="radioSelection2" name="radioSelectionLevel" checked="checked"><label for="radioSelection2" title="Molecule">M</label><input type="radio" id="radioSelection3" name="radioSelectionLevel"><label for="radioSelection3" title="Residue">R</label><input type="radio" id="radioSelection4" name="radioSelectionLevel"><label for="radioSelection4" title="Atom">A</label></div>').appendTo($(rg));
$(rg).appendTo(og);qg=$('<div id="selectDiv"></div>');$('<button id="showhideRep" class="mapSelection">Close</button>').appendTo(qg);this.pd=$('<select name="repType" id="repType" onfocus="this.selectedIndex = -1;"><option selected disabled>Representation</option></select>');this.Pf=$('<select name="col" id="col" onfocus="this.selectedIndex = 0;"><option selected disabled value="Coloration">Coloration</option></select>');this.Pf.keypress(function(){return!1});this.pd.appendTo(qg);this.pd.keypress(function(){return!1});
this.Pf.appendTo(qg);qg.appendTo(og);og.appendTo(pg);pg.appendTo(this.content);$('<div id="reprcolorpicker"><div id="colPicker"></div><button id="reprClosePicker" class="mapSelection">Close</button></div>').appendTo(this.content);$("#colPicker").minicolors({control:"hue",defaultValue:"#4fc8db",format:"hex",keywords:"",inline:"true",letterCase:"lowercase",position:"bottom left",swatches:[],change:function(og){og&&void 0!=sg.Cb&&biovizAPI.Pk(og,[sg.Cb],sg.Uf())}});$("#reprcolorpicker").toggle();$("#reprcolorpicker").hide();
$("#reprClosePicker").button({text:!1,label:"Quit",icons:{primary:"ui-icon-check"}}).click(function(){$("#reprcolorpicker").hide()});$("#reprcolorpicker").css({"align-self":"flex-end","float":"right"});$("#showhideRep").button({text:!1,label:"Show the representation",icons:{primary:"ui-icon-plus"}});$("#showhideRep").css({width:"5%",top:"3px"});this.toggle();var sg=this;$("#managementTitle").css({color:"white"});$("#closeManagementButton").button({text:!1,label:"Quit",icons:{primary:"ui-icon-close"}}).click(function(){sg.hide()});
$("#closeManagementButton").css({width:"15px",position:"absolute",right:"0px","margin-right":"10px"});$("#objectSelection").button().css({width:"63%",height:"20px"});$("#selectionLevel").buttonset().css({"margin-right":"0px",height:"100%",border:"0px"});$("#selection").css({"font-size":"0.7em",display:"flex","align-items":"stretch",width:"100%","margin-bottom":"2px"});$("#selectDiv").css({height:"20px",display:"flex","align-items":"stretch",width:"100%"});$("#repType").css({width:"60%"});this.pd.change(function(){var og=
sg.Uf();null===og||biovizAPI.Dj([sg.Cb],og)||biovizAPI.Tj([sg.Cb],og);sg.$i();var pg=sg.Ff();sg.Ah(pg,og);$('#col option[value="Coloration"]').prop("selected",!0);biovizAPI.Hb({type:"sceneStateChanged"})});this.Pf.change(function(){"Uniform color"===sg.Pf.val()?(sg.ev(),$("#reprcolorpicker").show()):($("#reprcolorpicker").hide(),biovizAPI.Pk(sg.Pf.val(),[sg.Cb],sg.Uf()))});$("#selectionLevel").change(function(){$("#reprcolorpicker").hide();var og=sg.Uf(),pg=sg.Ff(),qg=$("#objectSelection").html();
sg.Cb=biovizAPI.Ic(qg,pg)[0];sg.Ah(pg,og);null!=sg.Cb&&sg.$i();$('#col option[value="Coloration"]').prop("selected",!0)});$("#showhideRep").click(function(){var og=sg.Uf();if(null!=og){biovizAPI.Dj([sg.Cb],og)?biovizAPI.Or([sg.Cb],og):biovizAPI.Tj([sg.Cb],og);sg.$i();var pg=sg.Ff();sg.Ah(pg,og);biovizAPI.Hb({type:"sceneStateChanged"})}});pg=hi.za.Lx();for(var tg in pg)this.Kg(this.Pf,pg[tg],!1);this.Kg(this.Pf,"Uniform color",!1)};
xg.xd=function(){document.addEventListener("keypress",function(og,pg){return function(){return og.apply(pg,arguments)}}(function(og){114===og.which&&this.toggle()},this),!1)};xg.update=function(og){if(og.visible){var pg=this;og=pg.Uf();var qg=pg.Ff(),rg=$("#objectSelection").html();pg.Cb=biovizAPI.Ic(rg,qg)[0];pg.Ah(qg,og);pg.$i();Xk.ba().ca.u.jf.qr(function(og){null!=og&&($("#objectSelection").text(og.eb()),pg.mt(),$('#col option[value="Coloration"]').prop("selected",!0))})}};
function go(og){Mm.call(this,og);this.yd();this.xd()}go.prototype=Object.create(Mm.prototype);go.prototype.constructor=go;
go.prototype.yd=function(){var og=this;this.content=$('<div id="clippingWidget"></div>');var pg;pg='<div><span id="clippingTitle" class="mapSelection"> Clipping tool </span><button id="closeClippingButton" class="mapSelection">Close</button></div>';this.content.appendTo(this.parent.Ae);pg=$(pg);pg.appendTo(this.content);$('<div id="nearFarSliderTitle">Near / Far</div><div id="slider-range2" style="width:90%;"></div>').appendTo(this.content);this.hw=$("#slider-range2").css({margin:"0 auto"});this.hw.slider({orientation:"horizontal",
Lz:!0,step:.1,values:[0,100],slide:function(og,pg){Xk.ba().ca.u.cn(pg.values[0],pg.values[1])}});$("#clippingTitle").css({color:"white"});$("#nearFarSliderTitle").css({color:"white"});$("#closeClippingButton").button({text:!1,label:"Quit",icons:{primary:"ui-icon-close"}}).click(function(){og.hide()});$("#closeClippingButton").css({width:"15px",position:"absolute",right:"0px","margin-right":"10px"})};
go.prototype.xd=function(){document.addEventListener("keypress",function(og,pg){return function(){return og.apply(pg,arguments)}}(function(og){99===og.which&&this.toggle()},this),!1)};function ho(og){Mm.call(this,og);this.yd();this.xd()}ho.prototype=Object.create(Mm.prototype);ho.prototype.constructor=ho;
ho.prototype.yd=function(){var og=this;this.content=$('<div id="fogWidget"></div>');var pg;pg='<div><span id="fogTitle" class="mapSelection"> Fog tool </span><button id="closeFogButton" class="mapSelection">Close</button></div>';this.content.appendTo(this.parent.Ae);pg=$(pg);pg.appendTo(this.content);$('<div id="nearFarSliderFog">Near / Far</div><div id="slider-rangeFog" style="width:90%;"></div>').appendTo(this.content);this.hx=$("#slider-rangeFog").css({margin:"0 auto"});this.hx.slider({orientation:"horizontal",
Lz:!0,step:.1,values:[Ph.ba().Uq,100],slide:function(og,pg){Xk.ba().ca.u.xq(pg.values[0],pg.values[1])}});$("#fogTitle").css({color:"white"});$("#nearFarSliderFog").css({color:"white"});$("#closeFogButton").button({text:!1,label:"Quit",icons:{primary:"ui-icon-close"}}).click(function(){og.hide()});$("#closeFogButton").css({width:"15px",position:"absolute",right:"0px","margin-right":"10px"})};
ho.prototype.xd=function(){document.addEventListener("keypress",function(og,pg){return function(){return og.apply(pg,arguments)}}(function(og){110===og.which&&this.toggle()},this),!1)};
function io(og){Mm.call(this,og);this.PA="Star selection";this.uz="Pair selection";this.tq=" Click to select an atom ";this.ps=this.Go=null;this.yd();this.xd();var pg=this;Xk.ba().addListener("WidgetNotAvailableForBioassembly",function(){Xk.ba().ca.u.jf.Fl();pg.uf();pg.parent.ak("Measure widget is not available for big bioassemblies",5E3)})}io.prototype=Object.create(Mm.prototype);xg=io.prototype;xg.constructor=io;xg.mi=function(og){Xk.ba().ca.u.mi(og)};xg.uf=function(){Xk.ba().ca.u.uf()};xg.Jh=function(){Xk.ba().ca.u.Jh()};
xg.yd=function(){var og=this;this.content=$('<div id="measureWidget"></div>');var pg;pg='<div><span id="measureTitle" class="mapSelection"> Measuring tool </span><button id="closeMeasurementButton" class="mapSelection">Close</button></div>';this.content.appendTo(this.parent.Ae);pg=$(pg);pg.appendTo(this.content);var qg=$('<button id="clearMeasureButton"> Clear </button>');pg=$("<div></div>").css({display:"flex","justify-content":"center"});pg.appendTo(this.content);qg.appendTo(pg);qg=$('<radiogroup id="MeasurementTypeSelection"></radiogroup>');
qg.appendTo(pg);pg=$('<input type="radio" id="starSelection" name="radioSelectionMeasure" checked="checked">');pg.appendTo(qg);this.Go=$('<label id="starLabel" for="starSelection" title="starSelection" aria-pressed="true">'+this.PA+"</label>");this.Go.appendTo(qg);pg=$('<input type="radio" id="pairSelection" name="radioSelectionMeasure">');pg.appendTo(qg);this.ps=$('<label id="pairLabel" for="pairSelection" title="pairSelection">'+this.uz+"</label>");this.ps.appendTo(qg);$("#clearMeasureButton").button({text:!1,
label:"Clear",icons:{primary:" ui-icon-arrowrefresh-1-e"}}).css({height:"20px","font-size":"0.7em"}).click(function(){og.Jh()});this.Fo=$('<div id="starMeasureWidget"><button id="objectMeasurementSelection">'+this.tq+"</button></div>");this.wl=$('<div id="pairMeasureWidget"></div>');this.Fo.appendTo(this.content);this.wl.appendTo(this.content);this.wl.hide();$("#starLabel").click(function(){var pg=[];pg.visible=!0;og.update(pg);og.uf();og.Fo.show();og.wl.hide()});$("#pairLabel").click(function(){og.uf();
Xk.ba().ca.u.jf.Fl();og.Fo.hide();og.wl.show();og.mi()});$("#objectMeasurementSelection").button().css({width:"70%",height:"20px","font-size":"0.7em"}).click(function(){og.uf();var pg=[];pg.visible=!0;og.update(pg)});$("#MeasurementTypeSelection").buttonset().css({"font-size":"0.7em","margin-right":"0px",height:"100%",border:"0px"});$("#measureTitle").css({color:"white"});$("#closeMeasurementButton").button({text:!1,label:"Quit",icons:{primary:"ui-icon-close"}}).click(function(){og.hide()});$("#closeMeasurementButton").css({width:"15px",
position:"absolute",right:"0px","margin-right":"10px"})};xg.xd=function(){document.addEventListener("keypress",function(og,pg){return function(){return og.apply(pg,arguments)}}(function(og){109===og.which&&this.toggle()},this),!1)};xg.hide=function(){Mm.prototype.hide.call(this);this.uf()};
xg.update=function(og){var pg=this;$("#objectMeasurementSelection").text(this.tq);og.visible&&Xk.ba().ca.u.jf.qr(function(og){null!=og&&"true"==pg.Go.attr("aria-pressed")?(pg.mi(og),$("#objectMeasurementSelection").text(og.eb())):pg.mi();Xk.ba().ca.u.jf.Fl()})};function jo(og){Mm.call(this,og);this.yd();this.xd();this.og;this.Ng;this.ap="Asymmetric unit"}jo.prototype=Object.create(Mm.prototype);xg=jo.prototype;xg.constructor=jo;
xg.yd=function(){var og=this;this.content=$('<div id="baWidget"></div>');var pg="<div>",qg;qg=$('<select name="BASelected" id="BASelected"><option selected disabled> Choose a bioassembly </option></select>').css({width:"230px"});pg+='<span id="baTitle" class="mapSelection"> Bioassembly selection </span><button id="closeBaButton" class="mapSelection">Close</button></div>';this.content.appendTo(this.parent.Ae);pg=$(pg);pg.appendTo(this.content);pg=$('<div id="StructureSelect"></div>');this.og=$('<select name="structureSelected" id="structureSelected"><option selected disabled> Structure </option></select>');
this.og.appendTo(pg);this.Ng=qg;this.Ng.appendTo(pg);pg.appendTo(this.content);$("#baTitle").css({color:"white"});$("#closeBaButton").button({text:!1,label:"Quit",icons:{primary:"ui-icon-close"}}).click(function(){og.hide()});$("#closeBaButton").css({width:"15px",position:"absolute",right:"0px","margin-right":"10px"});$("#StructureSelect").css({height:"20px",display:"flex","align-items":"stretch",width:"100%"});this.og.change(function(){og.jt()});this.Ng.on("keydown keypress",function(og){og.preventDefault()});
this.Ng.change(function(){var pg=og.og.val(),qg=biovizAPI.sj(pg),tg=og.Ng.val();null===qg[1].get(tg)?biovizAPI.kg(pg):biovizAPI.kg(pg,tg)})};
xg.jt=function(){var og=this.og.val();this.Ng.html("<option selected disabled> Choose a bioassembly </option>");if(void 0!=og){var pg=biovizAPI.sj(og),qg=pg[1],rg=qg.keys(),og='<option value="'+this.ap+'">'+this.ap+"</option>",sg;for(sg in rg){var tg=rg[sg],ug=pg[0].get(tg)[0],yg=ug[0].length;void 0!==ug[1]&&(yg*=ug[1].length);og+='<option value="'+tg+'">'+tg+". "+qg.get(tg)+" ("+yg+" subunit)</option>"}$(og).appendTo(this.Ng)}};
xg.nt=function(){var og=biovizAPI.xj();0===og.length?this.og.html("<option selected disabled> Structure </option>"):this.og.html("");for(var pg=0;pg<og.length;pg++)this.Kg(this.og,og[pg],!1);this.jt()};xg.xd=function(){var og=this;document.addEventListener("keypress",function(og,qg){return function(){return og.apply(qg,arguments)}}(function(og){97===og.which&&this.toggle()},this),!1);Xk.ba().addListener("sceneStateChanged",function(){og.visible&&og.nt()})};xg.update=function(og){og.visible&&this.nt()};
function ko(og){this.canvas=Xk.ba().canvas;this.ti=new Map;this.Ae=$('<div id="widgets"></div>').css({position:"absolute",top:"5px",right:"0px","text-align":"center",opacity:"0.9",width:"300px"});this.Ae.appendTo(this.canvas);for(var pg in ko.pq)(1==og||og instanceof Array&&og.includes(pg.toLowerCase()))&&this.ti.set(pg,new ko.pq[pg](this));this.ga=Ph.ba();this.hs=$('<div id="widgetMessage"></div>');this.hs.appendTo(this.Ae);this.Nr();this.So=null}xg=ko.prototype;
xg.update=function(og,pg){var qg=!0,rg=!1,sg=void 0;try{for(var tg=this.ti.values()[Symbol.iterator](),ug;!(qg=(ug=tg.next()).done);qg=!0)ug.value.update(og,pg)}catch(yg){rg=!0,sg=yg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}};
xg.Nr=function(){this.ak();var og=!0,pg=!1,qg=void 0;try{for(var rg=this.ti.values()[Symbol.iterator](),sg;!(og=(sg=rg.next()).done);og=!0)sg.value.hide()}catch(tg){pg=!0,qg=tg}finally{try{!og&&rg["return"]&&rg["return"]()}finally{if(pg)throw qg;}}};xg.Jc=function(og){return this.ti.get(og)};xg.Uj=function(og){this.ti.has(og)&&this.ti.get(og).show(!0)};xg.show=function(){this.Ae.show()};xg.hide=function(){this.Ae.hide()};
xg.ak=function(og,pg){var qg=this.ga.zr();$("#widgetMessage").css("color",qg);this.hs.html(og||"");if(null!=pg&&null==this.So){var rg=this;this.So=setTimeout(function(){rg.ak();rg.So=null},pg)}};ko.pq={Legend:Nm,Representation:Om,Fog:ho,Clipping:go,Measurements:io,Bioassembly:jo};
function Xk(){if("object"===Vh(Xk.Qi))return Xk.Qi;Xk.Qi=this;this.canvas=null;this.Vo="https://pdb.bionext.com/pdbx/${id}";this.load=this.Xg=!0;new EventTarget(Xk.prototype);this.wo=this.ca=null;this.canvas=$('<div id="content"></div>').css({tabindex:"0","z-index":"0",width:"100%",height:"100%",overflow:"hidden"});this.ob=this.contextMenu=this.Sd=null;this.ga=Ph.ba()}Xk.ba=function(){return new Xk};xg=Xk.prototype;
xg.zo=function(og,pg){"urlTemplate"===og?(pg.startsWith("//")&&(pg=window.location.protocol+pg),this.Vo=pg):"loadPDBX"===og?this.Xg=pg:console.warn("Can't change unexisting option : "+og)};xg.fi=function(){this.Hb({type:"sceneStateChanged"})};xg.bt=function(og){this.Hb({type:"targetChanged",data:og})};xg.Zs=function(og){this.Hb({type:"structureLoaded",data:og})};xg.zy=function(){$("#bionextlogo").fadeTo(2E3,.6)};
xg.Oc=function(og,pg,qg){var rg=this.al(),sg=$("#loadBar"),tg=$("#loadLabel"),ug=$("#imgLoader"),yg=$("#cancelCall"),Bg=this.ga.zr();0==sg.length&&(ug=$('<img class="noselect" src="img/loader.gif" id="imgLoader" alt="loader">').css({display:"inline-block"}),yg=$('<button type="button" id="cancelCall"><b>Cancel</b></button>').css({display:"inline-block"}).click(qg),tg=$('<div id="loadLabel" class="noselect"> </div>').css({display:"inline-block",color:Bg,"font-size":"100%"}),sg=$('<div id="loadBar"> </div>').css({position:"absolute",
top:"2%",right:"0px"}),tg.appendTo(sg),ug.appendTo(sg),yg.appendTo(sg),sg.appendTo(rg));this.et&&clearTimeout(this.et);void 0==og?sg.hide():(sg.show(),pg?ug.show():ug.hide(),qg?(yg.unbind().click(qg),yg.show()):yg.hide(),tg.text(og),pg||(this.et=setTimeout(function(){$("#loadBar").hide()},6E3)))};xg.Zm=function(og){this.Hb({type:"atomMouseOver",data:og})};xg.pn=function(og){this.wo.bA(og,null==this.Sd)};xg.al=function(){return this.canvas};
xg.sz=function(og){if(null!=this.contextMenu){if(this.contextMenu.menu.getMenu()[0].parentElement!==this.jn[0]){og.as=!0;var pg=this.Tq.offset();og.pageX+=pg.left;og.pageY+=pg.top}else og.as=!1;this.contextMenu.div.contextmenu("open",this.vw,og)}};xg.gn=function(){null!=this.contextMenu&&this.contextMenu.div.contextmenu("close")};
xg.Pi=function(){if(!THREE.Detector.webgl)return THREE.Detector.addGetWebGLMessage({parent:this.canvas[0]}),!1;this.ca=new dm;this.wo=new Km(this.ca);this.yc=this.ca.u.yc;var og=this;$('<div id="bionextlogo" class="noselect"><img src="img/logo.png" alt="Bionext Logo" width="100%" /></div>').css({position:"absolute",top:"10px",width:"30%","max-width":"400px","margin-left":"10px","margin-right":"auto"}).appendTo(this.canvas);setTimeout(function(){og.zy()},4E3);this.Ju();return!0};
xg.Ju=function(){var og=this;this.wo.addListener("commandParsed",function(pg){og.yc.Tu(pg)})};xg.Hn=function(og){this.contextMenu=new fl($(document.body),og);this.vw=$(".hasContextMenu:first");this.jn=this.contextMenu.div;this.Tq=this.Vk=null};xg.On=function(og){this.ob=new ko(og)};
xg.Nn=function(){var og=this;this.Sd=new Lm;this.yc.addListener("timeChanged",function(pg){og.Sd.onProgress(pg)});this.yc.addListener("endScript",function(){og.Sd.rz()});this.Sd.addListener("play",function(){og.yc.play()});this.Sd.addListener("pause",function(){og.yc.pause()});this.Sd.addListener("stop",function(){og.yc.stop()});this.Sd.addListener("update",function(pg){og.yc.ns(pg)})};xg.Ws=function(og){og?$("#scriptPlayerDiv").css({top:"-50px"}):$("#scriptPlayerDiv").css({top:"50px"})};
function gl(og,pg){wi.call(this);this.$n=!0;this.la=og;this.vf=pg;this.Fa=new ii;this.updateMatrixWorld();this.fa=[];for(var qg=this.la.Dg,rg=0;rg<qg.length;rg++){var sg=qg[rg];if(sg.Wh()||sg.Yh())this.fa=this.fa.concat(sg.Qa())}}gl.prototype=Object.create(wi.prototype);gl.prototype.constructor=gl;Gi.add(gl,[ih.tm,ih.zp,ih.bm,ih.Zo,ih.jk,ih.mp,ih.cm,ih.$o]);xg=gl.prototype;xg.tb=function(){return this.vf.tb()};
xg["delete"]=function(){wi.prototype["delete"].call(this);for(var og=this.Fa.values(),pg=0,qg=og.length;pg<qg;pg++)og[pg]["delete"]();this.parent.remove(this)};xg.show=function(og){var pg=this;if(void 0==og)this.visible=!0,this.jb=this.tb().visible=!0;else return-1!==this.wn().indexOf(og)?wi.prototype.show.call(this,og):function rg(sg){return(new Promise(function(rg){var tg=pg.Fa.get(pg.Fa.keys()[sg]);setTimeout(function(){tg.show(og);rg(sg+1)},40)})).then(function(og){if(og<pg.Fa.keys().length)return rg(og)})}(0).then(function(){return new Promise(function(og){og()})})};
xg.hide=function(og){if(void 0==og)this.visible=!1,this.tb().visible=!1,this.jb=!0;else if(-1!==this.wn().indexOf(og))wi.prototype.hide.call(this,og);else for(var pg=0;pg<this.Fa.keys().length;pg++)this.Fa.get(this.Fa.keys()[pg]).hide(og)};xg.pl=function(og){var pg=!0,qg=this.hb(og);if(null!=qg&&-1!==this.wn().indexOf(og)&&null!=qg)return qg.visible;for(var qg=this.Fa.keys(),rg=0;rg<qg.length&&(pg=this.Fa.get(qg[rg]).pl(og),pg);rg++);return pg};xg.Gc=function(){return this.tb().Gc()};
xg.wb=function(){return this.tb().wb(0<arguments.length&&void 0!==arguments[0]?arguments[0]:!1)};
xg.nr=function(){var og=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!1,pg=new Hg,qg=!1,rg=!0,sg=!1,tg=void 0;try{for(var ug=this.Fa.values()[Symbol.iterator](),yg;!(rg=(yg=ug.next()).done);rg=!0){var Bg=yg.value;if(Bg.Fj()||og){var qg=!0,Cg=Bg.wb(og).clone();Cg.applyMatrix4(Bg.matrix);pg=pg.merge(Cg)}}}catch(Ag){sg=!0,tg=Ag}finally{try{!rg&&ug["return"]&&ug["return"]()}finally{if(sg)throw tg;}}qg||(pg=this.wb(!0));return pg};
xg.Fj=function(){if(this.visible){var og=!0,pg=!1,qg=void 0;try{for(var rg=this.Fa.values()[Symbol.iterator](),sg;!(og=(sg=rg.next()).done);og=!0)if(sg.value.Fj())return!0}catch(tg){pg=!0,qg=tg}finally{try{!og&&rg["return"]&&rg["return"]()}finally{if(pg)throw qg;}}}return!1};xg.toString=function(){return this.la.Ua.Jm};xg.nc=function(){return this.toString()};
xg.pr=function(og){var pg=this.Fa.keys();if("undefined"==og.split(":")[1]){for(var qg=[],rg=0;rg<pg.length;rg++){var sg=pg[rg];sg.toString().split(":")[0]===og.split(":")[0]&&qg.push(this.Fa.get(sg))}return qg}for(rg=0;rg<pg.length;rg++)if(sg=pg[rg],sg.toString()===og)return this.Fa.get(sg)};xg.cc=function(){for(var og=[],pg=this.Fa.keys(),qg=0;qg<pg.length;qg++)og.push(this.Fa.get(pg[qg]));return og};xg.Bb=function(og){var pg=this.Fa.get(og);void 0===pg&&(pg=new Tk(this,og),this.Fa.set(og,pg));return pg};
xg.reset=function(){this.visible=!0;this.Od();this.lf();this.mf();this.ah()};
xg.ah=function(){var og=this.cc(),pg=!0,qg=!1,rg=void 0;try{for(var sg=og[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0){var ug=tg.value;ug.yb(!1);var yg=ug.qd.values(),og=!0,Bg=!1,Cg=void 0;try{for(var Ag=yg[Symbol.iterator](),wg;!(og=(wg=Ag.next()).done);og=!0){var Dg=wg.value;Dg.yb(!1);var Eg=Dg.ge.values(),Fg=!0,Jg=!1,Ig=void 0;try{for(var Lg=Eg[Symbol.iterator](),Kg;!(Fg=(Kg=Lg.next()).done);Fg=!0)Kg.value.yb(!1)}catch(Mg){Jg=!0,Ig=Mg}finally{try{!Fg&&Lg["return"]&&Lg["return"]()}finally{if(Jg)throw Ig;
}}}}catch(Mg){Bg=!0,Cg=Mg}finally{try{!og&&Ag["return"]&&Ag["return"]()}finally{if(Bg)throw Cg;}}}}catch(Mg){qg=!0,rg=Mg}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}};xg.lf=function(){this.matrix.identity();this.matrixWorldNeedsUpdate=!0;for(var og=this.cc(),pg=0;pg<og.length;pg++)og[pg].lf()};xg.mf=function(){this.Od();var og=this.cc();this.show();for(var pg=0;pg<og.length;pg++)og[pg].reset()};
xg.clone=function(og,pg){var qg=wi.prototype.clone.call(this,this.la,og),rg=this.bd.keys(),sg;for(sg in rg){var tg=rg[sg];null==tg.da||tg.da instanceof Array||(tg=tg.da.clone(!1),qg.add(tg))}rg=!0;sg=!1;tg=void 0;try{for(var ug=this.Fa.values()[Symbol.iterator](),yg;!(rg=(yg=ug.next()).done);rg=!0){var Bg=yg.value;if(0<=pg.indexOf(Bg.pa.co)){var Cg=Bg.clone(qg);qg.Fa.set(Bg.pa,Cg)}}}catch(Ag){sg=!0,tg=Ag}finally{try{!rg&&ug["return"]&&ug["return"]()}finally{if(sg)throw tg;}}return qg};
xg.gc=function(og,pg,qg,rg){var sg,tg;if(og instanceof Sl||void 0==og)switch(og=this.la.Ua,pg){case void 0:case gl.Ia.om:this.Ub(og,og.toString(),og.xb(),this,qg,rg);break;case gl.Ia.oc:og=this.Fa.keys();for(var ug in og)tg=this.Fa.get(og[ug]),this.Ub(tg.pa,tg.pa.toString(),tg.pa.xb(),tg,qg,rg);break;case gl.Ia.Ud:og=this.Fa.keys();for(ug in og){tg=this.Fa.get(og[ug]);pg=tg.pa.ka;for(var yg=0;yg<pg.length;yg++)sg=pg[yg],this.Ub(sg,sg.toString(),sg.bl(),tg,qg,rg)}break;case gl.Ia.Fb:case gl.Ia.Vd:for(ug in og=
this.Fa.keys(),og)for(tg=this.Fa.get(og[ug]),sg=tg.pa.Qa(),yg=0;yg<sg.length;yg++){var Bg=sg[yg];pg===gl.Ia.Fb?this.Ub(Bg,Bg.toString(),Bg.xb(),tg,qg,rg):this.Ub(Bg,Pg.bf(Bg.symbol)[7],Bg.xb(),tg,qg,rg)}}else if(og instanceof fh)switch(pg){case gl.Ia.Fb:case gl.Ia.Vd:sg=og.Qa();tg=this.Bb(og);for(ug=0;ug<sg.length;ug++)Bg=sg[ug],pg===gl.Ia.Fb?this.Ub(Bg,Bg.toString(),Bg.xb(),tg,qg,rg):this.Ub(Bg,Pg.bf(Bg.symbol)[7],Bg.xb(),tg,qg,rg);break;case gl.Ia.Ud:pg=og.ka;tg=this.Bb(og);for(ug=0;ug<pg.length;ug++)sg=
pg[ug],this.Ub(sg,sg.toString(),sg.bl(),tg,qg,rg);break;case gl.Ia.oc:case void 0:tg=this.Bb(og),this.Ub(og,og.toString(),og.xb(),tg,qg,rg)}else if(og instanceof Rl)switch(pg){case void 0:case gl.Ia.Ud:tg=this.Bb(og.Ja());this.Ub(og,og.toString(),og.bl(),tg,qg,rg);break;case gl.Ia.Fb:case gl.Ia.Vd:for(tg=this.Bb(og.Ja()),sg=og.Qa(),ug=0;ug<sg.length;ug++)Bg=sg[ug],pg===gl.Ia.Fb?this.Ub(Bg,Bg.toString(),Bg.xb(),tg,qg,rg):this.Ub(Bg,Pg.bf(Bg.symbol)[7],Bg.xb(),tg,qg,rg)}else if(og instanceof Rg)switch(pg){case void 0:case gl.Ia.Fb:case gl.Ia.Vd:tg=
this.Bb(og.$a.Ja()),pg===gl.Ia.Fb||void 0===pg?this.Ub(og,og.toString(),og.xb(),tg,qg,rg):this.Ub(og,Pg.bf(og.symbol)[7],og.xb(),tg,qg,rg)}};xg.Hd=function(){return this.vf.Hd()};xg.tj=function(){for(var og=[],pg=Gi.get(Tk),qg=0;qg<pg.length;qg++)og.push(pg[qg]);return og};xg.wn=function(){for(var og=[],pg=Gi.get(this),qg=0;qg<pg.length;qg++)og.push(pg[qg]);return og};
xg.Zu=function(){Xk.ba().Oc("Loading 3D Representations...",!0);var og=this.cc(),pg=og.length;return function rg(sg){return(new Promise(function(pg){var rg=og[sg];setTimeout(function(){rg.Ul();pg(sg+1)},40)})).then(function(og){if(og<pg)return rg(og)})}(0).then(function(){return new Promise(function(og){Xk.ba().Oc();og()})})};gl.Ia={om:"structure",oc:"molecule",Ud:"residue",Fb:"atom",Vd:"vdw"};function lo(og){wi.call(this);this.kc=[];this.Yj=og}lo.prototype=Object.create(wi.prototype);xg=lo.prototype;
xg.constructor=lo;xg.tb=function(){return this.Yj};xg["delete"]=function(){for(var og=0;og<this.kc.length;og++)this.kc[og]["delete"]()};xg.mv=function(og){var pg=new gl(og,this);this.kc.push(pg);this.add(pg);og=og.Dg;for(var qg=og.length,rg=0;rg<qg;rg++)pg.Bb(og[rg])};xg.Hd=function(){var og=this.tb();return og.Wb.get(og.Oe)===this||null==og.Oe&&og.ee===this};xg.reset=function(){this.visible=!0;this.matrix.identity();this.matrixWorldNeedsUpdate=!0;this.kc[0].reset()};
function em(og){wi.call(this);this.ia=og;this.Wb=new Map;this.ee=new lo(this);this.add(this.ee);this.ee.mv(this.ia.gl())}em.prototype=Object.create(wi.prototype);xg=em.prototype;xg.constructor=em;xg.af=function(){return this.ia._id};xg.toString=function(){return this.ia.Jm};
xg.wb=function(){var og=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!1,pg=new Hg;if(void 0===this.Oe)pg=this.Ea().nr(og);else for(var og=this.Wb.get(this.Oe),qg=0;qg<og.kc.length;qg++){var rg=og.kc[qg],sg=rg.nr(!0).clone();sg.applyMatrix4(rg.matrix);pg=pg.merge(sg)}return pg};xg.Gc=function(){return this.wb(0<arguments.length&&void 0!==arguments[0]?arguments[0]:!1).getCenter()};xg.Fj=function(){return this.Ea().Fj()};xg.Ea=function(){return this.ee.kc[0]};xg.mf=function(){this.Ea().mf()};
xg.ah=function(){this.Ea().ah()};xg.ox=function(){var og=[];og.push(this.ee.kc[0]);var pg=!0,qg=!1,rg=void 0;try{for(var sg=this.Wb.keys()[Symbol.iterator](),tg;!(pg=(tg=sg.next()).done);pg=!0)og=og.concat(this.Wb.get(tg.value).kc)}catch(ug){qg=!0,rg=ug}finally{try{!pg&&sg["return"]&&sg["return"]()}finally{if(qg)throw rg;}}return og};
xg["delete"]=function(){this.ee["delete"]();var og=!0,pg=!1,qg=void 0;try{for(var rg=this.Wb.keys()[Symbol.iterator](),sg;!(og=(sg=rg.next()).done);og=!0)this.Wb.get(sg.value)["delete"]()}catch(tg){pg=!0,qg=tg}finally{try{!og&&rg["return"]&&rg["return"]()}finally{if(pg)throw qg;}}this.parent.remove(this)};xg.reset=function(){this.visible=!0;this.matrix.identity();this.matrixWorldNeedsUpdate=!0;this.kg();this.ee.reset()};
xg.lf=function(){this.matrix.identity();this.matrixWorldNeedsUpdate=!0;for(var og=this.ox(),pg=0;pg<og.length;pg++)og[pg].lf()};xg.sj=function(){return[this.ia.Af,this.ia.rh,this.ia.Bf]};
xg.kg=function(og){void 0===this.Oe?this.ee.visible=!1:this.Wb.get(this.Oe).visible=!1;this.Oe=og;if(void 0===og)this.ee.visible=!0;else if(void 0===this.Wb.get(og)){var pg=new lo(this);this.Wb.set(og,pg);this.add(pg);var qg=this.ia.Af,rg=this.ia.Bf,sg=qg.get(og)[0];og=qg.get(og)[1];if(1===sg.length)for(qg=0;qg<sg[0].length;qg++){var tg=this.Kp(pg,og,rg.get(sg[0][qg]));pg.kc.push(tg);pg.add(tg)}else if(2===sg.length)for(qg=0;qg<sg[1].length;qg++)for(tg=0;tg<sg[0].length;tg++){var ug=this.Kp(pg,og,
rg.get(sg[1][qg]),rg.get(sg[0][tg]));pg.kc.push(ug);pg.add(ug)}}else this.Wb.get(og).visible=!0};xg.Kp=function(og,pg,qg,rg){og=this.ee.kc[0].clone(og,pg);pg=new THREE.Matrix4;pg.set.apply(pg,Wh(qg).concat([0,0,0,1]));if(void 0!==rg){var sg;qg=(sg=new THREE.Matrix4).set.apply(sg,Wh(rg).concat([0,0,0,1]));pg.multiplyMatrices(qg,pg)}og.matrix=pg;og.updateMatrixWorld(!0);og.matrixWorldNeedsUpdate=!0;return og};
xg.bB=function(og){var pg,qg;if(og instanceof Tk)pg=og;else if(og instanceof Sk)pg=og.Ij;else if(og instanceof Rk)pg=og.$h.Ij;else if(og instanceof gl){pg=!0;var rg=!1,sg=void 0;try{for(var tg=this.Wb.keys()[Symbol.iterator](),ug;!(pg=(ug=tg.next()).done);pg=!0){var yg=ug.value;qg=this.Wb.get(yg);for(var Bg=0;Bg<qg.kc.length;Bg++){var Cg=qg.kc[Bg];this.Fd(yg)||og.uuid===Cg.uuid||og.Ik(Cg)}}}catch(Fh){rg=!0,sg=Fh}finally{try{!pg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}return}tg=!0;ug=
!1;yg=void 0;try{for(rg=this.Wb.keys()[Symbol.iterator]();!(tg=(sg=rg.next()).done);tg=!0)if(Bg=sg.value,!this.Fd(Bg))for(qg=this.Wb.get(Bg),Cg=0;Cg<qg.kc.length;Cg++){for(var Ag=qg.kc[Cg],wg=Ag.Fa.keys(),Dg=void 0,Eg=0;Eg<wg.length;Eg++){var Fg=Ag.Fa.get(wg[Eg]);if(Fg!==og&&Fg.pa.eb()===pg.pa.eb()){Dg=Fg;break}}if(void 0!=Dg)if(og instanceof Tk)og.Ik(Dg);else{var Jg;og instanceof Sk?Jg=og:og instanceof Rk&&(Jg=og.$h);for(var Ig=Dg.qd.keys(),Eg=void 0,Lg=0;Lg<Ig.length;Lg++){var Kg=Dg.qd.get(Ig[Lg]);
if(Kg.uuid!==og.uuid&&Kg.bc.eb()===Jg.bc.eb()){if(og instanceof Sk)og.Ik(Kg);else if(og instanceof Rk){for(var Mg=Kg.ge.keys(),Og=void 0,Sg=0;Sg<Mg.length;Sg++){var Qg=Kg.ge.get(Mg[Sg]);if(Qg.uuid!==og.uuid&&Qg.Xc.eb()===og.Xc.eb()){Og=Qg;og.Ik(Qg);break}}if(void 0==Og){var vh=og.clone(Kg);Kg.add(vh);Kg.ge.set(vh.Xc,vh)}}Eg=Kg}}if(void 0==Eg){var dh=Jg.clone(Dg);Dg.add(dh);Dg.qd.set(Jg.bc,dh)}}else if(og instanceof Tk){var di=pg.clone(Ag);Ag.Fa.set(pg.pa,di)}}}catch(Fh){ug=!0,yg=Fh}finally{try{!tg&&
rg["return"]&&rg["return"]()}finally{if(ug)throw yg;}}};xg.Vn=function(){return void 0!==this.Oe};
xg.Fd=function(og){if(null==og&&null==this.Oe)return!1;null==og&&(og=this.Oe);if(null!=this.Wb.get(og)&&null!=this.Wb.get(og).Xr)return this.Wb.get(og).Xr;var pg,qg=this.ia.Af,rg=qg.get(og)[0],qg=qg.get(og)[1],sg=0,tg=0;1===rg.length?sg=rg[0].length:2===rg.length&&(sg=rg[0].length*rg[1].length);var rg=!0,ug=!1,yg=void 0;try{pg=this.Ea().Fa.values()[Symbol.iterator]();for(var Bg;!(rg=(Bg=pg.next()).done);rg=!0){var Cg=Bg.value;0<=qg.indexOf(Cg.pa.co)&&(tg+=Cg.fa.length)}}catch(Ag){ug=!0,yg=Ag}finally{try{!rg&&
pg["return"]&&pg["return"]()}finally{if(ug)throw yg;}}pg=5<sg&&2E5<tg*sg;null!=this.Wb.get(og)&&(this.Wb.get(og).Xr=pg);return pg};var mo={},no;for(no in ih)"function"!=typeof ih[no]&&(mo[ih[no].xv]=ih[no].name);
var oo={STRUCTURE:gl.Ia.om,MOLECULE:gl.Ia.oc,RESIDUE:gl.Ia.Ud,ATOM:gl.Ia.Fb,VDW:gl.Ia.Vd},po={Molecule:hi.za.oc.name,Residue:hi.za.Ud.name,Atom:hi.za.Fb.name,CarbonAtom:hi.za.hp.name,HeteroAtom:hi.za.jp.name,SST:hi.za.tp.name,Rainbow:hi.za.rp.name,Hydrophobicity:hi.za.kp.name},qo={PROTEIN:fh.ea.Td,PEPTIDE:fh.ea.vg,SMALL_PEPTIDE:fh.ea.wg,RNA:fh.ea.Ai,DNA:fh.ea.wi,LIGAND:fh.ea.xi,ION:fh.ea.lp,SOLVENT:fh.ea.sp,UNKNOWN:fh.ea.rm};function ro(){}xg=ro.prototype;xg.xw=function(){Xk.ba()};
xg.Ey=function(){this.gu=Xk.ba().Pi();this.ca=Xk.ba().ca};xg.Hn=function(og){Xk.ba().Hn(og)};xg.On=function(og){Xk.ba().On(og)};xg.Nn=function(){Xk.ba().Nn()};xg.Ky=function(){return this.gu};xg.wu=function(){this.ca.ga.Vh=!1};xg.Yu=function(og){this.ca.Lo=og};xg.jA=function(og){Xk.ba().contextMenu.moveTo(og);Xk.ba().Vk=og;Xk.ba().Tq=og.find("#biovizFrame")};xg.al=function(){return Xk.ba().al()};xg.Xu=function(og){this.ca.Nq=og};xg.Hb=function(og){Xk.ba().Hb(og)};xg.Ie=function(og){return this.ca.u.Px(og)};
xg.uh=function(og){og=this.Ie(og);if(void 0!=og)var pg=og.Ea();return pg};xg.Ji=function(og,pg){var qg=this.uh(og);if(void 0!==qg)if(pg.includes("Proteinic"))for(var rg=["Protein","Peptide","Small Peptide"],sg=0,tg=rg.length;sg<tg;sg++){var ug=qg.pr(pg.replace("Proteinic",rg[sg]));if(null!=ug)return ug}else return qg.pr(pg)};xg.Ki=function(og,pg,qg){og=this.Ji(og,pg);if(void 0!==og)return og.ic(qg,!0)};xg.Sp=function(og,pg,qg,rg){og=this.Ki(og,pg,qg);if(void 0!==og)return og.le(rg,!0)};
xg.Ee=function(og){var pg,qg;for(qg in ih){var rg=ih[qg];if(rg.name===og){pg=rg;break}}if(!pg)throw"Can't find RepresentationType corresponding to representationTypeID : "+og;return pg};xg.Cp=function(og){if(1<og.length)throw Error("Selection must contain a single object");og=og[0];if(og instanceof Tk)return og;throw Error("Selection must contain a only a molecule");};
xg.Dp=function(og){if(1<og.length)throw Error("Selection must contain a single object");og=og[0];if(og instanceof wi)return og;throw Error("Selection must contain a only a molecule");};xg.um=function(og){var pg=this;if(og instanceof Error)return Promise.reject(og.message);Xk.ba().Oc("Creating scene");return this.ca.Em(og).then(function(og){pg.ca.kd(og,!0);pg.ca.u.zc(og);return og.ia._id})["catch"](function(og){return og})};
xg.Jx=function(og){if(og instanceof gl)return qo.rm;if(og instanceof Tk)return og.pa.ja;if(og instanceof Sk)return og.bc.Ja().ja;if(og instanceof Rk)return og.Xc.wa().Ja().ja};
xg.Ic=function(og,pg){var qg=null,rg=og.split(":"),sg,tg,ug;5<rg.length&&(ug=rg[5]+":"+rg[6],null==pg&&(pg=4));3<rg.length&&(tg=rg[3]+":"+rg[4],null==pg&&(pg=3));1<rg.length&&(sg=rg[1]+":"+rg[2],null==pg&&(pg=2));rg=rg[0];null==pg&&(pg=1);switch(pg){case 1:qg=this.uh(rg);break;case 2:qg=this.Ji(rg,sg);break;case 3:qg=this.Ki(rg,sg,tg);break;case 4:qg=this.Sp(rg,sg,tg,ug)}null!=qg?Array.isArray(qg)||(qg=[qg]):qg=[];return qg};
xg.tj=function(og){var pg=null;if(void 0==og)pg=Gi.get(Tk);else{if(void 0==og[0]||og[0]instanceof gl&&og[0].tb().Fd()||og[0]instanceof Tk&&og[0].Ea().tb().Fd()||og[0]instanceof Sk&&og[0].Bb().Ea().tb().Fd()||og[0]instanceof Rg&&og[0].ic().Bb().Ea().tb().Fd())return[];pg=og[0].tj()}return pg.map(function(og){return{name:og.name,commandName:og.Cq}})};xg.eo=function(og,pg){this.Cp(og).pa.eo(pg)};xg.mf=function(){this.ca.u.mf()};xg.Tz=function(){this.ca.u.ah()};xg.Ll=function(){this.ca.u.Ll()};
xg.Uz=function(){this.ca.u.reset()};
xg.yb=function(og){function pg(og){(og instanceof Tk||og instanceof Sk||og instanceof Rk)&&og.yb(qg,rg)}var qg=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,rg=null,sg=!0,tg=!1,ug=void 0;try{for(var yg=og[Symbol.iterator](),Bg;!(sg=(Bg=yg.next()).done);sg=!0){var Cg=Bg.value;if(Cg instanceof Tk)Cg.traverse(pg);else if(Cg instanceof Sk)Cg.traverse(pg),rg=Cg.fa,Cg.traverseAncestors(pg);else if(Cg instanceof Rk)Cg.traverse(pg),rg=[Cg.Xc],Cg.traverseAncestors(pg);else throw Error("Highlight only molecules, residues and / or atoms selection");
}}catch(Ag){tg=!0,ug=Ag}finally{try{!sg&&yg["return"]&&yg["return"]()}finally{if(tg)throw ug;}}};
xg.By=function(og,pg,qg){var rg=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!1,sg=this.Dp(og);if(sg instanceof Tk){var tg=null;if(null!=qg)for(var tg=[],ug=sg.la,yg=ug.ka,Bg,Cg=qg[0]-1;Cg<qg[1];Cg++)if(rg?(Bg=ug.ax.Rr(Cg),Bg=yg[Bg]):(Bg=Cg,Bg=ug.wa(Bg)),null!=Bg){Bg=Bg.Qa();for(var Ag=0;Ag<=Bg.length;Ag++)tg.push(Bg[Ag])}0<tg.length&&sg.yb(pg,tg)}else throw Error("Selection must contain a single molecule selection");};xg.$w=function(og){Xk.ba().pn(og)};xg.QA=function(){Xk.ba().yc.play()};
xg.TA=function(){Xk.ba().yc.stop()};xg.yz=function(){Xk.ba().yc.pause()};xg.addListener=function(og,pg){Xk.ba().addListener(og,pg)};xg.zo=function(og,pg){Xk.ba().zo(og,pg)};xg.Dj=function(og,pg){if(1===og.length&&og[0]instanceof wi)var qg=og[0],rg=this.Ee(pg);else throw Error("Selection must contain a single object");return qg.pl(rg)};
xg.Ov=function(og){var pg=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1,qg=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(1===og.length)0<qg?this.ca.u.kj(og[0],qg,pg):this.ca.kd(og[0],pg);else throw Error("Selection must contain a single object");};xg.vv=function(og){if(1===og.length){var pg=og[0];og[0]instanceof gl&&(pg=pg.parent.parent);this.ca.u.zc(pg)}else throw Error("Selection must contain a single object");};
xg.ky=function(og){var pg;if(1!==og.length)throw Error("Selection must contain a single object");if(og[0]instanceof Tk){pg=og[0].pa;og=og[0].Ea();pg=pg.ka;for(var qg=0;qg<pg.length;qg++)if(!og.bs(pg[qg]))return!1;return!0}return og[0]instanceof Sk?(pg=og[0].bc,og=og[0].Bb().Ea(),og.bs(pg)):!1};xg.jy=function(og){if(1!==og.length)throw Error("Selection must contain a single object");return og[0].Ny()};xg.oy=function(){return 0!==this.ca.u.sa.length};
xg.xj=function(){for(var og=[],pg=this.ca,qg=pg.u.sa.length,rg=0;rg<qg;rg++){var sg=pg.u.sa[rg];sg instanceof em&&og.push(sg.af())}return og};xg.Kx=function(og){var pg=[];og=this.uh(og).Fa.keys();for(var qg=0,rg=og.length;qg<rg;qg++){var sg=og[qg];pg.push(sg.ja.name+":"+sg.id)}return pg};xg.Dm=function(og){var pg=[];og=this.uh(og).Fa.keys();for(var qg=0,rg=og.length;qg<rg;qg++)pg.push(og[qg]);return pg};
xg.Xx=function(og){var pg=[];og=this.uh(og).Fa.keys();for(var qg=0,rg=og.length;qg<rg;qg++){var sg=og[qg];"Protein"!==sg.ja.name&&"Peptide"!==sg.ja.name&&"Small Peptide"!==sg.ja.name||pg.push(sg.ja.name+":"+sg.id)}return pg};xg.$x=function(og,pg){for(var qg=this.Ji(og,pg).pa.ka,rg=[],sg=0;sg<qg.length;sg++)rg.push(qg[sg].toString());return rg};xg.re=function(og,pg){var qg=this;return this.ca.re(og,pg).then(function(og){return qg.um(og)})["catch"](function(og){return Promise.reject(og)})};
xg.ql=function(og,pg){var qg=this;return this.ca.ql(og,pg).then(function(og){return qg.um(og)})["catch"](function(og){return Promise.reject(og)})};xg.Oq=function(og){var pg=this.Ie(og);if(null==pg)throw Error("Structure with id: "+og+" not found");this.ca.so(pg)};xg.Gw=function(){for(var og=this.xj(),pg=0,qg=og.length;pg<qg;pg++)this.Oq(og[pg])};xg.Ol=function(og,pg,qg,rg,sg){this.ca.u.Ol(og,pg,qg,rg,sg)};
xg.JA=function(og,pg){var qg=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0,rg=arguments[3],sg=4<arguments.length&&void 0!==arguments[4]?arguments[4]:10,tg=[Promise.resolve()],ug=[],yg=new THREE.Vector3,Bg=0;if(null!=rg)for(var Cg=0,Ag=rg.length;Cg<Ag;Cg++){var wg=rg[Cg].la;if(wg instanceof Rg)yg.add(wg.pos),Bg++;else for(var wg=wg.Qa(),Dg=0,Eg=wg.length;Dg<Eg;Dg++)yg.add(wg[Dg].pos),Bg++}ug.push(yg.divideScalar(Bg));for(var Fg=[],rg=this.Ee(pg),yg=0,Bg=og.length;yg<Bg;yg++)Cg=og[yg].hb(rg),
tg.push.apply(tg,Wh(this.Tj(og,pg))),Fg.push(Cg);Promise.all(tg).then(function(){var og=!0,pg=!1,rg=void 0;try{for(var tg=Fg[Symbol.iterator](),wg;!(og=(wg=tg.next()).done);og=!0){var yg=wg.value;null!=yg&&(qg?yg.da.Rq(ug,sg):yg.da.Pq())}}catch(Sg){pg=!0,rg=Sg}finally{try{!og&&tg["return"]&&tg["return"]()}finally{if(pg)throw rg;}}})};xg.Tj=function(og,pg){for(var qg=[Promise.resolve()],rg=this.Ee(pg),sg=0,tg=og.length;sg<tg;sg++)qg.push(og[sg].show(rg));Xk.ba().fi();return qg};
xg.Or=function(og,pg){for(var qg=this.Ee(pg),rg=0,sg=og.length;rg<sg;rg++)og[rg].hide(qg);Xk.ba().fi()};xg.show=function(og,pg){for(var qg=[],rg=0,sg=og.length;rg<sg;rg++){var tg=og[rg];tg.show();pg&&tg.traverseAncestors(function(og){(og instanceof gl||og instanceof Tk||og instanceof Sk)&&qg.push(og)})}0!=qg.length&&this.show(qg);this.ca.u.Uo()};
xg.hide=function(og,pg){for(var qg=[],rg=0,sg=og.length;rg<sg;rg++){var tg=og[rg];tg.hide();pg&&tg.traverse(function(og){(og instanceof Tk||og instanceof Sk||og instanceof Rk)&&qg.push(og)})}0!=qg.length&&this.hide(qg);this.ca.u.Uo()};xg.Ty=function(og){if(1===og.length)return og[0].visible;throw Error("Selection must contain a single object");};
xg.gc=function(og,pg){var qg,rg;if(1!==og.length)throw Error("Selection must contain a single object");if(og[0]instanceof Tk)qg=og[0].pa,rg=og[0].Ea();else if(og[0]instanceof Sk)qg=og[0].bc,rg=og[0].Bb().Ea();else throw Error("Selection item is not a Molecule or a Residue");rg.gc(qg,pg)};
xg.xy=function(og){var pg;if(1!==og.length)throw Error("Selection must contain a single object");if(og[0]instanceof Tk)pg=og[0].pa.ka,og=og[0].Ea();else if(og[0]instanceof Sk)pg=og[0].bc,og=og[0].Bb().Ea();else throw Error("Selection item is not a Molecule or a Residue");og.Od(pg)};
xg.Pk=function(og,pg,qg){pg[0]instanceof gl&&(pg=pg.concat(pg[0].cc()));var rg=hi.za.cl(og);null==rg&&(rg=og);og=0;for(var sg=pg.length;og<sg;og++)if(null!=pg[og])for(var tg=pg[og].vc(),ug=0,yg=tg.length;ug<yg;ug++){var Bg=tg[ug].Nj;null!=qg&&Bg!==qg||tg[ug].color(rg)}};
xg.jg=function(og,pg,qg){if(1!==pg.length)throw Error("Selection must contain a single object");pg[0]instanceof em&&(pg=pg[0].Ea().cc());pg[0]instanceof gl&&(pg=pg[0].cc());for(var rg=0,sg=pg.length;rg<sg;rg++)if(null!=pg[rg])for(var tg=pg[rg].vc(),ug=0,yg=tg.length;ug<yg;ug++){var Bg=tg[ug].Nj;null!=qg&&Bg!==qg||tg[ug].jg(og)}};
xg.Gr=function(og){var pg=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,qg=new Map,rg=null,sg=null;null==og&&(og=this.ca.u.sa.map(function(og){if(og instanceof em)return og.Ea()}));var tg=!0,ug=!1,yg=void 0;try{for(var Bg=og[Symbol.iterator](),Cg;!(tg=(Cg=Bg.next()).done);tg=!0){var Ag=Cg.value;Ag instanceof em&&(Ag=Ag.Ea());Ag instanceof wi&&!(Ag instanceof gl)&&(rg=Ag.vc(),sg=Ag.la.eb(),0<rg.length&&qg.set(sg,rg.map(function(og){return og.Nj})));if(pg||Ag instanceof gl)var wg=this.Gr(Ag.children,
pg),qg=new Map([].concat(Wh(wg),Wh(qg)))}}catch(Dg){ug=!0,yg=Dg}finally{try{!tg&&Bg["return"]&&Bg["return"]()}finally{if(ug)throw yg;}}return qg};xg.$v=function(og,pg){if(1!=og.length||!(og[0]instanceof Tk))throw Error("Selection must contain a single object");var qg=og[0];qg.pa.qA(pg);var rg=this.Ee(mo.dk);qg.hb(rg).update({OA:!0})};xg.Nv=function(og){this.ca.capture(this.Ie(og))};xg.dA=function(og){this.ca.Gs(new THREE.Color(og))};
xg.Vl=function(){this.ca.Vl(0<arguments.length&&void 0!==arguments[0]?arguments[0]:.1)};xg.Xj=function(){this.ca.Xj()};xg.$l=function(){this.ca.u.$l()};xg.fh=function(og){var pg=this.ca.u.Zz(og,1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1),qg="height="+window.innerHeight+",width="+window.innerWidth+",dialog",rg=window.URL||window.webkitURL;pg.then(function(og){og=rg.createObjectURL(og);window.open(og,"BiovizJS Screenshot",qg)})};xg.sj=function(og){return this.Ie(og).sj()};
xg.kg=function(og,pg){var qg=this.Ie(og);qg.kg(pg);this.ca.u.Uo(qg,void 0===pg);this.ca.gh();this.ca.kd(qg,!0);Xk.ba().Hb({type:"requestWidgetUpdate"})};xg.Ly=function(og){return this.Ie(og).Vn()};xg.Fd=function(og){return this.Ie(og).Fd()};window.BiovizAPI=ro.prototype.constructor;ro.prototype.RepresentationTypeID=mo;ro.prototype.LabelTypeID=oo;ro.prototype.ColorMappingID=po;ro.prototype.ObjectTypeID=qo;function so(og){this.ia=og;this.ta=new Vg}xg=so.prototype;
xg.nc=function(){return structure+"@"+chain};xg.Um=function(og){this.ta.set(og,[])};xg.Xm=function(og,pg){this.ta.get(og).push(pg)};xg.ur=function(og){return this.ta.get(og)};xg.er=function(){return this.ta.keys()};function to(og,pg,qg){this.type=og;this.yo=pg;this.xo=qg}to.prototype.Sx=function(){switch(this.type){case uo.ea.oh:return["Protein","Small Peptide","Peptide","DNA","RNA"];case uo.ea.yg:return["Solvent","Ligand"];case uo.ea.lh:return["Ligand","Solvent"]}};
to.prototype.toString=function(){var og="";switch(this.type){case uo.ea.oh:og+="T";break;case uo.ea.yg:og+="S";break;case uo.ea.lh:og+="L"}null!=this.yo&&null!=this.xo&&(og+="."+this.yo+"."+this.xo);return og};function uo(){}uo.ea={oh:"TARGET",yg:"SOLVENT",lh:"LIGAND"};uo.lx=function(og){switch(og){case "Protein":case "Small Peptide":case "Peptide":case "DNA":case "RNA":return uo.ea.oh;case "Solvent":return uo.ea.yg;case "Ligand":return uo.ea.lh;default:return null}};
uo.tn=function(og){switch(og.tf){case "GLY":case "ALA":case "VAL":case "LEU":case "ILE":case "PRO":case "PHE":case "MET":case "TRP":case "SER":case "THR":case "ASN":case "GLN":case "ASP":case "GLU":case "CYS":case "TYR":case "HIS":case "LYS":case "ARG":case "ASX":case "GLX":case "DA":case "DC":case "DG":case "DT":case "DI":case "DU":case "+A":case "+C":case "+G":case "+T":case "+I":case "+U":case "A":case "C":case "G":case "T":case "I":case "U":case "UNK":case "DN":case "N":case "HEM":return uo.ea.oh;case "HOH":case "DOD":case "GOL":case "EDO":return uo.ea.yg;
default:return 10<og.Qa().length?uo.ea.lh:uo.ea.yg}};uo.un=function(og){switch(og.toUpperCase()){case "T":case "TAR":case "TARGET":return uo.ea.oh;case "L":case "LIG":case "LIGAND":return uo.ea.lh;case "S":case "SOL":case "SOLVENT":return uo.ea.yg;default:return uo.ea.oh}};function vo(og){this.ta=new Vg;null!=og&&this.un(og)}xg=vo.prototype;
xg.un=function(og){og=og.split("+");for(var pg=0;pg<og.length;pg++){var qg=og[pg].split("/"),rg=qg[0].toUpperCase(),sg=new so(rg);this.ta.set(rg,sg);for(var rg=qg.slice(1),tg=0;tg<rg.length;tg++){var qg=rg[tg].split(":"),ug=qg[0].toUpperCase();sg.Um(ug);for(var qg=qg[1].split(","),yg=0;yg<qg.length;yg++){var Bg,Cg=null,Ag=null,wg=qg[yg].split(".");Bg=wg[0].toUpperCase();3===wg.length&&(Cg=wg[1].toUpperCase(),Ag=parseFloat(wg[2]));sg.Xm(ug,new to(uo.un(Bg),Cg,Ag))}}}};
xg.kx=function(og){var pg=og.split(":");og=pg[0].substr(0,4);var qg=pg[1],rg=pg[2],sg=null,tg=null;3<pg.length&&(sg=pg[3],tg=pg[4]);pg=new so(og);pg.Um(rg);this.ta.set(og,pg);pg.Xm(rg,new to(uo.lx(qg),sg,tg))};xg.tn=function(og){var pg=og.Ja().Ua.oa(),qg=og.Ja().oa(),rg=og.gb,sg=og.oa(),tg=new so(pg);tg.Um(qg);this.ta.set(pg,tg);og=new to(uo.tn(og),rg,sg);tg.Xm(qg,og)};xg.wj=function(){return this.ta.Nz()};xg.dr=function(og){return this.ta.get(og)};xg.rr=function(){return this.ta.keys().length};
xg.toString=function(){for(var og="",pg=this.wj(),qg=0,rg=pg.length;qg<rg;qg++){0<qg&&(og+="+");for(var sg=pg[qg],og=og+(sg+"/"),sg=this.dr(sg),tg=sg.er(),ug=0,yg=tg.length;ug<yg;ug++){0<ug&&(og+="/");for(var Bg=tg[ug],Cg=sg.ur(Bg),og=og+(Bg+":"),Bg=0,Ag=Cg.length;Bg<Ag;Bg++)og+=Cg[Bg].toString()}}return og};function wo(og,pg,qg){wi.call(this);this._id=og;this.ud=[];this.mg=null;this.Wf=[];this.u=qg;this.u.Lb=this;this.u.add(this)}wo.prototype=Object.create(wi.prototype);xg=wo.prototype;
xg.constructor=wo;xg["delete"]=function(){wi.prototype["delete"].call(this);var og=this;this.traverse(function(pg){pg===og.u.ca.je&&(console.log("hasAnchor"),og.u.ca.je=null);pg===og.u.ca.Ib&&(console.log("hasTarget"),og.u.ca.Ib=og.u)});for(var pg=this.parent.sa,qg=0,rg=this.ud.length;qg<rg;qg++)pg.splice(pg.indexOf(this.ud[qg]),1),this.ud[qg]["delete"]();this.mg["delete"]();pg.splice(pg.indexOf(this.mg),1);qg=0;for(rg=this.Wf.length;qg<rg;qg++)this.Wf[0]["delete"]();this.Wf=null;this.u.Lb=null;this.parent.remove(this)};
xg.Ym=function(og){this.u.ws(og);this.u.remove(og);this.ud.push(og);this.u.aj(og);og.u=this.u;this.add(og);var pg=this;og.wb=function(){var og=null,rg=this.Ea(),sg;for(sg in rg.Fa.keys()){var tg=rg.Fa.get(rg.Fa.keys()[sg]),ug=tg.wb().clone();ug.applyMatrix4(tg.matrix);og=null===og?ug:og.merge(ug)}og.applyMatrix4(pg.matrix);return og}};xg.jq=function(og){this.mg=og;this.u.aj(og);this.add(og)};xg.lv=function(og){this.Wf.push(og);this.add(og)};
xg.el=function(og){for(var pg=0,qg=this.Wf.length;pg<qg;pg++){var rg=this.Wf[pg];if(rg._id===og)return rg}return null};xg.vd=function(){};function xo(og){hi.call(this,og);this.Lb=og.Lb;this.Oo=og.Fn}xo.prototype=Object.create(hi.prototype);xo.prototype.constructor=xo;ih.bp=new hh("BVS Matching","BVSMatching","BVS_MATCHING",xo);xo.prototype.Dc=function(){this.ga.Vh?this.Rw():this.Uw()};xo.prototype.update=function(){};
xo.prototype.Uw=function(){var og=new THREE.CylinderGeometry(.1,.1,1),pg=(new THREE.BufferGeometry).fromGeometry(og),qg=this.fa.length/2,rg=pg.attributes.position.array.length/pg.attributes.position.itemSize,sg=qg*rg,og=new THREE.BufferGeometry,tg=new Float32Array(3*sg),ug=new Float32Array(3*sg),yg=new Float32Array(3*sg),Bg=new Float32Array(2*sg),sg=new Float32Array(sg),Cg=new THREE.Matrix4;Cg.makeRotationX(.5*Math.PI);for(var Ag=0;Ag<qg;Ag++){var wg=this.fa[2*Ag+1],Dg=this.cb.Pl[Ag],Eg=this.fa[2*
Ag].pos.clone(),Fg=wg.pos.clone(),wg=(new THREE.Matrix4).getInverse(this.Oo.matrix);Eg.applyMatrix4(wg);var Jg=(new THREE.Vector3).addVectors(Eg,Fg).multiplyScalar(.5),wg=(new THREE.Vector3).subVectors(Eg,Fg);if(!wg.equals(new THREE.Vector3)){var Ig=new THREE.Vector3(1,wg.length(),1),Lg=new THREE.Matrix4;Lg.lookAt(Fg,Eg,new THREE.Vector3(0,1,0));Lg.multiply(Cg);Lg.setPosition(Jg);Lg.scale(Ig);Jg=pg.clone();Jg.applyMatrix(Lg);Eg=Jg.attributes.position.array;Fg=Jg.attributes.normal.array;Lg=Jg.attributes.color.array;
Jg=Jg.attributes.uv.array;Dg=xo.Bm(wg.length(),Dg);wg=Eg.length/3;for(Ig=0;Ig<wg;Ig++){for(var Kg=0;3>Kg;Kg++)tg[Ag*Eg.length+3*Ig+Kg]=Eg[3*Ig+Kg],ug[Ag*Fg.length+3*Ig+Kg]=Fg[3*Ig+Kg],yg[Ag*Lg.length+3*Ig+Kg]=Dg[Kg];for(Kg=0;2>Kg;Kg++)Bg[Ag*Jg.length+2*Ig+Kg]=Jg[2*Ig+Kg];sg[Ag*rg+Ig]=Ag}}}og.addAttribute("position",new THREE.BufferAttribute(tg,3));og.addAttribute("normal",new THREE.BufferAttribute(ug,3));Lg=new THREE.BufferAttribute(yg,3);Lg.dynamic=!0;og.addAttribute("color",Lg);og.addAttribute("uv",
new THREE.BufferAttribute(Bg,2));og.addAttribute("atomIndex",new THREE.BufferAttribute(sg,1));og.oe();pg=this.ga.Ye();og=new THREE.Mesh(og,pg);og.Ma=this;this.parent.add(og);this.da=og};
xo.prototype.Rw=function(){for(var og=new THREE.BufferGeometry,pg=[],qg=[],rg=[],sg=[],tg=this.fa.length/2,ug=0;ug<tg;ug++){var yg=this.fa[2*ug],Bg=this.fa[2*ug+1],Cg=this.cb.Pl[ug],yg=yg.pos.clone(),Bg=Bg.pos.clone(),Ag=(new THREE.Matrix4).getInverse(this.Oo.matrix);yg.applyMatrix4(Ag);Ag=(new THREE.Vector3).subVectors(yg,Bg);Cg=xo.Bm(Ag.length(),Cg);pg.push(Bg.x);pg.push(Bg.y);pg.push(Bg.z);rg.push(0);rg.push(0);rg.push(0);qg.push(.1);sg.push(Cg[0]);sg.push(Cg[1]);sg.push(Cg[2]);pg.push(yg.x);pg.push(yg.y);
pg.push(yg.z);rg.push(0);rg.push(0);rg.push(0);qg.push(.1);sg.push(Cg[0]);sg.push(Cg[1]);sg.push(Cg[2])}for(ug=0;ug<tg;ug++)yg=this.fa[2*ug],Bg=this.fa[2*ug+1],Cg=this.cb.Pl[ug],yg=yg.pos.clone(),Bg=Bg.pos.clone(),Ag=(new THREE.Matrix4).getInverse(this.Oo.matrix),yg.applyMatrix4(Ag),Ag=(new THREE.Vector3).subVectors(yg,Bg),Ag.equals(new THREE.Vector3)||(Cg=xo.Bm(Ag.length(),Cg),pg.push(Bg.x),pg.push(Bg.y),pg.push(Bg.z),rg.push(Ag.x),rg.push(Ag.y),rg.push(Ag.z),qg.push(.1),sg.push(Cg[0]),sg.push(Cg[1]),
sg.push(Cg[2]));og.addAttribute("position",new THREE.Float32BufferAttribute(pg,3));pg=new THREE.Float32BufferAttribute(sg,3);pg.dynamic=!0;og.addAttribute("color",pg);og.addAttribute("radius",new THREE.Float32BufferAttribute(qg,1));og.addAttribute("dir",new THREE.Float32BufferAttribute(rg,3));og.oe();og.Qk();rg=this.ga.jl();pg=this.ga.zn();rg=[rg,pg];og.addGroup(0,2*tg,0);og.addGroup(2*tg,qg.length,1);og=new Hi(og,rg);og.Ma=this;this.parent.add(og);this.da=og};
xo.Ft=[new THREE.Color(.7,.7,.7),new THREE.Color(0,1,0)];xo.ut=[new THREE.Color(1,0,0),new THREE.Color(.9,.5,.1)];xo.Et=[.5,1];xo.tt=[.25,.75];xo.Bm=function(og,pg){return(5<og||.5>pg||.7>pg&&4<og?xo.Yp(xo.ut,xo.tt,pg):xo.Yp(xo.Ft,xo.Et,pg)).toArray()};
xo.Yp=function(og,pg,qg){var rg=pg[0],sg=pg[1];if(qg>=rg&&qg<=sg){var tg=og.length-1;pg=(sg-rg)/tg;sg=Math.ceil((qg-rg)/(sg-rg)*tg)-1;tg=rg+sg*pg;qg=(qg-tg)/(rg+(sg+1)*pg-tg);rg=og[sg].clone();og=og[sg+1].clone();rg.lerp(og,qg);og=rg}else og=qg<rg?og[0]:og[og.length-1];return og};
function yo(og,pg,qg){wi.call(this);this.Lb=og;this.Fn=pg;this.zl=qg;this.pf=new THREE.Object3D;this.add(this.pf);this.pf.visible=!1;this.Ue=new THREE.Object3D;this.add(this.Ue);this.Ue.visible=!1;this.fa=Array(2*this.zl.length);this.Pl=Array(this.zl.length);this.ju();og=this.hb(ih.bp);null!==og&&void 0!==og&&og.show();this.jb=!0;this.visible=!1}yo.prototype=Object.create(wi.prototype);yo.prototype.constructor=yo;Gi.add(yo,[ih.bp]);xg=yo.prototype;xg["delete"]=function(){wi.prototype["delete"].call(this)};
xg.show=function(){this.jb=this.visible=!0};xg.hide=function(){this.visible=!1;this.jb=!0};xg.yA=function(){this.Ue.visible=!1;this.pf.visible=!0;this.Ue.jb=!0;this.pf.jb=!0};xg.yy=function(){this.pf.visible=!1;this.pf.jb=!0};xg.wA=function(){this.pf.visible=!1;this.Ue.visible=!0;this.pf.jb=!0;this.Ue.jb=!0};xg.vy=function(){this.Ue.visible=!1;this.Ue.jb=!0};xg.Pp=function(og,pg){for(var qg=null,rg=0,sg=og.length;rg<sg;rg++){var tg=og[rg];tg.name+"."+tg.id===pg.split(".",2).join(".")&&(qg=tg)}return qg};
xg.ju=function(){for(var og=this.Lb.ud[0].ia.gl().Qa(),pg=this.Fn.ud[0].ia.gl().Qa(),qg=0,rg=this.zl.length;qg<rg;qg++){var sg=this.zl[qg],tg=this.Pp(og,sg.queryAtom),ug=this.Pp(pg,sg.targetAtom),sg=parseFloat(sg.value);this.fa[2*qg]=tg;this.fa[2*qg+1]=ug;this.Pl[qg]=sg;var tg=tg.pos.clone(),ug=ug.pos.clone(),yg=(new THREE.Matrix4).getInverse(this.Fn.matrix);tg.applyMatrix4(yg);yg=(new THREE.Vector3).addVectors(tg,ug).multiplyScalar(.5);tg=(new THREE.Vector3).subVectors(tg,ug).length();this.pf.add(this.Hp(sg.toFixed(2),
yg));this.Ue.add(this.Hp(tg.toFixed(2),yg))}};xg.Hp=function(og,pg){var qg=this.ga.ll(og,15);return vi.xr(qg,pg)};xg.vd=function(){};function zo(og,pg){wi.call(this);this._id=og;this.ud=[];this.mg=null;this.Lb=pg;this.Lb.lv(this);this.Yg={}}zo.prototype=Object.create(wi.prototype);xg=zo.prototype;xg.constructor=zo;
xg["delete"]=function(){wi.prototype["delete"].call(this);var og=this;this.traverse(function(pg){pg===og.Lb.u.ca.je&&(og.Lb.u.ca.je=null);pg===og.Lb.u.ca.Ib&&(og.Lb.u.ca.Ib=og.Lb.u)});for(var pg=this.Lb.parent.sa,qg=0,rg=this.ud.length;qg<rg;qg++)pg.splice(pg.indexOf(this.ud[qg]),1),this.ud[qg]["delete"]();for(var sg in this.Yg)this.remove(this.Yg[sg]),this.Yg[sg]["delete"]();null!=this.mg&&(pg.splice(pg.indexOf(this.mg),1),this.mg["delete"]());this.Lb.Wf.splice(this.Lb.Wf.indexOf(this),1);this.parent.remove(this)};
xg.Ym=function(og){this.Lb.u.ws(og);this.Lb.u.remove(og);this.ud.push(og);this.Lb.u.aj(og);this.add(og);var pg=this;og.wb=function(){var og=null,rg=this.Ea(),sg;for(sg in rg.Fa.keys()){var tg=rg.Fa.get(rg.Fa.keys()[sg]),ug=tg.wb().clone();ug.applyMatrix4(tg.matrix);og=null===og?ug:og.merge(ug)}og.applyMatrix4(pg.matrix);return og};og.updateMatrixWorld(!0)};xg.jq=function(og){this.mg=og;this.Lb.u.aj(og);this.add(og)};xg.show=function(){this.jb=this.visible=!0};
xg.hide=function(){this.visible=!1;this.jb=!0};xg.Ts=function(og,pg){var qg=this.Yg[og];qg&&(pg?qg.show():qg.hide())};xg.Vs=function(og,pg){var qg=this.Yg[og];qg&&(pg?qg.yA():qg.yy())};xg.Us=function(og,pg){var qg=this.Yg[og];qg&&(pg?qg.wA():qg.vy())};xg.Bw=function(og){for(var pg=0,qg=og.length;pg<qg;pg++){var rg=og[pg],sg=new yo(this.Lb,this,rg.qTips);this.Yg[rg.type]=sg;this.add(sg)}};xg.vd=function(){};function Ao(og){hi.call(this,og);this.Ug=og.Ug}Ao.prototype=Object.create(hi.prototype);
Ao.prototype.constructor=Ao;ih.em=new hh("BVS Surface","BVSSurface","BVS_SURFACE",Ao);
Ao.prototype.Dc=function(){for(var og=new Ni(!0),pg=this.Ug.Mx(),qg=0;qg<pg.length;qg++){var rg=pg[qg].De;og.Lg(rg.pos.x,rg.pos.y,rg.pos.z,new THREE.Color("#AAAA00"));og.Ig(this.cb.fa.indexOf(rg))}for(qg=0;qg<pg.length;qg++){var rg=pg[qg],sg=rg.me();if(sg)for(var tg=0;tg<sg.length;tg++){var ug=sg[tg];if(ug.Ej)for(var ug=ug.ne(rg),yg=ug.me(),Bg=0;Bg<yg.length;Bg++){var Cg=yg[Bg];Cg.Ej&&(Cg=Cg.ne(ug),Cg!==rg&&Cg.Mr(rg)&&og.ed(rg._id,ug._id,Cg._id))}}}og=og.Og();pg=this.ga.Ye(!0);pg.shading=THREE.FlatShading;
pg.vertexColors=THREE.FaceColors;pg.side=THREE.DoubleSide;og=new THREE.Mesh(og,pg);og.la=this.Xa;og.Ma=this;this.parent.add(og);this.da=og};Ao.prototype.update=function(){};function Bo(og){Li.call(this,og);this.hd=og.Ug}Bo.prototype=Object.create(Li.prototype);Bo.prototype.constructor=Bo;ih.cp=new hh("BVS Mesh","BVSMesh","BVS_MESH",Bo);
Bo.prototype.Dc=function(){Li.prototype.Dc.call(this);this.da.material.color=new THREE.Color(.7,.7,.7);this.da.material.needsUpdate=!0;this.da.material.depthFunc=THREE.LessDepth;this.color(hi.za.An("residue"))};function tq(og){Li.call(this,og);this.Ug=og.Ug;this.fa=this.Bu()}tq.prototype=Object.create(Li.prototype);tq.prototype.constructor=tq;ih.ep=new hh("BVS Residues","BVSResidues","BVS_RESIDUES",tq);
tq.prototype.Bu=function(){for(var og=this.fa.length,pg=[],qg=[],rg=0;rg<og;rg++){var sg=this.fa[rg].wa();if(!(0<=pg.indexOf(sg))){var tg=sg.Qa(),qg=qg.concat(tg);pg.push(sg)}}return qg};function uq(og,pg,qg){wi.call(this);this.xs=og;this.xs.jq(this);this.name=qg;this.Yj=this.xs.ud[0];this.la=this.Yj.ia.gl();this.Ug=this.ku(pg);this.fa=this.Ug.values();this.updateMatrixWorld(!0);this.hb(ih.em).show()}uq.prototype=Object.create(wi.prototype);uq.prototype.constructor=uq;
Gi.add(uq,[ih.em,ih.cp,ih.ep,ih.dm]);xg=uq.prototype;xg["delete"]=function(){wi.prototype["delete"].call(this)};xg.af=function(){return this.name};xg.reset=function(){};xg.lf=function(){};xg.Gc=function(){return this.wb().getCenter()};
xg.gc=function(og,pg){switch(pg){case void 0:case gl.Ia.Ud:var qg=!0,rg=!1,sg=void 0;try{for(var tg=this.fa[Symbol.iterator](),ug;!(qg=(ug=tg.next()).done);qg=!0){var yg=ug.value.wa();this.Ub(yg,yg.toString(),yg.bl(),this)}}catch(Bg){rg=!0,sg=Bg}finally{try{!qg&&tg["return"]&&tg["return"]()}finally{if(rg)throw sg;}}break;case gl.Ia.Fb:case gl.Ia.Vd:tg=!0;ug=!1;yg=void 0;try{for(qg=this.fa[Symbol.iterator]();!(tg=(rg=qg.next()).done);tg=!0)sg=rg.value,this.Ub(sg,sg.toString(),sg.xb(),this)}catch(Bg){ug=
!0,yg=Bg}finally{try{!tg&&qg["return"]&&qg["return"]()}finally{if(ug)throw yg;}}}};xg.wb=function(og){for(var pg=new THREE.Vector3(Infinity,Infinity,Infinity),qg=new THREE.Vector3(-Infinity,-Infinity,-Infinity),rg=0,sg=this.fa.length;rg<sg;rg++){var tg=this.fa[rg].pos;pg.x=Math.min(pg.x,tg.x);pg.y=Math.min(pg.y,tg.y);pg.z=Math.min(pg.z,tg.z);qg.x=Math.max(qg.x,tg.x);qg.y=Math.max(qg.y,tg.y);qg.z=Math.max(qg.z,tg.z)}pg=new Hg(pg,qg);(null==og||og)&&pg.applyMatrix4(this.parent.matrix);return pg};
xg.vd=function(){};
xg.ku=function(og){var pg=new ch,qg=this.la.Qa(),rg=og.triangles;if(rg)for(var sg=0;sg<rg.length;sg++){for(var tg=rg[sg].v1,ug=rg[sg].v2,yg=rg[sg].v3,Bg=null,Cg=null,Ag=null,wg=0;wg<qg.length&&(null==Bg||null==Cg||null==Ag);wg++){var Dg=qg[wg],Eg=Dg.name+"."+Dg.id;Eg===tg.split(".",2).join(".")&&(Bg=Dg);Eg===ug.split(".",2).join(".")&&(Cg=Dg);Eg===yg.split(".",2).join(".")&&(Ag=Dg)}wg=pg.findNode(Bg);null==wg&&(wg=pg.Jg(Bg));Dg=pg.findNode(Cg);null==Dg&&(Dg=pg.Jg(Cg));Eg=pg.findNode(Ag);null==Eg&&
(Eg=pg.Jg(Ag));yg=!1;if(Cg=pg.uj(wg))for(Bg=0,tg=Cg.length;Bg<tg;Bg++)if(Cg[Bg].ne(wg)===Dg){yg=!0;break}Ag=!1;if(Cg=pg.uj(Dg))for(Bg=0,tg=Cg.length;Bg<tg;Bg++)if(Cg[Bg].ne(Dg)===Eg){Ag=!0;break}ug=!1;if(Cg=pg.uj(Eg))for(Bg=0,tg=Cg.length;Bg<tg;Bg++)if(Cg[Bg].ne(Eg)===wg){ug=!0;break}yg||(Cg=pg.Gh(wg,Dg),Cg.Ej=!0);Ag||(Cg=pg.Gh(Dg,Eg),Cg.Ej=!0);ug||(Cg=pg.Gh(Eg,wg),Cg.Ej=!0)}Ag=og.edges;for(sg=0;sg<Ag.length;sg++){tg=Ag[sg].v1;ug=Ag[sg].v2;Cg=Bg=null;for(wg=0;wg<qg.length&&(null==Bg||null==Cg);wg++)Dg=
qg[wg],Eg=Dg.name+"."+Dg.id,Eg===tg.split(".",2).join(".")&&(Bg=Dg),Eg===ug.split(".",2).join(".")&&(Cg=Dg);wg=pg.findNode(Bg);null==wg&&(wg=pg.Jg(Bg));Dg=pg.findNode(Cg);null==Dg&&(Dg=pg.Jg(Cg));Eg=!1;if(Cg=pg.uj(wg))for(Bg=0,tg=Cg.length;Bg<tg;Bg++)if(Cg[Bg].ne(wg)===Dg){Eg=!0;break}Eg||(Cg=pg.Gh(wg,Dg),rg||(Cg.Ej=!0))}og=og.isolated;for(sg=0;sg<og.length;sg++){rg=og[sg].value;Ag=null;for(wg=0;wg<qg.length&&null==Ag;wg++)Dg=qg[wg],Eg=Dg.name+"."+Dg.id,Eg===rg.split(".",2).join(".")&&(Ag=Dg);null==
pg.findNode(Ag)&&pg.Jg(Ag)}return pg};ro.prototype.BvsRepresentationTypeID={BALLS:ih.dm.name,RESIDUES:ih.ep.name,SURFACE:ih.em.name,MESH:ih.cp.name};xg=ro.prototype;
xg.az=function(og,pg,qg,rg,sg){var tg=this,ug=new vo(og);new vo(pg);var yg=new wo(qg,0,this.ca.u),Bg=ug.rr(),Cg=0;return(new Promise(function(Ag,wg){for(var Dg=0;Dg<Bg;Dg++){var Eg=ug.wj()[Dg];tg.ca.re(sg||Eg,qg).then(function(og){return tg.ca.Em(og)})["catch"](function(){wg("Structure too large, canceled structure loading")}).then(function(sg){yg.Ym(sg);sg=new uq(yg,rg,qg);for(var ug=tg.hl(qg,og),wg=0,Dg=ug.length;wg<Dg;wg++)ug[wg].Ul();var Eg=hi.za.cl(po.Atom),ug=tg.hl(qg,pg);1===ug.length&&ug[0].show(ih.xg).then(function(og){og.color(Eg)});
tg.ca.u.zc(sg);tg.ca.u.Ks(sg);tg.ca.gh();tg.ca.kd(sg,!0,1);tg.ca.rl=!0;Cg++===Bg-1&&Ag()})["catch"](function(og){console.warn("Error on loadStructure : ",og)})}})).then(function(){return"Query loaded"})};xg.Iw=function(){this.vh()["delete"]();this.ca.u.Ks();this.ca.gh();this.ca.u.Nc=!0;this.ca.rl=!1};
xg.$y=function(og,pg,qg,rg,sg){var tg=this,ug=[],yg=null,Bg=new vo(og),Cg=this.vh();if(null!=Cg.el(pg))return Promise.reject("Hit already loaded with alias "+pg);var Ag=Bg.rr(),wg=0;return(new Promise(function(Dg,Eg){for(var Fg=0;Fg<Ag;Fg++){var Jg=Bg.wj()[Fg];tg.ca.re(Jg,pg).then(function(og){return tg.ca.Em(og)})["catch"](function(){Eg("Structure too large, canceled structure loading")}).then(function(Ag){if(null!=Ag){yg=Ag;var Eg=new zo(pg,Cg),Fg=new THREE.Vector3(rg[4],rg[5],rg[6]),Ig=new THREE.Quaternion(rg[1],
rg[2],rg[3],rg[0]),Fg=(new THREE.Matrix4).compose(Fg,Ig,new THREE.Vector3(1,1,1));Eg.applyMatrix(Fg);Eg.updateMatrixWorld(!0);Eg.Ym(Ag);if(null!=qg)var Jg=new uq(Eg,qg,pg);for(var Ig=Bg.wj(),Fg=Ig.length,Sg=0;Sg<Fg&&Ig[Sg].toUpperCase()!==Ag.ia.Xp.toUpperCase();Sg++);null!=sg&&Eg.Bw(sg);Ig=tg.hl(pg,og);Ag=0;for(Eg=Ig.length;Ag<Eg;Ag++)Ig[Ag].Ul();Ig=hi.za.cl(po.Atom);ug=tg.Ic(pg+":Ligand",2);Sg=[];if(null!=Jg){Ag=Jg.wb(!1);for(var Jg=Ag.$e(),Qg=Ag.Ze(),vh=0,Eg=ug.length;vh<Eg;vh++){var dh=ug[vh],
di=[];Ag=0;for(var Fh=dh.fa.length;Ag<Fh;Ag++){var xh=dh.fa[Ag];xh.pos.x>=Jg.x&&xh.pos.x<=Qg.x&&xh.pos.y>=Jg.y&&xh.pos.y<=Qg.y&&xh.pos.z>=Jg.z&&xh.pos.z<=Qg.z&&di.push(xh)}if(0<di.length)for(Ag=0,Fh=di.length;Ag<Fh;Ag++)dh=di[Ag],dh=tg.ic(dh.wa().Ja().Ua._id,dh.wa().Ja().ja.name+":"+dh.wa().Ja().id,""+dh.wa()._id),Sg.includes(dh)||Sg.push(dh)}ug=Sg}tg.Tj(ug,mo.STICKS);tg.Pk(Ig,ug,mo.STICKS);tg.ca.gh();wg++===Fg-1&&Dg()}})}})).then(function(){return{hit:[yg.Ea()],hitLigands:ug}})};
xg.Hw=function(og){og=this.Ef(og);null!=og&&(og["delete"](),this.ca.gh(),this.ca.u.Nc=!0)};
xg.hl=function(og,pg){for(var qg=new Set,rg=new vo(pg),sg=rg.wj(),tg=sg.length,ug=0;ug<tg;ug++)for(var yg=rg.dr(sg[ug]),Bg=yg.er(),Cg=Bg.length,Ag=0;Ag<Cg;Ag++)for(var wg=Bg[Ag],Dg=yg.ur(wg),Eg=Dg.length,Fg=0;Fg<Eg;Fg++)for(var Jg=Dg[Fg],Ig=Jg.Sx(),Lg,Kg=0,Mg=Ig.length;Kg<Mg;Kg++)if(Lg=Ig[Kg],Lg=Jg.type==uo.ea.lh||Jg.type==uo.ea.yg?this.Ki(og,Lg+":"+wg,Jg.yo+":"+Jg.xo):this.Ji(og,Lg+":"+wg),null!=Lg){qg.add(Lg);break}return Array.from(qg)};xg.Uy=function(og,pg){var qg=this.Gf(og),rg=this.Ee(pg);return qg.pl(rg)};
xg.CA=function(og,pg){var qg=this.Gf(og),rg=this.Ee(pg);qg.show(rg)};xg.Vu=function(og){console.log(this.Gf(og).fa)};xg.Ay=function(og,pg){var qg=this.Gf(og),rg=this.Ee(pg);qg.hide(rg)};xg.BA=function(og,pg,qg){og=this.Gf(og);pg?og.gc(og,qg):og.Od()};xg.xA=function(og){og=this.vh().el(og);null!=og&&og.show()};xg.wy=function(og){og=this.vh().el(og);null!=og&&og.hide()};xg.zA=function(og){og[0].show();og=og[0].cc();for(var pg in og){var qg=og[pg];qg.la.ja!==fh.ea.xi?qg.hide():qg.show()}};
xg.AA=function(og){if(1!==og.length)throw Error("Selection must contain a single Structure3D");og[0].visible=!0;og=og[0].cc();for(var pg in og)og[pg].visible=!0};xg.jw=function(og,pg,qg,rg){og=this.Ie(og).cc();for(var sg in og){var tg=og[sg],ug=tg.la.type;if(ug===fh.ea.Td||ug===fh.ea.vg||ug===fh.ea.wg){var tg=tg.vc(),yg;for(yg in tg)tg[yg].color([pg,qg,rg])}}};
xg.lw=function(og,pg,qg){var rg=this.Gf(pg);pg=hi.za.cl(og);null==pg&&(pg=og);og=rg.vc();for(var sg in og)rg=og[sg].Nj,null!=qg&&rg!==qg||og[sg].color(pg)};xg.kw=function(og,pg,qg){pg=this.Gf(pg).vc();for(var rg in pg){var sg=pg[rg].Nj;null!=qg&&sg!==qg||pg[rg].color(og)}};xg.tA=function(og,pg){this.Ef(og).Ts(pg,!0)};xg.sy=function(og,pg){this.Ef(og).Ts(pg,!1)};xg.vA=function(og,pg){this.Ef(og).Vs(pg,!0)};xg.uy=function(og,pg){this.Ef(og).Vs(pg,!1)};xg.uA=function(og,pg){this.Ef(og).Us(pg,!0)};
xg.ty=function(og,pg){this.Ef(og).Us(pg,!1)};xg.Gf=function(og){var pg=this.ca.u,qg;for(qg in pg.sa){var rg=pg.sa[qg];if(rg instanceof uq&&rg.name===og)return pg.sa[qg]}return null};xg.vh=function(){return this.ca.u.Lb};xg.Ef=function(og){return this.vh().el(og)};
xg.Kw=function(og,pg,qg){var rg=new Map,sg=this.Ic(og)[0],tg=[];og=0;for(var ug=pg.length;og<ug;og++)tg.push(this.Ic(pg[og])[0]);var yg=[],Bg=new THREE.Vector3(Infinity,Infinity,Infinity),Cg=new THREE.Vector3(-Infinity,-Infinity,-Infinity);og=0;for(ug=tg.length;og<ug;og++)if(pg=tg[og],pg!==sg){var Ag=pg.fa;pg=0;for(var wg=Ag.length;pg<wg;pg++){var Dg=Ag[pg];Bg.min(Dg.pos);Cg.max(Dg.pos);yg.push(new Mk(Dg))}}tg=new Lk(Bg,Cg);tg.add(yg);tg.optimize();sg=sg.fa;og=0;for(ug=sg.length;og<ug;og++)for(Dg=
sg[og],yg=Dg.radius(),Bg=tg.Xk(Dg.pos,2*qg),pg=0,Cg=Bg.length;pg<Cg;pg++){var Ag=Bg[pg].getPoint(),wg=Ag.wa(),Eg=wg.Ja(),wg=Eg.Wh()?wg.eb():Eg.eb(),Eg=Ag.distanceTo(Dg),Fg=Ag.radius();Eg/(yg+Fg)<=qg&&(Eg=rg.get(wg),null==Eg&&(Eg=[],rg.set(wg,Eg)),Eg.push([Dg.eb(),Ag.eb()]))}return rg};xg.wx=function(og){var pg=new vo,qg=this.Ic(og)[0].la;qg instanceof Rl?pg.tn(qg):pg.kx(og);return pg.toString()};
xg.ux=function(){for(var og=[],pg=this.xj(),qg=pg.length,rg=0;rg<qg;rg++)for(var sg=pg[rg],tg=this.Dm(sg),ug=0,yg=tg.length;ug<yg;ug++){var Bg=tg[ug];Bg.Yh()&&og.push(sg+":"+Bg.toString())}return og};xg.tx=function(){for(var og=[],pg=this.xj(),qg=pg.length,rg=0;rg<qg;rg++)for(var sg=pg[rg],tg=this.Dm(sg),ug=0,yg=tg.length;ug<yg;ug++){var Bg=tg[ug];if(Bg.Yh())og.push(sg+":"+Bg.toString());else if(Bg.Wh())for(var Cg=Bg.ka,Ag=0,wg=Cg.length;Ag<wg;Ag++)og.push(sg+":"+Bg.toString()+":"+Cg[Ag].toString())}return og};
xg.cy=function(og,pg){for(var qg=[],rg=0,sg=og.length;rg<sg;rg++){var tg=this.Ic(og[rg][pg])[0].la.wa().eb();0>qg.indexOf(tg)&&qg.push(tg)}return qg};xg.sx=function(og,pg){for(var qg=[],rg=0,sg=og.length;rg<sg;rg++){var tg=this.Ic(og[rg][pg])[0];0>qg.indexOf(tg)&&qg.push(tg)}return qg};xg.Fx=function(og){return og.la.Ua.blob};xg.ic=function(og,pg,qg){return this.Ki(og,pg,qg)};xg.Qz=function(og){og[0].gw()};ro.prototype.createBioviz=ro.prototype.xw;ro.prototype.initBioviz=ro.prototype.Ey;
ro.prototype.initContextMenu=ro.prototype.Hn;ro.prototype.initWidgetManager=ro.prototype.On;ro.prototype.initScriptPlayer=ro.prototype.Nn;ro.prototype.isAvailable=ro.prototype.Ky;ro.prototype._disableImpostors=ro.prototype.wu;ro.prototype._setStructureSizeLimit=ro.prototype.Yu;ro.prototype.setExternalContextMenuDiv=ro.prototype.jA;ro.prototype.getCanvas=ro.prototype.al;ro.prototype._setDefaultRepresentations=ro.prototype.Xu;ro.prototype._notify=ro.prototype.Hb;ro.prototype._getStructure=ro.prototype.Ie;
ro.prototype._getModel=ro.prototype.uh;ro.prototype._getMolecule=ro.prototype.Ji;ro.prototype._getResidue=ro.prototype.Ki;ro.prototype._getAtom=ro.prototype.Sp;ro.prototype._getRepresentationType=ro.prototype.Ee;ro.prototype._checkSingleMolecule3DFromSelection=ro.prototype.Cp;ro.prototype._checkSingleObject3DFromSelection=ro.prototype.Dp;ro.prototype._afterLoaded=ro.prototype.um;ro.prototype.getMoleculeType=ro.prototype.Jx;ro.prototype.getObjects3DFromSelection=ro.prototype.Ic;
ro.prototype.getAvailableRepresentations=ro.prototype.tj;ro.prototype.linkWithExternalSequence=ro.prototype.eo;ro.prototype.resetRepresentations=ro.prototype.mf;ro.prototype.resetHighlights=ro.prototype.Tz;ro.prototype.resetPositions=ro.prototype.Ll;ro.prototype.resetScene=ro.prototype.Uz;ro.prototype.highlight=ro.prototype.yb;ro.prototype.highlightSequence=ro.prototype.By;ro.prototype.executeScript=ro.prototype.$w;ro.prototype.startScript=ro.prototype.QA;ro.prototype.stopScript=ro.prototype.TA;
ro.prototype.pauseScript=ro.prototype.yz;ro.prototype.addListener=ro.prototype.addListener;ro.prototype.setOption=ro.prototype.zo;ro.prototype.isRepresentationActive=ro.prototype.Dj;ro.prototype.centerOnSelection=ro.prototype.Ov;ro.prototype.anchorOnSelection=ro.prototype.vv;ro.prototype.hasLabels=ro.prototype.ky;ro.prototype.hasHighlight=ro.prototype.jy;ro.prototype.hasObject3D=ro.prototype.oy;ro.prototype.getStructuresByPDBID=ro.prototype.xj;ro.prototype.getMoleculesFromStructure=ro.prototype.Kx;
ro.prototype._getMoleculesFromStructure=ro.prototype.Dm;ro.prototype.getProteinicMoleculesFromStructure=ro.prototype.Xx;ro.prototype.getResiduesFromMolecule=ro.prototype.$x;ro.prototype.loadStructure=ro.prototype.re;ro.prototype.loadLocalStructure=ro.prototype.ql;ro.prototype.deleteStructure=ro.prototype.Oq;ro.prototype.deleteAllStructures=ro.prototype.Gw;ro.prototype.say=ro.prototype.Ol;ro.prototype.sphereClipRepresentation=ro.prototype.JA;ro.prototype.showRepresentation=ro.prototype.Tj;
ro.prototype.hideRepresentation=ro.prototype.Or;ro.prototype.show=ro.prototype.show;ro.prototype.hide=ro.prototype.hide;ro.prototype.isShown=ro.prototype.Ty;ro.prototype.showLabel=ro.prototype.gc;ro.prototype.hideLabel=ro.prototype.xy;ro.prototype.colorBy=ro.prototype.Pk;ro.prototype.setAlpha=ro.prototype.jg;ro.prototype.getVisibleRepresentations=ro.prototype.Gr;ro.prototype.changeSSE=ro.prototype.$v;ro.prototype.capturePosition=ro.prototype.Nv;ro.prototype.setBackground=ro.prototype.dA;
ro.prototype.startSpin=ro.prototype.Vl;ro.prototype.stopSpin=ro.prototype.Xj;ro.prototype.toggleFullscreen=ro.prototype.$l;ro.prototype.takeScreenshot=ro.prototype.fh;ro.prototype.getAvailableBioassemblies=ro.prototype.sj;ro.prototype.setBioassembly=ro.prototype.kg;ro.prototype.isBioassembly=ro.prototype.Ly;ro.prototype.isBigBioassembly=ro.prototype.Fd;ro.prototype.loadBvsQuery=ro.prototype.az;ro.prototype.deleteBvsQuery=ro.prototype.Iw;ro.prototype.loadBvsHit=ro.prototype.$y;
ro.prototype.deleteBvsHit=ro.prototype.Hw;ro.prototype.getObjects3DFromBVSSelection=ro.prototype.hl;ro.prototype.isSiteRepresentationActive=ro.prototype.Uy;ro.prototype.showSiteRepresentation=ro.prototype.CA;ro.prototype._printSiteAtomsList=ro.prototype.Vu;ro.prototype.hideSiteRepresentation=ro.prototype.Ay;ro.prototype.showSiteLabels=ro.prototype.BA;ro.prototype.showHit=ro.prototype.xA;ro.prototype.hideHit=ro.prototype.wy;ro.prototype.showLigandOnly=ro.prototype.zA;ro.prototype.showMolecules=ro.prototype.AA;
ro.prototype.colorMolecules=ro.prototype.jw;ro.prototype.colorSiteBy=ro.prototype.lw;ro.prototype.colorSite=ro.prototype.kw;ro.prototype.showBvsHitMatching=ro.prototype.tA;ro.prototype.hideBvsHitMatching=ro.prototype.sy;ro.prototype.showBvsHitMatchingLabels=ro.prototype.vA;ro.prototype.hideBvsHitMatchingLabels=ro.prototype.uy;ro.prototype.showBvsHitMatchingDistanceLabels=ro.prototype.uA;ro.prototype.hideBvsHitMatchingDistanceLabels=ro.prototype.ty;ro.prototype._getSite=ro.prototype.Gf;
ro.prototype._getQuery=ro.prototype.vh;ro.prototype._getHit=ro.prototype.Ef;ro.prototype.detectLigands=ro.prototype.Kw;ro.prototype.getBVSSelectionFromBiovizSelection=ro.prototype.wx;ro.prototype.getAvailableTargets=ro.prototype.ux;ro.prototype.getAvailableCompounds=ro.prototype.tx;ro.prototype.getSelectionFromInteraction=ro.prototype.cy;ro.prototype.getAtomSelectionFromInteraction=ro.prototype.sx;ro.prototype.getFileFromStructureSelection=ro.prototype.Fx;ro.prototype.getResidue3D=ro.prototype.ic;
ro.prototype.removeResidues3D=ro.prototype.Qz;
